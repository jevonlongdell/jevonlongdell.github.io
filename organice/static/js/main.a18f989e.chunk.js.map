{"version":3,"sources":["lib/headline_filter_parser.js","lib/id_generator.js","lib/timestamps.js","lib/export_org.js","lib/capture_template_substitution.js","lib/org_utils.js","actions/base.js","lib/sample_capture_templates.js","actions/capture.js","util/settings_persister.js","lib/headline_filter.js","lib/clocking.js","lib/parse_org.js","util/misc.js","reducers/org.js","util/file_persister.js","actions/org.js","middleware/live_sync.js","middleware/toggle_color_scheme.js","reducers/base.js","reducers/capture.js","reducers/index.js","reducers/sync_backend.js","store.js","util/parse_query_string.js","migrations/index.js","migrations/migrate_access_token_to_dropbox_access_token.js","migrations/migrate_store_in_dropbox_to_store_in_sync_backend.js","migrations/migrate_nonsense_values_in_localstorage.js","sync_backend_clients/gitlab_sync_backend_client.js","actions/sync_backend.js","sync_backend_clients/dropbox_sync_backend_client.js","sync_backend_clients/webdav_sync_backend_client.js","images/organice.svg","components/Landing/index.js","components/UI/ExternalLink/index.js","components/PrivacyPolicy/index.js","components/HeaderBar/index.js","components/OrgFile/components/ActionDrawer/components/ActionButton/index.js","components/FileBrowser/components/ActionDrawer/index.js","components/FileBrowser/index.js","components/LoadingIndicator/index.js","components/OrgFile/components/AttributedString/components/TablePart/index.js","lib/color.js","components/UI/Checkbox/index.js","components/OrgFile/components/AttributedString/components/ListPart/ListActionDrawer/index.js","components/OrgFile/components/AttributedString/components/ListPart/index.js","components/OrgFile/components/AttributedString/components/TimestampPart/index.js","components/OrgFile/components/AttributedString/index.js","components/OrgFile/components/TitleLine/index.js","components/OrgFile/components/HeaderContent/components/PlanningItems/index.js","components/OrgFile/components/HeaderContent/components/PropertyListItems/index.js","components/OrgFile/components/HeaderContent/components/LogBookEntries/index.js","components/OrgFile/components/HeaderContent/index.js","components/OrgFile/components/Header/components/HeaderActionDrawer/index.js","components/OrgFile/components/Header/index.js","components/OrgFile/components/HeaderList/index.js","components/OrgFile/components/ActionDrawer/index.js","lib/browser_utils.js","components/UI/Switch/index.js","components/OrgFile/components/CaptureModal/index.js","components/OrgFile/components/SyncConfirmationModal/index.js","components/OrgFile/components/TagsEditorModal/index.js","components/UI/TabButtons/index.js","components/OrgFile/components/TimestampEditorModal/components/TimestampEditor/index.js","components/OrgFile/components/TimestampEditorModal/index.js","components/OrgFile/components/PropertyListEditorModal/index.js","components/OrgFile/components/TitleEditorModal/index.js","components/OrgFile/components/DescriptionEditorModal/index.js","components/OrgFile/components/TableEditorModal/components/TableActionButtons/index.js","components/OrgFile/components/TableEditorModal/index.js","components/OrgFile/components/NoteEditorModal/index.js","components/OrgFile/components/AgendaModal/components/AgendaDay/index.js","components/OrgFile/components/AgendaModal/index.js","components/OrgFile/components/SearchModal/components/HeaderListView/index.js","components/OrgFile/components/SearchModal/index.js","components/UI/Drawer/index.js","components/OrgFile/components/DrawerActionBar/components/DrawerActionButtons/index.js","components/OrgFile/components/DrawerActionBar/index.js","lib/keybindings.js","components/OrgFile/components/TaskListModal/components/TaskListView/index.js","components/OrgFile/components/TaskListModal/index.js","components/OrgFile/components/FinderModal/index.js","components/OrgFile/index.js","components/Settings/index.js","components/KeyboardShortcutsEditor/components/ShortcutRow/index.js","components/KeyboardShortcutsEditor/index.js","components/CaptureTemplatesEditor/components/CaptureTemplate/index.js","components/CaptureTemplatesEditor/index.js","components/FileSettingsEditor/components/FileSetting/index.js","components/FileSettingsEditor/index.js","components/Entry/index.js","components/SyncServiceSignIn/dropbox.svg","components/SyncServiceSignIn/gitlab.svg","components/SyncServiceSignIn/index.js","components/Turnout/index.js","lib/initial_setup.js","App.js","registerServiceWorker.js","index.js"],"names":["peg$SyntaxError","message","expected","found","location","this","name","Error","captureStackTrace","child","parent","ctor","constructor","prototype","peg$subclass","buildMessage","DESCRIBE_EXPECTATION_FNS","literal","expectation","literalEscape","text","i","escapedParts","parts","length","Array","classEscape","inverted","any","end","other","description","hex","ch","charCodeAt","toString","toUpperCase","s","replace","j","descriptions","type","sort","slice","join","describeExpected","describeFound","module","exports","SyntaxError","parse","input","options","peg$result","peg$FAILED","peg$startRuleFunctions","Expression","peg$parseExpression","peg$startRuleFunction","peg$c0","peg$otherExpectation","peg$c1","head","tail","reduce","result","element","push","peg$c2","peg$c3","a","offset","start","endOffset","peg$c4","peg$c5","peg$c6","peg$literalExpectation","peg$c7","field","exclude","peg$c8","peg$c9","peg$c10","match","words","peg$c11","peg$c12","peg$c13","peg$c14","peg$c15","peg$c16","b","property","peg$c17","peg$c18","peg$c19","peg$c20","timerange","peg$c21","peg$c22","peg$c23","peg$c24","peg$c25","peg$c26","peg$c27","peg$c28","peg$c29","peg$c30","peg$c31","peg$c32","peg$c33","peg$c34","peg$c35","peg$c36","peg$c37","peg$c38","peg$c39","peg$c40","peg$c41","peg$c42","from","to","peg$c43","peg$c44","point","peg$c45","peg$c46","peg$c47","peg$c48","peg$c49","peg$c50","peg$c51","peg$c52","value","peg$c53","peg$c54","peg$classExpectation","peg$c55","year","month","day","checkDate","peg$c56","checkMonth","peg$c57","parseInt","peg$c58","peg$c59","peg$c60","unit","peg$c61","peg$c62","peg$c63","peg$c64","peg$c65","peg$c66","peg$c67","peg$c68","peg$c69","peg$c70","peg$c71","peg$c72","peg$c73","peg$c74","peg$c75","peg$c76","peg$c77","peg$c78","peg$c79","peg$c80","peg$c81","peg$c82","peg$c83","peg$c84","peg$c85","peg$c86","peg$c87","peg$c88","peg$c89","peg$c90","peg$c91","peg$c92","peg$c93","peg$c94","peg$c95","peg$currPos","peg$savedPos","peg$posDetailsCache","line","column","peg$maxFailPos","peg$maxFailExpected","peg$silentFails","startRule","substring","peg$computeLocation","ignoreCase","peg$computePosDetails","pos","p","details","startPos","endPos","startPosDetails","endPosDetails","peg$fail","peg$buildStructuredError","s0","s1","s2","s3","s4","s5","s6","peg$parse_","peg$parseLocationAnnotedTerm","peg$parsePlainTerm","peg$parseTerm","substr","peg$parseTimeRange","peg$parseTermText","peg$parseTermField","test","charAt","peg$parsePropertyName","peg$parseStringAlternatives","peg$parseTermProp","peg$parseTagName","peg$parseTagAlternatives","peg$parseTermTag","peg$parseMoment","peg$parseTimeOffset","peg$parseYear","peg$parseMonth","peg$parseDay","peg$parseTimestamp","peg$parseTimeUnit","peg$parseString","date","Date","isNaN","valueOf","nextId","renderAsText","timestamp","isActive","dayName","startHour","startMinute","endHour","endMinute","repeaterType","repeaterValue","repeaterUnit","repeaterDeadlineValue","repeaterDeadlineUnit","delayType","delayValue","delayUnit","toJS","timestampText","timestampForDate","time","withStartTime","arguments","undefined","format","getCurrentTimestampAsText","getTimestampAsText","bracketPair","formatString","dateForTimestamp","timestampString","padStart","addTimestampUnitToDate","numUnits","timestampUnit","addHours","addDays","addWeeks","addMonths","addYears","subtractTimestampUnitFromDate","subHours","subDays","subWeeks","subMonths","subYears","timestampDuration","startTimestamp","endTimestamp","map","dateDuration","pad","minDiff","differenceInMinutes","hours","Math","floor","minutes","millisDuration","millis","formattedAttributedStringText","part","get","getIn","attributedStringToRawText","prevParts","unshift","zip","_ref","prevPart","markupTypeToRaw","bold","italic","strikethrough","underline","verbatim","inlineMarkUpToRawText","linkPart","tablePart","rowHeights","row","max","cell","_","countBy","columns","numColumns","size","columnWidths","times","columnIndex","content","lineLengths","split","trim","dropRight","flatten","rowIndex","rowHeight","contentRows","lineIndex","formattedLineLengths","padCount","repeat","contentRow","separator","columnWidth","concat","tablePartToRawText","listPart","bulletCharacter","previousNumber","item","optionalLeadingSpace","titleText","contentText","indentedContentText","listItemText","number","forceNumber","checked","unchecked","partial","listPartToRawText","timestampPartToRawText","console","error","optionalNewlinePrefix","includes","endsWith","generateTitleLine","header","includeStars","titleLine","nestingLevel","todoKeyword","rawTitle","tags","tagsString","filter","x","n","exportOrg","_ref2","headers","linesBeforeHeadings","dontIndent","createRawDescriptionText","includeTitle","immutableHeader","indentation","contents","planningItemsToRender","isRegularPlanningItem","planningItemsContent","planningItem","fromJS","trimRight","propertyListItems","propertyListItemsContent","propertyListItem","logNotes","logBookEntries","logBookEntriesContent","entry","raw","fixedRawDescription","rawDescription","templateString","customVariables","Map","substitutions","entrySeq","forEach","key","substitutedString","entries","RegExp","cursorIndex","indexOf","STATIC_FILE_PREFIX","changelogHash","Promise","resolve","reject","list","c","crypto","subtle","digest","Uint8Array","then","hashArray","values","warn","hash","indexAndHeaderWithId","headerId","headerIndex","indexOfHeaderWithId","findIndex","headerWithId","subheaderIndexRangeForHeaderIndex","nextSiblingHeaderIndex","siblingHeader","subheaderIndexRangeForHeaderId","subheadersOfHeaderWithIndex","begin","subheadersOfHeaderWithId","numSubheadersOfHeaderWithId","directParentOfHeaderWithId","previousHeader","parentIdOfHeaderWithId","parentHeader","findLast","inheritedValueOfProperty","headerProp","find","parentId","parentHeaderIndex","isHeaderVisible","parentHeaderId","openDirectParent","state","directParentIdOfHeaderWithId","setIn","getOpenHeaderPaths","openedHeaders","title","subheaders","openSubheaderPaths","openedSubheaderPath","getSelectedHeader","path","org","present","file","headerIdx","headerWithPath","headerPath","firstHeader","substituteTemplateVariables","first","rest","openHeaderWithPath","maxNestingLevel","firstTitle","update","set","take","takeLast","tablePartContainsCellId","cellId","some","doesAttributedStringContainTableCellId","headerThatContainsTableCellId","pathAndPartOfTimestampItemWithIdInAttributedString","timestampId","partIndex","timestampPart","itemIndex","pathAndPart","cellIndex","listPartContainsItemId","itemId","pathAndPartOfListItemWithIdInAttributedString","listItemId","listItemPart","pathAndPartOfTableContainingCellIdInAttributedString","pathAndPartOfListContainingItemIdInAttributedString","pathAndPartOfTimestampItemWithIdInHeaders","makeResult","localPath","propertyListItemIndex","plistPathAndPart","pathAndPartOfListItemWithIdInHeaders","updateTableContainingCellId","updaterCallbackGenerator","pathAndPartOfTableContainingCellIdInHeaders","rowIndexContainingCellId","columnIndexContainingCellId","updateIn","updateListContainingListItemId","pathAndPartOfListContainingItemIdInHeaders","itemIndexContainingId","updateContentsWithListItemAddition","listItem","last","insertIdx","insert","generateId","List","id","items","numberTerminatorCharacter","isOrdered","timestampWithIdInAttributedString","customFormatDistanceToNow","datetime","formatDistanceToNow","addSuffix","todoKeywordSetForKeyword","todoKeywordSets","keyword","keywordSet","contains","extractAllOrgTags","flatMap","h","toSet","extractAllOrgProperties","prop","valParts","isEmpty","computeAllPropertyNames","allOrgProperties","computeAllPropertyValuesFor","propertyName","toLowerCase","_ref3","y","hasHeaderContent","createIsTodoKeywordInDoneState","startsWith","getPlanningItemTypeText","orgFileExtensions","addBreadcrumbs","breadcrumbs","getBreadcrumbsStringFunction","allHeaders","allHeadersOfFile","filename","lastIndexOf","getBreadcrumbs","maxBreadcrumbLength","setLoadingMessage","loadingMessage","hideLoadingMessage","setIsLoading","isLoading","setIsOnline","online","setDisappearingLoadingMessage","delay","dispatch","setTimeout","setLastViewedFile","lastViewedPath","restoreStaticFile","staticFile","lastViewedFilePath","parseFile","changelog","sample","unloadStaticFile","getState","resetFileDisplay","base","setPath","setFontSize","newFontSize","setBulletStyle","newBulletStyle","setShouldTapTodoToAdvance","newShouldTapTodoToAdvance","setAgendaDefaultDeadlineDelayUnit","newAgendaDefaultDeadlineDelayUnit","setAgendaDefaultDeadlineDelayValue","newAgendaDefaultDeadlineDelayValue","setEditorDescriptionHeightValue","newEditorDescriptionHeightValue","setAgendaStartOnWeekday","newAgendaStartOnWeekday","setShouldLiveSync","shouldLiveSync","setShowDeadlineDisplay","showDeadlineDisplay","setShouldSyncOnBecomingVisibile","shouldSyncOnBecomingVisibile","setShouldShowTitleInOrgFile","shouldShowTitleInOrgFile","setShouldLogIntoDrawer","shouldLogIntoDrawer","setCloseSubheadersRecursively","closeSubheadersRecursively","setShouldNotIndentOnExport","shouldNotIndentOnExport","setShouldStoreSettingsInSyncBackend","newShouldStoreSettingsInSyncBackend","client","syncBackend","deleteFile","catch","doesFileNotExist","alert","window","previousSettingsFileContents","setColorScheme","colorScheme","setTheme","theme","setHasUnseenChangelog","newHasUnseenChangelog","setLastSeenChangelogHeader","newLastSeenChangelogHash","setCustomKeybinding","keybindingName","keybinding","restoreBaseSettings","newSettings","pushModalPage","modalPage","popModalPage","clearModalStack","activatePopup","popupType","data","closePopup","setAgendaTimeframe","agendaTimeframe","setFinderTab","finderTab","setPreferEditRawValues","preferEditRawValues","headerPaths","iconName","isAvailableInAllOrgFiles","letter","orgFilesWhereAvailable","shouldPrepend","template","isSample","addNewEmptyCaptureTemplate","updateTemplateFieldPathValue","templateId","fieldPath","newValue","addNewTemplateOrgFileAvailability","removeTemplateOrgFileAvailability","orgFileAvailabilityIndex","addNewTemplateHeaderPath","removeTemplateHeaderPath","headerPathIndex","deleteTemplate","restoreCaptureSettings","reorderCaptureTemplate","fromIndex","toIndex","localStorageAvailable","localStorage","setItem","localStorageRes","getItem","removeItem","e","debouncedPushConfigToSyncBackend","debounce","syncBackendClient","createFile","async","exists","existingContents","getFileContents","updateFile","updateConfigForGitLab","maxWait","persistableFields","category","default","search","refile","readOpennessState","opennessStateJSONString","JSON","getFieldsToPersist","fields","depreacted","stringify","getConfigFileContents","fieldsToPersist","fromPairs","readInitialState","initialState","getInitialStateWithDefaultValues","past","files","fileSettings","opennessState","searchFilter","searchFilterExpr","bookmarks","future","Set","capture","templates","settings","setting","loadFilesFromLocalStorage","loadContentFromLocalStorage","persistField","getPersistedField","nullable","fromUnit","d","startOfHour","startOfDay","startOfWeek","startOfMonth","startOfYear","toUnit","endOfHour","endOfDay","endOfWeek","endOfMonth","endOfYear","resolveFrom","temp","setFullYear","setMonth","setDate","startOfDate","fromSpecial","resolveTo","endOfDate","toSpecial","isRelative","moment","timeFilter","filterDescription","timeFilterDescription","lower","upper","orChain","source","xs","orChainDate","dates","computeCompletionsForDatalist","todoKeywords","tagNames","allProperties","filterExpr","filterString","curserPosition","completions","computeCompletions","tagAndPropNames","logicalCursorPosition","computeLogicalPosition","charBeforeCursor","charTwoBeforeCursor","SPACE_SURROUNDED","textBeforeCursor","filteredTodoKeywords","indexOfOtherColon","maybePropertyName","quoteStringIfPossible","maybeTagName","tup","elem","next","hasActiveClock","totalFilteredTimeLogged","filters","l","ts","t","every","f","acc","val","updateHeadersTotalTimeLoggedRecursive","headersWithtotalTimeLogged","totalTimeLogged","index","totalTimeLoggedRecursive","timestampOptionalRepeaterOrDelayRegexp","timestampRegex","re","markupAndCookieRegex","timestampFromRegexMatch","partIndices","typeBracket","timeStart","timeEnd","firstDelayRepeatType","firstDelayRepeatValue","firstDelayRepeatUnit","firstRepeaterDeadlineValue","firstRepeaterDeadlineUnit","secondDelayRepeatType","secondDelayRepeatValue","secondDelayRepeatUnit","secondRepeaterDeadlineValue","secondRepeaterDeadlineUnit","parseMarkupAndCookies","rawText","shouldAppendNewline","matches","exec","uri","percentCookieMatch","percentage","fractionCookieMatch","fraction","markupType","markupPrefixLength","firstTimestamp","range","secondTimestamp","lineParts","startIndex","computeParseResults","trailingText","parseTable","tableLines","table","columnProperties","lastRow","lineCells","cellContents","rawContents","excludeCookies","maxNumColumns","parseRawText","excludeContentElements","lines","LIST_HEADER_REGEX","currentListHeaderNestingLevel","rawLineParts","numLeadingSpaces","processedLineParts","linePart","takeWhile","contentLines","checkboxState","isCheckbox","X","newListItem","lastIndex","createOrUpdateTimestamp","parseDescriptionPrefixElements","planningItemsParse","optionalSinglePlanningItemRegex","asStrNoSlashs","planningRegex","concatRegexes","planningMatch","planningItems","planningTypeIndex","strippedDescription","_parsePlanningItems","propertyListParse","propertiesLineIndex","endLineIndex","parsePropertyList","logbookLineIndex","makeLogNotesResult","_parseLogNotes","logBookParse","logBookEntryStartRegex","logBookEntryFullRegex","lineFullMatch","lineStartMatch","trimLeft","parseLogbook","_updateHeaderFromDescription","rawUnstrippedDescription","parsedDescription","parsedTitle","mergedPlanningItems","mergePlanningItems","extractActiveTimestampsForPlanningItemsFromParse","defaultKeywordSets","keywords","completedKeywords","parseTitleLine","todoKeywordSet","titleParts","possibleTags","tag","newHeaderWithTitle","opened","_len","regexes","_key","prev","curr","regex","parseFileConfig","fileConfigLines","newKeywordSet","lowerLine","lineIsTodoKeywordConfig","keywordTokens","pipeIndex","configLine","parseTodoKeywordConfig","parseOrg","fileContents","getLinesFromFileContents","computeNestingLevel","activeClocks","parsedData","_len2","_key2","updatePlanningItems","parsed","merge","updatePlanningItemsFromHeader","titleLineWithAsterisk","logNotesLines","strippedDescriptionLines","rawLogNotes","action","parsedFile","openHeader","toggleHeaderOpened","isOpened","subheaderIndices","subheaderIndicesOfHeaderWithId","selectHeader","openParentsOfHeader","updateCookiesInAttributedStringWithChildCompletionStates","completionStates","doneCount","isDone","totalCount","updateCookiesOfHeaderWithId","directChildren","subheader","updateCookiesOfParentOfHeaderWithId","advanceTodoState","logIntoDrawer","existingHeaderId","currentTodoState","currentTodoSet","newStateIndex","newTodoState","updateHeadlines","indexedPlanningItemsWithRepeaters","setTodoState","enterEditMode","editModeType","exitEditMode","updateHeaderTitle","newTitleLine","newRawTitle","updateHeaderDescription","newRawDescription","addHeader","newHeader","createFirstHeader","selectNextSiblingHeader","nextSibling","selectNextVisibleHeader","nextVisibleHeader","nextVisibleHeaderAfterIndex","selectPreviousVisibleHeader","previousVisibleHeader","previousVisibleHeaderAfterIndex","reverse","removeHeader","numHeadersToRemove","delete","moveHeaderUp","previousSiblingIndex","indexOfPreviousSibling","moveHeaderDown","nextSiblingIndex","nextSiblingSubheaders","moveHeaderLeft","previousParentHeaderId","updateCookies","shiftTreeNestingLevel","moveHeaderRight","moveSubtreeLeft","moveSubtreeRight","moveItemInFile","fromList","targetItem","targetIndex","moveItemAcrossFiles","_ref4","toList","addNoteGeneric","noteText","updatedHeader","addNote","inputText","currentDate","wrappedInput","w","formatTextWrap","narrowHeader","widenHeader","setDirty","isDirty","setSelectedTableId","tableId","setSelectedTableCellId","updateDescriptionOfHeaderContainingTableCell","addNewTableRow","selectedTableCellId","rows","newEmptyTableRowLikeRows","removeTableRow","containingHeader","addNewTableColumn","_rowIndex","colIndex","removeTableColumn","moveTableRowDown","moveTableRowUp","moveTableColumnLeft","moveTableColumnRight","updateTableCellValue","insertCapture","newIndex","insertCapturePosition","newHeaderFromText","descriptionText","numSubheaders","updateParentListCheckboxes","itemPath","parentListItemPath","parentListItem","childrenCheckedStates","checkboxItem","childCompletionStates","advanceCheckboxState","newCheckboxState","setSelectedListItemId","updateDescriptionOfHeaderContainingListItem","updateListTitleValue","selectedListItemId","updateListContentsValue","addNewListItem","newItem","selectNextSiblingListItem","removeListItem","headerThatContainsListItemId","moveListItemUp","moveListItemDown","moveListItemLeft","moveListSubtreeLeft","moveListItemRight","selectedListItem","prevSiblingItemIndex","prevSiblingItemContentsPath","childrenListParts","selectedListItemIndex","partOfPath","parentListItemWithIdInHeaders","_item","moveListSubtreeRight","setLastSyncAt","lastSyncAt","setHeaderTags","reorderTags","selectedHeaderId","splice","reorderPropertyList","updateTimestampWithId","newTimestamp","updatePlanningItemTimestamp","planningItemIndex","addNewPlanningItem","newPlanningItem","planningType","removePlanningItem","removeIn","removeTimestamp","updatePropertyListItems","newPropertyListItems","setLogEntryStop","entryId","entryIndex","createLogEntryStart","newEntry","updateLogEntryTime","entryType","newTime","determineIncludedFiles","settingValue","includeByDefault","mapEntries","_ref5","filePath","fileSetting","searchHeaders","_ref6","filteredHeaders","headersToSearch","nrOfHeadersToSearch","searchFilterFunction","filterFilter","wordsLowerCase","filterTags","filterCS","filterIC","filterProps","filterField","filterDate","filterSchedule","filterDeadline","filterTagsExcl","filterCSExcl","filterICExcl","filterPropsExcl","filterDesc","filterDescCS","headLine","headlineText","properties","scheduleds","deadlines","p1","__","propertyFilter","ys","nameMatch","valueMatch","isMatch","headersFoundInCurrentFile","count","keySeq","headersFoundInFile","setSearchFilterInformation","cursorPosition","context","asMutable","searchFilterValid","headline_filter_parser","clockedTimeAndActiveClockFilters","clockFilters","clockFilter","hasActiveClockFilter","filterFunctions","showClockedTimes","narrowedHeaderId","headersOfFile","updateHeadersTotalFilteredTimeLoggedRecursive","clockedTime","filterIds","searchFilterSuggestions","currentFile","getTodoKeywordSetsAsFlattenedArray","asImmutable","indexOfFileSettingWithId","settingId","restoreFileSettings","applyFileSettingsFromConfig","config","reduceInFile","func","args","reducer","inFile","clearSearch","refileSubtree","sourcePath","sourceHeaderId","targetPath","targetHeaderId","moveItem","sourceHeaders","targetHeaders","sourceHeader","sourceHeaderIndex","targetHeaderIndex","subheadersOfSourceHeader","nestingLevelSource","nestingLevelTarget","applyOpennessState","fileOpennessState","openHeaderPath","setOpennessState","clearPendingCapture","setOrgFileErrorMessage","setShowClockDisplay","showClockDisplay","updateFileSettingFieldPathValue","settingIndex","reorderFileSetting","deleteFileSetting","loadOnStartup","includeInAgenda","includeInSearch","includeInRefile","includeInTasklist","addNewEmptyFileSetting","saveBookmark","_ref7","bookmark","deleteBookmark","_ref8","addNewFile","_ref9","determineAffectedFiles","dirtying","captureTarget","_ref10","_ref11","_ref12","adjustedTimestamp","applyRepeater","newDate","isBefore","timestampDate","setHours","getHours","setMinutes","getMinutes","titleIndex","titlePart","descriptionIndex","descriptionPart","_ref13","startupOptNoLogRepeat","elt","loggingProp","v","noLogRepeatEnabledP","lastRepeatTimestamp","newLastRepeatValue","inactiveTimestamp","newStateChangeLogText","addTodoStateChangeLogItem","updatePlanningItemsWithRepeaters","_ref14","direction","calculateNestingLevel","persistIsDirty","filesDirty","saveFunctionToDebounce","persistedFiles","debouncedSaveFunctions","saveFileToLocalStorage","debouncedSaveFunction","leading","trailing","Object","parseISO","saveFileContentsToLocalStorage","addSeconds","ActionCreators","clearHistory","debouncedSyncFunctions","syncDebounced","filesToSync","debouncedSyncFunction","doSync","sync","forceAction","log","successMessage","shouldSuppressMessages","currentPath","getFileContentsAndMetadata","lastModifiedAt","lastServerModifiedAt","isAfter","err","ActionTypes","CLEAR_HISTORY","selectHeaderAndOpenParents","addHeaderAndEdit","dirtyAction","sampleCaptureTemplates","insertPendingCapture","pendingCapture","templateName","captureContent","customCaptureVariables","history","pushState","pathname","substitutedTemplate","initialCursorIndex","addNewListItemAndEdit","store","dirtyFiles","prefersColorSchemeMediaQueryList","matchMedia","addEventListener","selectedColorScheme","applyCategorySettingsFromConfig","indexOfTemplateWithId","applyCaptureSettingsFromConfig","captureTemplates","undo","UNDO","redo","REDO","combineReducers","stack","pop","replaceState","document","add","signOut","setCurrentFileBrowserDirectoryListing","listing","directoryListing","hasMore","additionalSyncBackendState","setIsLoadingMoreDirectoryListing","currentFileBrowserDirectoryListing","isLoadingMore","undoable","affectedFiles","includeAction","templateIndex","orgFiles","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","parseQueryString","str","ret","create","param","shift","decodeURIComponent","isArray","accessToken","migrateAccessTokenToDropboxAccessToken","shouldStoreSettingsInDropbox","migrateStoreInDropboxToStoreInSyncBackend","k","createGitlabOAuth","expiryPromise","invalidGrantPromise","OAuth2AuthCodePKCE","authorizationUrl","tokenUrl","clientId","process","REACT_APP_GITLAB_CLIENT_ID","redirectUrl","origin","scopes","extraAuthorizationParams","clientSecret","REACT_APP_GITLAB_SECRET","onAccessTokenExpiry","refreshToken","onInvalidGrant","refreshAuthCodeOrToken","treeToDirectoryListing","tree","isDirectory","it","API_URL","oauthClient","decoratedFetch","decorateFetchHTTPClient","fetch","getProjectApi","cachedDefaultBranch","getDefaultBranch","response","ok","status","body","json","default_branch","fetchDirectory","url","pages","links","link","cursor","getRawFile","params","URLSearchParams","ref","encodedPath","encodeURIComponent","commit","getCommitDate","sha","committed","committed_date","authored","authored_date","toISOString","doCommit","file_path","method","branch","commit_message","actions","stats","isSignedIn","isAuthorized","getAccessToken","isProjectAccessible","userResponse","membersResponse","all","user","members","matched","m","access_level","getDirectoryListing","pagination","per_page","getMoreDirectoryListing","reset","clear","error_summary","loadMoreDirectoryListing","extendedListing","pushBackup","pathOrFileId","downloadFile","pathParse","dir","dirName","getCodeFromUrl","code","dbxPromise","transformDirectoryListing","sortedListing","filterAndSortDirectoryListing","path_display","uploadFile","dbx","filesUpload","mode","autorename","filesDownload","reader","FileReader","server_modified","readAsText","fileBlob","objectContainsTagErrorP","REDIRECT_URI","Dropbox","bind","dbxAuth","auth","setCodeVerifier","getAccessTokenFromCode","setRefreshToken","refresh_token","filesListFolder","has_more","filesListFolderContinue","filesDelete","useEffect","script","createElement","src","appendChild","React","Fragment","className","logo","alt","style","height","Menu","target","href","rel","ArrowRight","xmlns","viewBox","preserveAspectRatio","fill","CheckSquare","Calendar","EyeOff","color","allow","allowFullScreen","Link","children","PrivacyPolicy","ExternalLink","HeaderBar","PureComponent","props","super","bindAll","getPathRoot","getFilename","renderFileBrowserBackButton","backPath","fileParts","onClick","back","renderOrgFileBackButton","pathParts","directoryPath","handleBackClick","renderLogo","width","renderHomeFileBackButton","renderSignInBackButton","renderSettingsSubPageBackButton","renderBackButton","activeModalPage","renderTitle","titleContainerWithText","handleHeaderBarTitleClick","handleChangelogClick","handleModalPageDoneClick","handleUndoClick","isUndoEnabled","handleRedoClick","isRedoEnabled","handleHelpClick","handleSettingsClick","renderActions","isAuthenticated","hasUnseenChangelog","undoIconClassName","classNames","redoIconClassName","settingsIconClassName","render","isLandingPage","createBrowserHistory","testRunner","authenticatedSyncService","withRouter","connect","syncBackendType","bindActionCreators","baseActions","orgActions","undoActions","ActionButton","handleClick","isDisabled","subIconName","shouldRotateSubIcon","additionalClassName","tooltip","shouldSpinSubIcon","onRef","fas","subIconClassName","syncActions","marginLeft","marginRight","handleAddNewOrgFileClick","fileName","prompt","ensureCompleteFilename","newPath","opacity","position","zIndex","syncBackendActions","isTopLevelDirectory","ActionDrawer","getParentDirectoryPath","isBackupFile","isOrgFile","isSettingsFile","iconClass","handleLoadMoreClick","shouldRenderIndicator","setShouldRenderIndicator","useState","lastMessage","setLastMessage","spring","stiffness","Motion","onRest","handleAnimationRest","TablePart","rawCellValues","generateCellValueMap","shouldIgnoreBlur","componentDidUpdate","prevProps","subPartDataAndHandlers","onTableCellValueUpdate","inTableEditMode","has","setState","handleTableSelect","onTableSelect","AttributedString","interpolateColors","colorA","colorB","interpolationFactor","r","g","rgbaObject","rgbaString","rgba","readRgbaVariable","varName","varValue","getComputedStyle","documentElement","getPropertyValue","hexValue","rgbaValues","matchAll","themes","Solarized","Light","Dark","Gruvbox","One","Smyck","Code","uncheckedColor","checkedColor","checkboxStyle","colorFactor","backgroundColor","onEnterListTitleEditMode","onEnterListContentsEditMode","onAddNewListItem","onRemoveListItem","ListPart","listTitleValues","generateListTitleValueMap","listContentsValues","generateListContentsValueMap","onListTitleValueUpdate","onListContentsValueUpdate","inListTitleEditMode","inListContentsEditMode","prevSelectedListItemId","handleListItemSelect","onListItemSelect","handleCheckboxClick","stopPropagation","onCheckboxClick","handleTextareaBlur","onExitListTitleEditMode","handleListTitleChange","event","handleListContentsChange","handleInsertTimestampListTitle","listTitleValue","insertionIndex","textarea","selectionStart","selectionEnd","focus","handleInsertTimestampListContents","listContentsValue","handleTextareaRef","renderContent","shouldDisableActions","isItemSelected","lineContainerClass","Checkbox","autoFocus","onBlur","onChange","Collapse","ListActionDrawer","onTimestampClick","useLocation","normalisePath","normalised","textDecoration","renderLink","TimestampPart","TitleLine","titleValue","calculateRawTitle","containerWidth","storeContainerWidth","containerDiv","offsetWidth","componentDidMount","handleTitleClick","hasContent","isSelected","handleTodoClick","shouldTapTodoToAdvance","handleTitleFieldClick","handleTimestampClick","shouldDisableExplicitWidth","addition","isTodoKeywordInDoneState","titleStyle","wordBreak","additionStyle","minWidth","textAlign","whiteSpace","mapStateToProps","ownProps","PlanningItems","onEdit","isDrawerCollapsed","setIsDrawerCollapsed","handleCollapseToggle","HeaderContent","descriptionValue","calculateRawDescription","handleEnterListTitleEditMode","handleExitListTitleEditMode","handleListTitleValueUpdate","handleEnterListContentsEditMode","handleExitListContentsEditMode","handleListContentsValueUpdate","handleAddNewListItem","handleRemoveListItem","handleLogEntryTimestampClick","logEntryIndex","handleInsertTimestamp","handlePlanningItemTimestampClick","DEADLINE","SCHEDULED","handlePropertyListEdit","PropertyListItems","LogBookEntries","onExitListContentsEditMode","HeaderActionDrawer","iconWithFFClickCatcher","testId","onTitleClick","onDescriptionClick","onTagsClick","onPropertiesClick","isNarrowed","onNarrow","onWiden","onAddNewHeader","onDeadlineClick","onClockInOutClick","onScheduledClick","onShareHeader","onRefileHeader","onAddNote","Header","SWIPE_ACTION_ACTIVATION_DISTANCE","FREE_DRAG_ACTIVATION_DISTANCE","isDraggingFreely","dragStartX","currentDragX","isPlayingRemoveAnimation","heightBeforeRemove","disabledBackgroundColor","touchStartY","currentTouchY","globalMouseMoveHandler","handleMouseMove","globalMouseUpHandler","handleMouseUp","globalTouchMoveHandler","handleTouchMove","globalTouchEndHandler","handleTouchEnd","addGlobalDragHandlers","removeGlobalDragHandlers","removeEventListener","componentWillUnmount","handleRef","handleDragStart","dragX","closest","handleDragMove","abs","handleDragEnd","swipeDistance","offsetHeight","handleDragCancel","handleMouseDown","clientX","clientY","handleTouchStart","touch","changedTouches","currentY","currentX","verticalDistance","handleTouchCancel","handleHeaderClick","classList","handleShowTitleModal","handleShowDescriptionModal","handleShowTagsModal","handleShowPropertyListEditorModal","handleNarrow","handleWiden","handleAddNewHeader","handleRest","handleDeadlineAndScheduledClick","existingDeadlinePlanningItemIndex","handleDeadlineClick","handleClockInOutClick","logBook","existingClockIndex","now","getCurrentTimestamp","handleScheduledClick","handleShareHeaderClick","subject","mailtoURI","open","handleAddNoteClick","handlePopupClose","handleRefileHeaderRequest","bulletStyle","narrowedHeader","indentLevel","headerDeadlineMap","headerDeadline","paddingLeft","heightFactor","interpolatedStyle","swipedDistance","isLeftActionActivated","isRightActionActivated","leftActivatedBackgroundColor","rightActivatedBackgroundColor","disabledIconColor","activatedIconColor","leftSwipeActionContainerStyle","backgroundColorFactor","rightSwipeActionContainerStyle","headerStyle","onMouseDown","onTouchStart","onTouchCancel","leftInterpolatedStyle","leftStyle","leftIconStyle","display","rightInterpolatedStyle","rightStyle","rightIconStyle","springConfig","HeaderList","headerRefs","selectedHeaderDiv","boundingRectangle","getBoundingClientRect","viewportHeight","clientHeight","top","bottom","scrollIntoView","handleHeaderRef","div","headerRenderData","displayed","toArray","headerRenderDatum","previousRenderDatum","followingHeaders","followingHeaderIndex","followingHeader","narrowedHeaderIndex","headerColors","displayedHeaderRenderData","searchFiles","isNarrowedHeaderActive","captureActions","shouldDisableSyncButtons","isDisplayingArrowButtons","setIsDisplayingArrowButtons","isDisplayingCaptureButtons","setIsDisplayingCaptureButtons","mainArrowButton","useRef","mainArrowButtonBoundingRect","useMemo","current","handleUpClick","handleDownClick","handleLeftClick","handleRightClick","handleMoveSubtreeLeftClick","handleMoveSubtreeRightClick","getAvailableCaptureTemplates","availablePath","handleMainArrowButtonClick","handleMainCaptureButtonClick","handleSync","handleAgendaClick","renderMovementButtons","baseArrowButtonStyle","boxShadow","centerXOffset","screen","animatedStyles","topRowYOffset","bottomRowYOffset","firstColumnXOffset","secondColumnXOffset","subIconNameStr","tooltipUpStr","tooltipDownStr","tooltipLeftStr","tooltipRightStr","left","right","handleSearchButtonClick","renderCaptureButtons","availableCaptureTemplates","baseCaptureButtonStyle","mainButtonStyle","animatedStyle","browser","Bowser","getParser","navigator","userAgent","isMobileSafari13","satisfies","mobile","safari","isMobileBrowser","getPlatformType","isIos","getOS","isIphoneX","isIphone678","isRunningAsPWA","standalone","isInLandscapeMode","orientation","isEnabled","onToggle","disabledColor","enabledColor","switchStyle","grabberStyle","onCapture","targetHeader","textareaValue","setTextareaValue","setShouldPrepend","setSelectionRange","hP","Switch","handlePrependSwitchToggle","handleCaptureClick","minHeight","onPull","onPush","onCancel","TagsEditorModal","allTags","prevTags","currentTags","lastTextfield","handleTagChange","tagIndex","handleRemoveTag","handleAddNewTag","handleExistingTagClick","newTag","headerTags","tagName","idx","Droppable","droppableId","provided","_snapshot","assign","innerRef","droppableProps","Draggable","draggableId","snapshot","isDragging","draggableProps","textfield","dragHandleProps","placeholder","buttons","titles","selectedButton","useEqualWidthTabs","onSelect","handleButtonClick","buttonName","containerClassName","gridTemplateColumns","TimestampEditor","handleActiveToggle","handleDateChange","isNumber","activePopupType","onClose","newYear","newMonth","newDay","newDayName","handleAddTime","startOrEnd","hourKey","minuteKey","hour","minute","handleRemoveTime","handleTimeChange","handleAddRepeater","handleRemoveRepeater","handleRepeaterTypeChange","newRepeaterType","handleRepeaterValueChange","handleRepeaterUnitChange","newRepeaterUnit","handleAddDelay","handleRemoveDelay","handleDelayTypeChange","newDelayType","handleDelayValueChange","handleDelayUnitChange","newDelayUnit","renderTimeField","label","timeKey","showRemoveButton","renderRepeater","TabButtons","min","renderDelay","createPlanningItem","onFocus","nativeEvent","defaultValue","activePopup","activePopupData","TimestampEditorModal","handleChange","handleAddEndTimestamp","handleRemoveEndTimestamp","singleTimestampOnly","PropertyListEditorModal","prevItems","currentItems","handlePropertyChange","propertyListItemId","handleValueChange","handleRemoveItem","handleAddNewItem","allPropertyNames","propertyListItemsWithAllPropVals","allPropertyValues","propertyValue","TitleEditorModal","chooseTodoKeywordSet","todoKeywordSetIndex","editRawValues","setPopupCloseActionValuesAccessor","handleTextareaFocus","handleTitleChange","newTitle","lastCharacter","handleTodoChange","newTodoKeyword","saveTitle","onTodoClicked","handleNextTodoKeywordSet","newTodoKeywordSet","todo","completed","DescriptionEditorModal","editorDescriptionHeightValue","descriptionModifier","eachValList","handleDescriptionChange","onEnterTableEditMode","onAddNewTableRow","onRemoveTableRow","onAddNewTableColumn","onRemoveTableColumn","onUpClick","onLeftClick","onRightClick","onDownClick","TableEditorModal","handleTableCellValueUpdate","handleCellSelect","handleTableCellSelect","handleExitTableEditMode","handleCellChange","cellValue","handleEnterTableEditMode","handleAddNewTableRow","handleRemoveTableRow","handleAddNewTableColumn","handleRemoveTableColumn","onTableCellSelect","onExitTableEditMode","overflowX","overflowY","isCellSelected","TableActionButtons","selectedHeader","selectedTableId","NoteEditorModal","note","handleNoteFieldClick","AgendaDay","onHeaderClick","dateDisplayType","onToggleDateDisplayType","agendaDefaultDeadlineDelayValue","agendaDefaultDeadlineDelayUnit","dateStart","dateEnd","planningItemsAndHeaders","getPlanningItemsAndHeaders","isToday","planningItemDate","hasTodoKeyword","dateClassName","isPast","valueSeq","isTodoKeywordCompleted","appearDate","isEqual","isWithinInterval","hasBeenRepeated","sortBy","allFiles","agendaStartOnWeekday","selectedDate","setSelectedDate","setDateDisplayType","weekStartsOn","getDay","handleToggleDateDisplayType","weekStart","daysAfter","monthStart","getDaysInMonth","weekEnd","calculateTimeframeHeader","overflow","allBookmarks","setdateDisplayType","bookmarkChosen","canSaveBookmark","capitalize","string","autoCapitalize","autoComplete","bookmark__icon__enabled","HeaderListView","shouldIncludeCloseButton","maxSize","isVisible","setIsVisible","dragOffsetY","setDragOffsetY","useLayoutEffect","initialClientY","innerContainer","innerContainerHeight","handleInnerContainerClick","handleClose","targetTouches","isScrollingDown","scrollHeight","scrollTop","preventDefault","handleTouchEndOrCancel","innerContainerCurrent","outerClassName","innerStyle","offsetY","innerHeight","transform","DrawerActionButtons","disabled","onSwitch","onRemoveHeader","setEditRawValues","restorePreferEditRawValues","DrawerActionBar","handleShowTitleEditModal","handleShowDescriptionEditModal","handleShowDeadlineModal","handleShowScheduledModal","handleShowNoteModal","handleRemoveHeader","DEFAULT_BINDINGS","calculateNamedKeybindings","customKeybindings","bindingName","_bindingAction","binding","getTimeFromPlanningItem","getTime","headersForFiles","todoKeywordSetsForFiles","Number","MAX_SAFE_INTEGER","planningInformation","TaskListView","SearchModal","TaskListModal","renderTab","OrgFile","hasUncaughtError","querySelector","fileIsLoaded","urlFragment","componentDidCatch","handleSelectNextVisibleHeaderHotKey","handleSelectPreviousVisibleHeaderHotKey","handleToggleHeaderOpenedHotKey","handleAdvanceTodoHotKey","handleEditTitleHotKey","handleEditDescriptionHotKey","handleExitEditModeHotKey","getPopupSwitchAction","popupCloseActionValuesAccessor","container","handleAddHeaderHotKey","handleCreateFirstHeader","handleRemoveHeaderHotKey","handleMoveHeaderUpHotKey","handleMoveHeaderDownHotKey","handleMoveHeaderLeftHotKey","handleMoveHeaderRightHotKey","handleUndoHotKey","handleContainerRef","handleCapture","handleSearchPopupClose","handleRefilePopupClose","loadedPath","handleTitlePopupClose","handleDescriptionPopupClose","handleTablePopupClose","handleSyncConfirmationPull","handleSyncConfirmationPush","handleSyncConfirmationCancel","handleTagsChange","newTags","handlePropertyListItemsChange","handleTimestampChange","popupData","getPopupCloseAction","getPopupMaxSize","renderActivePopup","SyncConfirmationModal","headersOfCaptureTarget","CaptureModal","editingTimestamp","timestampWithId","AgendaModal","FinderModal","checkPopupAndHeader","callback","checkPopup","shouldDisableDirtyIndicator","parsingErrorMessage","orgFileErrorMessage","Redirect","keyMap","bindingAction","calculateActionedKeybindings","handlers","advanceTodo","editTitle","editDescription","GlobalHotKeys","tabIndex","Drawer","loadedFiles","fromKeys","fontSize","shouldStoreSettingsInSyncBackend","useHistory","documentationHost","handleShouldTapTodoToAdvanceChange","handleShouldLiveSyncChange","handleShouldSyncOnBecomingVisibleChange","handleShouldShowTitleInOrgFile","handleShouldLogIntoDrawer","handleCloseSubheadersRecursively","handleShouldNotIndentOnExport","handleShouldStoreSettingsInSyncBackendChange","handleShowClockDisplayClick","handleShowDeadlineDisplayChange","handlePreferEditRawValues","handleCaptureTemplatesClick","handleKeyboardShortcutsClick","handleFileSettingsClick","handleSignOutClick","confirm","ShortcutRow","isEditMode","rebindArea","handleRebindClick","handleKeyPress","Minus","Equal","Backspace","Enter","Return","Tab","BracketLeft","BracketRight","Semicolon","Quote","Backslash","Comma","Period","Slash","newModifiers","modifier","symbol","newBinding","onBindingChange","symbolizeKeybinding","currentBinding","rebindAreaClassName","handleBindingChange","alreadyInUseBinding","onFieldPathUpdate","onAddNewTemplateOrgFileAvailability","onRemoveTemplateOrgFileAvailability","onAddNewTemplateHeaderPath","onRemoveTemplateHeaderPath","onDeleteTemplate","loadedFilePaths","isCollapsed","setIsCollapsed","handleHeaderBarClick","updateField","fieldName","toggleAvailabilityInAllOrgFiles","togglePrepend","handleAddNewOrgFileAvailability","handleRemoveOrgFileAvailability","handleOrgFileAvailabilityChange","handleAddNewHeaderPath","handleRemoveHeaderPath","handleHeaderPathChange","handleDeleteClick","caretClassName","renderDescriptionField","maxLength","autoCorrect","renderIconField","orgFilePath","renderOrgFileAvailability","selected","renderFilePath","marginTop","renderHeaderPaths","renderPrependField","renderTemplateField","handleFieldPathUpdate","handleAddNewTemplateOrgFileAvailability","handleRemoveTemplateOrgFileAvailability","handleAddNewTemplateHeaderPath","handleRemoveTemplateHeaderPath","handleDeleteTemplate","handleReorderTemplate","CaptureTemplate","onReorder","handleAddNewTemplateClick","onDeleteSetting","loadedFilepaths","toggleDefaultOnStartup","toggleLoadOnStartup","toggleIncludeInAgenda","toggleIncludeInSearch","toggleIncludeInTasklist","toggleIncludeInRefile","renderPathField","renderOptionFields","existingSettings","paths","currentPathIfWithoutFileSetting","settingPath","handleDeleteSetting","handleReorderSetting","FileSetting","handleAddNewSettingClick","Entry","setChangelogUnseenChanges","filesToLoad","lastSeenChangelogHash","hasChanged","shouldPromptWhenLeaving","onbeforeunload","renderChangelogFile","renderSampleFile","shouldDisableActionDrawer","renderFileBrowser","FileBrowser","renderFile","hasDirtyFiles","defaultFilePath","osPreference","setProperty","setAttribute","loadTheme","pendingCapturePath","shouldRedirectToCapturePath","LoadingIndicator","KeyboardShortcutsEditor","CaptureTemplatesEditor","FileSettingsEditor","Route","exact","component","Settings","filesToLoadOnStartup","WebDAVForm","setUrl","REACT_APP_WEBDAV_URL","username","setUsername","password","setPassword","toggleVisible","onSubmit","htmlFor","GitLab","defaultProject","project","setProject","GitLabLogo","evt","projectId","projectURL","URL","hostname","gitLabProjectIdFromURL","fetchAuthorizationCode","SyncServiceSignIn","handleDropboxClick","DropboxAuth","getAuthenticationUrl","authUrl","codeVerifier","DropboxLogo","Landing","debouncedDispatchSync","filepath","syncOnBecomingVisible","visProp","prefixes","getHiddenProp","evtname","configure","ignoreTags","App","runAllMigrations","createDropboxSyncBackendClient","gitlabOAuth","createGitLabSyncBackendClient","success","isReturningFromAuthServer","syncClient","handleGitLabAuthResponse","login","webdavClient","createClient","basename","getDirectoryContents","putFileContents","overwrite","stat","lastmod","statusText","_additionalSyncBackendState","createWebDAVSyncBackendClient","queryStringContents","captureFile","captureTemplateName","capturePath","CUSTOM_VARIABLE_PREFIX","createStore","rootReducer","applyMiddleware","thunk","liveSync","toggleColorScheme","Store","subscribe","settingsFileContents","currentFilePath","openHeaderPaths","loadSettingsFromConfigFile","fileContentsPromise","configFileContents","_error","urlPathMatch","urlPath","onpopstate","listenToBrowserButtons","onLine","onoffline","ononline","listenToNetworkConnectionEvents","destination","DragDropContext","onDragEnd","BrowserRouter","Provider","Turnout","isLocalhost","Boolean","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","ReactDOM","getElementById","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.a18f989e.chunk.js","sourcesContent":["/* eslint-disable */\n/*\n * Generated by PEG.js 0.10.0.\n *\n * http://pegjs.org/\n */\n\n\"use strict\";\n\nfunction peg$subclass(child, parent) {\n  function ctor() { this.constructor = child; }\n  ctor.prototype = parent.prototype;\n  child.prototype = new ctor();\n}\n\nfunction peg$SyntaxError(message, expected, found, location) {\n  this.message  = message;\n  this.expected = expected;\n  this.found    = found;\n  this.location = location;\n  this.name     = \"SyntaxError\";\n\n  if (typeof Error.captureStackTrace === \"function\") {\n    Error.captureStackTrace(this, peg$SyntaxError);\n  }\n}\n\npeg$subclass(peg$SyntaxError, Error);\n\npeg$SyntaxError.buildMessage = function(expected, found) {\n  var DESCRIBE_EXPECTATION_FNS = {\n        literal: function(expectation) {\n          return \"\\\"\" + literalEscape(expectation.text) + \"\\\"\";\n        },\n\n        \"class\": function(expectation) {\n          var escapedParts = \"\",\n              i;\n\n          for (i = 0; i < expectation.parts.length; i++) {\n            escapedParts += expectation.parts[i] instanceof Array\n              ? classEscape(expectation.parts[i][0]) + \"-\" + classEscape(expectation.parts[i][1])\n              : classEscape(expectation.parts[i]);\n          }\n\n          return \"[\" + (expectation.inverted ? \"^\" : \"\") + escapedParts + \"]\";\n        },\n\n        any: function(expectation) {\n          return \"any character\";\n        },\n\n        end: function(expectation) {\n          return \"end of input\";\n        },\n\n        other: function(expectation) {\n          return expectation.description;\n        }\n      };\n\n  function hex(ch) {\n    return ch.charCodeAt(0).toString(16).toUpperCase();\n  }\n\n  function literalEscape(s) {\n    return s\n      .replace(/\\\\/g, '\\\\\\\\')\n      .replace(/\"/g,  '\\\\\"')\n      .replace(/\\0/g, '\\\\0')\n      .replace(/\\t/g, '\\\\t')\n      .replace(/\\n/g, '\\\\n')\n      .replace(/\\r/g, '\\\\r')\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });\n  }\n\n  function classEscape(s) {\n    return s\n      .replace(/\\\\/g, '\\\\\\\\')\n      .replace(/\\]/g, '\\\\]')\n      .replace(/\\^/g, '\\\\^')\n      .replace(/-/g,  '\\\\-')\n      .replace(/\\0/g, '\\\\0')\n      .replace(/\\t/g, '\\\\t')\n      .replace(/\\n/g, '\\\\n')\n      .replace(/\\r/g, '\\\\r')\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });\n  }\n\n  function describeExpectation(expectation) {\n    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);\n  }\n\n  function describeExpected(expected) {\n    var descriptions = new Array(expected.length),\n        i, j;\n\n    for (i = 0; i < expected.length; i++) {\n      descriptions[i] = describeExpectation(expected[i]);\n    }\n\n    descriptions.sort();\n\n    if (descriptions.length > 0) {\n      for (i = 1, j = 1; i < descriptions.length; i++) {\n        if (descriptions[i - 1] !== descriptions[i]) {\n          descriptions[j] = descriptions[i];\n          j++;\n        }\n      }\n      descriptions.length = j;\n    }\n\n    switch (descriptions.length) {\n      case 1:\n        return descriptions[0];\n\n      case 2:\n        return descriptions[0] + \" or \" + descriptions[1];\n\n      default:\n        return descriptions.slice(0, -1).join(\", \")\n          + \", or \"\n          + descriptions[descriptions.length - 1];\n    }\n  }\n\n  function describeFound(found) {\n    return found ? \"\\\"\" + literalEscape(found) + \"\\\"\" : \"end of input\";\n  }\n\n  return \"Expected \" + describeExpected(expected) + \" but \" + describeFound(found) + \" found.\";\n};\n\nfunction peg$parse(input, options) {\n  options = options !== void 0 ? options : {};\n\n  var peg$FAILED = {},\n\n      peg$startRuleFunctions = { Expression: peg$parseExpression },\n      peg$startRuleFunction  = peg$parseExpression,\n\n      peg$c0 = peg$otherExpectation(\"filter expression\"),\n      peg$c1 = function(head, tail) {\n            return tail.reduce((result, element) => {\n              result.push(element[1]);\n              return result;\n            }, [head]);\n          },\n      peg$c2 = function() { return [] },\n      peg$c3 = function(a) {\n              a.offset = location().start.offset;\n              a.endOffset = location().end.offset;\n              return a;\n            },\n      peg$c4 = peg$otherExpectation(\"filter term\"),\n      peg$c5 = \"-\",\n      peg$c6 = peg$literalExpectation(\"-\", false),\n      peg$c7 = function(a) { \n          if ( a.type === 'field' && a.field.type !== 'desc') {\n            throw { message: `can't negate timerange searches yet` };\n          } else {\n            a.exclude = true;  \n            return a;\n          } },\n      peg$c8 = function(a) { a.exclude = false; return a; },\n      peg$c9 = peg$otherExpectation(\"text filter term\"),\n      peg$c10 = function(a) {\n              let type = 'ignore-case';\n              // It's hard to check for upper-case chars in JS.\n              // Best approach: https://stackoverflow.com/a/31415820/999007\n              // Simplest approach for now:\n              if (text().match(/[A-Z]/))\n                type = 'case-sensitive';\n\n              return {type: type, words: a}\n        },\n      peg$c11 = peg$otherExpectation(\"tag filter term\"),\n      peg$c12 = \":\",\n      peg$c13 = peg$literalExpectation(\":\", false),\n      peg$c14 = function(a) { return {type: 'tag', words: a} },\n      peg$c15 = peg$otherExpectation(\"property filter term\"),\n      peg$c16 = function(a, b) {\n                return {\n                  type: 'property',\n                  property: a,\n                  words: b === null ? [''] : b\n                }\n              },\n      peg$c17 = peg$otherExpectation(\"search outside of header\"),\n      peg$c18 = \"date:\",\n      peg$c19 = peg$literalExpectation(\"date:\", false),\n      peg$c20 = function(a) { return { type: 'field', field: { type: 'date',        timerange: a } }; },\n      peg$c21 = \"clock:\",\n      peg$c22 = peg$literalExpectation(\"clock:\", false),\n      peg$c23 = function(a) { return { type: 'field', field: { type: 'clock',       timerange: a } }; },\n      peg$c24 = \"sched:\",\n      peg$c25 = peg$literalExpectation(\"sched:\", false),\n      peg$c26 = \"scheduled:\",\n      peg$c27 = peg$literalExpectation(\"scheduled:\", false),\n      peg$c28 = function(a) { return { type: 'field', field: { type: 'scheduled',   timerange: a } }; },\n      peg$c29 = \"dead:\",\n      peg$c30 = peg$literalExpectation(\"dead:\", false),\n      peg$c31 = \"deadline:\",\n      peg$c32 = peg$literalExpectation(\"deadline:\", false),\n      peg$c33 = function(a) { return { type: 'field', field: { type: 'deadline',    timerange: a } }; },\n      peg$c34 = \"desc:\",\n      peg$c35 = peg$literalExpectation(\"desc:\", false),\n      peg$c36 = \"description:\",\n      peg$c37 = peg$literalExpectation(\"description:\", false),\n      peg$c38 = function(a) { return { type: 'field', field: { type: 'description', text: a } }; },\n      peg$c39 = peg$otherExpectation(\"moments and timeranges\"),\n      peg$c40 = \"..\",\n      peg$c41 = peg$literalExpectation(\"..\", false),\n      peg$c42 = function(a, b) { return { type: 'range', from: a, to: b }; },\n      peg$c43 = function(a) { return { type: 'range', from: a, to: null }; },\n      peg$c44 = function(a) { return { type: 'point', point: a }; },\n      peg$c45 = function(a) { return { type: 'range', from: null, to: a }; },\n      peg$c46 = function() { return { type: 'all' }; },\n      peg$c47 = peg$otherExpectation(\"moment\"),\n      peg$c48 = \"today\",\n      peg$c49 = peg$literalExpectation(\"today\", false),\n      peg$c50 = \"now\",\n      peg$c51 = peg$literalExpectation(\"now\", false),\n      peg$c52 = function(a) { return { type: 'special', value: a }; },\n      peg$c53 = /^[\\-.\\/]/,\n      peg$c54 = peg$classExpectation([\"-\", \".\", \"/\"], false, false),\n      peg$c55 = function(year, month, day) { return checkDate(year, month, day); },\n      peg$c56 = function(year, month) { return checkMonth(year, month); },\n      peg$c57 = function(year) { return { type: 'timestamp', year: parseInt(year), month: null, day: null }; },\n      peg$c58 = /^[hdwmy]/,\n      peg$c59 = peg$classExpectation([\"h\", \"d\", \"w\", \"m\", \"y\"], false, false),\n      peg$c60 = function(a) { return { type: 'unit', unit: a }; },\n      peg$c61 = peg$otherExpectation(\"year\"),\n      peg$c62 = /^[0-9]/,\n      peg$c63 = peg$classExpectation([[\"0\", \"9\"]], false, false),\n      peg$c64 = function(a) { return a; },\n      peg$c65 = peg$otherExpectation(\"month\"),\n      peg$c66 = peg$otherExpectation(\"day\"),\n      peg$c67 = peg$otherExpectation(\"offset\"),\n      peg$c68 = function(a, b) { return { type: 'offset', value: parseInt(a), unit: b, }; },\n      peg$c69 = peg$otherExpectation(\"alternatives\"),\n      peg$c70 = \"|\",\n      peg$c71 = peg$literalExpectation(\"|\", false),\n      peg$c72 = function(head, tail) {\n             return tail.reduce((result, element) => {\n               result.push(element[1]);\n               return result;\n             }, [head])\n           },\n      peg$c73 = peg$otherExpectation(\"tag alternatives\"),\n      peg$c74 = peg$otherExpectation(\"string\"),\n      peg$c75 = /^[^: \\t|'\"]/,\n      peg$c76 = peg$classExpectation([\":\", \" \", \"\\t\", \"|\", \"'\", \"\\\"\"], true, false),\n      peg$c77 = function() { return text() },\n      peg$c78 = \"'\",\n      peg$c79 = peg$literalExpectation(\"'\", false),\n      peg$c80 = /^[^']/,\n      peg$c81 = peg$classExpectation([\"'\"], true, false),\n      peg$c82 = function(a) { return a.join('') },\n      peg$c83 = \"\\\"\",\n      peg$c84 = peg$literalExpectation(\"\\\"\", false),\n      peg$c85 = /^[^\"]/,\n      peg$c86 = peg$classExpectation([\"\\\"\"], true, false),\n      peg$c87 = peg$otherExpectation(\"property name\"),\n      peg$c88 = /^[^: \\t]/,\n      peg$c89 = peg$classExpectation([\":\", \" \", \"\\t\"], true, false),\n      peg$c90 = peg$otherExpectation(\"tag name\"),\n      peg$c91 = /^[a-zA-Z0-9_@]/,\n      peg$c92 = peg$classExpectation([[\"a\", \"z\"], [\"A\", \"Z\"], [\"0\", \"9\"], \"_\", \"@\"], false, false),\n      peg$c93 = peg$otherExpectation(\"whitespace\"),\n      peg$c94 = /^[ \\t]/,\n      peg$c95 = peg$classExpectation([\" \", \"\\t\"], false, false),\n\n      peg$currPos          = 0,\n      peg$savedPos         = 0,\n      peg$posDetailsCache  = [{ line: 1, column: 1 }],\n      peg$maxFailPos       = 0,\n      peg$maxFailExpected  = [],\n      peg$silentFails      = 0,\n\n      peg$result;\n\n  if (\"startRule\" in options) {\n    if (!(options.startRule in peg$startRuleFunctions)) {\n      throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n    }\n\n    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n  }\n\n  function text() {\n    return input.substring(peg$savedPos, peg$currPos);\n  }\n\n  function location() {\n    return peg$computeLocation(peg$savedPos, peg$currPos);\n  }\n\n  function expected(description, location) {\n    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)\n\n    throw peg$buildStructuredError(\n      [peg$otherExpectation(description)],\n      input.substring(peg$savedPos, peg$currPos),\n      location\n    );\n  }\n\n  function error(message, location) {\n    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)\n\n    throw peg$buildSimpleError(message, location);\n  }\n\n  function peg$literalExpectation(text, ignoreCase) {\n    return { type: \"literal\", text: text, ignoreCase: ignoreCase };\n  }\n\n  function peg$classExpectation(parts, inverted, ignoreCase) {\n    return { type: \"class\", parts: parts, inverted: inverted, ignoreCase: ignoreCase };\n  }\n\n  function peg$anyExpectation() {\n    return { type: \"any\" };\n  }\n\n  function peg$endExpectation() {\n    return { type: \"end\" };\n  }\n\n  function peg$otherExpectation(description) {\n    return { type: \"other\", description: description };\n  }\n\n  function peg$computePosDetails(pos) {\n    var details = peg$posDetailsCache[pos], p;\n\n    if (details) {\n      return details;\n    } else {\n      p = pos - 1;\n      while (!peg$posDetailsCache[p]) {\n        p--;\n      }\n\n      details = peg$posDetailsCache[p];\n      details = {\n        line:   details.line,\n        column: details.column\n      };\n\n      while (p < pos) {\n        if (input.charCodeAt(p) === 10) {\n          details.line++;\n          details.column = 1;\n        } else {\n          details.column++;\n        }\n\n        p++;\n      }\n\n      peg$posDetailsCache[pos] = details;\n      return details;\n    }\n  }\n\n  function peg$computeLocation(startPos, endPos) {\n    var startPosDetails = peg$computePosDetails(startPos),\n        endPosDetails   = peg$computePosDetails(endPos);\n\n    return {\n      start: {\n        offset: startPos,\n        line:   startPosDetails.line,\n        column: startPosDetails.column\n      },\n      end: {\n        offset: endPos,\n        line:   endPosDetails.line,\n        column: endPosDetails.column\n      }\n    };\n  }\n\n  function peg$fail(expected) {\n    if (peg$currPos < peg$maxFailPos) { return; }\n\n    if (peg$currPos > peg$maxFailPos) {\n      peg$maxFailPos = peg$currPos;\n      peg$maxFailExpected = [];\n    }\n\n    peg$maxFailExpected.push(expected);\n  }\n\n  function peg$buildSimpleError(message, location) {\n    return new peg$SyntaxError(message, null, null, location);\n  }\n\n  function peg$buildStructuredError(expected, found, location) {\n    return new peg$SyntaxError(\n      peg$SyntaxError.buildMessage(expected, found),\n      expected,\n      found,\n      location\n    );\n  }\n\n  function peg$parseExpression() {\n    var s0, s1, s2, s3, s4, s5, s6;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    s2 = peg$parse_();\n    while (s2 !== peg$FAILED) {\n      s1.push(s2);\n      s2 = peg$parse_();\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseLocationAnnotedTerm();\n      if (s2 !== peg$FAILED) {\n        s3 = [];\n        s4 = peg$currPos;\n        s5 = [];\n        s6 = peg$parse_();\n        if (s6 !== peg$FAILED) {\n          while (s6 !== peg$FAILED) {\n            s5.push(s6);\n            s6 = peg$parse_();\n          }\n        } else {\n          s5 = peg$FAILED;\n        }\n        if (s5 !== peg$FAILED) {\n          s6 = peg$parseLocationAnnotedTerm();\n          if (s6 !== peg$FAILED) {\n            s5 = [s5, s6];\n            s4 = s5;\n          } else {\n            peg$currPos = s4;\n            s4 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s4;\n          s4 = peg$FAILED;\n        }\n        while (s4 !== peg$FAILED) {\n          s3.push(s4);\n          s4 = peg$currPos;\n          s5 = [];\n          s6 = peg$parse_();\n          if (s6 !== peg$FAILED) {\n            while (s6 !== peg$FAILED) {\n              s5.push(s6);\n              s6 = peg$parse_();\n            }\n          } else {\n            s5 = peg$FAILED;\n          }\n          if (s5 !== peg$FAILED) {\n            s6 = peg$parseLocationAnnotedTerm();\n            if (s6 !== peg$FAILED) {\n              s5 = [s5, s6];\n              s4 = s5;\n            } else {\n              peg$currPos = s4;\n              s4 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s4;\n            s4 = peg$FAILED;\n          }\n        }\n        if (s3 !== peg$FAILED) {\n          s4 = [];\n          s5 = peg$parse_();\n          while (s5 !== peg$FAILED) {\n            s4.push(s5);\n            s5 = peg$parse_();\n          }\n          if (s4 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c1(s2, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = [];\n      s2 = peg$parse_();\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        s2 = peg$parse_();\n      }\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c2();\n      }\n      s0 = s1;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c0); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseLocationAnnotedTerm() {\n    var s0, s1;\n\n    s0 = peg$currPos;\n    s1 = peg$parseTerm();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c3(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parseTerm() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.charCodeAt(peg$currPos) === 45) {\n      s1 = peg$c5;\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c6); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsePlainTerm();\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c7(s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parsePlainTerm();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c8(s1);\n      }\n      s0 = s1;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c4); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsePlainTerm() {\n    var s0;\n\n    s0 = peg$parseTermField();\n    if (s0 === peg$FAILED) {\n      s0 = peg$parseTermText();\n      if (s0 === peg$FAILED) {\n        s0 = peg$parseTermProp();\n        if (s0 === peg$FAILED) {\n          s0 = peg$parseTermTag();\n        }\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTermText() {\n    var s0, s1;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseStringAlternatives();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c10(s1);\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c9); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTermTag() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.charCodeAt(peg$currPos) === 58) {\n      s1 = peg$c12;\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c13); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseTagAlternatives();\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c14(s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c11); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTermProp() {\n    var s0, s1, s2, s3, s4;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.charCodeAt(peg$currPos) === 58) {\n      s1 = peg$c12;\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c13); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsePropertyName();\n      if (s2 !== peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 58) {\n          s3 = peg$c12;\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c13); }\n        }\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parseStringAlternatives();\n          if (s4 === peg$FAILED) {\n            s4 = null;\n          }\n          if (s4 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c16(s2, s4);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c15); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTermField() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.substr(peg$currPos, 5) === peg$c18) {\n      s1 = peg$c18;\n      peg$currPos += 5;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c19); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseTimeRange();\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c20(s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      if (input.substr(peg$currPos, 6) === peg$c21) {\n        s1 = peg$c21;\n        peg$currPos += 6;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c22); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parseTimeRange();\n        if (s2 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c23(s2);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        if (input.substr(peg$currPos, 6) === peg$c24) {\n          s1 = peg$c24;\n          peg$currPos += 6;\n        } else {\n          s1 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c25); }\n        }\n        if (s1 === peg$FAILED) {\n          if (input.substr(peg$currPos, 10) === peg$c26) {\n            s1 = peg$c26;\n            peg$currPos += 10;\n          } else {\n            s1 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c27); }\n          }\n        }\n        if (s1 !== peg$FAILED) {\n          s2 = peg$parseTimeRange();\n          if (s2 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c28(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n        if (s0 === peg$FAILED) {\n          s0 = peg$currPos;\n          if (input.substr(peg$currPos, 5) === peg$c29) {\n            s1 = peg$c29;\n            peg$currPos += 5;\n          } else {\n            s1 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c30); }\n          }\n          if (s1 === peg$FAILED) {\n            if (input.substr(peg$currPos, 9) === peg$c31) {\n              s1 = peg$c31;\n              peg$currPos += 9;\n            } else {\n              s1 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c32); }\n            }\n          }\n          if (s1 !== peg$FAILED) {\n            s2 = peg$parseTimeRange();\n            if (s2 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c33(s2);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n          if (s0 === peg$FAILED) {\n            s0 = peg$currPos;\n            if (input.substr(peg$currPos, 5) === peg$c34) {\n              s1 = peg$c34;\n              peg$currPos += 5;\n            } else {\n              s1 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c35); }\n            }\n            if (s1 === peg$FAILED) {\n              if (input.substr(peg$currPos, 12) === peg$c36) {\n                s1 = peg$c36;\n                peg$currPos += 12;\n              } else {\n                s1 = peg$FAILED;\n                if (peg$silentFails === 0) { peg$fail(peg$c37); }\n              }\n            }\n            if (s1 !== peg$FAILED) {\n              s2 = peg$parseTermText();\n              if (s2 !== peg$FAILED) {\n                peg$savedPos = s0;\n                s1 = peg$c38(s2);\n                s0 = s1;\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          }\n        }\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c17); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTimeRange() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseMoment();\n    if (s1 !== peg$FAILED) {\n      if (input.substr(peg$currPos, 2) === peg$c40) {\n        s2 = peg$c40;\n        peg$currPos += 2;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c41); }\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseMoment();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c42(s1, s3);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseMoment();\n      if (s1 !== peg$FAILED) {\n        if (input.substr(peg$currPos, 2) === peg$c40) {\n          s2 = peg$c40;\n          peg$currPos += 2;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c41); }\n        }\n        if (s2 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c43(s1);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parseMoment();\n        if (s1 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c44(s1);\n        }\n        s0 = s1;\n        if (s0 === peg$FAILED) {\n          s0 = peg$currPos;\n          if (input.substr(peg$currPos, 2) === peg$c40) {\n            s1 = peg$c40;\n            peg$currPos += 2;\n          } else {\n            s1 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c41); }\n          }\n          if (s1 !== peg$FAILED) {\n            s2 = peg$parseMoment();\n            if (s2 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c45(s2);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n          if (s0 === peg$FAILED) {\n            s0 = peg$currPos;\n            if (input.substr(peg$currPos, 2) === peg$c40) {\n              s1 = peg$c40;\n              peg$currPos += 2;\n            } else {\n              s1 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c41); }\n            }\n            if (s1 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c46();\n            }\n            s0 = s1;\n          }\n        }\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c39); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseMoment() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$parseTimeOffset();\n    if (s0 === peg$FAILED) {\n      s0 = peg$parseTimestamp();\n      if (s0 === peg$FAILED) {\n        s0 = peg$parseTimeUnit();\n        if (s0 === peg$FAILED) {\n          s0 = peg$currPos;\n          s1 = peg$currPos;\n          if (input.substr(peg$currPos, 5) === peg$c48) {\n            s2 = peg$c48;\n            peg$currPos += 5;\n          } else {\n            s2 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c49); }\n          }\n          if (s2 === peg$FAILED) {\n            if (input.substr(peg$currPos, 3) === peg$c50) {\n              s2 = peg$c50;\n              peg$currPos += 3;\n            } else {\n              s2 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c51); }\n            }\n          }\n          if (s2 !== peg$FAILED) {\n            s1 = input.substring(s1, peg$currPos);\n          } else {\n            s1 = s2;\n          }\n          if (s1 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c52(s1);\n          }\n          s0 = s1;\n        }\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c47); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTimestamp() {\n    var s0, s1, s2, s3, s4, s5;\n\n    s0 = peg$currPos;\n    s1 = peg$parseYear();\n    if (s1 !== peg$FAILED) {\n      if (peg$c53.test(input.charAt(peg$currPos))) {\n        s2 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c54); }\n      }\n      if (s2 === peg$FAILED) {\n        s2 = null;\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseMonth();\n        if (s3 !== peg$FAILED) {\n          if (peg$c53.test(input.charAt(peg$currPos))) {\n            s4 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s4 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c54); }\n          }\n          if (s4 === peg$FAILED) {\n            s4 = null;\n          }\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parseDay();\n            if (s5 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c55(s1, s3, s5);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseYear();\n      if (s1 !== peg$FAILED) {\n        if (peg$c53.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c54); }\n        }\n        if (s2 === peg$FAILED) {\n          s2 = null;\n        }\n        if (s2 !== peg$FAILED) {\n          s3 = peg$parseMonth();\n          if (s3 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c56(s1, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parseYear();\n        if (s1 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c57(s1);\n        }\n        s0 = s1;\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTimeUnit() {\n    var s0, s1;\n\n    s0 = peg$currPos;\n    if (peg$c58.test(input.charAt(peg$currPos))) {\n      s1 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c59); }\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c60(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parseYear() {\n    var s0, s1, s2, s3, s4, s5, s6;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    s2 = peg$currPos;\n    if (peg$c62.test(input.charAt(peg$currPos))) {\n      s3 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s3 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c63); }\n    }\n    if (s3 !== peg$FAILED) {\n      if (peg$c62.test(input.charAt(peg$currPos))) {\n        s4 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c63); }\n      }\n      if (s4 !== peg$FAILED) {\n        if (peg$c62.test(input.charAt(peg$currPos))) {\n          s5 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s5 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c63); }\n        }\n        if (s5 !== peg$FAILED) {\n          if (peg$c62.test(input.charAt(peg$currPos))) {\n            s6 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s6 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c63); }\n          }\n          if (s6 !== peg$FAILED) {\n            s3 = [s3, s4, s5, s6];\n            s2 = s3;\n          } else {\n            peg$currPos = s2;\n            s2 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s2;\n          s2 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s2;\n        s2 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s2;\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c64(s1);\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c61); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseMonth() {\n    var s0, s1, s2, s3, s4;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    s2 = peg$currPos;\n    if (peg$c62.test(input.charAt(peg$currPos))) {\n      s3 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s3 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c63); }\n    }\n    if (s3 !== peg$FAILED) {\n      if (peg$c62.test(input.charAt(peg$currPos))) {\n        s4 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c63); }\n      }\n      if (s4 !== peg$FAILED) {\n        s3 = [s3, s4];\n        s2 = s3;\n      } else {\n        peg$currPos = s2;\n        s2 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s2;\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c64(s1);\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c65); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseDay() {\n    var s0, s1, s2, s3, s4;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    s2 = peg$currPos;\n    if (peg$c62.test(input.charAt(peg$currPos))) {\n      s3 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s3 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c63); }\n    }\n    if (s3 !== peg$FAILED) {\n      if (peg$c62.test(input.charAt(peg$currPos))) {\n        s4 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c63); }\n      }\n      if (s4 !== peg$FAILED) {\n        s3 = [s3, s4];\n        s2 = s3;\n      } else {\n        peg$currPos = s2;\n        s2 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s2;\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c64(s1);\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c66); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTimeOffset() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    s2 = [];\n    if (peg$c62.test(input.charAt(peg$currPos))) {\n      s3 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s3 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c63); }\n    }\n    if (s3 !== peg$FAILED) {\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        if (peg$c62.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c63); }\n        }\n      }\n    } else {\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      if (peg$c58.test(input.charAt(peg$currPos))) {\n        s2 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c59); }\n      }\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c68(s1, s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c67); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseStringAlternatives() {\n    var s0, s1, s2, s3, s4, s5;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseString();\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 124) {\n        s4 = peg$c70;\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c71); }\n      }\n      if (s4 !== peg$FAILED) {\n        s5 = peg$parseString();\n        if (s5 !== peg$FAILED) {\n          s4 = [s4, s5];\n          s3 = s4;\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s3;\n        s3 = peg$FAILED;\n      }\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 124) {\n          s4 = peg$c70;\n          peg$currPos++;\n        } else {\n          s4 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c71); }\n        }\n        if (s4 !== peg$FAILED) {\n          s5 = peg$parseString();\n          if (s5 !== peg$FAILED) {\n            s4 = [s4, s5];\n            s3 = s4;\n          } else {\n            peg$currPos = s3;\n            s3 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      }\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c72(s1, s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c69); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTagAlternatives() {\n    var s0, s1, s2, s3, s4, s5;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseTagName();\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 124) {\n        s4 = peg$c70;\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c71); }\n      }\n      if (s4 !== peg$FAILED) {\n        s5 = peg$parseTagName();\n        if (s5 !== peg$FAILED) {\n          s4 = [s4, s5];\n          s3 = s4;\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s3;\n        s3 = peg$FAILED;\n      }\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 124) {\n          s4 = peg$c70;\n          peg$currPos++;\n        } else {\n          s4 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c71); }\n        }\n        if (s4 !== peg$FAILED) {\n          s5 = peg$parseTagName();\n          if (s5 !== peg$FAILED) {\n            s4 = [s4, s5];\n            s3 = s4;\n          } else {\n            peg$currPos = s3;\n            s3 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      }\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c72(s1, s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c73); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseString() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c75.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c76); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c75.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c76); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c77();\n    }\n    s0 = s1;\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 39) {\n        s1 = peg$c78;\n        peg$currPos++;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c79); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        if (peg$c80.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c81); }\n        }\n        if (s3 !== peg$FAILED) {\n          while (s3 !== peg$FAILED) {\n            s2.push(s3);\n            if (peg$c80.test(input.charAt(peg$currPos))) {\n              s3 = input.charAt(peg$currPos);\n              peg$currPos++;\n            } else {\n              s3 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c81); }\n            }\n          }\n        } else {\n          s2 = peg$FAILED;\n        }\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 39) {\n            s3 = peg$c78;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c79); }\n          }\n          if (s3 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c82(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 34) {\n          s1 = peg$c83;\n          peg$currPos++;\n        } else {\n          s1 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c84); }\n        }\n        if (s1 !== peg$FAILED) {\n          s2 = [];\n          if (peg$c85.test(input.charAt(peg$currPos))) {\n            s3 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c86); }\n          }\n          if (s3 !== peg$FAILED) {\n            while (s3 !== peg$FAILED) {\n              s2.push(s3);\n              if (peg$c85.test(input.charAt(peg$currPos))) {\n                s3 = input.charAt(peg$currPos);\n                peg$currPos++;\n              } else {\n                s3 = peg$FAILED;\n                if (peg$silentFails === 0) { peg$fail(peg$c86); }\n              }\n            }\n          } else {\n            s2 = peg$FAILED;\n          }\n          if (s2 !== peg$FAILED) {\n            if (input.charCodeAt(peg$currPos) === 34) {\n              s3 = peg$c83;\n              peg$currPos++;\n            } else {\n              s3 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c84); }\n            }\n            if (s3 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c82(s2);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c74); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsePropertyName() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c88.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c89); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c88.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c89); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c77();\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c87); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTagName() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c91.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c92); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c91.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c92); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c77();\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c90); }\n    }\n\n    return s0;\n  }\n\n  function peg$parse_() {\n    var s0, s1;\n\n    peg$silentFails++;\n    if (peg$c94.test(input.charAt(peg$currPos))) {\n      s0 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s0 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c95); }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c93); }\n    }\n\n    return s0;\n  }\n\n\n    const checkDate = (year, month, day) => {\n      const date = new Date(year + \"-\" + month + \"-\" + day);\n      if (isNaN(date.valueOf())) {\n        throw { message: 'invalid date'};\n      } else {\n        return { \n          type: 'timestamp', \n          year: parseInt(year), \n          month: parseInt(month), \n          day: parseInt(day) \n        };\n      }\n    };\n    const checkMonth = (year, month) => {\n      if (month >= 1 && month <= 12) {\n        return { type: 'timestamp', year: parseInt(year), month: parseInt(month), day: null };\n      } else {\n        throw {message: 'invalid month'};  \n      }\n    };\n\n\n  peg$result = peg$startRuleFunction();\n\n  if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n    return peg$result;\n  } else {\n    if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n      peg$fail(peg$endExpectation());\n    }\n\n    throw peg$buildStructuredError(\n      peg$maxFailExpected,\n      peg$maxFailPos < input.length ? input.charAt(peg$maxFailPos) : null,\n      peg$maxFailPos < input.length\n        ? peg$computeLocation(peg$maxFailPos, peg$maxFailPos + 1)\n        : peg$computeLocation(peg$maxFailPos, peg$maxFailPos)\n    );\n  }\n}\n\nmodule.exports = {\n  SyntaxError: peg$SyntaxError,\n  parse:       peg$parse\n};\n","export default (() => {\n  let nextId = 1;\n  return () => nextId++;\n})();\n","import {\n  format,\n  parse,\n  addHours,\n  addDays,\n  addWeeks,\n  addMonths,\n  addYears,\n  subHours,\n  subDays,\n  subWeeks,\n  subMonths,\n  subYears,\n  isBefore,\n  differenceInMinutes,\n  getHours,\n  setHours,\n  getMinutes,\n  setMinutes,\n} from 'date-fns';\n\nexport const renderAsText = (timestamp) => {\n  const {\n    isActive,\n    year,\n    month,\n    day,\n    dayName,\n    startHour,\n    startMinute,\n    endHour,\n    endMinute,\n    repeaterType,\n    repeaterValue,\n    repeaterUnit,\n    repeaterDeadlineValue,\n    repeaterDeadlineUnit,\n    delayType,\n    delayValue,\n    delayUnit,\n  } = timestamp.toJS();\n\n  let timestampText = '';\n  timestampText += isActive ? '<' : '[';\n  timestampText += `${year}-${month}-${day}`;\n  timestampText += !!dayName ? ` ${dayName}` : '';\n  timestampText += !!startHour ? ` ${startHour}:${startMinute}` : '';\n  timestampText += !!endHour ? `-${endHour}:${endMinute}` : '';\n  timestampText += !!repeaterType ? ` ${repeaterType}${repeaterValue}${repeaterUnit}` : '';\n  timestampText +=\n    !!repeaterType && !!repeaterDeadlineValue\n      ? `/${repeaterDeadlineValue}${repeaterDeadlineUnit}`\n      : '';\n  timestampText += !!delayType ? ` ${delayType}${delayValue}${delayUnit}` : '';\n  timestampText += isActive ? '>' : ']';\n\n  return timestampText;\n};\n\nexport const getCurrentTimestamp = ({ isActive = true, withStartTime = false } = {}) =>\n  timestampForDate(new Date(), { isActive, withStartTime });\n\nexport const timestampForDate = (time, { isActive = true, withStartTime = false } = {}) => {\n  const timestamp = {\n    isActive,\n    year: format(time, 'yyyy'),\n    month: format(time, 'MM'),\n    day: format(time, 'dd'),\n    dayName: format(time, 'eee'),\n    startHour: null,\n    startMinute: null,\n    endHour: null,\n    endMinute: null,\n    repeaterType: null,\n    repeaterValue: null,\n    repeaterUnit: null,\n    repeaterDeadlineValue: null,\n    repeaterDeadlineUnit: null,\n    delayType: null,\n    delayValue: null,\n    delayUnit: null,\n  };\n\n  if (withStartTime) {\n    timestamp.startHour = format(time, 'HH');\n    timestamp.startMinute = format(time, 'mm');\n  }\n\n  return timestamp;\n};\n\n// To get around the heavy-weight renderAsText(fromJS(getCurrentTimestampAsText()))\nexport const getCurrentTimestampAsText = ({ isActive = true, withStartTime = false } = {}) =>\n  getTimestampAsText(new Date(), { isActive, withStartTime });\nexport const getTimestampAsText = (time, { isActive = true, withStartTime = false } = {}) => {\n  const bracketPair = isActive ? '<>' : '[]';\n  let formatString = 'yyyy-MM-dd eee';\n  if (withStartTime) formatString += ' HH:mm';\n  return `${bracketPair[0]}${format(time, formatString)}${bracketPair[1]}`;\n};\n\nexport const dateForTimestamp = (timestamp) => {\n  const { year, month, day, startHour, startMinute } = timestamp.toJS();\n\n  let timestampString = `${year}-${month}-${day}`;\n  if (startHour && startMinute) {\n    timestampString += ` ${startHour.padStart(2, '0')}:${startMinute}`;\n  } else {\n    timestampString += ' 12:00';\n  }\n  return parse(timestampString, 'yyyy-MM-dd HH:mm', new Date());\n};\n\nexport const addTimestampUnitToDate = (date, numUnits, timestampUnit) => {\n  switch (timestampUnit) {\n    case 'h':\n      return addHours(date, numUnits);\n    case 'd':\n      return addDays(date, numUnits);\n    case 'w':\n      return addWeeks(date, numUnits);\n    case 'm':\n      return addMonths(date, numUnits);\n    case 'y':\n      return addYears(date, numUnits);\n    default:\n      return date;\n  }\n};\n\nexport const subtractTimestampUnitFromDate = (date, numUnits, timestampUnit) => {\n  switch (timestampUnit) {\n    case 'h':\n      return subHours(date, numUnits);\n    case 'd':\n      return subDays(date, numUnits);\n    case 'w':\n      return subWeeks(date, numUnits);\n    case 'm':\n      return subMonths(date, numUnits);\n    case 'y':\n      return subYears(date, numUnits);\n    default:\n      return date;\n  }\n};\n\nexport const applyRepeater = (timestamp, currentDate) => {\n  if (!timestamp.get('repeaterType')) {\n    return timestamp;\n  }\n\n  let newDate = null;\n  switch (timestamp.get('repeaterType')) {\n    case '+':\n      newDate = addTimestampUnitToDate(\n        dateForTimestamp(timestamp),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      break;\n    case '++':\n      newDate = addTimestampUnitToDate(\n        dateForTimestamp(timestamp),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      while (isBefore(newDate, currentDate)) {\n        newDate = addTimestampUnitToDate(\n          newDate,\n          timestamp.get('repeaterValue'),\n          timestamp.get('repeaterUnit')\n        );\n      }\n      break;\n    case '.+':\n      newDate = addTimestampUnitToDate(\n        currentDate,\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      if (timestamp.get('repeaterUnit') !== 'h') {\n        let timestampDate = dateForTimestamp(timestamp);\n        newDate = setHours(newDate, getHours(timestampDate));\n        newDate = setMinutes(newDate, getMinutes(timestampDate));\n      }\n      break;\n    default:\n      console.error(`Unrecognized timestamp repeater type: ${timestamp.get('repeaterType')}`);\n      return timestamp;\n  }\n\n  timestamp = timestamp\n    .set('day', format(newDate, 'dd'))\n    .set('dayName', format(newDate, 'eee'))\n    .set('month', format(newDate, 'MM'))\n    .set('year', format(newDate, 'yyyy'));\n\n  if (timestamp.get('startHour') !== undefined && timestamp.get('startHour') !== null) {\n    timestamp = timestamp\n      .set('startHour', format(newDate, 'HH'))\n      .set('startMinute', format(newDate, 'mm'));\n  }\n\n  return timestamp;\n};\n\nexport const timestampDuration = (startTimestamp, endTimestamp) => {\n  let [start, end] = [startTimestamp, endTimestamp].map(dateForTimestamp);\n  return dateDuration(start, end);\n};\n\nexport const dateDuration = (start, end) => {\n  let pad = ' ';\n  if (start > end) {\n    pad = '-';\n    [start, end] = [end, start];\n  }\n  const minDiff = differenceInMinutes(end, start);\n  const hours = Math.floor(minDiff / 60);\n  if (hours >= 10) {\n    pad = '';\n  }\n  const minutes = minDiff % 60;\n  const minutesText = minutes >= 10 ? minutes : `0${minutes}`;\n  return `${pad}${hours}:${minutesText}`;\n};\n\nexport const millisDuration = (millis) => {\n  if (millis === undefined) {\n    return '';\n  }\n  return dateDuration(new Date(0), new Date(millis));\n};\n","import _ from 'lodash';\nimport { fromJS } from 'immutable';\n\nimport { isRegularPlanningItem } from './org_utils';\nimport { renderAsText, timestampDuration } from './timestamps';\n\nconst linkPartToRawText = (linkPart) => {\n  if (!!linkPart.getIn(['contents', 'title'])) {\n    return `[[${linkPart.getIn(['contents', 'uri'])}][${linkPart.getIn(['contents', 'title'])}]]`;\n  } else {\n    return `[[${linkPart.getIn(['contents', 'uri'])}]]`;\n  }\n};\n\nconst formattedAttributedStringText = (parts) => {\n  return parts\n    .map((part) => {\n      switch (part.get('type')) {\n        case 'text':\n          return part.get('contents');\n        case 'link':\n          if (part.getIn(['contents', 'title'])) {\n            return part.getIn(['contents', 'title']);\n          } else {\n            return part.getIn(['contents', 'uri']);\n          }\n        case 'table':\n          return '';\n        default:\n          return '';\n      }\n    })\n    .join('');\n};\n\nconst tablePartToRawText = (tablePart) => {\n  const rowHeights = tablePart\n    .get('contents')\n    .map((row) =>\n      Math.max(\n        ...row.get('contents').map((cell) => (_.countBy(cell.get('rawContents'))['\\n'] || 0) + 1)\n      )\n    )\n    .toJS();\n  const columns = tablePart.getIn(['contents', 0, 'contents']);\n  if (columns === undefined) {\n    return '';\n  }\n  const numColumns = columns.size;\n  const columnWidths = _.times(numColumns).map((columnIndex) =>\n    Math.max(\n      ...tablePart.get('contents').map((row) => {\n        const content = row.getIn(['contents', columnIndex, 'contents']);\n        const formattedText = formattedAttributedStringText(content);\n        const lineLengths = formattedText.split('\\n').map((line) => line.trim().length);\n        return Math.max(...lineLengths);\n      })\n    )\n  );\n\n  const rowStrings = _.dropRight(\n    _.flatten(\n      tablePart\n        .get('contents')\n        .map((row, rowIndex) => {\n          const rowHeight = rowHeights[rowIndex];\n\n          const contentRows = _.times(rowHeight)\n            .map((lineIndex) =>\n              row\n                .get('contents')\n                .map((cell, columnIndex) => {\n                  const content = cell.get('contents');\n                  const formattedText = formattedAttributedStringText(content);\n                  const formattedLineLengths = formattedText\n                    .split('\\n')\n                    .map((line) => line.trim().length);\n                  const line = (cell.get('rawContents').split('\\n')[lineIndex] || '').trim();\n\n                  const padCount = columnWidths[columnIndex] - formattedLineLengths[lineIndex];\n\n                  return line + ' '.repeat(padCount);\n                })\n                .toJS()\n                .join(' | ')\n            )\n            .map((contentRow) => `| ${contentRow} |`);\n\n          const separator =\n            '|' + columnWidths.map((columnWidth) => '-'.repeat(columnWidth + 2)).join('+') + '|';\n\n          return contentRows.concat(separator);\n        })\n        .toJS()\n    )\n  );\n\n  return rowStrings.join('\\n');\n};\n\nconst listPartToRawText = (listPart) => {\n  const bulletCharacter = listPart.get('bulletCharacter');\n\n  let previousNumber = 0;\n  return listPart\n    .get('items')\n    .map((item) => {\n      const optionalLeadingSpace = !listPart.get('isOrdered') && bulletCharacter === '*' ? ' ' : '';\n\n      const titleText = attributedStringToRawText(item.get('titleLine'));\n\n      const contentText = attributedStringToRawText(item.get('contents'));\n      const indentedContentText = contentText\n        .split('\\n')\n        .map((line) => (!!line.trim() ? `${optionalLeadingSpace}  ${line}` : ''))\n        .join('\\n');\n\n      let listItemText = null;\n      if (listPart.get('isOrdered')) {\n        let number = ++previousNumber;\n        let forceNumber = item.get('forceNumber');\n        if (!!forceNumber) {\n          number = forceNumber;\n          previousNumber = number;\n        }\n\n        listItemText = `${number}${listPart.get('numberTerminatorCharacter')}`;\n\n        if (!!forceNumber) {\n          listItemText += ` [@${forceNumber}]`;\n        }\n\n        if (item.get('isCheckbox')) {\n          const stateCharacter = {\n            checked: 'X',\n            unchecked: ' ',\n            partial: '-',\n          }[item.get('checkboxState')];\n\n          listItemText += ` [${stateCharacter}]`;\n        }\n\n        listItemText += ` ${titleText}`;\n      } else {\n        listItemText = `${optionalLeadingSpace}${bulletCharacter}`;\n\n        if (item.get('isCheckbox')) {\n          const stateCharacter = {\n            checked: 'X',\n            unchecked: ' ',\n            partial: '-',\n          }[item.get('checkboxState')];\n\n          listItemText += ` [${stateCharacter}]`;\n        }\n\n        listItemText += ` ${titleText}`;\n      }\n\n      if (!!contentText) {\n        listItemText += `\\n${indentedContentText}`;\n      }\n\n      return listItemText;\n    })\n    .join('\\n');\n};\n\nconst timestampPartToRawText = (part) => {\n  let text = renderAsText(part.get('firstTimestamp'));\n  if (part.get('secondTimestamp')) {\n    text += `--${renderAsText(part.get('secondTimestamp'))}`;\n  }\n\n  return text;\n};\n\nconst inlineMarkUpToRawText = (part) => {\n  const markupTypeToRaw = {\n    'inline-code': '~',\n    bold: '*',\n    italic: '/',\n    strikethrough: '+',\n    underline: '_',\n    verbatim: '=',\n  };\n  if (part.get('type') !== 'inline-markup' || !markupTypeToRaw[part.get('markupType')])\n    return part.get('content');\n  return (\n    markupTypeToRaw[part.get('markupType')] +\n    part.get('content') +\n    markupTypeToRaw[part.get('markupType')]\n  );\n};\n\nexport const attributedStringToRawText = (parts) => {\n  if (!parts) {\n    return '';\n  }\n\n  const prevParts = parts.unshift(null);\n\n  return parts\n    .zip(prevParts)\n    .map(([part, prevPart]) => {\n      let text = '';\n      switch (part.get('type')) {\n        case 'text':\n          text = part.get('contents');\n          break;\n        case 'inline-markup':\n          text = inlineMarkUpToRawText(part);\n          break;\n        case 'link':\n          text = linkPartToRawText(part);\n          break;\n        case 'fraction-cookie':\n          text = `[${part.getIn(['fraction', 0]) || ''}/${part.getIn(['fraction', 1]) || ''}]`;\n          break;\n        case 'percentage-cookie':\n          text = `[${part.get('percentage') || ''}%]`;\n          break;\n        case 'table':\n          text = tablePartToRawText(part);\n          break;\n        case 'list':\n          text = listPartToRawText(part);\n          break;\n        case 'timestamp':\n          text = timestampPartToRawText(part);\n          break;\n        case 'url':\n        case 'www-url':\n        case 'e-mail':\n        case 'phone-number':\n          text = part.get('content');\n          break;\n        default:\n          console.error(\n            `Unknown attributed string part type in attributedStringToRawText: ${part.get('type')}`\n          );\n      }\n\n      let optionalNewlinePrefix = '';\n      if (!!prevPart) {\n        if (['list', 'table'].includes(prevPart.get('type'))) {\n          optionalNewlinePrefix = '\\n';\n        } else if (\n          part.get('type') === 'list' &&\n          prevPart.get('type') === 'text' &&\n          !prevPart.get('contents').endsWith('\\n')\n        ) {\n          optionalNewlinePrefix = '\\n';\n        }\n      }\n      return optionalNewlinePrefix + text;\n    })\n    .join('');\n};\n\n// Takes a plain JS object\nexport const generateTitleLine = (header, includeStars) => {\n  // Remove stars afterwards if not includeStars - because of :tag: alignment\n  let titleLine = '*'.repeat(header.nestingLevel);\n\n  if (header.titleLine.todoKeyword) {\n    titleLine += ` ${header.titleLine.todoKeyword}`;\n  }\n  titleLine += ` ${header.titleLine.rawTitle}`;\n\n  if (header.titleLine.tags.length) {\n    // TODO: filter()? Why would we add empty tags in the first place?\n    let tagsString = `:${header.titleLine.tags.filter((x) => x).join(':')}:`;\n    if (!titleLine.match(/\\s$/)) {\n      // Insert as many spaces as orgmode auto-formatting does:\n      let n = 77 - titleLine.length - tagsString.length;\n      let space = ' '.repeat(n > 0 ? n : 1);\n      titleLine += space;\n    }\n    titleLine += tagsString;\n  }\n\n  if (!includeStars) titleLine = titleLine.substring(1 + header.nestingLevel);\n  return titleLine;\n};\n\n/**\n * Convert state data into a fully rendered Orgmode file text.\n *\n * @param {*} headers Full list of org headings from redux state.\n * @param {*} linesBeforeHeadings Text that occurs before the first heading.\n * @param {boolean} dontIndent Default false means indent drawers according to\n * nesting level, else keep everything flush-left. Description is kept as is.\n */\nexport const exportOrg = ({ headers, linesBeforeHeadings, dontIndent }) => {\n  let configContent = linesBeforeHeadings.map((x) => x + '\\n').join('');\n  const headerContent = headers.map((x) => createRawDescriptionText(x, true, dontIndent)).join('');\n  return configContent + headerContent;\n};\n\n/**\n * Transform state data of complete org element / header into rendered text.\n *\n * @param {*} header Immutable map with header data\n * @param {boolean} includeTitle Render the full orgmode title\n * @param {boolean} dontIndent If true keep all text flush-left, else (DEFAULT) indent according to nesting level\n */\nexport const createRawDescriptionText = (header, includeTitle, dontIndent) => {\n  // To simplify access to properties:\n  const immutableHeader = header;\n  header = header.toJS();\n\n  // Pad things like planning items and tables appropriately\n  // considering the nestingLevel of the header, unless that is explicitly disabled\n  const indentation = dontIndent ? '' : ' '.repeat(header.nestingLevel + 1);\n  let contents = '';\n\n  if (includeTitle) {\n    contents += generateTitleLine(header, true) + '\\n';\n  }\n\n  // Special case: do not render planning items that are normal active timestamps\n  const planningItemsToRender = immutableHeader\n    .get('planningItems')\n    .filter(isRegularPlanningItem)\n    .toJS();\n  if (planningItemsToRender.length) {\n    const planningItemsContent = planningItemsToRender\n      .map((planningItem) => {\n        const timestampString = renderAsText(fromJS(planningItem.timestamp));\n        return `${planningItem.type}: ${timestampString}`;\n      })\n      .join(' ')\n      .trimRight();\n    contents += `${indentation}${planningItemsContent}\\n`;\n  }\n\n  if (header.propertyListItems.length) {\n    const propertyListItemsContent = header.propertyListItems\n      .map((propertyListItem) => {\n        return `${indentation}:${propertyListItem.property}: ${attributedStringToRawText(\n          fromJS(propertyListItem.value)\n        )}`;\n      })\n      .join('\\n');\n    contents += `${indentation}:PROPERTIES:\\n`;\n    contents += `${propertyListItemsContent}\\n`;\n    contents += `${indentation}:END:\\n`;\n  }\n\n  // Log notes come after properties and before logbook.\n  contents += attributedStringToRawText(fromJS(header.logNotes))\n    .split('\\n')\n    .map((line) => (line.trim() ? `${indentation}${line}` : ''))\n    .join('\\n');\n  contents += header.logNotes.length ? '\\n' : '';\n\n  if (header.logBookEntries.length) {\n    const logBookEntriesContent = header.logBookEntries\n      .map((entry) => {\n        if (entry.raw !== undefined) {\n          return entry.raw ? `${indentation}${entry.raw}` : '';\n        } else if (entry.end === null) {\n          return `${indentation}CLOCK: ${renderAsText(fromJS(entry.start))}`;\n        } else {\n          return `${indentation}CLOCK: ${renderAsText(fromJS(entry.start))}--${renderAsText(\n            fromJS(entry.end)\n          )} => ${timestampDuration(fromJS(entry.start), fromJS(entry.end))}`;\n        }\n      })\n      .join('\\n')\n      .trimRight();\n    contents += `${indentation}:LOGBOOK:\\n`;\n    contents += `${logBookEntriesContent}\\n`;\n    contents += `${indentation}:END:\\n`;\n  }\n\n  // A newline character belongs to its line, not to the next line.\n  // Unless rawDescription === '', it must have a trailing newline character.\n  let fixedRawDescription = header.rawDescription;\n  if (header.rawDescription.match(/[^\\n]$/)) fixedRawDescription = header.rawDescription + '\\n';\n  contents += fixedRawDescription;\n\n  return contents;\n};\n","import { Map } from 'immutable';\nimport format from 'date-fns/format';\nimport _ from 'lodash';\n\nexport default (templateString, customVariables = Map()) => {\n  if (!templateString) {\n    return ['', null];\n  }\n\n  const substitutions = {\n    '%t': `<${format(new Date(), 'yyyy-MM-dd eee')}>`,\n    '%T': `<${format(new Date(), 'yyyy-MM-dd eee HH:mm')}>`,\n    '%u': `[${format(new Date(), 'yyyy-MM-dd eee')}]`,\n    '%U': `[${format(new Date(), 'yyyy-MM-dd eee HH:mm')}]`,\n    '%r': `${format(new Date(), 'yyyy-MM-dd eee')}`,\n    '%R': `${format(new Date(), 'yyyy-MM-dd eee HH:mm')}`,\n    '%y': `${format(new Date(), 'yyyy')}`,\n  };\n\n  customVariables.entrySeq().forEach(([key, value]) => {\n    substitutions[`%${key}`] = value;\n  });\n\n  let substitutedString = templateString;\n  _.entries(substitutions).forEach(\n    ([formatString, value]) =>\n      (substitutedString = substitutedString.replace(RegExp(formatString, 'g'), value))\n  );\n\n  const cursorIndex = substitutedString.includes('%?') ? substitutedString.indexOf('%?') : null;\n  substitutedString = substitutedString.replace(/%\\?/, '');\n\n  return [substitutedString, cursorIndex];\n};\n","import { List, Map, fromJS } from 'immutable';\nimport _ from 'lodash';\nimport raw from 'raw.macro';\nimport { formatDistanceToNow } from 'date-fns';\n\nimport generateId from './id_generator';\nimport { attributedStringToRawText } from './export_org';\nimport substituteTemplateVariables from './capture_template_substitution';\n\nexport const STATIC_FILE_PREFIX = 'organice_internal_';\n\nfunction generateHash(list) {\n  return new Promise((resolve, reject) => {\n    if (crypto.subtle) {\n      crypto.subtle\n        .digest(\n          {\n            name: 'SHA-256',\n          },\n          new Uint8Array(list)\n        )\n        .then((hashArray) => {\n          resolve(_.values(new Uint8Array(hashArray)).join(''));\n        });\n    } else {\n      console.warn('crypto.subtle module is not available, returning an empty bogus hash.');\n      resolve('');\n    }\n  });\n}\n\nexport const changelogHash = () => {\n  return new Promise((resolve, reject) => {\n    const changelogFile = raw('../../changelog.org');\n\n    generateHash(changelogFile.split('').map((c) => c.charCodeAt(0))).then((hash) => {\n      resolve(hash);\n    });\n  });\n};\n\nexport const indexAndHeaderWithId = (headers, headerId) => {\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n  return { headerIndex, header: headers.get(headerIndex) };\n};\n\nexport const indexOfHeaderWithId = (headers, headerId) => {\n  return headers.findIndex((header) => header.get('id') === headerId);\n};\n\nexport const headerWithId = (headers, headerId) => {\n  return headers.get(indexOfHeaderWithId(headers, headerId));\n};\n\nconst subheaderIndexRangeForHeaderIndex = (headers, headerIndex) => {\n  const header = headers.get(headerIndex);\n\n  const afterHeaders = headers.slice(headerIndex + 1);\n  const nextSiblingHeaderIndex = afterHeaders.findIndex((siblingHeader) => {\n    return siblingHeader.get('nestingLevel') <= header.get('nestingLevel');\n  });\n\n  if (nextSiblingHeaderIndex === -1) {\n    return [headerIndex + 1, headers.size];\n  } else {\n    return [headerIndex + 1, headerIndex + 1 + nextSiblingHeaderIndex];\n  }\n};\n\nconst subheaderIndexRangeForHeaderId = (headers, headerId) => {\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n  return subheaderIndexRangeForHeaderIndex(headers, headerIndex);\n};\n\nexport const subheaderIndicesOfHeaderWithId = (headers, headerId) => {\n  let [begin, end] = subheaderIndexRangeForHeaderId(headers, headerId);\n  return _.range(begin, end);\n};\n\nexport const subheadersOfHeaderWithIndex = (headers, headerIndex) => {\n  let [begin, end] = subheaderIndexRangeForHeaderIndex(headers, headerIndex);\n  return headers.slice(begin, end);\n};\n\nexport const subheadersOfHeaderWithId = (headers, headerId) => {\n  let [begin, end] = subheaderIndexRangeForHeaderId(headers, headerId);\n  return headers.slice(begin, end);\n};\n\nexport const numSubheadersOfHeaderWithId = (headers, headerId) =>\n  subheadersOfHeaderWithId(headers, headerId).size;\n\nexport const directParentOfHeaderWithId = (headers, headerId) => {\n  const { header, headerIndex } = indexAndHeaderWithId(headers, headerId);\n\n  for (let i = headerIndex - 1; i >= 0; --i) {\n    const previousHeader = headers.get(i);\n\n    if (previousHeader.get('nestingLevel') === header.get('nestingLevel') - 1) {\n      return previousHeader;\n    }\n\n    if (previousHeader.get('nestingLevel') < header.get('nestingLevel')) {\n      return null;\n    }\n  }\n\n  return null;\n};\n\nexport const directParentIdOfHeaderWithId = (headers, headerId) => {\n  const parent = directParentOfHeaderWithId(headers, headerId);\n  if (!parent) {\n    return null;\n  } else {\n    return parent.get('id');\n  }\n};\n\nexport const parentIdOfHeaderWithId = (headers, headerId) => {\n  const { header, headerIndex } = indexAndHeaderWithId(headers, headerId);\n\n  const previousHeaders = headers.slice(0, headerIndex);\n  const parentHeader = previousHeaders.findLast(\n    (previousHeader) => previousHeader.get('nestingLevel') < header.get('nestingLevel')\n  );\n\n  if (!parentHeader) {\n    return null;\n  }\n\n  return parentHeader.get('id');\n};\n\nexport const inheritedValueOfProperty = (headers, headerIndex, property) => {\n  const headerProp = headers\n    .getIn([headerIndex, 'propertyListItems'])\n    .find((item) => item.get('property') === property);\n  if (headerProp) {\n    return headerProp.get('value');\n  }\n  const parentId = parentIdOfHeaderWithId(headers, headers.getIn([headerIndex, 'id']));\n  if (parentId) {\n    const parentHeaderIndex = indexOfHeaderWithId(headers, parentId);\n    return inheritedValueOfProperty(headers, parentHeaderIndex, property);\n  }\n  return null;\n};\n\nexport const indexOfPreviousSibling = (headers, headerIndex) => {\n  const nestingLevel = headers.getIn([headerIndex, 'nestingLevel']);\n\n  for (let i = headerIndex - 1; i >= 0; --i) {\n    const header = headers.get(i);\n\n    if (header.get('nestingLevel') < nestingLevel) {\n      return null;\n    }\n\n    if (header.get('nestingLevel') === nestingLevel) {\n      return i;\n    }\n  }\n\n  return null;\n};\n\nconst isHeaderVisible = (headers, headerId) => {\n  const parentHeaderId = parentIdOfHeaderWithId(headers, headerId);\n  if (!parentHeaderId) {\n    return true;\n  }\n\n  const parentHeader = headerWithId(headers, parentHeaderId);\n  return parentHeader.get('opened') && isHeaderVisible(headers, parentHeader.get('id'));\n};\n\nexport const nextVisibleHeaderAfterIndex = (headers, headerIndex) => {\n  const followingHeaders = headers.slice(headerIndex + 1);\n  return followingHeaders.find((header) => isHeaderVisible(headers, header.get('id')));\n};\n\nexport const previousVisibleHeaderAfterIndex = (headers, headerIndex) => {\n  const previousHeaders = headers.slice(0, headerIndex).reverse();\n  return previousHeaders.find((header) => isHeaderVisible(headers, header.get('id')));\n};\n\nexport const openDirectParent = (state, headerId) => {\n  const parentHeaderId = directParentIdOfHeaderWithId(state.get('headers'), headerId);\n  if (parentHeaderId !== null) {\n    const parentHeaderIndex = indexOfHeaderWithId(state.get('headers'), parentHeaderId);\n    state = state.setIn(['headers', parentHeaderIndex, 'opened'], true);\n  }\n\n  return state;\n};\n\nexport const getOpenHeaderPaths = (headers) => {\n  let openedHeaders = [];\n  for (let i = 0; i < headers.size; ++i) {\n    const header = headers.get(i);\n    if (!header.get('opened')) {\n      continue;\n    }\n\n    const title = header.getIn(['titleLine', 'rawTitle']);\n\n    const subheaders = subheadersOfHeaderWithId(headers, header.get('id'));\n    const openSubheaderPaths = getOpenHeaderPaths(subheaders);\n\n    if (openSubheaderPaths.length > 0) {\n      openSubheaderPaths.forEach((openedSubheaderPath) => {\n        openedHeaders.push([title].concat(openedSubheaderPath));\n      });\n    } else {\n      openedHeaders.push([title]);\n    }\n\n    i += subheaders.size;\n  }\n\n  return openedHeaders;\n};\n\nexport const getSelectedHeader = (state) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path], Map());\n  const headerId = file.get('selectedHeaderId');\n  const headers = file.get('headers');\n  if (!headers) {\n    return null;\n  }\n  const headerIdx = indexOfHeaderWithId(headers, headerId);\n  if (headerIdx === -1) {\n    return null;\n  }\n  return file.getIn(['headers', headerIdx]);\n};\n\nexport const headerWithPath = (headers, headerPath) => {\n  if (headerPath.size === 0) {\n    return null;\n  }\n\n  const firstHeader = headers.find(\n    (header) =>\n      parentIdOfHeaderWithId(headers, header.get('id')) === null &&\n      header.getIn(['titleLine', 'rawTitle']).trim() ===\n        substituteTemplateVariables(headerPath.first())[0].trim()\n  );\n  if (!firstHeader) {\n    return null;\n  }\n\n  if (headerPath.size === 1) {\n    return firstHeader;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, firstHeader.get('id'));\n  return headerWithPath(subheaders, headerPath.rest());\n};\n\nexport const openHeaderWithPath = (headers, headerPath, maxNestingLevel = 1) => {\n  if (headerPath.size === 0) {\n    return headers;\n  }\n\n  const firstTitle = headerPath.first();\n  const headerIndex = headers.findIndex((header) => {\n    const rawTitle = header.getIn(['titleLine', 'rawTitle']);\n    const nestingLevel = header.get('nestingLevel');\n    return rawTitle === firstTitle && nestingLevel <= maxNestingLevel;\n  });\n  if (headerIndex === -1) {\n    return headers;\n  }\n\n  headers = headers.update(headerIndex, (header) => header.set('opened', true));\n\n  let subheaders = subheadersOfHeaderWithId(headers, headers.getIn([headerIndex, 'id']));\n  subheaders = openHeaderWithPath(subheaders, headerPath.rest(), maxNestingLevel + 1);\n\n  headers = headers\n    .take(headerIndex + 1)\n    .concat(subheaders)\n    .concat(headers.takeLast(headers.size - (headerIndex + 1 + subheaders.size)));\n\n  return headers;\n};\n\nconst tablePartContainsCellId = (tablePart, cellId) =>\n  tablePart\n    .get('contents')\n    .some((row) => row.get('contents').some((cell) => cell.get('id') === cellId));\n\nconst doesAttributedStringContainTableCellId = (parts, cellId) =>\n  parts\n    .filter((part) => ['table', 'list'].includes(part.get('type')))\n    .some((part) =>\n      part.get('type') === 'table'\n        ? tablePartContainsCellId(part, cellId)\n        : part\n            .get('items')\n            .some((item) => doesAttributedStringContainTableCellId(item.get('contents'), cellId))\n    );\n\nexport const headerThatContainsTableCellId = (headers, cellId) =>\n  headers.find((header) =>\n    doesAttributedStringContainTableCellId(header.get('description'), cellId)\n  );\n\nexport const pathAndPartOfTimestampItemWithIdInAttributedString = (parts, timestampId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'timestamp' && part.get('id') === timestampId) {\n        return {\n          path: [partIndex],\n          timestampPart: part,\n        };\n      } else if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n              item.get('contents'),\n              timestampId\n            );\n            if (pathAndPart) {\n              const { path, timestampPart } = pathAndPart;\n              return {\n                path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                timestampPart,\n              };\n            } else {\n              let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n                item.get('titleLine'),\n                timestampId\n              );\n              if (pathAndPart) {\n                const { path, timestampPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'titleLine'].concat(path),\n                  timestampPart,\n                };\n              } else {\n                return null;\n              }\n            }\n          })\n          .filter((result) => result)\n          .first();\n      } else if (part.get('type') === 'table') {\n        return part\n          .get('contents')\n          .map((row, rowIndex) => {\n            return row\n              .get('contents')\n              .map((cell, cellIndex) => {\n                const pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n                  cell.get('contents'),\n                  timestampId\n                );\n                if (pathAndPart) {\n                  const { path, timestampPart } = pathAndPart;\n                  return {\n                    path: [\n                      partIndex,\n                      'contents',\n                      rowIndex,\n                      'contents',\n                      cellIndex,\n                      'contents',\n                    ].concat(path),\n                    timestampPart,\n                  };\n                } else {\n                  return null;\n                }\n              })\n              .filter((result) => result)\n              .first();\n          })\n          .filter((result) => result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter((result) => result)\n    .first();\n\nexport const listPartContainsItemId = (listPart, itemId) =>\n  listPart.get('items').some((item) => item.get('id') === itemId);\n\nexport const headerThatContainsListItemId = (headers, listItemId) => {\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(headers, listItemId);\n  const headerIndex = pathAndPart.path[0];\n  return headers.get(headerIndex);\n};\n\nexport const pathAndPartOfListItemWithIdInAttributedString = (parts, listItemId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            if (item.get('id') === listItemId) {\n              return {\n                path: [partIndex, 'items', itemIndex],\n                listItemPart: item,\n              };\n            } else {\n              const pathAndPart = pathAndPartOfListItemWithIdInAttributedString(\n                item.get('contents'),\n                listItemId\n              );\n              if (pathAndPart) {\n                const { path, listItemPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                  listItemPart,\n                };\n              } else {\n                return null;\n              }\n            }\n          })\n          .filter((result) => result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter((result) => result)\n    .first();\n\nexport const pathAndPartOfTableContainingCellIdInAttributedString = (parts, cellId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'table') {\n        if (tablePartContainsCellId(part, cellId)) {\n          return { path: [partIndex], tablePart: part };\n        } else {\n          return null;\n        }\n      } else if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            const pathAndPart = pathAndPartOfTableContainingCellIdInAttributedString(\n              item.get('contents'),\n              cellId\n            );\n            if (pathAndPart) {\n              const { path, tablePart } = pathAndPart;\n              return {\n                path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                tablePart,\n              };\n            } else {\n              return null;\n            }\n          })\n          .filter((result) => result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter((result) => result)\n    .first();\n\nexport const pathAndPartOfListContainingItemIdInHeaders = (headers, itemId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfListContainingItemIdInAttributedString(\n        header.get('description'),\n        itemId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, listPart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        listPart,\n      };\n    })\n    .filter((result) => !!result)\n    .first();\n\nexport const pathAndPartOfListContainingItemIdInAttributedString = (parts, itemId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'list') {\n        if (listPartContainsItemId(part, itemId)) {\n          return { path: [partIndex], listPart: part };\n        } else {\n          return part\n            .get('items')\n            .map((item, itemIndex) => {\n              const pathAndPart = pathAndPartOfListContainingItemIdInAttributedString(\n                item.get('contents'),\n                itemId\n              );\n              if (!!pathAndPart) {\n                const { path, listPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                  listPart,\n                };\n              } else {\n                return null;\n              }\n            })\n            .filter((result) => !!result)\n            .first();\n        }\n      } else {\n        return null;\n      }\n    })\n    .filter((result) => !!result)\n    .first();\n\nexport const pathAndPartOfTimestampItemWithIdInHeaders = (headers, timestampId) => {\n  const makeResult = (headerIndex, pathAndPart, localPath) => ({\n    path: [headerIndex, ...localPath].concat(pathAndPart.path),\n    timestampPart: pathAndPart.timestampPart,\n  });\n\n  return headers\n    .map((header, headerIndex) => {\n      let localPath = ['titleLine', 'title'];\n      let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.getIn(localPath),\n        timestampId\n      );\n      if (pathAndPart) return makeResult(headerIndex, pathAndPart, localPath);\n\n      localPath = ['description'];\n      pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.getIn(localPath),\n        timestampId\n      );\n      if (pathAndPart) return makeResult(headerIndex, pathAndPart, localPath);\n\n      localPath = ['logNotes'];\n      pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.getIn(localPath),\n        timestampId\n      );\n      if (pathAndPart) return makeResult(headerIndex, pathAndPart, localPath);\n\n      pathAndPart = header\n        .get('propertyListItems')\n        .map((propertyListItem, propertyListItemIndex) => {\n          if (!propertyListItem.get('value')) {\n            return null;\n          }\n\n          const plistPathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n            propertyListItem.get('value'),\n            timestampId\n          );\n          localPath = ['propertyListItems', propertyListItemIndex, 'value'];\n          if (plistPathAndPart) return makeResult(headerIndex, plistPathAndPart, localPath);\n\n          return null;\n        })\n        .filter((result) => result)\n        .first();\n      if (pathAndPart) {\n        return pathAndPart;\n      }\n\n      return null;\n    })\n    .filter((result) => result)\n    .first();\n};\n\nexport const pathAndPartOfListItemWithIdInHeaders = (headers, listItemId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfListItemWithIdInAttributedString(\n        header.get('description'),\n        listItemId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, listItemPart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        listItemPart,\n      };\n    })\n    .filter((result) => result)\n    .first();\n\nexport const pathAndPartOfTableContainingCellIdInHeaders = (headers, cellId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfTableContainingCellIdInAttributedString(\n        header.get('description'),\n        cellId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, tablePart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        tablePart,\n      };\n    })\n    .filter((result) => result)\n    .first();\n\nexport const updateTableContainingCellId = (headers, cellId, updaterCallbackGenerator) => {\n  const { path, tablePart } = pathAndPartOfTableContainingCellIdInHeaders(headers, cellId);\n\n  const rowIndexContainingCellId = tablePart\n    .get('contents')\n    .findIndex((row) => row.get('contents').some((cell) => cell.get('id') === cellId));\n  const columnIndexContainingCellId = tablePart\n    .getIn(['contents', rowIndexContainingCellId, 'contents'])\n    .findIndex((cell) => cell.get('id') === cellId);\n\n  return headers.updateIn(\n    path.concat(['contents']),\n    updaterCallbackGenerator(rowIndexContainingCellId, columnIndexContainingCellId)\n  );\n};\n\nexport const newEmptyTableRowLikeRows = (rows) =>\n  rows\n    .get(0)\n    .set('id', generateId())\n    .update('contents', (contents) =>\n      contents.map((cell) =>\n        cell.set('id', generateId()).set('contents', List()).set('rawContents', '')\n      )\n    );\n\nexport const newEmptyTableCell = () =>\n  fromJS({\n    id: generateId(),\n    contents: [],\n    rawContents: '',\n  });\n\nexport const newListPart = () =>\n  fromJS({\n    type: 'list',\n    id: generateId(),\n    items: [],\n    bulletCharacter: '-',\n    numberTerminatorCharacter: null,\n    isOrdered: false,\n  });\n\nexport const newListPartLikePart = (part) => part.set('id', generateId()).set('items', new List());\n\nexport const newListItem = () =>\n  fromJS({\n    id: generateId(),\n    titleLine: [],\n    contents: [],\n    forceNumber: null,\n    isCheckbox: false,\n  });\n\nexport const parentListItemWithIdInHeaders = (headers, listItemId) => {\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(headers, listItemId);\n  let { path } = pathAndPart;\n  return headers.getIn(path.slice(0, path.length - 4));\n};\n\nexport const updateListContainingListItemId = (headers, listItemId, updaterCallbackGenerator) => {\n  const { path, listPart } = pathAndPartOfListContainingItemIdInHeaders(headers, listItemId);\n\n  const itemIndexContainingId = listPart\n    .get('items')\n    .findIndex((item) => item.get('id') === listItemId);\n\n  return headers.updateIn(path.concat(['items']), updaterCallbackGenerator(itemIndexContainingId));\n};\n\nexport const updateContentsWithListItemAddition = (parts, listItem, listPart = null) => {\n  if (parts.size === 0 || parts.last().get('type') !== 'list') {\n    const insertIdx = parts.size;\n    if (!!listPart) {\n      parts = parts.insert(insertIdx, newListPartLikePart(listPart));\n    } else {\n      parts = parts.insert(insertIdx, newListPart());\n    }\n  }\n\n  return parts.map((part) => {\n    switch (part.get('type')) {\n      case 'list':\n        return part.update('items', (items) => items.push(listItem));\n      default:\n        return part;\n    }\n  });\n};\n\nexport const timestampWithIdInAttributedString = (parts, timestampId) => {\n  if (!parts) {\n    return null;\n  }\n\n  const pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(parts, timestampId);\n  if (pathAndPart) {\n    return pathAndPart.timestampPart;\n  } else {\n    return null;\n  }\n};\n\nexport const timestampWithId = (headers, timestampId) =>\n  headers\n    .map(\n      (header) =>\n        timestampWithIdInAttributedString(header.getIn(['titleLine', 'title']), timestampId) ||\n        timestampWithIdInAttributedString(header.get('description'), timestampId) ||\n        timestampWithIdInAttributedString(header.get('logNotes'), timestampId) ||\n        header\n          .get('propertyListItems')\n          .map((propertyListItem) =>\n            timestampWithIdInAttributedString(propertyListItem.get('value'), timestampId)\n          )\n          .filter((result) => result)\n          .first()\n    )\n    .find((result) => result);\n\nexport const customFormatDistanceToNow = (datetime) => {\n  return formatDistanceToNow(datetime, { addSuffix: true });\n};\n\nexport const todoKeywordSetForKeyword = (todoKeywordSets, keyword) =>\n  todoKeywordSets.find((keywordSet) => keywordSet.get('keywords').contains(keyword)) ||\n  todoKeywordSets.first();\n\nexport const isTodoKeywordCompleted = (todoKeywordSets, keyword) =>\n  todoKeywordSetForKeyword(todoKeywordSets, keyword).get('completedKeywords').includes(keyword);\n\nexport const extractAllOrgTags = (headers) =>\n  headers\n    .flatMap((h) => h.getIn(['titleLine', 'tags']))\n    .toSet()\n    .sort();\n\nexport const extractAllOrgProperties = (headers) =>\n  headers\n    .map((h) => {\n      const propertyList = h.get('propertyListItems');\n      return propertyList.map((property) => {\n        const prop = property.get('property');\n        const valParts = property.get('value'); // lineParts, see parser\n        const val = attributedStringToRawText(valParts);\n        return [prop, val];\n      });\n    })\n    .filter((x) => !x.isEmpty())\n    .flatten();\n\nexport const computeAllPropertyNames = (allOrgProperties) =>\n  allOrgProperties\n    .map(([x]) => x)\n    .toSet()\n    .sort();\n\nexport const computeAllPropertyValuesFor = (allOrgProperties, propertyName) =>\n  // toLowerCase() because property names (keys) are case-insensitive:\n  // https://orgmode.org/manual/Property-Syntax.html\n  allOrgProperties\n    .filter(([x]) => x.toLowerCase() === propertyName.toLowerCase())\n    .map(([_, y]) => y)\n    .toSet()\n    .sort();\n\n/**\n * Returns `true` if the header has content, i.e. description.\n * Subheaders do not count as content.\n */\nexport const hasHeaderContent = (header) =>\n  header.get('rawDescription') ||\n  !header.get('planningItems').isEmpty() ||\n  !header.get('propertyListItems').isEmpty() ||\n  !header.get('logNotes').isEmpty() ||\n  !header.get('logBookEntries').isEmpty();\n\n/**\n * Returns a function which takes a `todoKeyword` which then returns\n * if said `todoKeyword` is in any `todoKeywordSets` states.\n * @param {Object} todoKeywordSets\n */\nexport const createIsTodoKeywordInDoneState = (todoKeywordSets) => {\n  return (todoKeyword) =>\n    todoKeywordSets.some((x) => x.get('completedKeywords').includes(todoKeyword));\n};\n\n// Regular planning items in org are written directly below headline and have type SCHEDULED, DEADLINE, CLOSED.\nexport const isRegularPlanningItem = (x) => !x.get('type').startsWith('TIMESTAMP_');\n\nexport const getPlanningItemTypeText = (planningItem) =>\n  isRegularPlanningItem(planningItem) ? planningItem.get('type') : 'TIMESTAMP';\n\nexport const getTodoKeywordSetsAsFlattenedArray = (state) => {\n  return state\n    .get('todoKeywordSets')\n    .flatMap((todoKeywordSet) => {\n      return todoKeywordSet.get('keywords');\n    })\n    .toSet()\n    .toJS();\n};\n\n/** Regular expression of file extensions to validate a filename. */\nexport const orgFileExtensions = /\\.org(_archive)?$/;\n\nconst addBreadcrumbs = (headers, breadcrumbs, headerId) => {\n  const parent = directParentOfHeaderWithId(headers, headerId);\n  if (!parent) {\n    return breadcrumbs;\n  }\n  breadcrumbs.unshift(parent.get('titleLine').get('rawTitle'));\n  return addBreadcrumbs(headers, breadcrumbs, parent.get('id'));\n};\n\nconst getBreadcrumbs = (headers, headerId) => {\n  return addBreadcrumbs(headers, [], headerId);\n};\n\nexport const getBreadcrumbsStringFunction = (allHeaders, path) => {\n  const allHeadersOfFile = allHeaders.get(path);\n\n  let filename;\n  if (path.startsWith(STATIC_FILE_PREFIX)) {\n    filename = path.substring(STATIC_FILE_PREFIX.length);\n  } else if (path.endsWith('.org')) {\n    filename = path.substring(path.lastIndexOf('/') + 1, path.lastIndexOf('.'));\n  } else {\n    filename = path.substring(path.lastIndexOf('/') + 1);\n  }\n\n  return (header) => {\n    let breadcrumbs = getBreadcrumbs(allHeadersOfFile, header.get('id'));\n    breadcrumbs.unshift(filename);\n    const maxBreadcrumbLength = Math.max(\n      3,\n      Math.floor((80 - 3 * breadcrumbs.length) / breadcrumbs.length)\n    );\n    breadcrumbs = breadcrumbs.map((b) =>\n      b.length > maxBreadcrumbLength ? b.substr(0, maxBreadcrumbLength - 2) + '..' : b\n    );\n    return breadcrumbs.join(' > ');\n  };\n};\n","import { parseFile, resetFileDisplay, setPath } from './org';\nimport { STATIC_FILE_PREFIX } from '../lib/org_utils';\n\nimport raw from 'raw.macro';\n\nexport const setLoadingMessage = (loadingMessage) => ({\n  type: 'SET_LOADING_MESSAGE',\n  loadingMessage,\n});\n\nexport const hideLoadingMessage = () => ({\n  type: 'HIDE_LOADING_MESSAGE',\n});\n\nexport const setIsLoading = (isLoading, path) => ({\n  type: 'SET_IS_LOADING',\n  isLoading,\n  path,\n});\n\nexport const setIsOnline = (online) => ({\n  type: 'SET_IS_ONLINE',\n  online,\n});\n\nexport const setDisappearingLoadingMessage = (loadingMessage, delay) => (dispatch) => {\n  dispatch(setLoadingMessage(loadingMessage));\n  setTimeout(() => dispatch(hideLoadingMessage()), delay);\n};\n\nexport const setLastViewedFile = (lastViewedPath) => ({\n  type: 'SET_LAST_VIEWED_FILE',\n  lastViewedPath,\n});\n\nexport const restoreStaticFile = (staticFile, lastViewedFilePath) => {\n  return (dispatch) => {\n    dispatch(setLastViewedFile(lastViewedFilePath));\n\n    const fileContents = {\n      changelog: raw('../../changelog.org'),\n      sample: raw('../../sample.org'),\n    }[staticFile];\n\n    dispatch(parseFile(STATIC_FILE_PREFIX + staticFile, fileContents));\n  };\n};\n\nexport const unloadStaticFile = () => {\n  return (dispatch, getState) => {\n    dispatch(resetFileDisplay());\n\n    const path = getState().base.get('lastViewedPath');\n    if (!!path) {\n      dispatch(setPath(path));\n    }\n  };\n};\n\nexport const setFontSize = (newFontSize) => ({\n  type: 'SET_FONT_SIZE',\n  newFontSize,\n});\n\nexport const setBulletStyle = (newBulletStyle) => ({\n  type: 'SET_BULLET_STYLE',\n  newBulletStyle,\n});\n\nexport const setShouldTapTodoToAdvance = (newShouldTapTodoToAdvance) => ({\n  type: 'SET_SHOULD_TAP_TODO_TO_ADVANCE',\n  newShouldTapTodoToAdvance,\n});\n\nexport const setAgendaDefaultDeadlineDelayUnit = (newAgendaDefaultDeadlineDelayUnit) => ({\n  type: 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT',\n  newAgendaDefaultDeadlineDelayUnit,\n});\n\nexport const setAgendaDefaultDeadlineDelayValue = (newAgendaDefaultDeadlineDelayValue) => ({\n  type: 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE',\n  newAgendaDefaultDeadlineDelayValue,\n});\n\nexport const setEditorDescriptionHeightValue = (newEditorDescriptionHeightValue) => ({\n  type: 'SET_EDITOR_DESCRIPTION_HEIGHT_VALUE',\n  newEditorDescriptionHeightValue,\n});\n\nexport const setAgendaStartOnWeekday = (newAgendaStartOnWeekday) => ({\n  type: 'SET_AGENDA_START_ON_WEEKDAY',\n  newAgendaStartOnWeekday,\n});\n\nexport const setShouldLiveSync = (shouldLiveSync) => ({\n  type: 'SET_SHOULD_LIVE_SYNC',\n  shouldLiveSync,\n});\n\nexport const setShowDeadlineDisplay = (showDeadlineDisplay) => ({\n  type: 'SET_SHOW_DEADLINE_DISPLAY',\n  showDeadlineDisplay,\n});\n\nexport const setShouldSyncOnBecomingVisibile = (shouldSyncOnBecomingVisibile) => ({\n  type: 'SET_SHOULD_SYNC_ON_BECOMING_VISIBLE',\n  shouldSyncOnBecomingVisibile,\n});\n\nexport const setShouldShowTitleInOrgFile = (shouldShowTitleInOrgFile) => ({\n  type: 'SET_SHOULD_SHOW_TITLE_IN_ORG_FILE',\n  shouldShowTitleInOrgFile,\n});\n\nexport const setShouldLogIntoDrawer = (shouldLogIntoDrawer) => ({\n  type: 'SET_SHOULD_LOG_INTO_DRAWER',\n  shouldLogIntoDrawer,\n});\n\nexport const setCloseSubheadersRecursively = (closeSubheadersRecursively) => ({\n  type: 'SET_CLOSE_SUBHEADERS_RECURSIVELY',\n  closeSubheadersRecursively,\n});\n\nexport const setShouldNotIndentOnExport = (shouldNotIndentOnExport) => ({\n  type: 'SET_SHOULD_NOT_INDENT_ON_EXPORT',\n  shouldNotIndentOnExport,\n});\n\nexport const setShouldStoreSettingsInSyncBackend = (newShouldStoreSettingsInSyncBackend) => {\n  return (dispatch, getState) => {\n    dispatch({\n      type: 'SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND',\n      newShouldStoreSettingsInSyncBackend,\n    });\n\n    if (!newShouldStoreSettingsInSyncBackend) {\n      const client = getState().syncBackend.get('client');\n      switch (client.type) {\n        case 'Dropbox':\n        case 'GitLab':\n        case 'WebDAV':\n          client\n            .deleteFile('/.organice-config.json')\n            .catch((doesFileNotExist, error) =>\n              doesFileNotExist\n                ? null\n                : alert(\n                    `There was an error trying to delete the .organice-config.json file: ${error}`\n                  )\n            );\n          break;\n        default:\n      }\n\n      window.previousSettingsFileContents = null;\n    }\n  };\n};\n\nexport const setColorScheme = (colorScheme) => ({\n  type: 'SET_COLOR_SCHEME',\n  colorScheme,\n});\n\nexport const setTheme = (theme) => ({\n  type: 'SET_THEME',\n  theme,\n});\n\nexport const setHasUnseenChangelog = (newHasUnseenChangelog) => ({\n  type: 'SET_HAS_UNSEEN_CHANGELOG',\n  newHasUnseenChangelog,\n});\n\nexport const setLastSeenChangelogHeader = (newLastSeenChangelogHash) => ({\n  type: 'SET_LAST_SEEN_CHANGELOG_HEADER',\n  newLastSeenChangelogHash,\n});\n\nexport const setCustomKeybinding = (keybindingName, keybinding) => ({\n  type: 'SET_CUSTOM_KEYBINDING',\n  keybindingName,\n  keybinding,\n});\n\nexport const restoreBaseSettings = (newSettings) => ({\n  type: 'RESTORE_BASE_SETTINGS',\n  newSettings,\n});\n\nexport const pushModalPage = (modalPage) => ({\n  type: 'PUSH_MODAL_PAGE',\n  modalPage,\n});\n\nexport const popModalPage = () => ({\n  type: 'POP_MODAL_PAGE',\n});\n\nexport const clearModalStack = () => ({\n  type: 'CLEAR_MODAL_STACK',\n});\n\nexport const activatePopup = (popupType, data) => ({\n  type: 'ACTIVATE_POPUP',\n  popupType,\n  data,\n});\n\nexport const closePopup = () => ({\n  type: 'CLOSE_POPUP',\n});\n\nexport const setAgendaTimeframe = (agendaTimeframe) => (dispatch) =>\n  dispatch({\n    type: 'SET_AGENDA_TIMEFRAME',\n    agendaTimeframe,\n  });\n\nexport const setFinderTab = (finderTab) => (dispatch) =>\n  dispatch({\n    type: 'SET_FINDER_TAB',\n    finderTab,\n  });\n\nexport const setPreferEditRawValues = (preferEditRawValues) => (dispatch) =>\n  dispatch({\n    type: 'PREFER_EDIT_RAW_VALUES',\n    preferEditRawValues,\n  });\n","import generateId from './id_generator';\n\nimport { fromJS } from 'immutable';\n\nexport default fromJS([\n  {\n    description: 'Groceries',\n    headerPaths: ['Capture', 'Groceries'],\n    iconName: 'lemon',\n    id: generateId(),\n    isAvailableInAllOrgFiles: false,\n    letter: '',\n    orgFilesWhereAvailable: [],\n    shouldPrepend: false,\n    template: '* TODO %?',\n    isSample: true,\n  },\n  {\n    description: 'Deeply nested header',\n    headerPaths: ['Capture', 'Deeply', 'Nested', 'Headers', 'Work', 'Too!'],\n    iconName: 'fighter-jet',\n    id: generateId(),\n    isAvailableInAllOrgFiles: false,\n    letter: '',\n    orgFilesWhereAvailable: [],\n    shouldPrepend: true,\n    template: '* You can insert timestamps too! %T %?',\n    isSample: true,\n  },\n]);\n","export const addNewEmptyCaptureTemplate = () => ({\n  type: 'ADD_NEW_EMPTY_CAPTURE_TEMPLATE',\n});\n\nexport const updateTemplateFieldPathValue = (templateId, fieldPath, newValue) => ({\n  type: 'UPDATE_TEMPLATE_FIELD_PATH_VALUE',\n  templateId,\n  fieldPath,\n  newValue,\n});\n\nexport const addNewTemplateOrgFileAvailability = (templateId) => ({\n  type: 'ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY',\n  templateId,\n});\n\nexport const removeTemplateOrgFileAvailability = (templateId, orgFileAvailabilityIndex) => ({\n  type: 'REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY',\n  templateId,\n  orgFileAvailabilityIndex,\n});\n\nexport const addNewTemplateHeaderPath = (templateId) => ({\n  type: 'ADD_NEW_TEMPLATE_HEADER_PATH',\n  templateId,\n});\n\nexport const removeTemplateHeaderPath = (templateId, headerPathIndex) => ({\n  type: 'REMOVE_TEMPLATE_HEADER_PATH',\n  templateId,\n  headerPathIndex,\n});\n\nexport const deleteTemplate = (templateId) => ({\n  type: 'DELETE_TEMPLATE',\n  templateId,\n});\n\nexport const restoreCaptureSettings = (newSettings) => ({\n  type: 'RESTORE_CAPTURE_SETTINGS',\n  newSettings,\n});\n\nexport const reorderCaptureTemplate = (fromIndex, toIndex) => ({\n  type: 'REORDER_CAPTURE_TEMPLATE',\n  fromIndex,\n  toIndex,\n});\n","import { Map, List, Set, fromJS } from 'immutable';\nimport _ from 'lodash';\n\nimport { getOpenHeaderPaths } from '../lib/org_utils';\n\nimport { restoreBaseSettings } from '../actions/base';\nimport { restoreCaptureSettings } from '../actions/capture';\nimport { restoreFileSettings } from '../actions/org';\n\nimport generateId from '../lib/id_generator';\nimport { loadFilesFromLocalStorage } from './file_persister';\n\nexport const localStorageAvailable = (() => {\n  try {\n    localStorage.setItem('test', 'test');\n    const localStorageRes = localStorage.getItem('test') === 'test';\n    localStorage.removeItem('test');\n    return localStorageRes && localStorage;\n  } catch (e) {\n    return false;\n  }\n})();\n\n/**\n * GitLab doesn't allow updating a file that doesn't exist or creating one that already exists, so\n * need to figure out which to do.\n */\nconst updateConfigForGitLab = async (client, contents) => {\n  const filename = '/.organice-config.json';\n  let exists = false;\n  try {\n    const existingContents = await client.getFileContents(filename);\n    exists = true;\n    // INFO: Not calling syncBackendClient.createFile is a\n    // workaround for\n    // https://github.com/200ok-ch/organice/issues/736\n    if (existingContents === contents) {\n      return;\n    }\n  } catch {\n    // Error is (presumably) because file doesn't exist. Unfortunately this isn't perfect because it\n    // could have failed due to e.g. a network issue.\n  }\n  if (exists) {\n    await client.updateFile(filename, contents);\n  } else {\n    await client.createFile(filename, contents);\n  }\n};\n\nconst debouncedPushConfigToSyncBackend = _.debounce(\n  (syncBackendClient, contents) => {\n    switch (syncBackendClient.type) {\n      case 'Dropbox':\n      case 'WebDAV':\n        syncBackendClient\n          .createFile('/.organice-config.json', contents)\n          .catch((error) =>\n            alert(`There was an error trying to push settings to your sync backend: ${error}`)\n          );\n        break;\n      case 'GitLab':\n        updateConfigForGitLab(syncBackendClient, contents).catch((error) =>\n          alert(`There was an error trying to push settings to your sync backend: ${error}`)\n        );\n        break;\n      default:\n    }\n  },\n  1000,\n  { maxWait: 3000 }\n);\n\nexport const persistableFields = [\n  {\n    category: 'base',\n    name: 'fontSize',\n    type: 'nullable',\n  },\n  {\n    category: 'base',\n    name: 'bulletStyle',\n    type: 'nullable',\n    default: 'Fancy',\n  },\n  {\n    category: 'base',\n    name: 'shouldTapTodoToAdvance',\n    type: 'boolean',\n  },\n\n  {\n    category: 'base',\n    name: 'agendaDefaultDeadlineDelayUnit',\n    type: 'nullable',\n  },\n  {\n    category: 'base',\n    name: 'agendaDefaultDeadlineDelayValue',\n    type: 'nullable',\n  },\n  {\n    category: 'base',\n    name: 'editorDescriptionHeightValue',\n    type: 'nullable',\n    default: '8',\n  },\n  {\n    category: 'base',\n    name: 'agendaStartOnWeekday',\n    type: 'nullable',\n    default: 1,\n  },\n\n  {\n    category: 'base',\n    name: 'shouldStoreSettingsInSyncBackend',\n    type: 'boolean',\n    default: true,\n  },\n  {\n    category: 'base',\n    name: 'lastSeenChangelogHash',\n    type: 'nullable',\n  },\n  {\n    category: 'base',\n    name: 'customKeybindings',\n    type: 'json',\n  },\n  {\n    category: 'base',\n    name: 'shouldLiveSync',\n    type: 'boolean',\n    default: true,\n  },\n  {\n    category: 'base',\n    name: 'showDeadlineDisplay',\n    type: 'boolean',\n    default: false,\n  },\n  {\n    category: 'base',\n    name: 'shouldSyncOnBecomingVisibile',\n    type: 'boolean',\n    default: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldShowTitleInOrgFile',\n    type: 'boolean',\n  },\n  {\n    category: 'base',\n    name: 'shouldLogIntoDrawer',\n    type: 'boolean',\n  },\n  {\n    category: 'base',\n    name: 'closeSubheadersRecursively',\n    type: 'boolean',\n  },\n  {\n    category: 'base',\n    name: 'shouldNotIndentOnExport',\n    type: 'boolean',\n  },\n  {\n    category: 'org',\n    name: 'showClockDisplay',\n    type: 'boolean',\n  },\n  {\n    category: 'base',\n    name: 'colorScheme',\n    type: 'string',\n    default: 'OS',\n  },\n  {\n    category: 'base',\n    name: 'theme',\n    type: 'string',\n    default: 'Solarized',\n  },\n  {\n    category: 'capture',\n    name: 'captureTemplates',\n    type: 'json',\n    default: List(),\n  },\n  {\n    category: 'org',\n    name: 'fileSettings',\n    type: 'json',\n    default: List(),\n  },\n  {\n    category: 'base',\n    name: 'agendaTimeframe',\n    type: 'string',\n    default: 'Week',\n  },\n  {\n    category: 'base',\n    name: 'preferEditRawValues',\n    type: 'boolean',\n  },\n  {\n    category: 'org',\n    name: 'bookmarks',\n    type: 'json',\n    default: Map({\n      search: List(),\n      'task-list': List(),\n      refile: List(),\n    }),\n  },\n];\n\nexport const readOpennessState = () => {\n  const opennessStateJSONString = localStorage.getItem('headerOpenness');\n  return !!opennessStateJSONString ? JSON.parse(opennessStateJSONString) : null;\n};\n\nconst getFieldsToPersist = (state, fields) => {\n  return fields\n    .filter((field) => !field.depreacted)\n    .filter((field) => field.category === 'org')\n    .map((field) =>\n      field.type === 'json'\n        ? [field.name, JSON.stringify(state.org.present.get(field.name) || field.default || {})]\n        : [field.name, state.org.present.get(field.name)]\n    )\n    .concat(\n      persistableFields\n        .filter((field) => field.category !== 'org')\n        .map((field) => {\n          return field.type === 'json'\n            ? [\n                field.name,\n                JSON.stringify(state[field.category].get(field.name) || field.default || {}),\n              ]\n            : [field.name, state[field.category].get(field.name) || field.default];\n        })\n    );\n};\n\nconst getConfigFileContents = (fieldsToPersist) => {\n  return JSON.stringify(_.fromPairs(fieldsToPersist), null, 2);\n};\n\nexport const applyCategorySettingsFromConfig = (state, config, category) => {\n  persistableFields\n    .filter((field) => field.category === category)\n    .forEach((field) => {\n      field.type === 'json'\n        ? (state = state.set(field.name, fromJS(JSON.parse(config[field.name]))))\n        : (state = state.set(field.name, config[field.name]));\n    });\n\n  return state;\n};\n\nexport const applyCaptureSettingsFromConfig = (state, config) => {\n  const captureTemplates = fromJS(JSON.parse(config.captureTemplates)).map((template) =>\n    template.set('id', generateId())\n  );\n\n  return state.set('captureTemplates', captureTemplates);\n};\nexport const applyFileSettingsFromConfig = (state, config) => {\n  const fileSettings = fromJS(JSON.parse(config.fileSettings)).map((setting) =>\n    setting.set('id', generateId())\n  );\n\n  return state.set('fileSettings', fileSettings);\n};\n\nconst getInitialStateWithDefaultValues = () => {\n  let initialState = {\n    syncBackend: Map(),\n    org: {\n      past: [],\n      present: Map({\n        files: Map(),\n        fileSettings: [],\n        opennessState: Map(),\n        search: Map({\n          searchFilter: '',\n          searchFilterExpr: [],\n        }),\n        bookmarks: Map({\n          search: List(),\n          'task-list': List(),\n          refile: List(),\n        }),\n      }),\n      future: [],\n    },\n    base: Map({ isLoading: Set(), finderTab: 'Search' }),\n    capture: Map(),\n  };\n\n  persistableFields.forEach((field) => {\n    const value = field.default;\n\n    if (field.category === 'org') {\n      initialState[field.category].present = initialState[field.category].present.set(\n        field.name,\n        value\n      );\n    } else {\n      initialState[field.category] = initialState[field.category].set(field.name, value);\n    }\n  });\n\n  return initialState;\n};\n\nconst loadContentFromLocalStorage = (initialState) => {\n  persistableFields.forEach((field) => {\n    let value = localStorage.getItem(field.name);\n\n    if (field.type === 'nullable') {\n      if (value === 'null') {\n        value = null;\n      }\n    } else if (field.type === 'boolean') {\n      value = value === 'true';\n    } else if (field.type === 'json') {\n      if (!value) {\n        value = field.default || Map();\n      } else {\n        value = fromJS(JSON.parse(value));\n      }\n    }\n    // When nothing has been saved to localStorage before, keep the default.\n    value = value || field.default;\n\n    if (field.category === 'org') {\n      initialState[field.category].present = initialState[field.category].present.set(\n        field.name,\n        value\n      );\n    } else {\n      initialState[field.category] = initialState[field.category].set(field.name, value);\n    }\n  });\n\n  // Assign new ids to the capture templates.\n  if (initialState.capture.get('captureTemplates')) {\n    initialState.capture = initialState.capture.update('captureTemplates', (templates) =>\n      templates.map((template) => template.set('id', generateId()))\n    );\n  }\n  // Assign new ids to the file settings.\n  if (initialState.org.present.get('fileSettings')) {\n    initialState.org.present = initialState.org.present.update('fileSettings', (settings) =>\n      settings.map((setting) => setting.set('id', generateId()))\n    );\n  }\n\n  const opennessState = readOpennessState();\n  if (!!opennessState) {\n    initialState.org.present = initialState.org.present.set('opennessState', fromJS(opennessState));\n  }\n\n  // Cache the config file contents locally so we don't overwrite on\n  // initial page load.\n  window.previousSettingsFileContents = getConfigFileContents(\n    getFieldsToPersist(initialState, persistableFields)\n  );\n\n  return loadFilesFromLocalStorage(initialState);\n};\n\nexport const readInitialState = () => {\n  let initialState = getInitialStateWithDefaultValues();\n\n  return localStorageAvailable ? loadContentFromLocalStorage(initialState) : initialState;\n};\n\nexport const loadSettingsFromConfigFile = (dispatch, getState) => {\n  const syncBackendClient = getState().syncBackend.get('client');\n  if (!syncBackendClient) {\n    return;\n  }\n\n  let fileContentsPromise = null;\n  switch (syncBackendClient.type) {\n    case 'Dropbox':\n    case 'GitLab':\n    case 'WebDAV':\n      fileContentsPromise = syncBackendClient.getFileContents('/.organice-config.json');\n      break;\n    default:\n  }\n\n  fileContentsPromise\n    .then((configFileContents) => {\n      try {\n        let config;\n\n        /* Rationale for the type check:\n          When loading the settings file, `configFileContents` is\n          sometimes already an object. Therefore, when JSON.parse is\n          run, it throws an error which is silently swallowed by the\n          catch below. This appears to be the cause of\n          https:github.com/200ok-ch/organice/issues/472. Settings will\n          never load from file and default config always loads.\n          */\n        if (typeof configFileContents === 'string') {\n          config = JSON.parse(configFileContents);\n        } else {\n          config = configFileContents;\n        }\n\n        dispatch(restoreBaseSettings(config));\n        dispatch(restoreCaptureSettings(config));\n        dispatch(restoreFileSettings(config));\n      } catch (_error) {\n        // Something went wrong parsing the config file, but we don't care, we'll just\n        // overwrite it with a good local copy.\n      }\n    })\n    .catch(() => {});\n};\n\nexport const subscribeToChanges = (store) => {\n  if (!localStorageAvailable) {\n    return () => {};\n  } else {\n    return () => {\n      const state = store.getState();\n\n      const fieldsToPersist = getFieldsToPersist(state, persistableFields);\n\n      fieldsToPersist.forEach(([name, value]) => {\n        if (name && value) localStorage.setItem(name, value);\n      });\n\n      if (state.base.get('shouldStoreSettingsInSyncBackend')) {\n        const settingsFileContents = getConfigFileContents(fieldsToPersist);\n\n        if (window.previousSettingsFileContents !== settingsFileContents) {\n          debouncedPushConfigToSyncBackend(state.syncBackend.get('client'), settingsFileContents);\n        }\n\n        window.previousSettingsFileContents = settingsFileContents;\n      }\n\n      const currentFilePath = state.org.present.get('path');\n      const headers = state.org.present.getIn(['files', currentFilePath, 'headers']);\n      if (!!currentFilePath && headers) {\n        const openHeaderPaths = getOpenHeaderPaths(headers);\n\n        let opennessState = {};\n        const opennessStateJSONString = localStorage.getItem('headerOpenness');\n        if (opennessStateJSONString) {\n          opennessState = JSON.parse(opennessStateJSONString);\n        }\n\n        opennessState[currentFilePath] = openHeaderPaths;\n        localStorage.setItem('headerOpenness', JSON.stringify(opennessState));\n      }\n    };\n  }\n};\n\nexport const persistField = (field, value) => {\n  if (!localStorageAvailable) {\n    return;\n  } else {\n    localStorage.setItem(field, value);\n  }\n};\n\nexport const getPersistedField = (field, nullable = false) => {\n  if (!localStorageAvailable) {\n    return null;\n  } else {\n    const value = localStorage.getItem(field);\n    if (nullable) {\n      return value === 'null' ? null : value;\n    } else {\n      return value;\n    }\n  }\n};\n","// Matcher\n\nimport { fromJS } from 'immutable';\nimport {\n  startOfHour,\n  startOfDay,\n  startOfWeek,\n  startOfMonth,\n  startOfYear,\n  endOfHour,\n  endOfDay,\n  endOfWeek,\n  endOfMonth,\n  endOfYear,\n} from 'date-fns';\nimport { attributedStringToRawText } from './export_org.js';\nimport { computeAllPropertyNames, computeAllPropertyValuesFor } from './org_utils';\nimport {\n  addTimestampUnitToDate,\n  subtractTimestampUnitFromDate,\n  dateForTimestamp,\n} from './timestamps';\n\nconst startOfDate = (from) => {\n  const temp = new Date();\n  temp.setFullYear(from.year);\n  if (from.month === null) {\n    return startOfYear(temp);\n  } else if (from.day === null) {\n    temp.setMonth(from.month - 1);\n    return startOfMonth(temp);\n  } else {\n    temp.setMonth(from.month - 1);\n    temp.setDate(from.day);\n    return startOfDay(temp);\n  }\n};\n\nconst endOfDate = (to) => {\n  const temp = new Date();\n  temp.setFullYear(to.year);\n  if (to.month === null) {\n    return endOfYear(temp);\n  } else if (to.day === null) {\n    temp.setMonth(to.month - 1);\n    return endOfMonth(temp);\n  } else {\n    temp.setMonth(to.month - 1);\n    temp.setDate(to.day);\n    return endOfDay(temp);\n  }\n};\n\nconst fromSpecial = (from) => {\n  const temp = new Date();\n  if (from.value === 'now') {\n    return temp;\n  } else if (from.value === 'today') {\n    return startOfDay(temp);\n  }\n};\n\nconst toSpecial = (to) => {\n  const temp = new Date();\n  if (to.value === 'now') {\n    return temp;\n  } else if (to.value === 'today') {\n    return endOfDay(temp);\n  }\n};\n\nconst fromUnit = (date, unit) => {\n  const d = new Date(date);\n  switch (unit) {\n    case 'h':\n      return startOfHour(d);\n    case 'd':\n      return startOfDay(d);\n    case 'w':\n      return startOfWeek(d);\n    case 'm':\n      return startOfMonth(d);\n    case 'y':\n      return startOfYear(d);\n    default:\n      throw Error('unknown `unit` for timerange search');\n  }\n};\n\nconst toUnit = (date, unit) => {\n  const d = new Date(date);\n  switch (unit) {\n    case 'h':\n      return endOfHour(d);\n    case 'd':\n      return endOfDay(d);\n    case 'w':\n      return endOfWeek(d);\n    case 'm':\n      return endOfMonth(d);\n    case 'y':\n      return endOfYear(d);\n    default:\n      throw Error('unknown `unit` for timerange search');\n  }\n};\n\nconst resolveFrom = (from) => {\n  if (from === null) {\n    return new Date();\n  } else if (from.type === 'timestamp') {\n    return startOfDate(from);\n  } else if (from.type === 'special') {\n    return fromSpecial(from);\n  } else if (from.type === 'offset') {\n    return subtractTimestampUnitFromDate(new Date(), from.value, from.unit);\n  } else if (from.type === 'unit') {\n    return fromUnit(new Date(), from.unit);\n  }\n};\n\nconst resolveTo = (to) => {\n  if (to === null) {\n    return new Date();\n  } else if (to.type === 'timestamp') {\n    return endOfDate(to);\n  } else if (to.type === 'special') {\n    return toSpecial(to);\n  } else if (to.type === 'offset') {\n    return addTimestampUnitToDate(new Date(), to.value, to.unit);\n  } else if (to.type === 'unit') {\n    return toUnit(new Date(), to.unit);\n  }\n};\n\nconst isRelative = (moment) => {\n  return moment.type === 'offset' || moment.type === 'unit';\n};\n\nexport const timeFilter = (filterDescription) => {\n  const timeFilterDescription = filterDescription.field.timerange;\n  let lower;\n  let upper;\n  if (timeFilterDescription.type === 'point') {\n    const point = timeFilterDescription.point;\n    if (point.type === 'offset') {\n      lower = new Date();\n      upper = addTimestampUnitToDate(new Date(lower));\n    } else {\n      lower = resolveFrom(point);\n      upper = resolveTo(point);\n    }\n    return (timestamp) =>\n      lower <= dateForTimestamp(timestamp) && dateForTimestamp(timestamp) <= upper;\n  } else if (timeFilterDescription.type === 'range') {\n    const from = timeFilterDescription.from\n      ? timeFilterDescription.from\n      : { type: 'special', value: 'now' };\n    const to = timeFilterDescription.to\n      ? timeFilterDescription.to\n      : { type: 'special', value: 'now' };\n    let lower;\n    let upper;\n    if (isRelative(from) === isRelative(to)) {\n      lower = resolveFrom(from);\n      upper = resolveTo(to);\n    } else if (from.type === 'offset') {\n      upper = resolveTo(to);\n      lower = subtractTimestampUnitFromDate(new Date(upper), from.value, from.unit);\n    } else if (to.type === 'offset') {\n      lower = resolveFrom(from);\n      upper = addTimestampUnitToDate(new Date(lower), to.value, to.unit);\n    } else if (from.type === 'unit') {\n      upper = resolveTo(to);\n      lower = fromUnit(upper, from.unit);\n    } else if (to.type === 'unit') {\n      lower = resolveFrom(from);\n      upper = toUnit(lower, to.unit);\n    } else {\n      throw Error('unable to construct timerangefilter');\n    }\n    return (timestamp) =>\n      lower <= dateForTimestamp(timestamp) && dateForTimestamp(timestamp) <= upper;\n  } else if (timeFilterDescription.type === 'all') {\n    return (_) => true;\n  } else {\n    throw Error('unable to construct timefilter');\n  }\n};\n\nconst orChain = (source) => (xs) => xs.some((x) => source.includes(x));\nconst orChainDate = (dates) => (filter) => dates.size !== 0 && dates.some((x) => filter(x));\n\nexport const isMatch = (filterExpr) => {\n  const filterFilter = (type, exclude) => (x) => x.type === type && x.exclude === exclude;\n  const words = (x) => x.words;\n  const wordsLowerCase = (x) => x.words.map((y) => y.toLowerCase());\n\n  const filterTags = filterExpr.filter(filterFilter('tag', false)).map(words);\n  const filterCS = filterExpr.filter(filterFilter('case-sensitive', false)).map(words);\n  const filterIC = filterExpr.filter(filterFilter('ignore-case', false)).map(wordsLowerCase);\n  const filterProps = filterExpr\n    .filter(filterFilter('property', false))\n    .map((x) => [x.property, x.words]);\n  const filterField = filterExpr.filter(filterFilter('field', false));\n  const filterDate = filterField.filter((f) => f.field.type === 'date').map(timeFilter);\n  //const filterClock = filterField.filter((f) => f.field.type === 'clock').map(timeFilter);\n  const filterSchedule = filterField.filter((f) => f.field.type === 'scheduled').map(timeFilter);\n  const filterDeadline = filterField.filter((f) => f.field.type === 'deadline').map(timeFilter);\n\n  const filterTagsExcl = filterExpr.filter(filterFilter('tag', true)).map(words);\n  const filterCSExcl = filterExpr.filter(filterFilter('case-sensitive', true)).map(words);\n  const filterICExcl = filterExpr.filter(filterFilter('ignore-case', true)).map(wordsLowerCase);\n  const filterPropsExcl = filterExpr\n    .filter(filterFilter('property', true))\n    .map((x) => [x.property, x.words]);\n\n  const filterDesc = filterField\n    .filter((f) => f.field.type === 'description' && f.field.text.type === 'ignore-case')\n    .map((x) => x.field.text.words.map((y) => y.toLowerCase()));\n  const filterDescCS = filterField\n    .filter((f) => f.field.type === 'description' && f.field.text.type === 'case-sensitive')\n    .map((x) => x.field.text.words);\n\n  return (header) => {\n    const headLine = header.get('titleLine');\n    const tags = headLine.get('tags');\n    const todoKeyword = headLine.get('todoKeyword');\n    const rawTitle = headLine.get('rawTitle');\n    const headlineText = todoKeyword ? `${todoKeyword} ${rawTitle}` : rawTitle;\n    const properties = header\n      .get('propertyListItems')\n      .map((p) => [p.get('property'), attributedStringToRawText(p.get('value'))]);\n    const planningItems = header\n      .get('planningItems')\n      .filter((p) => p.get('timestamp').get('isActive') === true);\n    const dates = planningItems.map((p) => p.get('timestamp'));\n    const scheduleds = planningItems\n      .filter((p) => p.get('type') === 'SCHEDULED')\n      .map((p) => p.get('timestamp'));\n    const deadlines = planningItems\n      .filter((p) => p.get('type') === 'DEADLINE')\n      .map((p) => p.get('timestamp'));\n\n    var description = '';\n    if (filterDesc.length > 0 || filterDescCS.length > 0) {\n      const stripMarkup = (text) => text.replace(/\\*([\\w]*)\\*/, (match, p1, _, __) => p1);\n      description = stripMarkup(header.get('rawDescription'));\n    }\n\n    //const clocks = header\n    //  .get('logBookEntries')\n    //  .flatMap((l) => [l.get('start'), l.get('end')])\n    //  .filter((t) => t !== undefined && t !== null);\n    const propertyFilter = ([x, ys]) =>\n      !properties\n        .filter(([key, val]) => {\n          // Property names (keys) are case-insensitive\n          // https://orgmode.org/manual/Property-Syntax.html\n          const nameMatch = key.toLowerCase() === x.toLowerCase();\n          const valueMatch = ys.some((y) => val.includes(y));\n          return nameMatch && valueMatch;\n        })\n        .isEmpty();\n\n    return (\n      filterTags.every(orChain(tags)) &&\n      filterCS.every(orChain(headlineText)) &&\n      filterIC.every(orChain(headlineText.toLowerCase())) &&\n      filterProps.every(propertyFilter) &&\n      filterDate.every(orChainDate(dates)) &&\n      //filterClock.every(orChainDate(clocks)) &&\n      filterSchedule.every(orChainDate(scheduleds)) &&\n      filterDeadline.every(orChainDate(deadlines)) &&\n      filterDesc.every(orChain(description.toLowerCase())) &&\n      filterDescCS.every(orChain(description)) &&\n      !filterTagsExcl.some(orChain(tags)) &&\n      !filterCSExcl.some(orChain(headlineText)) &&\n      !filterICExcl.some(orChain(headlineText.toLowerCase())) &&\n      !filterPropsExcl.some(propertyFilter)\n    );\n  };\n};\n\n// Suggestions / Completions\n\n// The computation of completions rely on the fact, that the filter syntax does NOT\n// support quoted strings (i.e. no search for a quoted 'master headline').\n\n// This function is complex and still not perfect. It resembles parts of the\n// filter syntax parser. If the parser would annotate all parsed symbols with\n// offsets information, computeLogicalPosition could simplify the algorithm as\n// long as the filter string is parsed successfully.\n\nexport const computeCompletions = (todoKeywords, tagNames, allProperties) => (\n  filterExpr,\n  filterString,\n  curserPosition\n) => {\n  const tagAndPropNames = [].concat(\n    tagNames,\n    computeAllPropertyNames(fromJS(allProperties))\n      .toJS()\n      .map((x) => x + ':')\n  );\n\n  const logicalCursorPosition = filterExpr\n    ? computeLogicalPosition(filterExpr, filterString, curserPosition)\n    : null;\n\n  const charBeforeCursor = filterString.charAt(curserPosition - 1);\n  const charTwoBeforeCursor = curserPosition > 1 ? filterString.charAt(curserPosition - 2) : '';\n\n  if (logicalCursorPosition === null) {\n  } else if (logicalCursorPosition === SPACE_SURROUNDED) {\n    return todoKeywords;\n  } else if (logicalCursorPosition.type === 'case-sensitive') {\n    if (charBeforeCursor.match(/[A-Z]/)) {\n      const textBeforeCursor = charBeforeCursor;\n      const filteredTodoKeywords = todoKeywords\n        .filter((x) => x.startsWith(textBeforeCursor))\n        .map((x) => x.substring(textBeforeCursor.length));\n      if ([' ', '', '|', '-'].includes(charTwoBeforeCursor)) {\n        return filteredTodoKeywords;\n      }\n    }\n  } else if (logicalCursorPosition.type === 'ignore-case') {\n    // A text filter starting with '-' turns into an exclude filter as soon as text is appended\n    if (charBeforeCursor === '-' && [' ', ''].includes(charTwoBeforeCursor)) return todoKeywords;\n    return [];\n  } else if (logicalCursorPosition.type === 'tag') {\n    // This case will likely not occur because ':' alone cannot be parsed\n    if (charBeforeCursor === ':') return tagAndPropNames;\n  } else if (logicalCursorPosition.type === 'property') {\n    if (charBeforeCursor === ':') {\n      if (charTwoBeforeCursor === ' ' || charTwoBeforeCursor === '') return tagAndPropNames;\n      else {\n        // Either property name or text filter\n        const indexOfOtherColon = filterString.substring(0, curserPosition - 1).lastIndexOf(':');\n        const maybePropertyName = filterString.substring(indexOfOtherColon + 1, curserPosition - 1);\n        const quoteStringIfPossible = (x) => {\n          if (x.match(/ /)) {\n            if (!x.match(/\"/)) return [`\"${x}\"`];\n            if (!x.match(/'/)) return [`'${x}'`];\n            const match = x.match(/^[^ ]*/);\n            return [match[0]];\n          }\n          return [x];\n        };\n        if (indexOfOtherColon >= 0 && maybePropertyName.match(/^[^ ]+$/)) {\n          // No space in property name -> is property -> return values for that property\n          return computeAllPropertyValuesFor(fromJS(allProperties), maybePropertyName)\n            .flatMap(quoteStringIfPossible)\n            .toJS();\n        }\n      }\n    }\n  }\n\n  // If ':' or '|' is before cursor, the filter string is likely not\n  // successfully parsed and therefore cannot be handled above.\n  if (charBeforeCursor === ':') {\n    if ([' ', '', '-'].includes(charTwoBeforeCursor)) {\n      return tagAndPropNames;\n    }\n  } else if (charBeforeCursor === '|') {\n    const indexOfOtherColon = filterString.substring(0, curserPosition).lastIndexOf(':');\n    const maybeTagName = filterString.substring(indexOfOtherColon + 1, curserPosition - 1);\n    if (indexOfOtherColon > -1 && !maybeTagName.match(/ /)) {\n      // No space characters between ':' and '|'  ->  '|' is in a tag filter\n      return tagNames;\n    } else {\n      return todoKeywords;\n    }\n  }\n\n  return [];\n};\n\nexport const computeCompletionsForDatalist = (todoKeywords, tagNames, allProperties) => (\n  filterExpr,\n  filterString,\n  curserPosition\n) => {\n  const completions = computeCompletions(todoKeywords, tagNames, allProperties)(\n    filterExpr,\n    filterString,\n    curserPosition\n  );\n  return completions.map(\n    (x) => filterString.substring(0, curserPosition) + x + filterString.substring(curserPosition)\n  );\n};\n\nconst SPACE_SURROUNDED = ' ';\n\n// Compute the logical curser position within the parsed filter expression.\n// Return SPACE_SURROUNDED if the curser is inbetween two expressions and\n// surrounded by spaces (begin and end of line count as space).\n// Return the the filter term if the curser is in or at the edge of an filter term.\nconst computeLogicalPosition = (filterExpr, filterString, curserPosition) => {\n  if (filterExpr.length === 0) return SPACE_SURROUNDED;\n  const tup = (x, y) => ({ value: x, elem: y });\n  const firstElem = { offset: -1, endOffset: -1 };\n  const { value } = filterExpr.reduce(\n    ({ value, elem }, next) => {\n      if (elem === null) {\n        return tup(value, null); // short-circuit if already found\n      }\n      if (curserPosition >= next.offset && curserPosition <= next.endOffset) {\n        return tup(next, null);\n      }\n      if (curserPosition > elem.endOffset && curserPosition < next.offset) {\n        return tup(SPACE_SURROUNDED, null);\n      }\n      return tup(null, next);\n    },\n    { value: null, elem: firstElem }\n  );\n  if (curserPosition > filterExpr[filterExpr.length - 1].endOffset) return SPACE_SURROUNDED;\n  return value;\n};\n","import { subheadersOfHeaderWithIndex } from './org_utils';\nimport { dateForTimestamp } from './timestamps';\n\nexport const hasActiveClock = (header) => {\n  const logBookEntries = header.get('logBookEntries', []);\n  const activeEntries = logBookEntries.filter((entry) => entry.get('start') && !entry.get('end'));\n  return activeEntries.size !== 0;\n};\n\nconst totalTimeLogged = (header) => {\n  const logBookEntries = header.get('logBookEntries', []);\n\n  const times = logBookEntries.map((entry) =>\n    entry.get('start') && entry.get('end')\n      ? dateForTimestamp(entry.get('end')) - dateForTimestamp(entry.get('start'))\n      : 0\n  );\n\n  const addedTimes = times.reduce((acc, val) => acc + val, 0);\n  return addedTimes;\n};\n\nexport const totalFilteredTimeLogged = (filters, header) => {\n  const clocks = header\n    .get('logBookEntries', [])\n    .map((l) => [l.get('start'), l.get('end')])\n    .filter(([start, end]) => start && end)\n    .filter((ts) => ts.some((t) => filters.every((f) => f(t))));\n\n  const times = clocks.map(([start, end]) => dateForTimestamp(end) - dateForTimestamp(start));\n\n  const addedTimes = times.reduce((acc, val) => acc + val, 0);\n  return addedTimes;\n};\n\nexport const updateHeadersTotalTimeLoggedRecursive = (headers) => {\n  if (!headers) {\n    return headers;\n  }\n  const headersWithtotalTimeLogged = headers.map((header) =>\n    header.set('totalTimeLogged', totalTimeLogged(header))\n  );\n  const headersWithtotalTimeLoggedRecursive = headersWithtotalTimeLogged.map((header, index) => {\n    const subheaders = subheadersOfHeaderWithIndex(headersWithtotalTimeLogged, index);\n    const totalTimeLoggedRecursive = subheaders.reduce(\n      (acc, val) => acc + val.get('totalTimeLogged'),\n      header.get('totalTimeLogged')\n    );\n    return header.set('totalTimeLoggedRecursive', totalTimeLoggedRecursive);\n  });\n  return headersWithtotalTimeLoggedRecursive;\n};\n\nexport const updateHeadersTotalFilteredTimeLoggedRecursive = (filters, headers) => {\n  if (!headers) {\n    return headers;\n  }\n  const headersWithtotalTimeLogged = headers.map((header) =>\n    header.set('totalFilteredTimeLogged', totalFilteredTimeLogged(filters, header))\n  );\n  const headersWithtotalTimeLoggedRecursive = headersWithtotalTimeLogged.map((header, index) => {\n    const subheaders = subheadersOfHeaderWithIndex(headersWithtotalTimeLogged, index);\n    const totalTimeLoggedRecursive = subheaders.reduce(\n      (acc, val) => acc + val.get('totalFilteredTimeLogged'),\n      header.get('totalFilteredTimeLogged')\n    );\n    return header.set('totalFilteredTimeLoggedRecursive', totalTimeLoggedRecursive);\n  });\n  return headersWithtotalTimeLoggedRecursive;\n};\n","import generateId from './id_generator';\nimport { hasActiveClock, updateHeadersTotalTimeLoggedRecursive } from './clocking';\n\nimport { fromJS, List } from 'immutable';\nimport _ from 'lodash';\n\n// TODO: Extract all match groups of `beginningRegexp` (for example\n// like `emailRegexp`), so that they can be documented and are less\n// unwieldly.\nconst beginningRegexp = /(\\[\\[([^\\]]*)\\]\\]|\\[\\[([^\\]]*)\\]\\[([^\\]]*)\\]\\])|(\\[((\\d*%)|(\\d*\\/\\d*))\\])|((^|\\s|[({'\"])([*/~=_+])([^\\s,'](.*?))\\11([\\s\\-.,:;!?'\")}]?))/;\n\n// Regexp taken from https://stackoverflow.com/a/3809435/999007\nconst httpUrlRegexp = /(https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\\\+.~#?&//=]*))/;\n\n// Regexp taken from https://stackoverflow.com/a/1373724/999007\nconst urlRegexp = /([a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)/;\n\nconst internationalPhoneRegexp = /((\\+|00)\\d{8,30})/;\n\n// Regexp taken from https://stackoverflow.com/a/16699507/252585\nconst usPhoneRegexp = /((\\+\\d{1,2}\\s)?\\(?\\d{3}\\)?[\\s.-]\\d{3}[\\s.-]\\d{4})/;\n\n// Works for formatted mobile phone numbers like \"078 326 86 74\"\nconst swissPhoneRegexp1 = /(0[1-9]{2}\\s[0-9]{3}\\s[0-9]{2}\\s[0-9]{2})/;\n\n// Works for unformatted mobile phone numbers like \"0783268674\" and\n// unformatted landline numbers like \"041783268675\"\nconst swissPhoneRegexp2 = /(0[0-9]{9,11})/;\n\nconst wwwUrlRegexp = /(www(\\.[-_a-zA-Z0-9]+){2,}(\\/[-_a-zA-Z0-9]+)*)/;\n\nconst timestampOptionalRepeaterOrDelayRegexp = /(?: (\\+|\\+\\+|\\.\\+|-|--)(\\d+)([hdwmy])(?:\\/(\\d+)([hdwmy]))?)?/;\nconst timestampRegex = new RegExp(\n  [\n    /([<[])/,\n    /(\\d{4})-(\\d{2})-(\\d{2})/,\n    /(?: ([^0-9\\s]{1,9}))?/,\n    /(?: ([012]?\\d:[0-5]\\d))?(?:-([012]?\\d:[0-5]\\d))?/,\n    timestampOptionalRepeaterOrDelayRegexp,\n    timestampOptionalRepeaterOrDelayRegexp,\n    /[>\\]]/,\n  ]\n    .map((re) => re.source)\n    .join('')\n);\n\nconst markupAndCookieRegex = new RegExp(\n  [\n    beginningRegexp.source,\n    `(${timestampRegex.source}(?:--${timestampRegex.source})?)`,\n    httpUrlRegexp.source,\n    urlRegexp.source,\n    internationalPhoneRegexp.source,\n    usPhoneRegexp.source,\n    swissPhoneRegexp1.source,\n    swissPhoneRegexp2.source,\n    wwwUrlRegexp.source,\n  ].join('|'),\n  'g'\n);\n\n// INFO: https://www.debuggex.com/ is a good tool to inspect how the\n// matches work.\n// console.log(markupAndCookieRegex);\n\nconst timestampFromRegexMatch = (match, partIndices) => {\n  const [\n    typeBracket,\n    year,\n    month,\n    day,\n    dayName,\n    timeStart,\n    timeEnd,\n    firstDelayRepeatType,\n    firstDelayRepeatValue,\n    firstDelayRepeatUnit,\n    firstRepeaterDeadlineValue,\n    firstRepeaterDeadlineUnit,\n    secondDelayRepeatType,\n    secondDelayRepeatValue,\n    secondDelayRepeatUnit,\n    secondRepeaterDeadlineValue,\n    secondRepeaterDeadlineUnit,\n  ] = partIndices.map((partIndex) => match[partIndex]);\n\n  if (!year) {\n    return null;\n  }\n\n  const [startHour, startMinute] = !!timeStart ? timeStart.split(':') : [];\n  const [endHour, endMinute] = !!timeEnd ? timeEnd.split(':') : [];\n\n  let repeaterType, repeaterValue, repeaterUnit, repeaterDeadlineValue, repeaterDeadlineUnit;\n  let delayType, delayValue, delayUnit;\n\n  if (['+', '++', '.+'].includes(firstDelayRepeatType)) {\n    repeaterType = firstDelayRepeatType;\n    repeaterValue = firstDelayRepeatValue;\n    repeaterUnit = firstDelayRepeatUnit;\n    repeaterDeadlineValue = firstRepeaterDeadlineValue;\n    repeaterDeadlineUnit = firstRepeaterDeadlineUnit;\n  } else if (['-', '--'].includes(firstDelayRepeatType)) {\n    delayType = firstDelayRepeatType;\n    delayValue = firstDelayRepeatValue;\n    delayUnit = firstDelayRepeatUnit;\n  }\n  if (['+', '++', '.+'].includes(secondDelayRepeatType)) {\n    repeaterType = secondDelayRepeatType;\n    repeaterValue = secondDelayRepeatValue;\n    repeaterUnit = secondDelayRepeatUnit;\n    repeaterDeadlineValue = secondRepeaterDeadlineValue;\n    repeaterDeadlineUnit = secondRepeaterDeadlineUnit;\n  } else if (['-', '--'].includes(secondDelayRepeatType)) {\n    delayType = secondDelayRepeatType;\n    delayValue = secondDelayRepeatValue;\n    delayUnit = secondDelayRepeatUnit;\n  }\n\n  return {\n    isActive: typeBracket === '<',\n    year,\n    month,\n    day,\n    dayName,\n    startHour,\n    startMinute,\n    endHour,\n    endMinute,\n    repeaterType,\n    repeaterValue,\n    repeaterUnit,\n    delayType,\n    delayValue,\n    delayUnit,\n    repeaterDeadlineValue,\n    repeaterDeadlineUnit,\n  };\n};\n\nexport const parseMarkupAndCookies = (rawText, { shouldAppendNewline = false } = {}) => {\n  const matches = [];\n  let match = markupAndCookieRegex.exec(rawText);\n  while (match) {\n    if (!!match[2]) {\n      matches.push({\n        type: 'link',\n        rawText: match[0],\n        uri: match[2],\n        index: match.index,\n      });\n    } else if (!!match[3] && !!match[4]) {\n      matches.push({\n        type: 'link',\n        rawText: match[0],\n        uri: match[3],\n        title: match[4],\n        index: match.index,\n      });\n    } else if (!!match[7]) {\n      const percentCookieMatch = match[7].match(/(\\d*)%/);\n      matches.push({\n        type: 'percentage-cookie',\n        rawText: match[0],\n        percentage: percentCookieMatch[1],\n        index: match.index,\n      });\n    } else if (!!match[8]) {\n      const fractionCookieMatch = match[8].match(/(\\d*)\\/(\\d*)/);\n      matches.push({\n        type: 'fraction-cookie',\n        rawText: match[0],\n        fraction: [fractionCookieMatch[1], fractionCookieMatch[2]],\n        index: match.index,\n      });\n    } else if (!!match[11]) {\n      const markupType = {\n        '~': 'inline-code',\n        '*': 'bold',\n        '/': 'italic',\n        '+': 'strikethrough',\n        _: 'underline',\n        '=': 'verbatim',\n      }[match[11]];\n\n      const markupPrefixLength = match[10].length;\n\n      matches.push({\n        type: 'inline-markup',\n        rawText: match[0].substring(markupPrefixLength, match[12].length + 2 + markupPrefixLength),\n        index: match.index + markupPrefixLength,\n        content: match[12],\n        markupType,\n      });\n    } else if (!!match[15]) {\n      const firstTimestamp = timestampFromRegexMatch(match, _.range(16, 33));\n      const secondTimestamp = timestampFromRegexMatch(match, _.range(33, 50));\n\n      matches.push({\n        type: 'timestamp',\n        rawText: match[0],\n        index: match.index,\n        firstTimestamp,\n        secondTimestamp,\n      });\n    } else if (!!match[50]) {\n      matches.push({\n        type: 'url',\n        rawText: match[0],\n        index: match.index,\n      });\n    } else if (!!match[53]) {\n      matches.push({\n        type: 'e-mail',\n        rawText: match[0],\n        index: match.index,\n      });\n    } else if (!!match[54] || !!match[56] || !!match[58] || !!match[59]) {\n      matches.push({\n        type: 'phone-number',\n        rawText: match[0],\n        index: match.index,\n      });\n    } else if (!!match[60]) {\n      matches.push({\n        type: 'www-url',\n        rawText: match[0],\n        index: match.index,\n      });\n    }\n    match = markupAndCookieRegex.exec(rawText);\n  }\n\n  const lineParts = [];\n  let startIndex = 0;\n  matches.forEach((match) => {\n    let index = match.index;\n\n    // Get the part before the first match:\n    if (index !== startIndex) {\n      const text = rawText.substring(startIndex, index);\n      lineParts.push({\n        type: 'text',\n        contents: text,\n      });\n    }\n\n    // Get this match:\n    const part = computeParseResults(rawText, match);\n    lineParts.push(part);\n\n    startIndex = match.index + match.rawText.length;\n  });\n\n  if (startIndex !== rawText.length || shouldAppendNewline) {\n    const trailingText =\n      rawText.substring(startIndex, rawText.length) + (shouldAppendNewline ? '\\n' : '');\n    lineParts.push({\n      type: 'text',\n      contents: trailingText,\n    });\n  }\n\n  return lineParts;\n};\n\nconst computeParseResults = (rawText, match) => {\n  switch (match.type) {\n    case 'link':\n      const linkPart = {\n        id: generateId(),\n        type: 'link',\n        contents: {\n          uri: match.uri,\n        },\n      };\n      if (match.title) {\n        linkPart.contents.title = match.title;\n      }\n      return linkPart;\n    case 'percentage-cookie':\n      return {\n        id: generateId(),\n        type: 'percentage-cookie',\n        percentage: match.percentage,\n      };\n    case 'fraction-cookie':\n      return {\n        id: generateId(),\n        type: 'fraction-cookie',\n        fraction: match.fraction,\n      };\n    case 'inline-markup':\n      return {\n        id: generateId(),\n        type: 'inline-markup',\n        content: match.content,\n        markupType: match.markupType,\n      };\n    case 'timestamp':\n      return {\n        id: generateId(),\n        type: 'timestamp',\n        firstTimestamp: match.firstTimestamp,\n        secondTimestamp: match.secondTimestamp,\n      };\n    case 'url':\n    case 'www-url':\n    case 'e-mail':\n    case 'phone-number':\n      return {\n        id: generateId(),\n        type: match.type,\n        content: match.rawText,\n      };\n    default:\n      throw Error(\n        'The regex parser parsed something but it is not converted to proper data structure.'\n      );\n  }\n};\n\nconst parseTable = (tableLines) => {\n  const table = {\n    id: generateId(),\n    type: 'table',\n    contents: [[]],\n    columnProperties: [],\n  };\n\n  tableLines\n    .map((line) => line.trim())\n    .forEach((line) => {\n      if (line.startsWith('|-')) {\n        table.contents.push([]);\n      } else {\n        const lastRow = _.last(table.contents);\n        const lineCells = line.substr(1, line.length - 2).split('|');\n\n        if (lastRow.length === 0) {\n          lineCells.forEach((cell) => lastRow.push(cell));\n        } else {\n          lineCells.forEach((cellContents, cellIndex) => {\n            lastRow[cellIndex] += `\\n${cellContents}`;\n          });\n        }\n      }\n    });\n\n  // Parse the contents of each cell.\n  table.contents = table.contents.map((row) => ({\n    id: generateId(),\n    contents: row.map((rawContents) => ({\n      id: generateId(),\n      contents: parseMarkupAndCookies(rawContents, { excludeCookies: true }),\n      rawContents,\n    })),\n  }));\n\n  // We sometimes end up with an extra, empty row - remove it if so.\n  if (_.last(table.contents).contents.length === 0) {\n    table.contents = table.contents.slice(0, table.contents.length - 1);\n  }\n\n  // Make sure each row has the same number of columns.\n  const maxNumColumns = Math.max(...table.contents.map((row) => row.contents.length));\n  table.contents.forEach((row) => {\n    if (row.contents.length < maxNumColumns) {\n      _.times(maxNumColumns - row.contents.length, () => {\n        row.contents.push({\n          id: generateId(),\n          contents: [],\n          rawContents: '',\n        });\n      });\n    }\n  });\n\n  return table;\n};\n\nexport const parseRawText = (rawText, { excludeContentElements = false } = {}) => {\n  const lines = rawText.split('\\n');\n\n  const LIST_HEADER_REGEX = /^\\s*([-+*]|(\\d+(\\.|\\)))) (.*)/;\n\n  let currentListHeaderNestingLevel = null;\n  const rawLineParts = _.flatten(\n    lines.map((line, lineIndex) => {\n      const numLeadingSpaces = line.match(/^( *)/)[0].length;\n\n      if (\n        currentListHeaderNestingLevel !== null &&\n        (numLeadingSpaces > currentListHeaderNestingLevel || !line.trim())\n      ) {\n        return [\n          {\n            type: 'raw-list-content',\n            line,\n          },\n        ];\n      } else {\n        currentListHeaderNestingLevel = null;\n\n        if (line.match(LIST_HEADER_REGEX) && !excludeContentElements) {\n          currentListHeaderNestingLevel = numLeadingSpaces;\n\n          return [\n            {\n              type: 'raw-list-header',\n              line,\n            },\n          ];\n        } else if (line.trim().startsWith('|') && !excludeContentElements) {\n          return [\n            {\n              type: 'raw-table',\n              line,\n            },\n          ];\n        } else {\n          return parseMarkupAndCookies(line, {\n            shouldAppendNewline: lineIndex !== lines.length - 1,\n            excludeCookies: true,\n          });\n        }\n      }\n    })\n  );\n\n  const processedLineParts = [];\n  for (let partIndex = 0; partIndex < rawLineParts.length; ++partIndex) {\n    const linePart = rawLineParts[partIndex];\n    if (linePart.type === 'raw-table') {\n      const tableLines = _.takeWhile(\n        rawLineParts.slice(partIndex),\n        (part) => part.type === 'raw-table'\n      ).map((part) => part.line);\n\n      processedLineParts.push(parseTable(tableLines));\n\n      partIndex += tableLines.length - 1;\n    } else if (linePart.type === 'raw-list-header') {\n      const numLeadingSpaces = linePart.line.match(/^( *)/)[0].length;\n      const contentLines = _.takeWhile(\n        rawLineParts.slice(partIndex + 1),\n        (part) => part.type === 'raw-list-content'\n      )\n        .map((part) => part.line)\n        .map((line) =>\n          line.startsWith(' '.repeat(numLeadingSpaces + 2))\n            ? line.substr(numLeadingSpaces + 2)\n            : line.substr(numLeadingSpaces + 1)\n        );\n      if (contentLines[contentLines.length - 1] === '') {\n        contentLines[contentLines.length - 1] = ' ';\n      }\n      const contents = parseRawText(contentLines.join('\\n')).toJS();\n\n      partIndex += contentLines.length;\n\n      const isOrdered = !!linePart.line.match(/^\\s*\\d+[.)]/);\n\n      // Remove the leading -, +, *, or number characters.\n      let line = linePart.line.match(LIST_HEADER_REGEX)[4];\n\n      let forceNumber = null;\n      if (line.match(/^\\s*\\[@\\d+\\]/)) {\n        forceNumber = line.match(/^\\s*\\[@(\\d+)\\]/)[1];\n        line = line.replace(/^\\s*\\[@\\d+\\]\\s*/, '');\n      }\n\n      let checkboxState = null;\n      const isCheckbox = !!line.match(/^\\s*\\[[ X-]\\]/);\n      if (isCheckbox) {\n        const stateCharacter = line.match(/^\\s*\\[([ X-])\\]/)[1];\n        checkboxState = {\n          ' ': 'unchecked',\n          X: 'checked',\n          '-': 'partial',\n        }[stateCharacter];\n\n        line = line.replace(/^\\s*\\[[ X-]\\]\\s*/, '');\n      }\n\n      const newListItem = {\n        id: generateId(),\n        titleLine: parseMarkupAndCookies(line),\n        contents,\n        forceNumber,\n        isCheckbox,\n        checkboxState,\n      };\n\n      const lastIndex = processedLineParts.length - 1;\n      if (lastIndex >= 0 && processedLineParts[lastIndex].type === 'list') {\n        processedLineParts[lastIndex].items.push(newListItem);\n      } else {\n        processedLineParts.push({\n          type: 'list',\n          id: generateId(),\n          items: [newListItem],\n          bulletCharacter: linePart.line.trim()[0],\n          numberTerminatorCharacter: isOrdered ? linePart.line.match(/\\s*\\d+([.)])/)[1] : null,\n          isOrdered,\n        });\n      }\n    } else {\n      processedLineParts.push(linePart);\n    }\n  }\n\n  return fromJS(processedLineParts);\n};\n\nexport const _parsePlanningItems = (rawText) => {\n  const optionalSinglePlanningItemRegex = RegExp(\n    `((DEADLINE|SCHEDULED|CLOSED):\\\\s*${asStrNoSlashs(timestampRegex)})?`\n  );\n\n  // If there are any planning items, consume not more\n  // than one newline after the last planning item.\n  const planningRegex = concatRegexes(\n    /^\\s*/,\n    optionalSinglePlanningItemRegex,\n    /[ \\t]*/,\n    optionalSinglePlanningItemRegex,\n    /[ \\t]*/,\n    optionalSinglePlanningItemRegex,\n    /[ \\t]*\\n?/\n  );\n  const planningRegexCaptureGroupsOfType = [2, 21, 40]; // depends on timestampRegex\n  const planningMatch = rawText.match(planningRegex);\n\n  const planningItems = fromJS(\n    planningRegexCaptureGroupsOfType\n      .map((planningTypeIndex) => {\n        const type = planningMatch[planningTypeIndex];\n        if (!type) {\n          return null;\n        }\n\n        const timestamp = timestampFromRegexMatch(\n          planningMatch,\n          _.range(planningTypeIndex + 1, planningTypeIndex + 1 + 17)\n        );\n\n        return createOrUpdateTimestamp({ type, timestamp });\n      })\n      .filter((item) => !!item)\n  );\n\n  if (planningItems.size === 0) {\n    // If there are no matches for planning items, return the original rawText.\n    return { planningItems: fromJS([]), strippedDescription: rawText };\n  } else {\n    const remainingDescriptionWithoutPlanningItem = rawText.replace(planningRegex, '');\n    return { planningItems, strippedDescription: remainingDescriptionWithoutPlanningItem };\n  }\n};\n\nconst createOrUpdateTimestamp = ({ type, timestamp, id }) =>\n  fromJS({ type, timestamp, id: id || generateId() });\n\nconst parsePropertyList = (rawText) => {\n  const lines = rawText.split('\\n');\n  const propertiesLineIndex = lines.findIndex((line) => line.trim() === ':PROPERTIES:');\n  const endLineIndex = lines.findIndex((line) => line.trim() === ':END:');\n\n  if (\n    propertiesLineIndex === -1 ||\n    endLineIndex === -1 ||\n    !rawText.trim().startsWith(':PROPERTIES:')\n  ) {\n    return {\n      propertyListItems: List(),\n      strippedDescription: rawText,\n    };\n  }\n\n  const propertyListItems = fromJS(\n    lines\n      .slice(propertiesLineIndex + 1, endLineIndex)\n      .map((line) => {\n        const match = line.match(/:([^\\s]*):(?: (.*))?/);\n        if (!match) {\n          return null;\n        }\n\n        // Parse the properties value even though most values would\n        // not need parsing. Only timestamps are interactive, the rest\n        // will be saved as plain text.\n        let value = !!match[2] ? parseMarkupAndCookies(match[2]) : null;\n\n        if (value && value[0].type !== 'timestamp') {\n          value = [{ contents: match[2], type: 'text' }];\n        }\n\n        return {\n          property: match[1],\n          value,\n          id: generateId(),\n        };\n      })\n      .filter((result) => !!result)\n  );\n\n  return {\n    propertyListItems,\n    strippedDescription: lines.slice(endLineIndex + 1).join('\\n'),\n  };\n};\n\nconst parseLogbook = (rawText) => {\n  const lines = rawText.split('\\n');\n  const logbookLineIndex = lines.findIndex((line) => line.trim() === ':LOGBOOK:');\n  const endLineIndex = lines.findIndex((line) => line.trim() === ':END:');\n\n  if (logbookLineIndex === -1 || endLineIndex === -1 || !rawText.trim().startsWith(':LOGBOOK:')) {\n    return {\n      logBookEntries: List(),\n      strippedDescription: rawText,\n    };\n  }\n\n  const logBookEntryStartRegex = concatRegexes(/^CLOCK: /, timestampRegex, /$/);\n  const logBookEntryFullRegex = concatRegexes(\n    /^CLOCK: /,\n    timestampRegex,\n    '/--/',\n    timestampRegex,\n    /\\s*=>\\s*\\S+$/\n  );\n  const logBookEntries = fromJS(\n    lines.slice(logbookLineIndex + 1, endLineIndex).map((line) => {\n      const lineFullMatch = line.trim().match(logBookEntryFullRegex);\n      if (lineFullMatch) {\n        return {\n          start: timestampFromRegexMatch(lineFullMatch, _.range(1, 18)),\n          end: timestampFromRegexMatch(lineFullMatch, _.range(18, 39)),\n          id: generateId(),\n        };\n      }\n      const lineStartMatch = line.trim().match(logBookEntryStartRegex);\n      if (lineStartMatch) {\n        return {\n          start: timestampFromRegexMatch(lineStartMatch, _.range(1, 18)),\n          end: null,\n          id: generateId(),\n        };\n      }\n      return { raw: line.trimLeft(), id: generateId() };\n    })\n  );\n\n  return {\n    logBookEntries,\n    strippedDescription: lines.slice(endLineIndex + 1).join('\\n'),\n  };\n};\n\nexport const _parseLogNotes = (rawText) => {\n  // Only parse log notes if a logbook exists. Otherwise, a list - log notes\n  // or just a normal list - will go into the description.\n  const lines = rawText.split('\\n');\n  const logbookLineIndex = lines.findIndex((line) => line.trim() === ':LOGBOOK:');\n  if (logbookLineIndex !== -1)\n    return makeLogNotesResult(lines.slice(0, logbookLineIndex), lines.slice(logbookLineIndex));\n  return makeLogNotesResult([], [rawText]);\n};\n\nexport const parseDescriptionPrefixElements = (rawText) => {\n  const planningItemsParse = _parsePlanningItems(rawText);\n\n  const planningItems = planningItemsParse.planningItems;\n  const propertyListParse = parsePropertyList(planningItemsParse.strippedDescription);\n  // In Orgmode, notes are added below properties and before\n  // logbook. However, logbook is added directly below properties if\n  // it does not exist.\n  const logNotes = _parseLogNotes(propertyListParse.strippedDescription);\n  const logBookParse = parseLogbook(logNotes.strippedDescription);\n\n  return {\n    planningItems: planningItems,\n    propertyListItems: propertyListParse.propertyListItems,\n    logNotes: logNotes.logNotes,\n    logBookEntries: logBookParse.logBookEntries,\n    strippedDescription: logBookParse.strippedDescription,\n  };\n};\n\nexport const _updateHeaderFromDescription = (header, rawUnstrippedDescription) => {\n  const {\n    planningItems,\n    propertyListItems,\n    logNotes,\n    logBookEntries,\n    strippedDescription,\n  } = parseDescriptionPrefixElements(rawUnstrippedDescription);\n  const parsedDescription = parseRawText(strippedDescription);\n\n  const parsedTitle = header.getIn(['titleLine', 'title']);\n  const mergedPlanningItems = mergePlanningItems(\n    planningItems,\n    extractActiveTimestampsForPlanningItemsFromParse('TIMESTAMP_TITLE', parsedTitle),\n    extractActiveTimestampsForPlanningItemsFromParse('TIMESTAMP_DESCRIPTION', parsedDescription),\n    extractActiveTimestampsForPlanningItemsFromParse('TIMESTAMP_LOG_NOTES', logNotes)\n  );\n\n  return header\n    .set('rawDescription', strippedDescription)\n    .set('description', parsedDescription)\n    .set('planningItems', mergedPlanningItems)\n    .set('propertyListItems', propertyListItems)\n    .set('logNotes', logNotes)\n    .set('logBookEntries', logBookEntries);\n};\n\nconst defaultKeywordSets = fromJS([\n  {\n    keywords: ['TODO', 'DONE'],\n    completedKeywords: ['DONE'],\n    default: true,\n  },\n]);\n\nexport const parseTitleLine = (titleLine, todoKeywordSets) => {\n  const allKeywords = todoKeywordSets.flatMap((todoKeywordSet) => {\n    return todoKeywordSet.get('keywords');\n  });\n  const todoKeyword = allKeywords.filter((keyword) => titleLine.startsWith(keyword + ' ')).first();\n  let rawTitle = titleLine;\n  if (todoKeyword) {\n    rawTitle = rawTitle.substr(todoKeyword.length + 1);\n  }\n\n  // Check for tags.\n  let tags = [];\n  if (rawTitle.trimRight().endsWith(':')) {\n    const titleParts = rawTitle.trimRight().split(' ');\n    const possibleTags = titleParts[titleParts.length - 1];\n    if (/^:[^\\s]+:$/.test(possibleTags)) {\n      rawTitle = rawTitle.substr(0, rawTitle.length - possibleTags.length);\n      tags = possibleTags.split(':').filter((tag) => tag !== '');\n    }\n  }\n\n  const title = parseMarkupAndCookies(rawTitle);\n\n  return fromJS({ title, rawTitle, todoKeyword, tags });\n};\n\nexport const newHeaderWithTitle = (line, nestingLevel, todoKeywordSets) => {\n  if (todoKeywordSets.size === 0) {\n    todoKeywordSets = defaultKeywordSets;\n  }\n\n  const titleLine = parseTitleLine(line, todoKeywordSets);\n  return fromJS({\n    titleLine,\n    rawDescription: '',\n    description: [],\n    opened: false,\n    id: generateId(),\n    nestingLevel,\n    planningItems: [],\n    propertyListItems: [],\n    logNotes: [],\n    logBookEntries: [],\n  });\n};\n\nconst concatRegexes = (...regexes) =>\n  regexes.reduce((prev, curr) => RegExp(asStrNoSlashs(prev) + asStrNoSlashs(curr)));\n\n// Converts RegExp or strings like '/regex/' to a string without these slashes.\nconst asStrNoSlashs = (regex) => {\n  const s = regex.toString();\n  return s.substring(1, s.length - 1);\n};\n\nexport const newHeaderFromText = (rawText, todoKeywordSets) => {\n  // This function is currently only used for capture templates.\n  // Hence, it's acceptable that it is opinionated on treating\n  // whitespace.\n  const titleLine = rawText.split('\\n')[0].replace(/^\\**\\s*|\\s*$/g, '');\n  const descriptionText = rawText.split('\\n').slice(1).join('\\n');\n\n  // TODO: possible addition: allow subheaders in description!\n\n  const newHeader = newHeaderWithTitle(titleLine, 1, todoKeywordSets);\n  return _updateHeaderFromDescription(newHeader, descriptionText);\n};\n\nexport const lineIsTodoKeywordConfig = (line) => {\n  const lowerLine = line.toLowerCase();\n  return (\n    lowerLine.startsWith('#+todo: ') ||\n    lowerLine.startsWith('#+typ_todo: ') ||\n    lowerLine.startsWith('#+seq_todo: ')\n  );\n};\n\nexport const parseTodoKeywordConfig = (line) => {\n  if (!lineIsTodoKeywordConfig(line)) {\n    return null;\n  }\n\n  const keywordsString = line.substr(line.indexOf(':') + 2);\n  const keywordTokens = keywordsString.split(/\\s/);\n  const keywords = keywordTokens\n    .filter((keyword) => keyword !== '|')\n    // Remove fast access TODO states suffix from keyword, because\n    // there's no UI to handle those in organice\n    // https://orgmode.org/manual/Fast-access-to-TODO-states.html#Fast-access-to-TODO-states\n    .map((keyword) => keyword.replace(/\\(.[!@]?(\\/[!@])?\\)$/, ''));\n\n  const pipeIndex = keywordTokens.indexOf('|');\n  const completedKeywords = pipeIndex >= 0 ? keywords.slice(pipeIndex) : [];\n\n  return fromJS({\n    keywords,\n    completedKeywords,\n    configLine: line,\n    default: false,\n  });\n};\n\nexport const parseFileConfig = (lines) => {\n  let todoKeywordSets = List();\n  let fileConfigLines = List();\n\n  lines.forEach((line) => {\n    const newKeywordSet = parseTodoKeywordConfig(line);\n    if (newKeywordSet) {\n      todoKeywordSets = todoKeywordSets.push(newKeywordSet);\n    } else if (line.startsWith('#+')) {\n      fileConfigLines = fileConfigLines.push(line);\n    }\n  });\n\n  if (todoKeywordSets.size === 0) {\n    todoKeywordSets = defaultKeywordSets;\n  }\n\n  return {\n    todoKeywordSets,\n    fileConfigLines,\n  };\n};\n\nexport const parseOrg = (fileContents) => {\n  let headers = List();\n  const lines = getLinesFromFileContents(fileContents);\n\n  let linesBeforeHeadings = List();\n\n  // This is the first pass over the whole file\n  const { todoKeywordSets, fileConfigLines } = parseFileConfig(lines);\n\n  // This is the second pass over the whole file\n  lines.forEach((line) => {\n    // A header has to start with at least one consecutive asterisk\n    // followed by a blank\n    if (line.match(/^\\*+ /)) {\n      const nestingLevel = computeNestingLevel(line);\n      const title = line.substr(nestingLevel + 1);\n      headers = headers.push(newHeaderWithTitle(title, nestingLevel, todoKeywordSets));\n    } else if (headers.size === 0) {\n      linesBeforeHeadings = linesBeforeHeadings.push(line);\n    } else {\n      headers = headers.updateIn([headers.size - 1, 'rawDescription'], (rawDescription) => {\n        // In the beginning of the parseOrg function, the original\n        // fileContent lines are split by '\\n'. Therefore, the newline\n        // has to be added again to the line:\n        const lineToAdd = line + '\\n';\n        rawDescription = rawDescription ? rawDescription : '';\n        return rawDescription + lineToAdd;\n      });\n    }\n  });\n\n  headers = headers.map((header) => {\n    // Normally, rawDescription contains the \"stripped\" raw description text,\n    // i.e. no log book, properties, or planning items.\n    // In this case (parsing the complete org file), rawDescription contains\n    // the full raw description text. Only after _updateHeaderFromDescription(),\n    // the contents of rawDescription are correct.\n    const description = header.get('rawDescription');\n    return _updateHeaderFromDescription(header, description);\n  });\n\n  headers = updateHeadersTotalTimeLoggedRecursive(headers);\n  const activeClocks = fromJS(headers).filter(hasActiveClock).size;\n\n  return fromJS({\n    headers,\n    activeClocks,\n    todoKeywordSets,\n    fileConfigLines,\n    linesBeforeHeadings,\n  });\n};\n\nconst extractActiveTimestampsForPlanningItemsFromParse = (type, parsedData) => {\n  // planningItems only accept a single timestamp -> ignore second timestamp\n  return parsedData\n    .filter((x) => x.get('type') === 'timestamp' && x.getIn(['firstTimestamp', 'isActive']))\n    .map((x) =>\n      createOrUpdateTimestamp({ type: type, timestamp: x.get('firstTimestamp'), id: x.get('id') })\n    );\n};\n\n// Merge planningItems from parsed title, description, and planning keywords.\nconst mergePlanningItems = (...planningItems) => {\n  return planningItems[0].concat(...planningItems.slice(1));\n};\n\nexport const updatePlanningItems = (planningItems, type, parsed) =>\n  planningItems\n    .filter((x) => x.get('type') !== type)\n    .merge(extractActiveTimestampsForPlanningItemsFromParse(type, parsed));\n\nexport const updatePlanningItemsFromHeader = (header) => {\n  let items = header.get('planningItems');\n  items = updatePlanningItems(items, 'TIMESTAMP_TITLE', header.getIn(['titleLine', 'title']));\n  items = updatePlanningItems(items, 'TIMESTAMP_DESCRIPTION', header.get('description'));\n  items = updatePlanningItems(items, 'TIMESTAMP_LOG_NOTES', header.get('logNotes'));\n  return items;\n};\n\nconst computeNestingLevel = (titleLineWithAsterisk) => {\n  const nestingLevel = titleLineWithAsterisk.indexOf(' ');\n  if (nestingLevel === -1) return titleLineWithAsterisk.trimRight().length;\n  return nestingLevel;\n};\n\nconst getLinesFromFileContents = (fileContents) => {\n  // We expect a newline at EOF (from the last line of fileContents).\n  // After split(), this results in an empty string at the last position of the\n  // array => Remove that last array item.\n  const lines = fileContents.split('\\n');\n\n  // Special case when last line did not end with a newline character:\n  if (lines.length > 0 && lines[lines.length - 1] !== '') return lines;\n\n  return lines.slice(0, lines.length - 1);\n};\n\nconst makeLogNotesResult = (logNotesLines, strippedDescriptionLines) => {\n  const rawLogNotes = logNotesLines.join('\\n');\n  return {\n    rawLogNotes: rawLogNotes,\n    logNotes: parseRawText(rawLogNotes),\n    strippedDescription: strippedDescriptionLines.join('\\n'),\n  };\n};\n","import { createBrowserHistory } from 'history';\n\n// Hard-wrap long lines - from https://stackoverflow.com/a/51506718/252585\nexport const formatTextWrap = (text, w) => {\n  return text.replace(new RegExp(`(?![^\\\\n]{1,${w}}$)([^\\\\n]{1,${w}})\\\\s`, 'g'), '$1\\n');\n};\n\n/* See adr-002 for details.\n  `isLandingPage` is a function that can be used to create certain\n   safeguards, i.e. not loading some CSS where not appropriate. */\n\nexport const isLandingPage = () => {\n  const history = createBrowserHistory();\n  return (\n    !window.testRunner &&\n    history.location.pathname === '/' &&\n    !localStorage.authenticatedSyncService\n  );\n};\n","/* global process */\n\nimport { Map, List, fromJS } from 'immutable';\nimport _ from 'lodash';\n\nimport headline_filter_parser from '../lib/headline_filter_parser';\nimport { isMatch, computeCompletionsForDatalist, timeFilter } from '../lib/headline_filter';\nimport {\n  updateHeadersTotalTimeLoggedRecursive,\n  totalFilteredTimeLogged,\n  updateHeadersTotalFilteredTimeLoggedRecursive,\n  hasActiveClock,\n} from '../lib/clocking';\n\nimport {\n  extractAllOrgTags,\n  extractAllOrgProperties,\n  getTodoKeywordSetsAsFlattenedArray,\n  STATIC_FILE_PREFIX,\n} from '../lib/org_utils';\n\nimport {\n  parseOrg,\n  parseTitleLine,\n  parseRawText,\n  parseMarkupAndCookies,\n  newHeaderWithTitle,\n  newHeaderFromText,\n  updatePlanningItems,\n  updatePlanningItemsFromHeader,\n  _updateHeaderFromDescription,\n} from '../lib/parse_org';\nimport { attributedStringToRawText } from '../lib/export_org';\nimport {\n  indexOfHeaderWithId,\n  indexAndHeaderWithId,\n  parentIdOfHeaderWithId,\n  subheadersOfHeaderWithId,\n  subheaderIndicesOfHeaderWithId,\n  numSubheadersOfHeaderWithId,\n  indexOfPreviousSibling,\n  openDirectParent,\n  openHeaderWithPath,\n  nextVisibleHeaderAfterIndex,\n  previousVisibleHeaderAfterIndex,\n  updateTableContainingCellId,\n  newEmptyTableRowLikeRows,\n  newEmptyTableCell,\n  headerThatContainsTableCellId,\n  headerWithPath,\n  pathAndPartOfListItemWithIdInHeaders,\n  pathAndPartOfTimestampItemWithIdInHeaders,\n  todoKeywordSetForKeyword,\n  inheritedValueOfProperty,\n  newListItem,\n  parentListItemWithIdInHeaders,\n  updateListContainingListItemId,\n  headerThatContainsListItemId,\n  updateContentsWithListItemAddition,\n} from '../lib/org_utils';\nimport { timestampForDate, getTimestampAsText, applyRepeater } from '../lib/timestamps';\nimport generateId from '../lib/id_generator';\nimport { formatTextWrap } from '../util/misc';\nimport { applyFileSettingsFromConfig } from '../util/settings_persister';\n\nexport const parseFile = (state, action) => {\n  const { path, contents } = action;\n\n  const parsedFile = parseOrg(contents);\n\n  return state\n    .setIn(['files', path, 'headers'], parsedFile.get('headers'))\n    .setIn(['files', path, 'todoKeywordSets'], parsedFile.get('todoKeywordSets'))\n    .setIn(['files', path, 'fileConfigLines'], parsedFile.get('fileConfigLines'))\n    .setIn(['files', path, 'linesBeforeHeadings'], parsedFile.get('linesBeforeHeadings'))\n    .setIn(['files', path, 'activeClocks'], parsedFile.get('activeClocks'));\n};\n\nconst clearSearch = (state) => state.setIn(['search', 'filteredHeaders'], null);\n\nconst openHeader = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  return state.setIn(['headers', headerIndex, 'opened'], true);\n};\n\nconst toggleHeaderOpened = (state, action) => {\n  const headers = state.get('headers');\n\n  const { header, headerIndex } = indexAndHeaderWithId(headers, action.headerId);\n  const isOpened = header.get('opened');\n\n  if (isOpened && state.get('narrowedHeaderId') === action.headerId) {\n    return state;\n  }\n\n  if (isOpened && action.closeSubheadersRecursively) {\n    const subheaderIndices = subheaderIndicesOfHeaderWithId(headers, action.headerId);\n    subheaderIndices.forEach((index) => {\n      state = state.setIn(['headers', index, 'opened'], false);\n    });\n  }\n\n  return state.setIn(['headers', headerIndex, 'opened'], !isOpened);\n};\n\nconst selectHeader = (state, action) => {\n  return state.set('selectedHeaderId', action.headerId);\n};\n\nconst openParentsOfHeader = (state, action) => {\n  let headers = state.get('headers');\n  const { headerId } = action;\n\n  let parentHeaderId = parentIdOfHeaderWithId(headers, headerId);\n  while (!!parentHeaderId) {\n    const parentHeaderIndex = indexOfHeaderWithId(headers, parentHeaderId);\n    headers = headers.setIn([parentHeaderIndex, 'opened'], true);\n    parentHeaderId = parentIdOfHeaderWithId(headers, parentHeaderId);\n  }\n\n  return state.set('headers', headers);\n};\n\nconst updateCookiesInAttributedStringWithChildCompletionStates = (parts, completionStates) => {\n  const doneCount = completionStates.filter((isDone) => isDone).length;\n  const totalCount = completionStates.length;\n\n  return parts.map((part) => {\n    switch (part.get('type')) {\n      case 'fraction-cookie':\n        return part.set('fraction', List([doneCount, totalCount]));\n      case 'percentage-cookie':\n        return part.set('percentage', Math.floor((doneCount / totalCount) * 100));\n      default:\n        return part;\n    }\n  });\n};\n\nconst updateCookiesOfHeaderWithId = (file, headerId) => {\n  const headers = file.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n  const subheaders = subheadersOfHeaderWithId(headers, headerId);\n\n  const directChildren = [];\n  for (let i = 0; i < subheaders.size; ++i) {\n    const subheader = subheaders.get(i);\n    directChildren.push(subheader);\n\n    const subheaderSubheaders = subheadersOfHeaderWithId(headers, subheader.get('id'));\n    i += subheaderSubheaders.size;\n  }\n\n  let completionStates = directChildren\n    .map((header) => header.getIn(['titleLine', 'todoKeyword']))\n    .filter((todoKeyword) => !!todoKeyword)\n    .map((todoKeyword) =>\n      todoKeywordSetForKeyword(file.get('todoKeywordSets'), todoKeyword)\n        .get('completedKeywords')\n        .contains(todoKeyword)\n    );\n\n  // If there are no headers with possible completion states, check for plain lists instead.\n  if (completionStates.length === 0) {\n    completionStates = headers\n      .get(headerIndex)\n      .get('description')\n      .filter((part) => part.get('type') === 'list')\n      .flatMap((listPart) => listPart.get('items'))\n      .filter((item) => item.get('isCheckbox'))\n      .map((item) => item.get('checkboxState') === 'checked')\n      .toJS();\n  }\n\n  return file\n    .updateIn(['headers', headerIndex, 'titleLine', 'title'], (title) =>\n      updateCookiesInAttributedStringWithChildCompletionStates(title, completionStates)\n    )\n    .updateIn(['headers', headerIndex, 'titleLine'], (titleLine) =>\n      titleLine.set('rawTitle', attributedStringToRawText(titleLine.get('title')))\n    );\n};\n\nconst updateCookiesOfParentOfHeaderWithId = (file, headerId) => {\n  const parentHeaderId = parentIdOfHeaderWithId(file.get('headers'), headerId);\n  if (!parentHeaderId) {\n    return file;\n  }\n\n  return updateCookiesOfHeaderWithId(file, parentHeaderId);\n};\n\nconst advanceTodoState = (state, action) => {\n  const { headerId, logIntoDrawer, timestamp } = action;\n  const existingHeaderId = headerId || state.get('selectedHeaderId');\n  if (!existingHeaderId) {\n    return state;\n  }\n\n  const headers = state.get('headers');\n  const { header, headerIndex } = indexAndHeaderWithId(headers, existingHeaderId);\n\n  const currentTodoState = header.getIn(['titleLine', 'todoKeyword']);\n  const currentTodoSet = todoKeywordSetForKeyword(state.get('todoKeywordSets'), currentTodoState);\n\n  const currentStateIndex = currentTodoSet.get('keywords').indexOf(currentTodoState);\n  const newStateIndex = currentStateIndex + 1;\n  const newTodoState = currentTodoSet.get('keywords').get(newStateIndex) || '';\n\n  const indexedPlanningItemsWithRepeaters = header\n    .get('planningItems')\n    .map((planningItem, index) => [planningItem, index])\n    .filter(([planningItem]) => !!planningItem.getIn(['timestamp', 'repeaterType']));\n\n  state = updateHeadlines({\n    currentTodoSet,\n    newTodoState,\n    indexedPlanningItemsWithRepeaters,\n    state,\n    headerIndex,\n    currentTodoState,\n    logIntoDrawer,\n    timestamp,\n  });\n\n  state = updateCookiesOfParentOfHeaderWithId(state, existingHeaderId);\n\n  return state;\n};\n\nconst setTodoState = (state, action) => {\n  const { headerId, logIntoDrawer, newTodoState, timestamp } = action;\n  const existingHeaderId = headerId || state.get('selectedHeaderId');\n  if (!existingHeaderId) {\n    return state;\n  }\n\n  const headers = state.get('headers');\n  const { header, headerIndex } = indexAndHeaderWithId(headers, existingHeaderId);\n\n  const currentTodoState = header.getIn(['titleLine', 'todoKeyword']);\n  const currentTodoSet = todoKeywordSetForKeyword(state.get('todoKeywordSets'), currentTodoState);\n  const newTodoSet = todoKeywordSetForKeyword(state.get('todoKeywordSets'), newTodoState);\n  const isInSameTodoSet = currentTodoSet === newTodoSet;\n\n  if (isInSameTodoSet) {\n    const indexedPlanningItemsWithRepeaters = header\n      .get('planningItems')\n      .map((planningItem, index) => [planningItem, index])\n      .filter(([planningItem]) => !!planningItem.getIn(['timestamp', 'repeaterType']));\n\n    state = updateHeadlines({\n      currentTodoSet,\n      newTodoState,\n      indexedPlanningItemsWithRepeaters,\n      state,\n      headerIndex,\n      currentTodoState,\n      logIntoDrawer,\n      timestamp,\n    });\n  } else {\n    state = state.setIn(['headers', headerIndex, 'titleLine', 'todoKeyword'], newTodoState);\n  }\n\n  state = updateCookiesOfParentOfHeaderWithId(state, existingHeaderId);\n\n  return state;\n};\n\nconst enterEditMode = (state, action) => state.set('editMode', action.editModeType);\n\nconst exitEditMode = (state) => state.set('editMode', null);\n\nconst updateHeaderTitle = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n  const todoKeywordSets = state.get('todoKeywordSets');\n\n  const newTitleLine = parseTitleLine(action.newRawTitle.trim(), todoKeywordSets);\n\n  state = state.setIn(['headers', headerIndex, 'titleLine'], newTitleLine);\n\n  state = state.updateIn(['headers', headerIndex, 'planningItems'], (planningItems) =>\n    updatePlanningItems(planningItems, 'TIMESTAMP_TITLE', newTitleLine.get('title'))\n  );\n\n  return updateCookiesOfParentOfHeaderWithId(state, action.headerId);\n};\n\nconst updateHeaderDescription = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  return state.updateIn(['headers', headerIndex], (header) =>\n    _updateHeaderFromDescription(header, action.newRawDescription)\n  );\n};\n\nconst addHeader = (state, action) => {\n  const headers = state.get('headers');\n  const { header, headerIndex } = indexAndHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n\n  const newHeader = newHeaderWithTitle(\n    todoKeyword ? todoKeyword + ' ' : '',\n    header.get('nestingLevel'),\n    state.get('todoKeywordSets')\n  );\n\n  if (action.headerId === state.get('narrowedHeaderId')) {\n    state = state.set('narrowedHeaderId', null);\n  }\n\n  return state.update('headers', (headers) =>\n    headers.insert(headerIndex + subheaders.size + 1, newHeader)\n  );\n};\n\nconst createFirstHeader = (state) => {\n  let newHeader = newHeaderWithTitle('First header', 1, state.get('todoKeywordSets'));\n\n  let description = 'Extend the file from here';\n  if (state.get('linesBeforeHeadings').size > 0) {\n    description = state.get('linesBeforeHeadings').toJS().join('\\n');\n\n    state = state.set('linesBeforeHeadings', List());\n  }\n\n  newHeader = _updateHeaderFromDescription(newHeader, description);\n\n  return state.update('headers', (headers) => headers.insert(0, newHeader));\n};\n\nconst selectNextSiblingHeader = (state, action) => {\n  const headers = state.get('headers');\n  const { header, headerIndex } = indexAndHeaderWithId(headers, action.headerId);\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  const nextSibling = headers.get(headerIndex + subheaders.size + 1);\n\n  if (!nextSibling || nextSibling.get('nestingLevel') !== header.get('nestingLevel')) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', nextSibling.get('id'));\n};\n\nconst selectNextVisibleHeader = (state) => {\n  const headers = state.get('headers');\n\n  if (state.get('selectedHeaderId') === undefined) {\n    return state.set('selectedHeaderId', headers.getIn([0, 'id']));\n  }\n\n  const headerIndex = indexOfHeaderWithId(headers, state.get('selectedHeaderId'));\n\n  const nextVisibleHeader = nextVisibleHeaderAfterIndex(headers, headerIndex);\n\n  if (!nextVisibleHeader) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', nextVisibleHeader.get('id'));\n};\n\nconst selectPreviousVisibleHeader = (state) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, state.get('selectedHeaderId'));\n\n  const previousVisibleHeader = previousVisibleHeaderAfterIndex(headers, headerIndex);\n\n  if (!previousVisibleHeader) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', previousVisibleHeader.get('id'));\n};\n\nconst removeHeader = (state, action) => {\n  let headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  const numHeadersToRemove = 1 + subheaders.size;\n\n  const parentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  _.times(numHeadersToRemove).forEach(() => {\n    headers = headers.delete(headerIndex);\n  });\n\n  if (action.headerId === state.get('narrowedHeaderId')) {\n    state = state.set('narrowedHeaderId', null);\n  }\n\n  state = state.set('headers', headers);\n\n  if (parentHeaderId) {\n    state = updateCookiesOfHeaderWithId(state, parentHeaderId);\n  }\n\n  return state;\n};\n\nconst moveHeaderUp = (state, action) => {\n  let headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousSiblingIndex = indexOfPreviousSibling(headers, headerIndex);\n  if (previousSiblingIndex === null) {\n    return state;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  _.times(1 + subheaders.size).forEach(() => {\n    headers = headers.insert(previousSiblingIndex, headers.get(headerIndex + subheaders.size));\n    headers = headers.delete(headerIndex + subheaders.size + 1);\n  });\n\n  return state.set('headers', headers);\n};\n\nconst moveHeaderDown = (state, action) => {\n  let headers = state.get('headers');\n  const { header, headerIndex } = indexAndHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  const nextSiblingIndex = headerIndex + subheaders.size + 1;\n  const nextSibling = headers.get(nextSiblingIndex);\n  if (!nextSibling || nextSibling.get('nestingLevel') < header.get('nestingLevel')) {\n    return state;\n  }\n\n  const nextSiblingSubheaders = subheadersOfHeaderWithId(headers, nextSibling.get('id'));\n  _.times(1 + nextSiblingSubheaders.size).forEach(() => {\n    headers = headers.insert(\n      headerIndex,\n      headers.get(nextSiblingIndex + nextSiblingSubheaders.size)\n    );\n    headers = headers.delete(nextSiblingIndex + nextSiblingSubheaders.size + 1);\n  });\n\n  return state.set('headers', headers);\n};\n\nconst moveHeaderLeft = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex }, '-');\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return state;\n};\n\nconst moveHeaderRight = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex }, '+');\n  state = openDirectParent(state, action.headerId);\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return state;\n};\n\nconst moveSubtreeLeft = (state, action) => {\n  const headers = state.get('headers');\n  const { header, headerIndex } = indexAndHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  if (header.get('nestingLevel') === 1) {\n    return state;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex, subheaders }, '-');\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return state;\n};\n\nconst moveSubtreeRight = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex, subheaders }, '+');\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return openDirectParent(state, action.headerId);\n};\n\n/**\n * Move an item in immutablejs Lists.\n * @param {list} List\n * @param {integer} fromIndex\n * @param {integer} toIndex\n * @param {any} integer\n */\nconst moveItemInFile = ({ fromList, fromIndex, toIndex, item }) => {\n  const targetItem = fromList.get(toIndex);\n  fromList = fromList.delete(fromIndex);\n  const targetIndex = fromList.indexOf(targetItem);\n  fromList = fromList.insert(targetIndex + 1, item);\n  return [fromList, fromList];\n};\n\nconst moveItemAcrossFiles = ({ fromList, fromIndex, toList, toIndex, item }) => {\n  const targetItem = toList.get(toIndex);\n  fromList = fromList.delete(fromIndex);\n  const targetIndex = toList.indexOf(targetItem);\n  toList = toList.insert(targetIndex + 1, item);\n  return [fromList, toList];\n};\n\nconst refileSubtree = (state, action) => {\n  const { sourcePath, sourceHeaderId, targetPath, targetHeaderId } = action;\n  const moveItem = sourcePath === targetPath ? moveItemInFile : moveItemAcrossFiles;\n  let sourceHeaders = state.getIn(['files', sourcePath, 'headers']);\n  let targetHeaders = state.getIn(['files', targetPath, 'headers']);\n  let { header: sourceHeader, headerIndex: sourceHeaderIndex } = indexAndHeaderWithId(\n    sourceHeaders,\n    sourceHeaderId\n  );\n  let targetHeaderIndex = indexOfHeaderWithId(targetHeaders, targetHeaderId);\n\n  let subheadersOfSourceHeader = subheadersOfHeaderWithId(sourceHeaders, sourceHeaderId);\n\n  const nestingLevelSource = sourceHeaders.getIn([sourceHeaderIndex, 'nestingLevel']);\n  const nestingLevelTarget = targetHeaders.getIn([targetHeaderIndex, 'nestingLevel']);\n\n  // Indent the newly placed sourceheader so that it fits underneath the targetHeader\n  sourceHeader = sourceHeader.set('nestingLevel', nestingLevelTarget + 1);\n\n  // Put the sourceHeader into the right slot after the targetHeader\n  [sourceHeaders, targetHeaders] = moveItem({\n    fromList: sourceHeaders,\n    fromIndex: sourceHeaderIndex,\n    toList: targetHeaders,\n    toIndex: targetHeaderIndex,\n    item: sourceHeader,\n  });\n\n  // Put the subheaders of the sourceHeader right after\n  subheadersOfSourceHeader.forEach((subheader, index) => {\n    subheader = subheader.set(\n      'nestingLevel',\n      // target\n      // 1\n      //   source\n      //   2 (1)\n      //     subheader\n      //      3 (2)\n      //       subheader\n      //       4 (3)\n      subheader.get('nestingLevel') - nestingLevelSource + nestingLevelTarget + 1\n    );\n    const fromIndex = indexOfHeaderWithId(sourceHeaders, subheader.get('id'));\n\n    targetHeaderIndex = indexOfHeaderWithId(targetHeaders, targetHeaderId);\n    const toIndex = targetHeaderIndex + index + 1;\n\n    [sourceHeaders, targetHeaders] = moveItem({\n      fromList: sourceHeaders,\n      fromIndex,\n      toList: targetHeaders,\n      toIndex,\n      item: subheader,\n    });\n  });\n\n  state = state.setIn(['files', sourcePath, 'headers'], sourceHeaders);\n  state = state.setIn(['files', targetPath, 'headers'], targetHeaders);\n\n  state = state.updateIn(['files', sourcePath], (file) =>\n    updateCookies(file, sourceHeaderId, action)\n  );\n  state = state.updateIn(['files', targetPath], (file) =>\n    updateCookies(file, targetHeaderId, action)\n  );\n\n  return state;\n};\n\n// Add a log note to the selected header. This can be any type of log\n// note as defined in the Emacs Org mode variable\n// `org-log-note-headings`.\nconst addNoteGeneric = (state, action) => {\n  const { noteText } = action;\n\n  const headerId = state.get('selectedHeaderId');\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n  return state.updateIn(['headers', headerIndex], (header) => {\n    const updatedHeader = header.update('logNotes', (logNotes) =>\n      parseRawText(noteText + (logNotes.isEmpty() ? '\\n' : '')).concat(logNotes)\n    );\n    return updatedHeader.set('planningItems', updatePlanningItemsFromHeader(updatedHeader));\n  });\n};\n\n// See Emacs Org mode `org-add-note` (C-c C-z) and variable\n// `org-log-note-headings`.\nconst addNote = (state, action) => {\n  const { inputText, currentDate } = action;\n  // Wrap line at 70 characters, see Emacs `fill-column` in \"Insert\n  // note\" window (C-c C-z)\n  const wrappedInput = formatTextWrap(inputText, 70).replace(/\\n(.)/g, '\\n  $1');\n  // Generate note based on a template string (as defined in Emacs Org\n  // mode `org-log-note-headings`):\n  const timestamp = getTimestampAsText(currentDate, { isActive: false, withStartTime: true });\n  const noteText = `- Note taken on ${timestamp} \\\\\\\\\\n  ${wrappedInput}`;\n  return addNoteGeneric(state, { noteText });\n};\n\nconst narrowHeader = (state, action) => {\n  return state.set('narrowedHeaderId', action.headerId);\n};\n\nconst widenHeader = (state) => state.set('narrowedHeaderId', null);\n\nconst applyOpennessState = (state, action) => {\n  const { path } = action;\n  const opennessState = state.get('opennessState');\n  if (!opennessState) {\n    return state;\n  }\n\n  const fileOpennessState = opennessState.get(path);\n  if (!fileOpennessState || fileOpennessState.size === 0) {\n    return state;\n  }\n\n  let headers = state.getIn(['files', path, 'headers']);\n  fileOpennessState.forEach((openHeaderPath) => {\n    headers = openHeaderWithPath(headers, openHeaderPath);\n  });\n\n  return state.setIn(['files', path, 'headers'], headers);\n};\n\nconst setOpennessState = (state, action) => {\n  const { path, opennessState } = action;\n  return state.setIn(['opennessState', path], fromJS(opennessState));\n};\n\nconst setDirty = (state, action) => state.set('isDirty', action.isDirty);\n\nconst setSelectedTableId = (state, action) => state.set('selectedTableId', action.tableId);\n\nconst setSelectedTableCellId = (state, action) => state.set('selectedTableCellId', action.cellId);\n\nconst updateDescriptionOfHeaderContainingTableCell = (state, cellId, header = null) => {\n  const headers = state.get('headers');\n  if (!header) {\n    header = headerThatContainsTableCellId(headers, cellId);\n  }\n  const headerIndex = indexOfHeaderWithId(headers, header.get('id'));\n\n  return state.updateIn(['headers', headerIndex], (header) =>\n    header.set('rawDescription', attributedStringToRawText(header.get('description')))\n  );\n};\n\nconst addNewTableRow = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (rowIndex) => (rows) =>\n      rows.insert(rowIndex + 1, newEmptyTableRowLikeRows(rows))\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst removeTableRow = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  const containingHeader = headerThatContainsTableCellId(state.get('headers'), selectedTableCellId);\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (rowIndex) => (rows) =>\n      rows.delete(rowIndex)\n    )\n  );\n\n  state = state.set('selectedTableCellId', null);\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId, containingHeader);\n};\n\nconst addNewTableColumn = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, colIndex) => (rows) =>\n      rows.map((row) =>\n        row.update('contents', (contents) => contents.insert(colIndex + 1, newEmptyTableCell()))\n      )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst removeTableColumn = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  const containingHeader = headerThatContainsTableCellId(state.get('headers'), selectedTableCellId);\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, colIndex) => (rows) =>\n      rows.map((row) => row.update('contents', (contents) => contents.delete(colIndex)))\n    )\n  );\n\n  state = state.set('selectedTableCellId', null);\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId, containingHeader);\n};\n\nconst moveTableRowDown = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (rowIndex) => (rows) =>\n      rowIndex + 1 === rows.size\n        ? rows\n        : rows.insert(rowIndex, rows.get(rowIndex + 1)).delete(rowIndex + 2)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableRowUp = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (rowIndex) => (rows) =>\n      rowIndex === 0 ? rows : rows.insert(rowIndex - 1, rows.get(rowIndex)).delete(rowIndex + 1)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableColumnLeft = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, columnIndex) => (rows) =>\n      columnIndex === 0\n        ? rows\n        : rows.map((row) =>\n            row.update('contents', (contents) =>\n              contents.size === 0\n                ? contents\n                : contents\n                    .insert(columnIndex - 1, contents.get(columnIndex))\n                    .delete(columnIndex + 1)\n            )\n          )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableColumnRight = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, columnIndex) => (rows) =>\n      columnIndex + 1 >= rows.getIn([0, 'contents']).size\n        ? rows\n        : rows.map((row) =>\n            row.update('contents', (contents) =>\n              contents.size === 0\n                ? contents\n                : contents\n                    .insert(columnIndex, contents.get(columnIndex + 1))\n                    .delete(columnIndex + 2)\n            )\n          )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst updateTableCellValue = (state, action) => {\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, action.cellId, (rowIndex, colIndex) => (rows) =>\n      rows.updateIn([rowIndex, 'contents', colIndex], (cell) =>\n        cell\n          .set('rawContents', action.newValue)\n          .set('contents', fromJS(parseMarkupAndCookies(action.newValue, { excludeCookies: true })))\n      )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, action.cellId);\n};\n\nconst insertCapture = (state, action) => {\n  const headers = state.get('headers');\n  const { template, content, shouldPrepend } = action;\n\n  const { newIndex, nestingLevel, parentHeader } = insertCapturePosition(\n    template,\n    headers,\n    shouldPrepend\n  );\n  if (newIndex === undefined) {\n    // Should never happen; see comment in insertCapturePosition below.\n    return state;\n  }\n\n  const newHeader = newHeaderFromText(content, state.get('todoKeywordSets')).set(\n    'nestingLevel',\n    nestingLevel\n  );\n\n  state = state.update('headers', (headers) => headers.insert(newIndex, newHeader));\n  if (parentHeader !== undefined) {\n    // We inserted the new header under a parent rather than at the top or\n    // bottom of the file.\n    state = updateCookiesOfHeaderWithId(state, parentHeader.get('id'));\n  }\n\n  return state;\n};\n\nconst insertCapturePosition = (template, headers, shouldPrepend) => {\n  const headerPaths = template.get('headerPaths');\n  if (headerPaths.size === 0) {\n    if (shouldPrepend) {\n      // Insert at beginning of file\n      return { newIndex: 0, nestingLevel: 1 };\n    } else {\n      // Insert at end of file\n      return { newIndex: headers.size + 1, nestingLevel: 1 };\n    }\n  }\n\n  const parentHeader = headerWithPath(headers, headerPaths);\n  if (parentHeader == null) {\n    // No parent header found.  In theory this shouldn't happen since\n    // CaptureModal already checks whether a valid targetHeader can be\n    // found if headerPaths is non-empty.\n    return {};\n  }\n  const parentHeaderIndex = indexOfHeaderWithId(headers, parentHeader.get('id'));\n  const numSubheaders = numSubheadersOfHeaderWithId(headers, parentHeader.get('id'));\n  const newIndex = parentHeaderIndex + 1 + (shouldPrepend ? 0 : numSubheaders);\n  const nestingLevel = parentHeader.get('nestingLevel') + 1;\n  return { newIndex, nestingLevel, parentHeader };\n};\n\nconst clearPendingCapture = (state) => state.set('pendingCapture', null);\n\nconst updateParentListCheckboxes = (state, itemPath) => {\n  const parentListItemPath = itemPath.slice(0, itemPath.length - 4);\n  const parentListItem = state.getIn(parentListItemPath);\n  if (!parentListItem.get('isCheckbox')) {\n    return state;\n  }\n\n  const childrenCheckedStates = parentListItem\n    .get('contents')\n    .filter((part) => part.get('type') === 'list')\n    .flatMap((listPart) =>\n      listPart\n        .get('items')\n        .filter((item) => item.get('isCheckbox'))\n        .map((checkboxItem) => checkboxItem.get('checkboxState'))\n    );\n\n  if (childrenCheckedStates.every((state) => state === 'checked')) {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'checked');\n  } else if (childrenCheckedStates.every((state) => state === 'unchecked')) {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'unchecked');\n  } else {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'partial');\n  }\n\n  const childCompletionStates = childrenCheckedStates\n    .map((state) => {\n      switch (state) {\n        case 'checked':\n          return true;\n        case 'unchecked':\n          return false;\n        case 'partial':\n          return false;\n        default:\n          if (process.env.NODE_ENV !== 'production') {\n            throw Error(\"Unexpected checkboxState: '\" + state + \"'\");\n          } else {\n            return false;\n          }\n      }\n    })\n    .toJS();\n\n  state = state.updateIn(parentListItemPath.concat('titleLine'), (titleLine) =>\n    updateCookiesInAttributedStringWithChildCompletionStates(titleLine, childCompletionStates)\n  );\n\n  return updateParentListCheckboxes(state, parentListItemPath);\n};\n\nconst advanceCheckboxState = (state, action) => {\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(state.get('headers'), action.listItemId);\n  const { path, listItemPart } = pathAndPart;\n\n  const hasDirectCheckboxChildren = listItemPart\n    .get('contents')\n    .filter((part) => part.get('type') === 'list')\n    .some((listPart) => listPart.get('items').some((item) => item.get('isCheckbox')));\n  if (hasDirectCheckboxChildren) {\n    return state;\n  }\n\n  const newCheckboxState = {\n    checked: 'unchecked',\n    unchecked: 'checked',\n    partial: 'unchecked',\n  }[listItemPart.get('checkboxState')];\n\n  state = state.setIn(['headers'].concat(path).concat(['checkboxState']), newCheckboxState);\n  state = updateParentListCheckboxes(state, ['headers'].concat(path));\n\n  const headerIndex = path[0];\n  state = updateCookiesOfHeaderWithId(state, state.getIn(['headers', headerIndex, 'id']));\n  state = state.updateIn(['headers', headerIndex], (header) =>\n    header.set('rawDescription', attributedStringToRawText(header.get('description')))\n  );\n\n  return state;\n};\n\nconst setSelectedListItemId = (state, action) => state.set('selectedListItemId', action.listItemId);\n\nconst updateDescriptionOfHeaderContainingListItem = (state, listItemId, header = null) => {\n  let headerIndex = -1;\n  const headers = state.get('headers');\n  if (!header) {\n    const pathAndPart = pathAndPartOfListItemWithIdInHeaders(headers, listItemId);\n    headerIndex = pathAndPart.path[0];\n  } else {\n    headerIndex = indexOfHeaderWithId(headers, header.get('id'));\n  }\n\n  if (headerIndex >= 0) {\n    return state.updateIn(['headers', headerIndex], (header) =>\n      header.set('rawDescription', attributedStringToRawText(header.get('description')))\n    );\n  } else {\n    return state;\n  }\n};\n\nconst updateListTitleValue = (state, action) => {\n  const selectedListItemId = action.listItemId;\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateListContainingListItemId(headers, selectedListItemId, (itemIndex) => (items) =>\n      items.updateIn([itemIndex], (item) =>\n        item.set('titleLine', fromJS(parseMarkupAndCookies(action.newValue)))\n      )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst updateListContentsValue = (state, action) => {\n  const selectedListItemId = action.listItemId;\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateListContainingListItemId(headers, selectedListItemId, (itemIndex) => (items) =>\n      items.updateIn([itemIndex], (item) =>\n        item.set('contents', fromJS(parseRawText(action.newValue)))\n      )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst addNewListItem = (state) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n\n  let newItem = newListItem();\n  if (pathAndPart.listItemPart.get('isCheckbox')) {\n    newItem = newItem.set('isCheckbox', true).set('checkboxState', 'unchecked');\n  }\n\n  state = state.update('headers', (headers) =>\n    updateListContainingListItemId(headers, selectedListItemId, (itemIndex) => (items) =>\n      items.insert(itemIndex + 1, newItem)\n    )\n  );\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst selectNextSiblingListItem = (state) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n  let { path } = pathAndPart;\n  path[path.length - 1] = path[path.length - 1] + 1;\n\n  state = state.set('selectedListItemId', state.getIn(['headers'].concat(path).concat('id')));\n\n  return state;\n};\n\nconst removeListItem = (state) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const containingHeader = headerThatContainsListItemId(state.get('headers'), selectedListItemId);\n\n  state = state.update('headers', (headers) =>\n    updateListContainingListItemId(headers, selectedListItemId, (itemIndex) => (items) =>\n      items.delete(itemIndex)\n    )\n  );\n\n  state = state.set('selectedListItemId', null);\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId, containingHeader);\n};\n\nconst moveListItemUp = (state) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateListContainingListItemId(headers, selectedListItemId, (itemIndex) => (items) =>\n      itemIndex === 0\n        ? items\n        : items.insert(itemIndex - 1, items.get(itemIndex)).delete(itemIndex + 1)\n    )\n  );\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst moveListItemDown = (state) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateListContainingListItemId(headers, selectedListItemId, (itemIndex) => (items) =>\n      itemIndex + 1 === items.size\n        ? items\n        : items.insert(itemIndex, items.get(itemIndex + 1)).delete(itemIndex + 2)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst moveListItemLeft = (state) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n\n  const hasChildrenItem = pathAndPart.listItemPart\n    .get('contents')\n    .filter((part) => part.get('type') === 'list')\n    .some((listPart) => listPart.get('items').size > 0);\n  if (hasChildrenItem) {\n    return state;\n  }\n  return moveListSubtreeLeft(state);\n};\n\nconst moveListItemRight = (state) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n  let { path, listItemPart: selectedListItem } = pathAndPart;\n  const listPart = state.getIn(['headers'].concat(path.slice(0, path.length - 2)));\n  const prevSiblingItemIndex = path[path.length - 1] - 1;\n\n  if (prevSiblingItemIndex < 0) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateListContainingListItemId(headers, selectedListItemId, (itemIndex) => (items) =>\n      items.delete(itemIndex)\n    )\n  );\n\n  const prevSiblingItemContentsPath = ['headers']\n    .concat(path.slice(0, path.length - 1))\n    .concat(prevSiblingItemIndex)\n    .concat('contents');\n\n  const childrenListParts = selectedListItem\n    .get('contents')\n    .filter((part) => part.get('type') === 'list');\n\n  selectedListItem = selectedListItem.update('contents', (contents) =>\n    contents.filter((part) => part.get('type') !== 'list')\n  );\n\n  state = state.updateIn(prevSiblingItemContentsPath, (contents) =>\n    updateContentsWithListItemAddition(contents, selectedListItem, listPart)\n  );\n\n  childrenListParts.map((listPart) =>\n    listPart.get('items').forEach((item) => {\n      state = state.updateIn(prevSiblingItemContentsPath, (contents) =>\n        updateContentsWithListItemAddition(contents, item, listPart)\n      );\n    })\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst moveListSubtreeLeft = (state) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n  let { path, listItemPart: selectedListItem } = pathAndPart;\n  const selectedListItemIndex = path[path.length - 1];\n  if (path.filter((partOfPath) => partOfPath === 'items').length < 2) {\n    return state;\n  }\n\n  const parentListItem = parentListItemWithIdInHeaders(\n    state.getIn(['headers']),\n    selectedListItemId\n  );\n\n  parentListItem\n    .get('contents')\n    .filter((part) => part.get('type') === 'list')\n    .map((listPart) =>\n      listPart.get('items').forEach((item, itemIndex) => {\n        if (itemIndex > selectedListItemIndex) {\n          selectedListItem = selectedListItem.update('contents', (contents) =>\n            updateContentsWithListItemAddition(contents, item, listPart)\n          );\n        }\n      })\n    );\n\n  state = state.update('headers', (headers) =>\n    updateListContainingListItemId(headers, selectedListItemId, () => (items) =>\n      items.filter((_item, index) => index < selectedListItemIndex)\n    )\n  );\n\n  state = state.update('headers', (headers) =>\n    updateListContainingListItemId(headers, parentListItem.get('id'), (itemIndex) => (items) =>\n      items.insert(itemIndex + 1, selectedListItem)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst moveListSubtreeRight = (state) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n  const { path, listItemPart: selectedListItem } = pathAndPart;\n  const listPart = state.getIn(['headers'].concat(path.slice(0, path.length - 2)));\n  const prevSiblingItemIndex = path[path.length - 1] - 1;\n  if (prevSiblingItemIndex < 0) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateListContainingListItemId(headers, selectedListItemId, (itemIndex) => (items) =>\n      itemIndex === 0 ? items : items.delete(itemIndex)\n    )\n  );\n\n  state = state.updateIn(\n    ['headers']\n      .concat(path.slice(0, path.length - 1))\n      .concat(prevSiblingItemIndex)\n      .concat('contents'),\n    (contents) => updateContentsWithListItemAddition(contents, selectedListItem, listPart)\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst setLastSyncAt = (state, action) => state.set('lastSyncAt', action.lastSyncAt);\n\nconst setHeaderTags = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n  if (headerIndex === -1) {\n    return state;\n  }\n\n  return state.setIn(['headers', headerIndex, 'titleLine', 'tags'], action.tags);\n};\n\nconst reorderTags = (state, action) => {\n  const selectedHeaderId = state.get('selectedHeaderId');\n  if (!selectedHeaderId) {\n    return state;\n  }\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), selectedHeaderId);\n\n  return state.updateIn(['headers', headerIndex, 'titleLine', 'tags'], (tags) =>\n    tags.splice(action.fromIndex, 1).splice(action.toIndex, 0, tags.get(action.fromIndex))\n  );\n};\n\nconst reorderPropertyList = (state, action) => {\n  const headerId = action.headerId;\n  if (!headerId) {\n    return state;\n  }\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), headerId);\n\n  return state.updateIn(['headers', headerIndex, 'propertyListItems'], (propertyListItems) =>\n    propertyListItems\n      .splice(action.fromIndex, 1)\n      .splice(action.toIndex, 0, propertyListItems.get(action.fromIndex))\n  );\n};\n\nconst updateTimestampWithId = (state, action) => {\n  const pathAndPart = pathAndPartOfTimestampItemWithIdInHeaders(\n    state.get('headers'),\n    action.timestampId\n  );\n  if (!pathAndPart) {\n    return state;\n  }\n\n  const { path } = pathAndPart;\n  const headerIndex = path[0];\n\n  return state\n    .setIn(['headers'].concat(path), action.newTimestamp)\n    .updateIn(['headers', headerIndex], (header) => {\n      const description = header.get('description');\n      const title = header.getIn(['titleLine', 'title']);\n\n      return header\n        .setIn(['titleLine', 'rawTitle'], attributedStringToRawText(title))\n        .set('rawDescription', attributedStringToRawText(description))\n        .set('planningItems', updatePlanningItemsFromHeader(header));\n    });\n};\n\n// This is for special planning items like SCHEDULED: and DEADLINE:; but not\n// for normal active timestamps (which are also added to planning items).\nconst updatePlanningItemTimestamp = (state, action) => {\n  const { headerId, planningItemIndex, newTimestamp } = action;\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), headerId);\n\n  return state.setIn(\n    ['headers', headerIndex, 'planningItems', planningItemIndex, 'timestamp'],\n    newTimestamp\n  );\n};\n\nconst addNewPlanningItem = (state, action) => {\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\n\n  const newPlanningItem = fromJS({\n    id: generateId(),\n    type: action.planningType,\n    timestamp: timestampForDate(action.timestamp),\n  });\n\n  return state.updateIn(['headers', headerIndex, 'planningItems'], (planningItems) =>\n    !!planningItems ? planningItems.push(newPlanningItem) : List([newPlanningItem])\n  );\n};\n\nconst removePlanningItem = (state, action) => {\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\n  const { planningItemIndex } = action;\n\n  return state.removeIn(['headers', headerIndex, 'planningItems', planningItemIndex]);\n};\n\nconst removeTimestamp = (state, action) => {\n  const { path } = pathAndPartOfTimestampItemWithIdInHeaders(\n    state.get('headers'),\n    action.timestampId\n  );\n\n  // remove parsed timestamp\n  state = state.removeIn(['headers', ...path]);\n\n  // in case this is an active timestamp, remove it from planning items.\n  state = state.updateIn(['headers', path[0], 'planningItems'], (planningItems) =>\n    planningItems.filter((item) => item.get('id') !== action.timestampId)\n  );\n\n  // rebuild text representation of header\n  state = state.setIn(\n    ['headers', path[0], 'titleLine', 'rawTitle'],\n    attributedStringToRawText(state.getIn(['headers', path[0], 'titleLine', 'title']))\n  );\n  state = state.setIn(\n    ['headers', path[0], 'rawDescription'],\n    attributedStringToRawText(state.getIn(['headers', path[0], 'description']))\n  );\n\n  return state;\n};\n\nexport const updatePropertyListItems = (state, action) => {\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\n\n  return state.setIn(['headers', headerIndex, 'propertyListItems'], action.newPropertyListItems);\n};\n\nexport const setLogEntryStop = (state, action) => {\n  const { headerId, entryId, time } = action;\n  const headerIdx = indexOfHeaderWithId(state.get('headers'), headerId);\n  const entryIndex = state\n    .getIn(['headers', headerIdx, 'logBookEntries'])\n    .findIndex((entry) => entry.get('id') === entryId);\n  state = state.update('activeClocks', (i) => i - 1);\n  return state.setIn(['headers', headerIdx, 'logBookEntries', entryIndex, 'end'], fromJS(time));\n};\n\nexport const createLogEntryStart = (state, action) => {\n  const { headerId, time } = action;\n  const headerIdx = indexOfHeaderWithId(state.get('headers'), headerId);\n  const newEntry = fromJS({\n    id: generateId(),\n    start: time,\n    end: null,\n  });\n  state = state.update('activeClocks', (i) => i + 1);\n  return state.updateIn(['headers', headerIdx, 'logBookEntries'], (entries) =>\n    !!entries ? entries.unshift(newEntry) : List([newEntry])\n  );\n};\n\nexport const updateLogEntryTime = (state, action) => {\n  const { headerId, entryIndex, entryType, newTime } = action;\n  const headerIdx = indexOfHeaderWithId(state.get('headers'), headerId);\n  return state.setIn(\n    ['headers', headerIdx, 'logBookEntries', entryIndex, entryType],\n    fromJS(newTime)\n  );\n};\n\nexport const determineIncludedFiles = (files, fileSettings, path, settingValue, includeByDefault) =>\n  files.mapEntries(([filePath, file]) => [\n    filePath,\n    file.update('headers', (headers) => {\n      const fileSetting = fileSettings.find((setting) => filePath === setting.get('path'));\n      // always include the viewed file\n      if (path === filePath) {\n        return headers;\n      } else if (fileSetting) {\n        if (fileSetting.get(settingValue)) {\n          return headers;\n        } else {\n          return List();\n        }\n      } else if (filePath.startsWith(STATIC_FILE_PREFIX)) {\n        // never include static files\n        return List();\n      } else {\n        // if no setting exists\n        return includeByDefault ? headers : List();\n      }\n    }),\n  ]);\n\nconst searchHeaders = ({ searchFilterExpr = [], headersToSearch, path }) => {\n  let filteredHeaders;\n  let nrOfHeadersToSearch = 200;\n  const searchFilterFunction = isMatch(searchFilterExpr);\n\n  // search the current file first\n  const headersFoundInCurrentFile = headersToSearch\n    .get(path)\n    .filter(searchFilterFunction)\n    .take(nrOfHeadersToSearch);\n  nrOfHeadersToSearch -= headersFoundInCurrentFile.count();\n  filteredHeaders = Map().set(path, headersFoundInCurrentFile);\n\n  // search rest of files until nrOfHeadersToDisplay results are found\n  const filePathsToSearch = headersToSearch.keySeq().filter((p) => p !== path);\n  filePathsToSearch.forEach((filePath) => {\n    if (nrOfHeadersToSearch > 0) {\n      const headersFoundInFile = headersToSearch\n        .get(filePath)\n        .filter(searchFilterFunction)\n        .take(nrOfHeadersToSearch);\n      nrOfHeadersToSearch -= headersFoundInFile.count();\n      filteredHeaders = filteredHeaders.set(filePath, headersFoundInFile);\n    }\n  });\n  return filteredHeaders;\n};\n\nconst isActiveClockFilter = (clockFilter) =>\n  clockFilter.field.timerange.type === 'point' &&\n  clockFilter.field.timerange.point.type === 'special' &&\n  clockFilter.field.timerange.point.value === 'now';\n\nexport const setSearchFilterInformation = (state, action) => {\n  const { searchFilter, cursorPosition, context } = action;\n\n  let files = state.get('files');\n  state = state.asMutable();\n\n  let searchFilterValid = true;\n  let searchFilterExpr;\n  try {\n    searchFilterExpr = headline_filter_parser.parse(searchFilter);\n    state.setIn(['search', 'searchFilterExpr'], searchFilterExpr);\n  } catch (e) {\n    // No need to print this parser exceptions. They are expected, see\n    // *.grammar.pegjs. However, we don't need to update the filtered\n    // headers when given an invalid search filter.\n    searchFilterValid = false;\n  }\n\n  const path = state.get('path');\n  const fileSettings = state.get('fileSettings');\n  // Decide which files to include\n  if (context === 'agenda') {\n    files = determineIncludedFiles(files, fileSettings, path, 'includeInAgenda', false);\n  } else if (context === 'search') {\n    files = determineIncludedFiles(files, fileSettings, path, 'includeInSearch', false);\n  } else if (context === 'task-list') {\n    files = determineIncludedFiles(files, fileSettings, path, 'includeInTasklist', false);\n  } else if (context === 'refile') {\n    files = determineIncludedFiles(files, fileSettings, path, 'includeInRefile', false);\n  } // there should not be another context, but if so use all files\n\n  state.setIn(['search', 'searchFilterValid'], searchFilterValid);\n  // Only run filter if a filter is given and parsing was successful\n  if (searchFilterValid) {\n    const headers = files.map((file) => file.get('headers'));\n\n    // show clocked times & sum if there is a clock search term\n    const clockedTimeAndActiveClockFilters = searchFilterExpr\n      .filter((f) => f.type === 'field')\n      .filter((f) => f.field.type === 'clock');\n    const clockFilters = clockedTimeAndActiveClockFilters.filter((f) => !isActiveClockFilter(f));\n    // check for special case \"clock:now\" which searches active clocks\n    const hasActiveClockFilter = clockedTimeAndActiveClockFilters.length !== clockFilters.length;\n\n    const filterFunctions = clockFilters.map(timeFilter);\n    const showClockedTimes = clockFilters.length !== 0;\n    state.setIn(['search', 'showClockedTimes'], showClockedTimes);\n\n    // Only search subheaders if a header is narrowed\n    const narrowedHeaderId = state.getIn(['files', path, 'narrowedHeaderId']);\n    let headersToSearch;\n    if (!narrowedHeaderId || context === 'refile') {\n      headersToSearch = headers;\n    } else {\n      headersToSearch = Map().set(\n        path,\n        subheadersOfHeaderWithId(headers.get(path), narrowedHeaderId)\n      );\n    }\n\n    if (hasActiveClockFilter) {\n      headersToSearch = headersToSearch.map((headersOfFile) =>\n        headersOfFile.filter(hasActiveClock)\n      );\n    }\n\n    // calculate relevant clocked times and total\n    if (showClockedTimes) {\n      headersToSearch = headersToSearch.map((headersOfFile) =>\n        headersOfFile.map((header) =>\n          header.set('totalFilteredTimeLogged', totalFilteredTimeLogged(filterFunctions, header))\n        )\n      );\n      headersToSearch = headersToSearch.map((headersOfFile) =>\n        updateHeadersTotalFilteredTimeLoggedRecursive(filterFunctions, headersOfFile).filter(\n          (header) => header.get('totalFilteredTimeLoggedRecursive') !== 0\n        )\n      );\n    }\n\n    // perform the actual search\n    let filteredHeaders = searchHeaders({ searchFilterExpr, headersToSearch, path });\n\n    if (showClockedTimes) {\n      const clockedTime = filteredHeaders\n        .map((headersOfFile) =>\n          headersOfFile.reduce((acc, val) => acc + val.get('totalFilteredTimeLogged'), 0)\n        )\n        .toList()\n        .reduce((acc, val) => acc + val, 0);\n      state.setIn(['search', 'clockedTime'], clockedTime);\n    }\n\n    // Filter selectedHeader and its subheaders from `headers`,\n    // because you don't want to refile a header to itself or to one\n    // of its subheaders.\n    if (context === 'refile') {\n      const selectedHeaderId = state.getIn(['files', path, 'selectedHeaderId']);\n      const subheaders = subheadersOfHeaderWithId(headers.get(path), selectedHeaderId);\n      let filterIds = subheaders.map((s) => s.get('id')).toJS();\n      filterIds.push(selectedHeaderId);\n      filteredHeaders = filteredHeaders.update(path, (headersOfFile) =>\n        headersOfFile.filter((h) => {\n          return !filterIds.includes(h.get('id'));\n        })\n      );\n    }\n\n    state.setIn(['search', 'filteredHeaders'], filteredHeaders);\n  }\n\n  state.setIn(['search', 'searchFilter'], searchFilter);\n\n  let searchFilterSuggestions = [];\n  if (!_.isEmpty(searchFilter)) {\n    // TODO: Currently only showing suggestions based on opened file.\n    // Decide if they should be based on all files.\n    const currentFile = files.get(path);\n    const headersOfFile = currentFile.get('headers');\n    const todoKeywords = getTodoKeywordSetsAsFlattenedArray(currentFile);\n    const tagNames = extractAllOrgTags(headersOfFile).toJS();\n    const allProperties = extractAllOrgProperties(headersOfFile).toJS();\n    searchFilterSuggestions = computeCompletionsForDatalist(todoKeywords, tagNames, allProperties)(\n      searchFilterExpr,\n      searchFilter,\n      cursorPosition\n    );\n  }\n\n  state.setIn(['search', 'searchFilterSuggestions'], searchFilterSuggestions);\n\n  // update bookmarks to order them by 'last used'\n  let bookmarks = state.getIn(['bookmarks', context]);\n  if (bookmarks.contains(searchFilter)) {\n    bookmarks = bookmarks\n      .filter((x) => x !== searchFilter)\n      .unshift(searchFilter)\n      .take(10);\n  }\n  state.setIn(['bookmarks', context], bookmarks);\n\n  return state.asImmutable();\n};\n\nconst setOrgFileErrorMessage = (state, action) => state.set('orgFileErrorMessage', action.message);\n\nconst setPath = (state, action) => state.set('path', action.path);\n\nconst setShowClockDisplay = (state, action) => {\n  if (action.showClockDisplay) {\n    state = state.update('headers', updateHeadersTotalTimeLoggedRecursive);\n  }\n  return state.set('showClockDisplay', action.showClockDisplay);\n};\n\nconst indexOfFileSettingWithId = (settings, settingId) =>\n  settings.findIndex((setting) => setting.get('id') === settingId);\n\nconst updateFileSettingFieldPathValue = (state, action) => {\n  const settingIndex = indexOfFileSettingWithId(state.get('fileSettings'), action.settingId);\n\n  return state.setIn(['fileSettings', settingIndex].concat(action.fieldPath), action.newValue);\n};\n\nconst reorderFileSetting = (state, action) =>\n  state.update('fileSettings', (settings) =>\n    settings.splice(action.fromIndex, 1).splice(action.toIndex, 0, settings.get(action.fromIndex))\n  );\n\nconst deleteFileSetting = (state, action) => {\n  const settingIndex = indexOfFileSettingWithId(state.get('fileSettings'), action.settingId);\n\n  return state.update('fileSettings', (settings) => settings.delete(settingIndex));\n};\n\nconst saveBookmark = (state, { context, bookmark }) => {\n  return state.updateIn(['bookmarks', context], (bookmarks) =>\n    bookmarks\n      .filter((x) => x !== bookmark)\n      .unshift(bookmark)\n      .take(10)\n  );\n};\n\nconst deleteBookmark = (state, { context, bookmark }) => {\n  return state.updateIn(['bookmarks', context], (bookmarks) =>\n    bookmarks.filter((x) => x !== bookmark).take(10)\n  );\n};\n\nconst addNewFile = (state, { path, content }) => {\n  const parsedFile = parseOrg(content);\n\n  return state\n    .setIn(['files', path, 'headers'], parsedFile.get('headers'))\n    .setIn(['files', path, 'todoKeywordSets'], parsedFile.get('todoKeywordSets'))\n    .setIn(['files', path, 'fileConfigLines'], parsedFile.get('fileConfigLines'))\n    .setIn(['files', path, 'linesBeforeHeadings'], parsedFile.get('linesBeforeHeadings'))\n    .setIn(['files', path, 'activeClocks'], parsedFile.get('activeClocks'))\n    .setIn(['files', path, 'isDirty'], false);\n};\n\nconst addNewEmptyFileSetting = (state) =>\n  state.update('fileSettings', (settings) =>\n    settings.push(\n      fromJS({\n        id: generateId(),\n        path: '',\n        loadOnStartup: false,\n        includeInAgenda: false,\n        includeInSearch: false,\n        includeInRefile: false,\n        includeInTasklist: false,\n      })\n    )\n  );\n\nconst restoreFileSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n\n  return applyFileSettingsFromConfig(state, action.newSettings);\n};\n\nconst reduceInFile = (state, action, path) => (func, ...args) => {\n  return state.updateIn(['files', path], (file) => func(file ? file : Map(), action, ...args));\n};\n\nconst reducer = (state, action) => {\n  const path = state.get('path');\n  const inFile = reduceInFile(state, action, path);\n\n  switch (action.type) {\n    case 'PARSE_FILE':\n      return parseFile(state, action);\n    case 'CLEAR_SEARCH':\n      return clearSearch(state, action);\n    case 'TOGGLE_HEADER_OPENED':\n      return inFile(toggleHeaderOpened);\n    case 'OPEN_HEADER':\n      return inFile(openHeader);\n    case 'SELECT_HEADER':\n      return inFile(selectHeader);\n    case 'OPEN_PARENTS_OF_HEADER':\n      return inFile(openParentsOfHeader);\n    case 'ADVANCE_TODO_STATE':\n      return inFile(advanceTodoState);\n    case 'SET_TODO_STATE':\n      return inFile(setTodoState);\n    case 'ENTER_EDIT_MODE':\n      return inFile(enterEditMode);\n    case 'EXIT_EDIT_MODE':\n      return inFile(exitEditMode);\n    case 'UPDATE_HEADER_TITLE':\n      return inFile(updateHeaderTitle);\n    case 'UPDATE_HEADER_DESCRIPTION':\n      return inFile(updateHeaderDescription);\n    case 'ADD_HEADER':\n      return inFile(addHeader);\n    case 'CREATE_FIRST_HEADER':\n      return inFile(createFirstHeader);\n    case 'SELECT_NEXT_SIBLING_HEADER':\n      return inFile(selectNextSiblingHeader);\n    case 'SELECT_NEXT_VISIBLE_HEADER':\n      return inFile(selectNextVisibleHeader);\n    case 'SELECT_PREVIOUS_VISIBLE_HEADER':\n      return inFile(selectPreviousVisibleHeader);\n    case 'REMOVE_HEADER':\n      return inFile(removeHeader);\n    case 'MOVE_HEADER_UP':\n      return inFile(moveHeaderUp);\n    case 'MOVE_HEADER_DOWN':\n      return inFile(moveHeaderDown);\n    case 'MOVE_HEADER_LEFT':\n      return inFile(moveHeaderLeft);\n    case 'MOVE_HEADER_RIGHT':\n      return inFile(moveHeaderRight);\n    case 'MOVE_SUBTREE_LEFT':\n      return inFile(moveSubtreeLeft);\n    case 'MOVE_SUBTREE_RIGHT':\n      return inFile(moveSubtreeRight);\n    case 'REFILE_SUBTREE':\n      return refileSubtree(state, action);\n    case 'HEADER_ADD_NOTE':\n      return inFile(addNote);\n    case 'APPLY_OPENNESS_STATE':\n      return applyOpennessState(state, action);\n    case 'SET_OPENNESS_STATE':\n      return setOpennessState(state, action);\n    case 'SET_DIRTY':\n      return action.path ? reduceInFile(state, action, action.path)(setDirty) : inFile(setDirty);\n    case 'NARROW_HEADER':\n      return inFile(narrowHeader);\n    case 'WIDEN_HEADER':\n      return inFile(widenHeader);\n    case 'SET_SELECTED_TABLE_ID':\n      return inFile(setSelectedTableId);\n    case 'SET_SELECTED_TABLE_CELL_ID':\n      return inFile(setSelectedTableCellId);\n    case 'ADD_NEW_TABLE_ROW':\n      return inFile(addNewTableRow);\n    case 'REMOVE_TABLE_ROW':\n      return inFile(removeTableRow);\n    case 'ADD_NEW_TABLE_COLUMN':\n      return inFile(addNewTableColumn);\n    case 'REMOVE_TABLE_COLUMN':\n      return inFile(removeTableColumn);\n    case 'MOVE_TABLE_ROW_DOWN':\n      return inFile(moveTableRowDown);\n    case 'MOVE_TABLE_ROW_UP':\n      return inFile(moveTableRowUp);\n    case 'MOVE_TABLE_COLUMN_LEFT':\n      return inFile(moveTableColumnLeft);\n    case 'MOVE_TABLE_COLUMN_RIGHT':\n      return inFile(moveTableColumnRight);\n    case 'UPDATE_TABLE_CELL_VALUE':\n      return inFile(updateTableCellValue);\n    case 'INSERT_CAPTURE':\n      return action.template.get('file')\n        ? reduceInFile(state, action, action.template.get('file'))(insertCapture)\n        : inFile(insertCapture);\n    case 'CLEAR_PENDING_CAPTURE':\n      return clearPendingCapture(state, action);\n    case 'ADVANCE_CHECKBOX_STATE':\n      return inFile(advanceCheckboxState);\n    case 'SET_SELECTED_LIST_ITEM_ID':\n      return inFile(setSelectedListItemId);\n    case 'UPDATE_LIST_TITLE_VALUE':\n      return inFile(updateListTitleValue);\n    case 'UPDATE_LIST_CONTENTS_VALUE':\n      return inFile(updateListContentsValue);\n    case 'ADD_NEW_LIST_ITEM':\n      return inFile(addNewListItem);\n    case 'SELECT_NEXT_SIBLING_LIST_ITEM':\n      return inFile(selectNextSiblingListItem);\n    case 'REMOVE_LIST_ITEM':\n      return inFile(removeListItem);\n    case 'MOVE_LIST_ITEM_UP':\n      return inFile(moveListItemUp);\n    case 'MOVE_LIST_ITEM_DOWN':\n      return inFile(moveListItemDown);\n    case 'MOVE_LIST_ITEM_LEFT':\n      return inFile(moveListItemLeft);\n    case 'MOVE_LIST_ITEM_RIGHT':\n      return inFile(moveListItemRight);\n    case 'MOVE_LIST_SUBTREE_LEFT':\n      return inFile(moveListSubtreeLeft);\n    case 'MOVE_LIST_SUBTREE_RIGHT':\n      return inFile(moveListSubtreeRight);\n    case 'SET_LAST_SYNC_AT':\n      return action.path\n        ? reduceInFile(state, action, action.path)(setLastSyncAt)\n        : inFile(setLastSyncAt);\n    case 'SET_HEADER_TAGS':\n      return inFile(setHeaderTags);\n    case 'REORDER_TAGS':\n      return inFile(reorderTags);\n    case 'REORDER_PROPERTY_LIST':\n      return inFile(reorderPropertyList);\n    case 'UPDATE_TIMESTAMP_WITH_ID':\n      return inFile(updateTimestampWithId);\n    case 'UPDATE_PLANNING_ITEM_TIMESTAMP':\n      return inFile(updatePlanningItemTimestamp);\n    case 'ADD_NEW_PLANNING_ITEM':\n      return inFile(addNewPlanningItem);\n    case 'REMOVE_PLANNING_ITEM':\n      return inFile(removePlanningItem);\n    case 'REMOVE_TIMESTAMP':\n      return inFile(removeTimestamp);\n    case 'UPDATE_PROPERTY_LIST_ITEMS':\n      return inFile(updatePropertyListItems);\n    case 'SET_ORG_FILE_ERROR_MESSAGE':\n      return setOrgFileErrorMessage(state, action);\n    case 'SET_LOG_ENTRY_STOP':\n      return inFile(setLogEntryStop);\n    case 'CREATE_LOG_ENTRY_START':\n      return inFile(createLogEntryStart);\n    case 'UPDATE_LOG_ENTRY_TIME':\n      return inFile(updateLogEntryTime);\n    case 'SET_SEARCH_FILTER_INFORMATION':\n      return setSearchFilterInformation(state, action);\n    case 'SET_PATH':\n      return setPath(state, action);\n    case 'TOGGLE_CLOCK_DISPLAY':\n      return setShowClockDisplay(state, action);\n    case 'UPDATE_FILE_SETTING_FIELD_PATH_VALUE':\n      return updateFileSettingFieldPathValue(state, action);\n    case 'REORDER_FILE_SETTING':\n      return reorderFileSetting(state, action);\n    case 'DELETE_FILE_SETTING':\n      return deleteFileSetting(state, action);\n    case 'ADD_NEW_EMPTY_FILE_SETTING':\n      return addNewEmptyFileSetting(state, action);\n    case 'RESTORE_FILE_SETTINGS':\n      return restoreFileSettings(state, action);\n    case 'SAVE_BOOKMARK':\n      return saveBookmark(state, action);\n    case 'DELETE_BOOKMARK':\n      return deleteBookmark(state, action);\n    case 'ADD_NEW_FILE':\n      return addNewFile(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default (state = Map(), action) => {\n  const affectedFiles = determineAffectedFiles(state, action);\n  affectedFiles.forEach((path) => {\n    state = state.setIn(['files', path, 'isDirty'], true);\n  });\n\n  state = reducer(state, action);\n\n  if (action.dirtying && state.get('showClockDisplay')) {\n    affectedFiles.forEach((path) => {\n      state = state.updateIn(['files', path, 'headers'], updateHeadersTotalTimeLoggedRecursive);\n    });\n  }\n  return state;\n};\n\nexport const determineAffectedFiles = (state, action) => {\n  if (action.dirtying) {\n    if (action.type === 'REFILE_SUBTREE') {\n      return [action.sourcePath, action.targetPath];\n    } else if (action.type === 'INSERT_CAPTURE') {\n      const captureTarget = action.template.get('file');\n      if (captureTarget) {\n        return [captureTarget];\n      } else {\n        return [state.get('path')];\n      }\n    } else {\n      return [state.get('path')];\n    }\n  } else {\n    return [];\n  }\n};\n\n/**\n * Updates Headlines with the next todoKeyword `newTodoState`. Also\n * reschedules planning items with repeaters if applicable.\n * @param {any} currentTodoSet\n * @param {String} newTodoState\n * @param {any} indexedPlanningItemsWithRepeaters\n * @param {Object} state - redux state\n * @param {Number} headerIndex\n * @param {String} currentTodoState\n */\nfunction updateHeadlines({\n  currentTodoSet,\n  newTodoState,\n  indexedPlanningItemsWithRepeaters,\n  state,\n  headerIndex,\n  currentTodoState,\n  logIntoDrawer,\n  timestamp,\n}) {\n  if (\n    currentTodoSet.get('completedKeywords').includes(newTodoState) &&\n    indexedPlanningItemsWithRepeaters.size > 0\n  )\n    return updatePlanningItemsWithRepeaters({\n      indexedPlanningItemsWithRepeaters,\n      state,\n      headerIndex,\n      currentTodoSet,\n      newTodoState,\n      currentTodoState,\n      logIntoDrawer,\n      timestamp,\n    });\n  // Update simple headline (without repeaters)\n  return state.setIn(['headers', headerIndex, 'titleLine', 'todoKeyword'], newTodoState);\n}\n\n/**\n * Add a TODO state change log item either to the heading body or LOGBOOK drawer.\n *\n * @param {*} state\n * @param {*} headerIndex Index of header where the state change log item should be added.\n * @param {string} newTodoState New TODO state, e.g. DONE.\n * @param {string} currentTodoState Current TODO state, e.g. TODO or DONE.\n * @param {boolean} logIntoDrawer By default false, so add log messages as bullets into the body. If true, add into LOGBOOK drawer.\n */\nfunction addTodoStateChangeLogItem(\n  state,\n  headerIndex,\n  newTodoState,\n  currentTodoState,\n  logIntoDrawer,\n  timestamp\n) {\n  // This is how the TODO state change will be logged\n  const inactiveTimestamp = getTimestampAsText(timestamp, { isActive: false, withStartTime: true });\n  const newStateChangeLogText = `- State \"${newTodoState}\"       from \"${currentTodoState}\"       ${inactiveTimestamp}`;\n\n  if (logIntoDrawer) {\n    // Prepend this single item to the :LOGBOOK: drawer, same as org-log-into-drawer setting\n    // https://www.gnu.org/software/emacs/manual/html_node/org/Tracking-TODO-state-changes.html\n    const newEntry = fromJS({\n      id: generateId(),\n      raw: newStateChangeLogText,\n    });\n    return state.updateIn(['headers', headerIndex, 'logBookEntries'], (entries) =>\n      entries.unshift(newEntry)\n    );\n  } else {\n    // When org-log-into-drawer not set, prepend state change log text to log notes\n    return addNoteGeneric(state, { noteText: newStateChangeLogText });\n  }\n}\n\nfunction updatePlanningItemsWithRepeaters({\n  indexedPlanningItemsWithRepeaters,\n  state,\n  headerIndex,\n  currentTodoSet,\n  newTodoState,\n  currentTodoState,\n  logIntoDrawer,\n  timestamp,\n}) {\n  indexedPlanningItemsWithRepeaters.forEach(([planningItem, planningItemIndex]) => {\n    const adjustedTimestamp = applyRepeater(planningItem.get('timestamp'), timestamp);\n    state = state.setIn(\n      ['headers', headerIndex, 'planningItems', planningItemIndex, 'timestamp'],\n      adjustedTimestamp\n    );\n\n    // INFO: Active timestamps are now manually updated in place.\n    // Rationale: The active timestamps in title and description are\n    // added to `planningItems` on parse. Since there can be an\n    // arbitrary amount of timestamps it makes sense not to have one\n    // `planningItem` representing the title or the description. We\n    // need to preserve the place of a timestamp in title/description\n    // and we want to have it in a list of `planningItems`. So they\n    // necessarily exist in more than one place. There might be a\n    // cleaner solution where we store the timestamp only in one place\n    // and use references to that place but I don't see any extra\n    // benefit for what would be no negligible refactoring effort.\n\n    // Scheduled / deadline timestamps on the other hand are part of\n    // `rawDescription` but not of the parsed description. These\n    // timestamps only exist in one place (`planningItems`) so\n    // changing them there is visible and will be persisted.\n    switch (planningItem.get('type')) {\n      case 'TIMESTAMP_TITLE':\n        const titleIndex = state\n          .getIn(['headers', headerIndex, 'titleLine', 'title'])\n          .findIndex((titlePart) => planningItem.get('id') === titlePart.get('id'));\n        state = state.setIn(\n          ['headers', headerIndex, 'titleLine', 'title', titleIndex, 'firstTimestamp'],\n          adjustedTimestamp\n        );\n        state = state.setIn(\n          ['headers', headerIndex, 'titleLine', 'rawTitle'],\n          attributedStringToRawText(state.getIn(['headers', headerIndex, 'titleLine', 'title']))\n        );\n        break;\n      case 'TIMESTAMP_DESCRIPTION':\n        const descriptionIndex = state\n          .getIn(['headers', headerIndex, 'description'])\n          .findIndex((descriptionPart) => planningItem.get('id') === descriptionPart.get('id'));\n        state = state.setIn(\n          ['headers', headerIndex, 'description', descriptionIndex, 'firstTimestamp'],\n          adjustedTimestamp\n        );\n        state = state.setIn(\n          ['headers', headerIndex, 'rawDescription'],\n          attributedStringToRawText(state.getIn(['headers', headerIndex, 'description']))\n        );\n        break;\n      default:\n        break;\n    }\n  });\n  state = state.setIn(\n    ['headers', headerIndex, 'titleLine', 'todoKeyword'],\n    currentTodoSet.get('keywords').first()\n  );\n  if (!noLogRepeatEnabledP({ state, headerIndex })) {\n    const lastRepeatTimestamp = timestampForDate(timestamp, {\n      isActive: false,\n      withStartTime: true,\n    });\n    const newLastRepeatValue = [\n      {\n        type: 'timestamp',\n        id: generateId(),\n        firstTimestamp: lastRepeatTimestamp,\n        secondTimestamp: null,\n      },\n    ];\n\n    state = state.updateIn(['headers', headerIndex, 'propertyListItems'], (propertyListItems) =>\n      propertyListItems.some((item) => item.get('property') === 'LAST_REPEAT')\n        ? propertyListItems.map((item) =>\n            item.get('property') === 'LAST_REPEAT'\n              ? item.set('value', fromJS(newLastRepeatValue))\n              : item\n          )\n        : propertyListItems.push(\n            fromJS({\n              property: 'LAST_REPEAT',\n              value: newLastRepeatValue,\n              id: generateId(),\n            })\n          )\n    );\n    state = addTodoStateChangeLogItem(\n      state,\n      headerIndex,\n      newTodoState,\n      currentTodoState,\n      logIntoDrawer,\n      timestamp\n    );\n  }\n  return state;\n}\n\n/**\n * Is the `nologrepeat` feature enabled for this buffer?\n * More info:\n * https://www.gnu.org/software/emacs/manual/html_node/org/Repeated-tasks.html\n */\nexport function noLogRepeatEnabledP({ state, headerIndex }) {\n  const startupOptNoLogRepeat = state\n    .get('fileConfigLines')\n    .some((elt) => elt.match(/^#\\+STARTUP:.*nologrepeat.*/));\n  const loggingProp = inheritedValueOfProperty(state.get('headers'), headerIndex, 'LOGGING');\n  return !!(\n    startupOptNoLogRepeat ||\n    (loggingProp &&\n      loggingProp.some(\n        (v) => v.get('type') === 'text' && v.get('contents').match(/\\s*nologrepeat\\s*/)\n      ))\n  );\n}\n\n/**\n * Function wrapper around `updateCookiesOfHeaderWithId` and\n * `updateCookiesOfParentOfHeaderWithId`.\n */\nfunction updateCookies(file, previousParentHeaderId, action) {\n  file = updateCookiesOfHeaderWithId(file, previousParentHeaderId);\n  file = updateCookiesOfParentOfHeaderWithId(file, action.headerId);\n  return file;\n}\n\n/**\n * Helper function to calculate the new state when moving a header\n * (either with or without subheaders) to the left or right.\n * @param {Object} param0 - Current state\n * @param {Object} param0.state - Redux `state` object\n * @param {Object} param0.headerIndex - Position of relevant header object\n * @param {Object} param0.subheaders - List of subheaders of relevant header\n * @param {String} direction: Can be either '-' to move the header left\n * or '+' to move it right\n */\nfunction shiftTreeNestingLevel({ state, headerIndex, subheaders = [] }, direction = '-') {\n  state = state.updateIn(['headers', headerIndex, 'nestingLevel'], calculateNestingLevel());\n  subheaders.forEach((_, index) => {\n    state = state.updateIn(\n      ['headers', headerIndex + index + 1, 'nestingLevel'],\n      calculateNestingLevel()\n    );\n  });\n  return state;\n\n  function calculateNestingLevel() {\n    return (nestingLevel) => {\n      if (direction === '-') {\n        // Don't move a header further to the left than the first\n        // column\n        return Math.max(nestingLevel - 1, 1);\n      } else {\n        return nestingLevel + 1;\n      }\n    };\n  }\n}\n","import { debounce } from 'lodash';\nimport { parseISO, addSeconds } from 'date-fns';\nimport { localStorageAvailable } from '../util/settings_persister';\nimport { exportOrg } from '../lib/export_org';\nimport { parseFile } from '../reducers/org';\nimport { STATIC_FILE_PREFIX } from '../lib/org_utils';\n\nexport const persistIsDirty = (isDirty, path) => {\n  if (localStorageAvailable) {\n    const filesDirty = JSON.parse(localStorage.getItem('isDirty')) || {};\n    filesDirty[path] = isDirty;\n    localStorage.setItem('isDirty', JSON.stringify(filesDirty));\n  }\n};\n\nexport const saveFileContentsToLocalStorage = (path, contents) => {\n  if (localStorageAvailable && !path.startsWith(STATIC_FILE_PREFIX)) {\n    let persistedFiles = JSON.parse(localStorage.getItem('persistedFiles'));\n    persistedFiles = persistedFiles || {};\n\n    localStorage.setItem('files__' + path, contents);\n    persistedFiles[path] = addSeconds(new Date(), 5);\n\n    localStorage.setItem('persistedFiles', JSON.stringify(persistedFiles));\n  }\n};\n\nconst saveFunctionToDebounce = (state, path) => {\n  if (localStorageAvailable && !path.startsWith(STATIC_FILE_PREFIX)) {\n    const persistedFiles = JSON.parse(localStorage.getItem('persistedFiles')) || {};\n\n    const contents = exportOrg({\n      headers: state.org.present.getIn(['files', path, 'headers']),\n      linesBeforeHeadings: state.org.present.getIn(['files', path, 'linesBeforeHeadings']),\n      dontIndent: state.base.get('shouldNotIndentOnExport'),\n    });\n    localStorage.setItem('files__' + path, contents);\n\n    persistedFiles[path] = state.org.present.getIn(['files', path, 'lastSyncAt']);\n    localStorage.setItem('persistedFiles', JSON.stringify(persistedFiles));\n  }\n};\nconst getDebouncedSaveFunction = () =>\n  debounce(saveFunctionToDebounce, 3000, {\n    leading: true,\n    trailing: true,\n  });\nconst debouncedSaveFunctions = {};\nexport const saveFileToLocalStorage = (state, path) => {\n  // to make sure no file is skipped when multiple files are dirty\n  // a seperately debounced function is used per file\n  let debouncedSaveFunction = debouncedSaveFunctions[path];\n  if (!debouncedSaveFunction) {\n    debouncedSaveFunctions[path] = getDebouncedSaveFunction();\n    debouncedSaveFunction = debouncedSaveFunctions[path];\n  }\n  debouncedSaveFunction(state, path);\n};\n\nexport const loadFilesFromLocalStorage = (state) => {\n  if (localStorageAvailable) {\n    const persistedFiles = JSON.parse(localStorage.getItem('persistedFiles')) || {};\n    const isDirty = JSON.parse(localStorage.getItem('isDirty')) || {};\n    Object.entries(persistedFiles).forEach(([path, lastSyncAt]) => {\n      const contents = localStorage.getItem('files__' + path);\n      if (contents) {\n        state.org.present = state.org.present.update((org) => parseFile(org, { path, contents }));\n        state.org.present = state.org.present.setIn(\n          ['files', path, 'lastSyncAt'],\n          parseISO(lastSyncAt)\n        );\n        state.org.present = state.org.present.setIn(['files', path, 'isDirty'], isDirty[path]);\n      }\n    });\n  }\n  return state;\n};\n","import { ActionCreators, ActionTypes } from 'redux-undo';\nimport { debounce } from 'lodash';\nimport {\n  setLoadingMessage,\n  hideLoadingMessage,\n  setIsLoading,\n  setDisappearingLoadingMessage,\n  activatePopup,\n  closePopup,\n} from './base';\nimport { exportOrg } from '../lib/export_org';\nimport substituteTemplateVariables from '../lib/capture_template_substitution';\nimport { headerWithPath, STATIC_FILE_PREFIX } from '../lib/org_utils';\n\nimport sampleCaptureTemplates from '../lib/sample_capture_templates';\n\nimport { isAfter, addSeconds } from 'date-fns';\nimport { parseISO } from 'date-fns';\nimport { persistIsDirty, saveFileContentsToLocalStorage } from '../util/file_persister';\nimport { localStorageAvailable, readOpennessState } from '../util/settings_persister';\n\nexport const parseFile = (path, contents) => (dispatch) => {\n  if (localStorageAvailable && !path.startsWith(STATIC_FILE_PREFIX)) {\n    saveFileContentsToLocalStorage(path, contents);\n    const opennessState = readOpennessState();\n    if (!!opennessState) {\n      dispatch(setOpennessState(path, opennessState[path]));\n    }\n  }\n  dispatch({\n    type: 'PARSE_FILE',\n    path,\n    contents,\n  });\n  dispatch(applyOpennessState(path));\n};\n\nexport const setLastSyncAt = (lastSyncAt, path) => ({\n  type: 'SET_LAST_SYNC_AT',\n  path,\n  lastSyncAt,\n});\n\nexport const resetFileDisplay = () => {\n  return (dispatch) => {\n    dispatch(widenHeader());\n    dispatch(closePopup());\n    dispatch({ type: 'CLEAR_SEARCH' });\n    dispatch(setPath(null));\n    dispatch(ActionCreators.clearHistory());\n  };\n};\n\nconst getDebouncedSyncFunction = () =>\n  debounce((dispatch, options) => dispatch(doSync(options)), 3000, {\n    leading: true,\n    trailing: true,\n  });\nconst debouncedSyncFunctions = {};\nconst syncDebounced = (dispatch, getState, options) => {\n  // to make sure no file is skipped when multiple files are dirty\n  // a seperately debounced function is used per file\n  let filesToSync = [];\n  if (options.path) {\n    filesToSync = [options.path];\n  } else {\n    // if no path is passed in, sync all dirty files\n    const files = getState().org.present.get('files');\n    filesToSync = files.keySeq().filter((path) => files.getIn([path, 'isDirty']));\n  }\n  filesToSync.forEach((path) => {\n    let debouncedSyncFunction = debouncedSyncFunctions[path];\n    if (!debouncedSyncFunction) {\n      debouncedSyncFunctions[path] = getDebouncedSyncFunction();\n      debouncedSyncFunction = debouncedSyncFunctions[path];\n    }\n    debouncedSyncFunction(dispatch, options);\n  });\n};\n\nexport const sync = (options) => (dispatch, getState) => {\n  // Don't do anything if the browser is not online. When it gets back\n  // from an offline state, a new `sync`action will be triggered then.\n  if (getState().base.get('online')) {\n    // If the user hits the 'sync' button, no matter if there's a sync\n    // in progress or if the sync 'should' be debounced, listen to the\n    // user and start a sync.\n    if (options.forceAction === 'manual') {\n      console.log('forcing sync');\n      const files = getState().org.present.get('files');\n      // sync all files on manual sync\n      files.keySeq().forEach((path) => dispatch(doSync({ ...options, path })));\n    } else {\n      syncDebounced(dispatch, getState, options);\n    }\n  }\n};\n\n// doSync is the actual sync action synchronizing/persisting the Org\n// file. When 'live sync' is enabled, there's potentially a quick\n// succession of calls to 'sync' and therefore to the sync back-end\n// happening. These calls need to be debounced. If there's a really\n// succession of calls, only the first and last synchronization will\n// happen.\n// Note: This action is a redux-thunk action (because it returns a\n// function). This function is defined every time it is called. Hence,\n// wrapping it in `debounce` will not be good enough. Since it would\n// be a new function every time, it would be called every time. The\n// solution is to define an inner function `sync` outside of the\n// wrapping function `syncDebounced`. This will actually debounce\n// `doSync`, because the inner function `sync` will be created only\n// once.\nconst doSync = ({\n  forceAction = null,\n  successMessage = 'Changes pushed',\n  shouldSuppressMessages = false,\n  path,\n} = {}) => (dispatch, getState) => {\n  const client = getState().syncBackend.get('client');\n  const currentPath = getState().org.present.get('path');\n  path = path || currentPath;\n  if (!path || path.startsWith(STATIC_FILE_PREFIX)) {\n    return;\n  }\n\n  // Calls do `doSync` are already debounced using a timer, but on big\n  // Org files or slow connections, it's still possible to have\n  // concurrent requests to `doSync` which has no merit. When\n  // `isLoading`, don't trigger another sync in parallel. Instead,\n  // call `syncDebounced` and return immediately. This will\n  // recursively enqueue the request to do a sync until the current\n  // sync is finished. Since it's a debounced call, enqueueing it\n  // recursively is efficient.\n  // That is, unless the user manually hits the 'sync' button\n  // (indicated by `forceAction === 'manual'`). Then, do what the user\n  // requests.\n  if (getState().base.get('isLoading').includes(path) && forceAction !== 'manual') {\n    // Since there is a quick succession of debounced requests to\n    // synchronize, the user likely is in a undo/redo workflow with\n    // potential new changes to the Org file in between. In such a\n    // situation, it is easy for the remote file to have a newer\n    // `lastModifiedAt` date than the `lastSyncAt` date. Hence,\n    // pushing is the right action - no need for the modal to ask the\n    // user for her request to pull/push or cancel.\n    dispatch(sync({ forceAction: 'push' }));\n    return;\n  }\n\n  if (!shouldSuppressMessages) {\n    dispatch(setLoadingMessage(`Syncing ...`));\n  }\n  dispatch(setIsLoading(true, path));\n  dispatch(setOrgFileErrorMessage(null));\n\n  client\n    .getFileContentsAndMetadata(path)\n    .then(({ contents, lastModifiedAt }) => {\n      const isDirty = getState().org.present.getIn(['files', path, 'isDirty']);\n      const lastServerModifiedAt = parseISO(lastModifiedAt);\n      const lastSyncAt = getState().org.present.getIn(['files', path, 'lastSyncAt']);\n\n      if (isAfter(lastSyncAt, lastServerModifiedAt) || forceAction === 'push') {\n        if (isDirty) {\n          const contents = exportOrg({\n            headers: getState().org.present.getIn(['files', path, 'headers']),\n            linesBeforeHeadings: getState().org.present.getIn([\n              'files',\n              path,\n              'linesBeforeHeadings',\n            ]),\n            dontIndent: getState().base.get('shouldNotIndentOnExport'),\n          });\n          client\n            .updateFile(path, contents)\n            .then(() => {\n              if (!shouldSuppressMessages) {\n                dispatch(setDisappearingLoadingMessage(successMessage, 2000));\n              } else {\n                setTimeout(() => dispatch(hideLoadingMessage()), 2000);\n              }\n              dispatch(setIsLoading(false, path));\n              dispatch(setDirty(false, path));\n              dispatch(setLastSyncAt(addSeconds(new Date(), 5), path));\n            })\n            .catch((error) => {\n              const err = `There was an error pushing the file ${path}: ${error.toString()}`;\n              console.error(err);\n              dispatch(setDisappearingLoadingMessage(err, 5000));\n              dispatch(hideLoadingMessage());\n              dispatch(setIsLoading(false, path));\n              // Re-enqueue the file to be synchronized again\n              dispatch(sync({ path }));\n            });\n        } else {\n          if (!shouldSuppressMessages) {\n            dispatch(setDisappearingLoadingMessage('Nothing to sync', 2000));\n          } else {\n            setTimeout(() => dispatch(hideLoadingMessage()), 2000);\n          }\n          dispatch(setIsLoading(false, path));\n        }\n      } else {\n        if (isDirty && forceAction !== 'pull') {\n          dispatch(hideLoadingMessage());\n          dispatch(setIsLoading(false, path));\n          dispatch(activatePopup('sync-confirmation', { lastServerModifiedAt, lastSyncAt, path }));\n        } else {\n          dispatch(parseFile(path, contents));\n          dispatch(setDirty(false, path));\n          dispatch(setLastSyncAt(addSeconds(new Date(), 5), path));\n          if (!shouldSuppressMessages) {\n            dispatch(setDisappearingLoadingMessage(`Latest version pulled: ${path}`, 2000));\n          } else {\n            setTimeout(() => dispatch(hideLoadingMessage()), 2000);\n          }\n          dispatch(setIsLoading(false, path));\n        }\n      }\n    })\n    .catch(() => {\n      dispatch(hideLoadingMessage());\n      dispatch(setIsLoading(false, path));\n      dispatch(setOrgFileErrorMessage(`File ${path} not found`));\n    });\n};\n\nexport const openHeader = (headerId) => ({\n  type: 'OPEN_HEADER',\n  headerId,\n});\n\nexport const toggleHeaderOpened = (headerId, closeSubheadersRecursively) => ({\n  type: 'TOGGLE_HEADER_OPENED',\n  headerId,\n  closeSubheadersRecursively,\n});\n\nexport const selectHeader = (headerId) => (dispatch) => {\n  dispatch({ type: 'SELECT_HEADER', headerId });\n\n  if (!!headerId) {\n    dispatch(setSelectedTableCellId(null));\n    dispatch(setSelectedListItemId(null));\n  }\n};\n\nexport const setPath = (path) => (dispatch) => {\n  dispatch({\n    type: 'SET_PATH',\n    path,\n  });\n  dispatch({ type: ActionTypes.CLEAR_HISTORY });\n};\n\nexport const selectHeaderAndOpenParents = (path, headerId) => (dispatch) => {\n  dispatch(setPath(path));\n  dispatch({ type: 'OPEN_PARENTS_OF_HEADER', headerId });\n  // select header after the file is displayed to allow the header to scroll into view\n  setTimeout(() => dispatch(selectHeader(headerId)), 0);\n};\n\n/**\n * Action to advance the state, e.g. TODO -> DONE, of the header specified in headerId.\n *\n * @param {*} headerId headerId to advance, or null if you want the currently narrowed header.\n * @param {*} logIntoDrawer false to log state change into body, true to log into :LOGBOOK: drawer.\n */\nexport const advanceTodoState = (headerId, logIntoDrawer) => ({\n  type: 'ADVANCE_TODO_STATE',\n  headerId,\n  logIntoDrawer,\n  dirtying: true,\n  timestamp: new Date(),\n});\n\nexport const setTodoState = (headerId, newTodoState, logIntoDrawer) => ({\n  type: 'SET_TODO_STATE',\n  newTodoState,\n  headerId,\n  logIntoDrawer,\n  dirtying: true,\n  timestamp: new Date(),\n});\n\nexport const enterEditMode = (editModeType) => ({\n  type: 'ENTER_EDIT_MODE',\n  editModeType,\n});\n\nexport const exitEditMode = () => ({\n  type: 'EXIT_EDIT_MODE',\n});\n\nexport const updateHeaderTitle = (headerId, newRawTitle) => ({\n  type: 'UPDATE_HEADER_TITLE',\n  headerId,\n  newRawTitle,\n  dirtying: true,\n});\n\nexport const updateHeaderDescription = (headerId, newRawDescription) => ({\n  type: 'UPDATE_HEADER_DESCRIPTION',\n  headerId,\n  newRawDescription,\n  dirtying: true,\n});\n\nexport const addHeader = (headerId) => ({\n  type: 'ADD_HEADER',\n  headerId,\n  // Performance optimization: Don't actually sync a whole Org file\n  // for an empty header. When the user adds some data and triggers\n  // UPDATE_HEADER_TITLE, then it makes sense to save it.\n  dirtying: false,\n});\n\nexport const createFirstHeader = () => ({\n  type: 'CREATE_FIRST_HEADER',\n  dirtying: true,\n});\n\nexport const selectNextSiblingHeader = (headerId) => ({\n  type: 'SELECT_NEXT_SIBLING_HEADER',\n  headerId,\n});\n\nexport const addHeaderAndEdit = (headerId) => (dispatch) => {\n  dispatch(addHeader(headerId));\n  dispatch(selectNextSiblingHeader(headerId));\n  dispatch(activatePopup('title-editor'));\n};\n\nexport const selectNextVisibleHeader = (headerId) => ({\n  type: 'SELECT_NEXT_VISIBLE_HEADER',\n  headerId,\n});\n\nexport const selectPreviousVisibleHeader = (headerId) => ({\n  type: 'SELECT_PREVIOUS_VISIBLE_HEADER',\n  headerId,\n});\n\nexport const removeHeader = (headerId) => ({\n  type: 'REMOVE_HEADER',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderUp = (headerId) => ({\n  type: 'MOVE_HEADER_UP',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderDown = (headerId) => ({\n  type: 'MOVE_HEADER_DOWN',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderLeft = (headerId) => ({\n  type: 'MOVE_HEADER_LEFT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderRight = (headerId) => ({\n  type: 'MOVE_HEADER_RIGHT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveSubtreeLeft = (headerId) => ({\n  type: 'MOVE_SUBTREE_LEFT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveSubtreeRight = (headerId) => ({\n  type: 'MOVE_SUBTREE_RIGHT',\n  headerId,\n  dirtying: true,\n});\n\nexport const refileSubtree = (sourcePath, sourceHeaderId, targetPath, targetHeaderId) => ({\n  type: 'REFILE_SUBTREE',\n  sourcePath,\n  sourceHeaderId,\n  targetPath,\n  targetHeaderId,\n  dirtying: true,\n});\n\nexport const addNote = (inputText, currentDate) => ({\n  type: 'HEADER_ADD_NOTE',\n  inputText,\n  currentDate,\n  dirtying: true,\n});\n\nexport const narrowHeader = (headerId) => ({\n  type: 'NARROW_HEADER',\n  headerId,\n});\n\nexport const widenHeader = () => ({\n  type: 'WIDEN_HEADER',\n});\n\nexport const setOpennessState = (path, opennessState) => ({\n  type: 'SET_OPENNESS_STATE',\n  path,\n  opennessState,\n});\n\nexport const applyOpennessState = (path) => ({\n  type: 'APPLY_OPENNESS_STATE',\n  path,\n});\n\nexport const dirtyAction = (isDirty, path) => ({\n  type: 'SET_DIRTY',\n  isDirty,\n  path,\n});\n\nexport const setDirty = (isDirty, path) => (dispatch) => {\n  persistIsDirty(isDirty, path);\n  dispatch(dirtyAction(isDirty, path));\n};\n\nexport const setSelectedTableId = (tableId) => (dispatch) => {\n  dispatch({ type: 'SET_SELECTED_TABLE_ID', tableId });\n};\n\nexport const setSelectedTableCellId = (cellId) => (dispatch) => {\n  dispatch({ type: 'SET_SELECTED_TABLE_CELL_ID', cellId });\n\n  if (!!cellId) {\n    dispatch(setSelectedListItemId(null));\n  }\n};\n\nexport const addNewTableRow = () => ({\n  type: 'ADD_NEW_TABLE_ROW',\n  dirtying: true,\n});\n\nexport const removeTableRow = () => ({\n  type: 'REMOVE_TABLE_ROW',\n  dirtying: true,\n});\n\nexport const addNewTableColumn = () => ({\n  type: 'ADD_NEW_TABLE_COLUMN',\n  dirtying: true,\n});\n\nexport const removeTableColumn = () => ({\n  type: 'REMOVE_TABLE_COLUMN',\n  dirtying: true,\n});\n\nexport const moveTableRowDown = () => ({\n  type: 'MOVE_TABLE_ROW_DOWN',\n  dirtying: true,\n});\n\nexport const moveTableRowUp = () => ({\n  type: 'MOVE_TABLE_ROW_UP',\n  dirtying: true,\n});\n\nexport const moveTableColumnLeft = () => ({\n  type: 'MOVE_TABLE_COLUMN_LEFT',\n  dirtying: true,\n});\n\nexport const moveTableColumnRight = () => ({\n  type: 'MOVE_TABLE_COLUMN_RIGHT',\n  dirtying: true,\n});\n\nexport const updateTableCellValue = (cellId, newValue) => ({\n  type: 'UPDATE_TABLE_CELL_VALUE',\n  cellId,\n  newValue,\n  dirtying: true,\n});\n\nexport const insertCapture = (templateId, content, shouldPrepend) => (dispatch, getState) => {\n  dispatch(closePopup());\n\n  const template = getState()\n    .capture.get('captureTemplates')\n    .concat(sampleCaptureTemplates)\n    .find((template) => template.get('id') === templateId);\n  dispatch({ type: 'INSERT_CAPTURE', template, content, shouldPrepend, dirtying: true });\n};\n\nexport const clearPendingCapture = () => ({\n  type: 'CLEAR_PENDING_CAPTURE',\n});\n\nexport const insertPendingCapture = () => (dispatch, getState) => {\n  const path = getState().org.present.get('path');\n  const pendingCapture = getState().org.present.get('pendingCapture');\n  const templateName = pendingCapture.get('captureTemplateName');\n  const captureContent = pendingCapture.get('captureContent');\n  const customCaptureVariables = pendingCapture.get('customCaptureVariables');\n\n  dispatch(clearPendingCapture());\n  window.history.pushState({}, '', window.location.pathname);\n\n  const template = getState()\n    .capture.get('captureTemplates')\n    .filter(\n      (template) =>\n        template.get('isAvailableInAllOrgFiles') ||\n        template.get('orgFilesWhereAvailable').includes(getState().org.present.get('path'))\n    )\n    .find((template) => template.get('description').trim() === templateName.trim());\n  if (!template) {\n    dispatch(\n      setDisappearingLoadingMessage(\n        `Capture failed: \"${templateName}\" template not found or not available in this file`,\n        8000\n      )\n    );\n    return;\n  }\n\n  const targetHeader = headerWithPath(\n    getState().org.present.getIn(['files', path, 'headers']),\n    template.get('headerPaths')\n  );\n  if (!targetHeader) {\n    dispatch(\n      setDisappearingLoadingMessage(\n        `Capture failed: \"${template.get('description')}\" header path invalid in this file`,\n        8000\n      )\n    );\n    return;\n  }\n\n  const [substitutedTemplate, initialCursorIndex] = substituteTemplateVariables(\n    template.get('template'),\n    customCaptureVariables\n  );\n\n  const content = !!initialCursorIndex\n    ? `${substitutedTemplate.substring(\n        0,\n        initialCursorIndex\n      )}${captureContent}${substitutedTemplate.substring(initialCursorIndex)}`\n    : `${substitutedTemplate}${captureContent}`;\n\n  dispatch(insertCapture(template.get('id'), content, template.get('shouldPrepend')));\n  dispatch(sync({ successMessage: 'Item captured' }));\n};\n\nexport const advanceCheckboxState = (listItemId) => ({\n  type: 'ADVANCE_CHECKBOX_STATE',\n  listItemId,\n  dirtying: true,\n});\n\nexport const setSelectedListItemId = (listItemId) => (dispatch) => {\n  dispatch({ type: 'SET_SELECTED_LIST_ITEM_ID', listItemId });\n\n  if (!!listItemId) {\n    dispatch(selectHeader(null));\n    dispatch(setSelectedTableCellId(null));\n  }\n};\n\nexport const updateListTitleValue = (listItemId, newValue) => ({\n  type: 'UPDATE_LIST_TITLE_VALUE',\n  listItemId,\n  newValue,\n  dirtying: true,\n});\n\nexport const updateListContentsValue = (listItemId, newValue) => ({\n  type: 'UPDATE_LIST_CONTENTS_VALUE',\n  listItemId,\n  newValue,\n  dirtying: true,\n});\n\nexport const addNewListItem = () => ({\n  type: 'ADD_NEW_LIST_ITEM',\n  dirtying: true,\n});\n\nexport const selectNextSiblingListItem = () => ({\n  type: 'SELECT_NEXT_SIBLING_LIST_ITEM',\n});\n\nexport const addNewListItemAndEdit = () => (dispatch) => {\n  dispatch(addNewListItem());\n  dispatch(selectNextSiblingListItem());\n  dispatch(enterEditMode('list-title'));\n};\n\nexport const removeListItem = () => ({\n  type: 'REMOVE_LIST_ITEM',\n  dirtying: true,\n});\n\nexport const moveListItemUp = () => ({\n  type: 'MOVE_LIST_ITEM_UP',\n  dirtying: true,\n});\n\nexport const moveListItemDown = () => ({\n  type: 'MOVE_LIST_ITEM_DOWN',\n  dirtying: true,\n});\n\nexport const moveListItemLeft = () => ({\n  type: 'MOVE_LIST_ITEM_LEFT',\n  dirtying: true,\n});\n\nexport const moveListItemRight = () => ({\n  type: 'MOVE_LIST_ITEM_RIGHT',\n  dirtying: true,\n});\n\nexport const moveListSubtreeLeft = () => ({\n  type: 'MOVE_LIST_SUBTREE_LEFT',\n  dirtying: true,\n});\n\nexport const moveListSubtreeRight = () => ({\n  type: 'MOVE_LIST_SUBTREE_RIGHT',\n  dirtying: true,\n});\n\nexport const setHeaderTags = (headerId, tags) => ({\n  type: 'SET_HEADER_TAGS',\n  headerId,\n  tags,\n  dirtying: true,\n});\n\nexport const reorderTags = (fromIndex, toIndex) => ({\n  type: 'REORDER_TAGS',\n  fromIndex,\n  toIndex,\n  dirtying: true,\n});\n\nexport const reorderPropertyList = (fromIndex, toIndex) => (dispatch, getState) =>\n  dispatch({\n    type: 'REORDER_PROPERTY_LIST',\n    fromIndex,\n    toIndex,\n    headerId: getState().base.getIn(['activePopup', 'data', 'headerId']),\n    dirtying: true,\n  });\n\n/**\n * Action to change the timestamp using a cross-cutting id.\n *\n * @param {*} timestampId cross-cutting id of the timestamp (might be in the title or description).\n * @param {*} newTimestamp the new value for the timestamp;\n *                         must have the form: {id:, type:, firstTimestamp:, secondTimestamp:}.\n */\nexport const updateTimestampWithId = (timestampId, newTimestamp) => ({\n  type: 'UPDATE_TIMESTAMP_WITH_ID',\n  timestampId,\n  newTimestamp,\n  dirtying: true,\n});\n\nexport const updatePlanningItemTimestamp = (headerId, planningItemIndex, newTimestamp) => ({\n  type: 'UPDATE_PLANNING_ITEM_TIMESTAMP',\n  headerId,\n  planningItemIndex,\n  newTimestamp,\n  dirtying: true,\n});\n\nexport const addNewPlanningItem = (headerId, planningType) => ({\n  type: 'ADD_NEW_PLANNING_ITEM',\n  headerId,\n  planningType,\n  dirtying: true,\n  timestamp: new Date(),\n});\n\nexport const removePlanningItem = (headerId, planningItemIndex) => ({\n  type: 'REMOVE_PLANNING_ITEM',\n  headerId,\n  planningItemIndex,\n  dirtying: true,\n});\n\nexport const removeTimestamp = (headerId, timestampId) => ({\n  type: 'REMOVE_TIMESTAMP',\n  headerId,\n  timestampId,\n  dirtying: true,\n});\n\nexport const updatePropertyListItems = (headerId, newPropertyListItems) => ({\n  type: 'UPDATE_PROPERTY_LIST_ITEMS',\n  headerId,\n  newPropertyListItems,\n  dirtying: true,\n});\n\nexport const setOrgFileErrorMessage = (message) => ({\n  type: 'SET_ORG_FILE_ERROR_MESSAGE',\n  message,\n});\n\nexport const setLogEntryStop = (headerId, entryId, time) => ({\n  type: 'SET_LOG_ENTRY_STOP',\n  headerId,\n  entryId,\n  time,\n  dirtying: true,\n});\n\nexport const createLogEntryStart = (headerId, time) => ({\n  type: 'CREATE_LOG_ENTRY_START',\n  headerId,\n  time,\n  dirtying: true,\n});\n\nexport const updateLogEntryTime = (headerId, entryIndex, entryType, newTime) => ({\n  type: 'UPDATE_LOG_ENTRY_TIME',\n  headerId,\n  entryIndex,\n  entryType,\n  newTime,\n  dirtying: true,\n});\n\nexport const setSearchFilterInformation = (searchFilter, cursorPosition, context) => ({\n  type: 'SET_SEARCH_FILTER_INFORMATION',\n  searchFilter,\n  cursorPosition,\n  context,\n});\n\nexport const setShowClockDisplay = (showClockDisplay) => ({\n  type: 'TOGGLE_CLOCK_DISPLAY',\n  showClockDisplay,\n});\n\nexport const updateFileSettingFieldPathValue = (settingId, fieldPath, newValue) => ({\n  type: 'UPDATE_FILE_SETTING_FIELD_PATH_VALUE',\n  settingId,\n  fieldPath,\n  newValue,\n});\n\nexport const reorderFileSetting = (fromIndex, toIndex) => ({\n  type: 'REORDER_FILE_SETTING',\n  fromIndex,\n  toIndex,\n});\n\nexport const deleteFileSetting = (settingId) => ({\n  type: 'DELETE_FILE_SETTING',\n  settingId,\n});\n\nexport const addNewEmptyFileSetting = () => (dispatch) =>\n  dispatch({ type: 'ADD_NEW_EMPTY_FILE_SETTING' });\n\nexport const restoreFileSettings = (newSettings) => ({\n  type: 'RESTORE_FILE_SETTINGS',\n  newSettings,\n});\n\nexport const saveBookmark = (context, bookmark) => ({\n  type: 'SAVE_BOOKMARK',\n  context,\n  bookmark,\n});\n\nexport const deleteBookmark = (context, bookmark) => ({\n  type: 'DELETE_BOOKMARK',\n  context,\n  bookmark,\n});\n\nexport const addNewFile = (path, content) => ({\n  type: 'ADD_NEW_FILE',\n  path,\n  content,\n});\n","import { sync } from '../actions/org';\nimport { persistIsDirty, saveFileToLocalStorage } from '../util/file_persister';\nimport { determineAffectedFiles } from '../reducers/org';\n\nexport default (store) => (next) => (action) => {\n  // middleware is run before the reducer. to persist the result of the action,\n  // save and sync are done in a callback so they happen after the state is changed\n  setTimeout(() => {\n    let dirtyFiles = determineAffectedFiles(store.getState().org.present, action);\n\n    dirtyFiles.forEach((path) => saveFileToLocalStorage(store.getState(), path));\n    dirtyFiles.forEach((path) => persistIsDirty(true, path));\n\n    if (store.getState().base.get('shouldLiveSync')) {\n      dirtyFiles.forEach((path) => store.dispatch(sync({ shouldSuppressMessages: true, path })));\n    }\n  }, 0);\n\n  return next(action);\n};\n","import { setColorScheme } from '../actions/base';\n\nexport default (store) => (next) => (action) => {\n  // Watch if the user changes the preferred color scheme through the\n  // OS or browser.\n\n  // Returns a MediaQueryList object\n  const prefersColorSchemeMediaQueryList = window.matchMedia('(prefers-color-scheme: dark)');\n\n  // Feature detection. If there's no dark mode (i.e. iOS <14), then\n  // the `matchMedia` query above does not resolve in anything that\n  // can be observed.\n  if ('addEventListener' in prefersColorSchemeMediaQueryList) {\n    prefersColorSchemeMediaQueryList.addEventListener('change', (e) => {\n      const selectedColorScheme = e.matches ? 'Dark' : 'Light';\n      store.dispatch(setColorScheme(selectedColorScheme));\n    });\n  }\n\n  return next(action);\n};\n","import { Map, List, fromJS } from 'immutable';\n\nimport { applyCategorySettingsFromConfig } from '../util/settings_persister';\n\nconst setLoadingMessage = (state, action) => state.set('loadingMessage', action.loadingMessage);\n\nconst hideLoadingMessage = (state) => state.set('loadingMessage', null);\n\nconst setFontSize = (state, action) => state.set('fontSize', action.newFontSize);\n\nconst setBulletStyle = (state, action) => state.set('bulletStyle', action.newBulletStyle);\n\nconst setShouldTapTodoToAdvance = (state, action) =>\n  state.set('shouldTapTodoToAdvance', action.newShouldTapTodoToAdvance);\n\nconst setAgendaDefaultDeadlineDelayUnit = (state, action) =>\n  state.set('agendaDefaultDeadlineDelayUnit', action.newAgendaDefaultDeadlineDelayUnit);\n\nconst setAgendaDefaultDeadlineDelayValue = (state, action) =>\n  state.set('agendaDefaultDeadlineDelayValue', action.newAgendaDefaultDeadlineDelayValue);\n\nconst setEditorDescriptionHeightValue = (state, action) =>\n  state.set('editorDescriptionHeightValue', action.newEditorDescriptionHeightValue);\n\nconst setAgendaStartOnWeekday = (state, action) =>\n  state.set('agendaStartOnWeekday', action.newAgendaStartOnWeekday);\n\nconst setShouldStoreSettingsInSyncBackend = (state, action) =>\n  state.set('shouldStoreSettingsInSyncBackend', action.newShouldStoreSettingsInSyncBackend);\n\nconst setShouldLiveSync = (state, action) => state.set('shouldLiveSync', action.shouldLiveSync);\n\nconst setShowDeadlineDisplay = (state, action) =>\n  state.set('showDeadlineDisplay', action.showDeadlineDisplay);\n\nconst setShouldSyncOnBecomingVisibile = (state, action) =>\n  state.set('shouldSyncOnBecomingVisibile', action.shouldSyncOnBecomingVisibile);\n\nconst setShouldShowTitleInOrgFile = (state, action) =>\n  state.set('shouldShowTitleInOrgFile', action.shouldShowTitleInOrgFile);\n\nconst setShouldLogIntoDrawer = (state, action) =>\n  state.set('shouldLogIntoDrawer', action.shouldLogIntoDrawer);\n\nconst setCloseSubheadersRecursively = (state, action) =>\n  state.set('closeSubheadersRecursively', action.closeSubheadersRecursively);\n\n/**\n * When enabled, keep all heading body text flush-left. When disabled (the\n * default) indent the body text of headings according to the nesting level of\n * the heading.\n */\nconst setShouldNotIndentOnExport = (state, action) =>\n  state.set('shouldNotIndentOnExport', action.shouldNotIndentOnExport);\n\nconst setHasUnseenChangelog = (state, action) =>\n  state.set('hasUnseenChangelog', action.newHasUnseenChangelog);\n\nconst setLastSeenChangelogHeader = (state, action) =>\n  state.set('lastSeenChangelogHash', action.newLastSeenChangelogHash);\n\nconst setLastViewedFile = (state, action) => state.set('lastViewedPath', action.lastViewedPath);\n\nconst setCustomKeybinding = (state, action) => {\n  if (!state.get('customKeybindings')) {\n    state = state.set('customKeybindings', Map());\n  }\n\n  return state.setIn(['customKeybindings', action.keybindingName], action.keybinding);\n};\n\nconst restoreBaseSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n  return applyCategorySettingsFromConfig(state, action.newSettings, 'base');\n};\n\nconst pushModalPage = (state, action) =>\n  state.update('modalPageStack', (stack) =>\n    !!stack ? stack.push(action.modalPage) : List([action.modalPage])\n  );\n\nconst popModalPage = (state) =>\n  state.update('modalPageStack', (stack) => (!!stack ? stack.pop() : stack));\n\nconst clearModalStack = (state) => state.set('modalPageStack', List());\n\nconst activatePopup = (state, action) => {\n  const { data, popupType } = action;\n\n  // Remember active popup in URL state for popups that are uniquely\n  // identifiable (aka not related to a single header like tags,\n  // properties or timestamps).\n  if (['search', 'task-list', 'agenda'].includes(popupType)) {\n    window.history.replaceState({}, '', `${window.location.pathname}#${popupType}`);\n  }\n\n  return state.set(\n    'activePopup',\n    fromJS({\n      type: popupType,\n      data,\n    })\n  );\n};\n\nconst closePopup = (state) => {\n  window.history.replaceState(\n    '',\n    document.title,\n    window.location.pathname + window.location.search\n  );\n  return state.set('activePopup', null);\n};\n\nconst setIsLoading = (state, action) => {\n  if (action.isLoading) {\n    return state.update('isLoading', (isLoading) => isLoading.add(action.path));\n  } else {\n    return state.update('isLoading', (isLoading) => isLoading.delete(action.path));\n  }\n};\n\nconst setIsOnline = (state, action) => {\n  return state.set('online', action.online);\n};\n\nconst setAgendaTimeframe = (state, action) => state.set('agendaTimeframe', action.agendaTimeframe);\n\nconst setFinderTab = (state, action) => state.set('finderTab', action.finderTab);\n\nconst setPreferEditRawValues = (state, action) =>\n  state.set('preferEditRawValues', action.preferEditRawValues);\n\nconst setColorScheme = (state, action) => {\n  return state.set('colorScheme', action.colorScheme);\n};\n\nconst setTheme = (state, action) => {\n  return state.set('theme', action.theme);\n};\n\n/**\n * Reducer that is responsible for the \"base\" state slice.\n */\nexport default (state = Map(), action) => {\n  switch (action.type) {\n    case 'SET_LOADING_MESSAGE':\n      return setLoadingMessage(state, action);\n    case 'HIDE_LOADING_MESSAGE':\n      return hideLoadingMessage(state, action);\n    case 'SET_FONT_SIZE':\n      return setFontSize(state, action);\n    case 'SET_BULLET_STYLE':\n      return setBulletStyle(state, action);\n    case 'SET_SHOULD_TAP_TODO_TO_ADVANCE':\n      return setShouldTapTodoToAdvance(state, action);\n    case 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT':\n      return setAgendaDefaultDeadlineDelayUnit(state, action);\n    case 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE':\n      return setAgendaDefaultDeadlineDelayValue(state, action);\n    case 'SET_EDITOR_DESCRIPTION_HEIGHT_VALUE':\n      return setEditorDescriptionHeightValue(state, action);\n    case 'SET_AGENDA_START_ON_WEEKDAY':\n      return setAgendaStartOnWeekday(state, action);\n    case 'SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND':\n      return setShouldStoreSettingsInSyncBackend(state, action);\n    case 'SET_COLOR_SCHEME':\n      return setColorScheme(state, action);\n    case 'SET_THEME':\n      return setTheme(state, action);\n    case 'SET_SHOULD_LIVE_SYNC':\n      return setShouldLiveSync(state, action);\n    case 'SET_SHOW_DEADLINE_DISPLAY':\n      return setShowDeadlineDisplay(state, action);\n    case 'SET_SHOULD_SYNC_ON_BECOMING_VISIBLE':\n      return setShouldSyncOnBecomingVisibile(state, action);\n    case 'SET_SHOULD_SHOW_TITLE_IN_ORG_FILE':\n      return setShouldShowTitleInOrgFile(state, action);\n    case 'SET_SHOULD_LOG_INTO_DRAWER':\n      return setShouldLogIntoDrawer(state, action);\n    case 'SET_CLOSE_SUBHEADERS_RECURSIVELY':\n      return setCloseSubheadersRecursively(state, action);\n    case 'SET_SHOULD_NOT_INDENT_ON_EXPORT':\n      return setShouldNotIndentOnExport(state, action);\n    case 'SET_HAS_UNSEEN_CHANGELOG':\n      return setHasUnseenChangelog(state, action);\n    case 'SET_LAST_SEEN_CHANGELOG_HEADER':\n      return setLastSeenChangelogHeader(state, action);\n    case 'SET_LAST_VIEWED_FILE':\n      return setLastViewedFile(state, action);\n    case 'SET_CUSTOM_KEYBINDING':\n      return setCustomKeybinding(state, action);\n    case 'RESTORE_BASE_SETTINGS':\n      return restoreBaseSettings(state, action);\n    case 'PUSH_MODAL_PAGE':\n      return pushModalPage(state, action);\n    case 'POP_MODAL_PAGE':\n      return popModalPage(state, action);\n    case 'CLEAR_MODAL_STACK':\n      return clearModalStack(state, action);\n    case 'ACTIVATE_POPUP':\n      return activatePopup(state, action);\n    case 'CLOSE_POPUP':\n      return closePopup(state, action);\n    case 'SET_IS_LOADING':\n      return setIsLoading(state, action);\n    case 'SET_IS_ONLINE':\n      return setIsOnline(state, action);\n    case 'SET_AGENDA_TIMEFRAME':\n      return setAgendaTimeframe(state, action);\n    case 'SET_FINDER_TAB':\n      return setFinderTab(state, action);\n    case 'PREFER_EDIT_RAW_VALUES':\n      return setPreferEditRawValues(state, action);\n    default:\n      return state;\n  }\n};\n","import { Map, List, fromJS } from 'immutable';\n\nimport generateId from '../lib/id_generator';\nimport { applyCaptureSettingsFromConfig } from '../util/settings_persister';\n\nconst indexOfTemplateWithId = (templates, templateId) =>\n  templates.findIndex((template) => template.get('id') === templateId);\n\nconst addNewEmptyCaptureTemplate = (state) => {\n  if (!state.get('captureTemplates')) {\n    state = state.set('captureTemplates', List());\n  }\n\n  return state.update('captureTemplates', (templates) =>\n    templates.push(\n      fromJS({\n        id: generateId(),\n        description: '',\n        letter: '',\n        iconName: '',\n        isAvailableInAllOrgFiles: true,\n        file: '',\n        orgFilesWhereAvailable: [''],\n        headerPaths: [''],\n        shouldPrepend: false,\n        template: '',\n      })\n    )\n  );\n};\n\nconst updateTemplateFieldPathValue = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.setIn(['captureTemplates', templateIndex].concat(action.fieldPath), action.newValue);\n};\n\nconst addNewTemplateOrgFileAvailability = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'orgFilesWhereAvailable'], (orgFiles) =>\n    orgFiles.push('')\n  );\n};\n\nconst removeTemplateOrgFileAvailability = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'orgFilesWhereAvailable'], (orgFiles) =>\n    orgFiles.delete(action.orgFileAvailabilityIndex)\n  );\n};\n\nconst addNewTemplateHeaderPath = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'headerPaths'], (headerPaths) =>\n    headerPaths.push('')\n  );\n};\n\nconst removeTemplateHeaderPath = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'headerPaths'], (headerPaths) =>\n    headerPaths.delete(action.headerPathIndex)\n  );\n};\n\nconst deleteTemplate = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.update('captureTemplates', (templates) => templates.delete(templateIndex));\n};\n\nconst restoreCaptureSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n\n  return applyCaptureSettingsFromConfig(state, action.newSettings);\n};\n\nconst reorderCaptureTemplate = (state, action) =>\n  state.update('captureTemplates', (templates) =>\n    templates.splice(action.fromIndex, 1).splice(action.toIndex, 0, templates.get(action.fromIndex))\n  );\n\nexport default (state = Map(), action) => {\n  switch (action.type) {\n    case 'ADD_NEW_EMPTY_CAPTURE_TEMPLATE':\n      return addNewEmptyCaptureTemplate(state, action);\n    case 'UPDATE_TEMPLATE_FIELD_PATH_VALUE':\n      return updateTemplateFieldPathValue(state, action);\n    case 'ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY':\n      return addNewTemplateOrgFileAvailability(state, action);\n    case 'REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY':\n      return removeTemplateOrgFileAvailability(state, action);\n    case 'ADD_NEW_TEMPLATE_HEADER_PATH':\n      return addNewTemplateHeaderPath(state, action);\n    case 'REMOVE_TEMPLATE_HEADER_PATH':\n      return removeTemplateHeaderPath(state, action);\n    case 'DELETE_TEMPLATE':\n      return deleteTemplate(state, action);\n    case 'RESTORE_CAPTURE_SETTINGS':\n      return restoreCaptureSettings(state, action);\n    case 'REORDER_CAPTURE_TEMPLATE':\n      return reorderCaptureTemplate(state, action);\n    default:\n      return state;\n  }\n};\n","import { combineReducers } from 'redux';\nimport undoable, { includeAction, ActionCreators, ActionTypes } from 'redux-undo';\n\nimport baseReducer from './base';\nimport syncBackendReducer from './sync_backend';\nimport orgReducer from './org';\nimport captureReducer from './capture';\nimport { setDirty, sync } from '../actions/org';\n\nconst UNDOABLE_ACTIONS = [\n  'ADD_HEADER',\n  'REMOVE_HEADER',\n  'MOVE_HEADER_UP',\n  'MOVE_HEADER_DOWN',\n  'MOVE_HEADER_LEFT',\n  'MOVE_HEADER_RIGHT',\n  'MOVE_SUBTREE_LEFT',\n  'MOVE_SUBTREE_RIGHT',\n  'ADVANCE_TODO_STATE',\n  'SET_TODO_STATE',\n  'UPDATE_HEADER_TITLE',\n  'UPDATE_HEADER_DESCRIPTION',\n  'ADD_NEW_TABLE_ROW',\n  'ADD_NEW_TABLE_COLUMN',\n  'REMOVE_TABLE_ROW',\n  'REMOVE_TABLE_COLUMN',\n  'UPDATE_TABLE_CELL_VALUE',\n  'MOVE_TABLE_ROW_DOWN',\n  'MOVE_TABLE_ROW_UP',\n  'MOVE_TABLE_COLUMN_LEFT',\n  'MOVE_TABLE_COLUMN_RIGHT',\n  'INSERT_CAPTURE',\n  'REFILE_SUBTREE',\n  'HEADER_ADD_NOTE',\n  'SET_HEADER_TAGS',\n  'UPDATE_PROPERTY_LIST_ITEMS',\n  'ADD_NEW_PLANNING_ITEM',\n  'REMOVE_PLANNING_ITEM',\n  'CREATE_LOG_ENTRY_START',\n  'SET_LOG_ENTRY_STOP',\n  'ADD_NEW_LIST_ITEM',\n  'REMOVE_LIST_ITEM',\n  'MOVE_LIST_ITEM_UP',\n  'MOVE_LIST_ITEM_DOWN',\n  'MOVE_LIST_ITEM_LEFT',\n  'MOVE_LIST_ITEM_RIGHT',\n  'MOVE_LIST_SUBTREE_LEFT',\n  'MOVE_LIST_SUBTREE_RIGHT',\n];\n\n// INFO: An `undo` in organice is always related to changing the Org\n// file structure. Hence, it is necessary to trigger a `sync` action.\n// This needs a little extra work, because this `sync` would result in\n// a conflict: The state is now in the `past` the Org file has been\n// synchronized in the `future`. Hence the `lastModifiedAt` timestamp\n// will be in the future and organice won't see a reason to push. Even\n// if we wanted to push, organice would show the 'conflict' modal,\n// because the remote file is newer. For this reason, when doing an\n// 'undo', organice will suppress this modal and 'force' a push. We\n// don't want the user to need to understand that an 'undo' means\n// moving to the past and the conflict has been created by herself in\n// the future (which in real life might have been seconds ago).\n\n// Implementation: Override the redux-undo `undo` and `redo` action creators. Additionally to the redux `undo`, they will force a sync, always.\nActionCreators.undo = function () {\n  return (dispatch) => {\n    dispatch({ type: ActionTypes.UNDO });\n    dispatch(setDirty(true));\n    dispatch(sync({ forceAction: 'push' }));\n  };\n};\n\nActionCreators.redo = function () {\n  return (dispatch) => {\n    dispatch({ type: ActionTypes.REDO });\n    dispatch(setDirty(true));\n    dispatch(sync({ forceAction: 'push' }));\n  };\n};\n\nexport default combineReducers({\n  base: baseReducer,\n  syncBackend: syncBackendReducer,\n  org: undoable(orgReducer, {\n    filter: includeAction(UNDOABLE_ACTIONS),\n  }),\n  capture: captureReducer,\n});\n","import { Map } from 'immutable';\n\nconst signOut = (state) => state.set('isAuthenticated', false).set('client', null);\n\nconst setCurrentFileBrowserDirectoryListing = (state, action) =>\n  state\n    .set(\n      'currentFileBrowserDirectoryListing',\n      Map({\n        listing: action.directoryListing,\n        hasMore: action.hasMore,\n        additionalSyncBackendState: action.additionalSyncBackendState,\n      })\n    )\n    .set('currentPath', action.path);\n\nconst setIsLoadingMoreDirectoryListing = (state, action) =>\n  state\n    .update('currentFileBrowserDirectoryListing', (currentFileBrowserDirectoryListing) =>\n      !!currentFileBrowserDirectoryListing ? currentFileBrowserDirectoryListing : Map()\n    )\n    .setIn(['currentFileBrowserDirectoryListing', 'isLoadingMore'], action.isLoadingMore);\n\nexport default (state = Map(), action) => {\n  switch (action.type) {\n    case 'SIGN_OUT':\n      return signOut(state);\n    case 'SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING':\n      return setCurrentFileBrowserDirectoryListing(state, action);\n    case 'SET_IS_LOADING_MORE_DIRECTORY_LISTING':\n      return setIsLoadingMoreDirectoryListing(state, action);\n    default:\n      return state;\n  }\n};\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport thunk from 'redux-thunk';\nimport liveSync from './middleware/live_sync';\nimport toggleColorScheme from './middleware/toggle_color_scheme';\nimport rootReducer from './reducers';\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nexport default (initialState) =>\n  createStore(\n    rootReducer,\n    initialState,\n    composeEnhancers(applyMiddleware(thunk, liveSync, toggleColorScheme))\n  );\n","const parseQueryString = (str) => {\n  var ret = Object.create(null);\n\n  if (typeof str !== 'string') {\n    return ret;\n  }\n\n  str = str.trim().replace(/^(\\?|#|&)/, '');\n\n  if (!str) {\n    return ret;\n  }\n\n  str.split('&').forEach(function (param) {\n    var parts = param.replace(/\\+/g, ' ').split('=');\n    // Firefox (pre 40) decodes `%3D` to `=`\n    // https://github.com/sindresorhus/query-string/pull/37\n    var key = parts.shift();\n    var val = parts.length > 0 ? parts.join('=') : undefined;\n\n    key = decodeURIComponent(key);\n\n    // missing `=` should be `null`:\n    // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n    val = val === undefined ? null : decodeURIComponent(val);\n\n    if (ret[key] === undefined) {\n      ret[key] = val;\n    } else if (Array.isArray(ret[key])) {\n      ret[key].push(val);\n    } else {\n      ret[key] = [ret[key], val];\n    }\n  });\n\n  return ret;\n};\n\nexport default parseQueryString;\n","import migrateAccessTokenToDropboxAccessToken from './migrate_access_token_to_dropbox_access_token';\nimport migrateStoreInDropboxToStoreInSyncBackend from './migrate_store_in_dropbox_to_store_in_sync_backend';\nimport migrateNonsenseValuesInLocalstorage from './migrate_nonsense_values_in_localstorage';\n\nexport default () => {\n  migrateAccessTokenToDropboxAccessToken();\n  migrateStoreInDropboxToStoreInSyncBackend();\n  migrateNonsenseValuesInLocalstorage();\n};\n","import { localStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!localStorageAvailable) {\n    return;\n  }\n\n  const accessToken = localStorage.getItem('accessToken');\n  if (!accessToken) {\n    return;\n  }\n\n  localStorage.setItem('dropboxAccessToken', accessToken);\n  localStorage.removeItem('accessToken');\n};\n","import { localStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!localStorageAvailable) {\n    return;\n  }\n\n  const shouldStoreSettingsInDropbox = localStorage.getItem('shouldStoreSettingsInDropbox');\n  if (!shouldStoreSettingsInDropbox) {\n    return;\n  }\n\n  localStorage.setItem('shouldStoreSettingsInSyncBackend', shouldStoreSettingsInDropbox);\n  localStorage.removeItem('shouldStoreSettingsInDropbox');\n};\n","import { localStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!localStorageAvailable) {\n    return;\n  }\n\n  Object.entries(localStorage).forEach(([k, v], _) => {\n    if (['null', 'undefined'].includes(v)) {\n      console.warn(`localStorage contains a bogus entry: '${k}': '${v}'`);\n      console.warn('Deleting the bogus entry.');\n      localStorage.removeItem(k);\n    }\n  });\n};\n","/* global process */\n\nimport { OAuth2AuthCodePKCE } from '@bity/oauth2-auth-code-pkce';\nimport { orgFileExtensions } from '../lib/org_utils';\nimport { getPersistedField } from '../util/settings_persister';\n\nimport { fromJS, Map } from 'immutable';\n\nexport const createGitlabOAuth = () => {\n  // Use promises as mutex to prevent concurrent token refresh attempts, which causes problems.\n  // More info: https://github.com/BitySA/oauth2-auth-code-pkce/issues/29\n  // TODO: remove this workaround if/when oauth2-auth-code-pkce fixes the issue.\n  let expiryPromise;\n  let invalidGrantPromise;\n  return new OAuth2AuthCodePKCE({\n    authorizationUrl: 'https://gitlab.com/oauth/authorize',\n    tokenUrl: 'https://gitlab.com/oauth/token',\n    clientId: process.env.REACT_APP_GITLAB_CLIENT_ID,\n    redirectUrl: window.location.origin,\n    scopes: ['api'],\n    extraAuthorizationParams: {\n      clientSecret: process.env.REACT_APP_GITLAB_SECRET,\n    },\n    onAccessTokenExpiry: async (refreshToken) => {\n      if (!expiryPromise) {\n        expiryPromise = refreshToken();\n      }\n      const result = await expiryPromise;\n      expiryPromise = undefined;\n      return result;\n    },\n    onInvalidGrant: async (refreshAuthCodeOrToken) => {\n      if (!invalidGrantPromise) {\n        invalidGrantPromise = refreshAuthCodeOrToken();\n      }\n      // This is a void promise, so don't need to return the result. Refer to the TypeScript source\n      // of OAuth2AuthCodePKCE. Types are great.\n      await invalidGrantPromise;\n      invalidGrantPromise = undefined;\n    },\n  });\n};\n\n/**\n * Convert project URL to identifier for use with API, since explaining how to find the ID of a\n * project is unnecessarily confusing for users.\n *\n * @see https://docs.gitlab.com/ee/api/projects.html#get-single-project\n * @param {string} projectURL Full URL for project, such as gitlab.com/foo/bar/baz. Leading https:// is\n * optional.\n * @returns {string|undefined} Project ID if `projectURL` appears to be a gitlab.com project and\n * parsing succeeded, otherwise undefined.\n */\nexport const gitLabProjectIdFromURL = (projectURL) => {\n  if (!projectURL) return;\n\n  if (!projectURL.includes('://')) {\n    // URL() class requires protocol.\n    projectURL = `https://${projectURL}`;\n  }\n  try {\n    const url = new URL(projectURL);\n    const path = url.pathname.replace(/(^\\/)|(\\/$)/g, '');\n    // Rough heuristic to check that url at least *potentially* refers\n    // to a project. Reminder: a project path is not necessarily\n    // /user/project because it may be under one or more groups such\n    // as /user/group/subgroup/project.\n    if (url.hostname === 'gitlab.com' && path.split('/').length > 1) {\n      return encodeURIComponent(path);\n    } else {\n      return undefined;\n    }\n  } catch (e) {\n    console.error('Error trying to get gitLab project_id from URL:');\n    console.error(e);\n    return undefined;\n  }\n};\n\n/**\n * Parse 'link' pagination response header.\n *\n * @see https://docs.gitlab.com/ee/api/index.html#keyset-based-pagination\n * @param {string|null} links raw header value\n * @return {Object.<string, string>} Key-value mapping of link name to url. Empty object if none.\n */\nexport const parseLinkHeader = (links) => {\n  if (!links) {\n    return {};\n  }\n  // Based on https://stackoverflow.com/a/48109741\n  return links.split(',').reduce((acc, link) => {\n    const match = link.match(/<(.*)>; rel=\"(\\w*)\"/);\n    const url = match[1];\n    const rel = match[2];\n    acc[rel] = url;\n    return acc;\n  }, {});\n};\n\n/**\n * Converts response from GitLab's list repo tree API into organice format.\n *\n * @see https://docs.gitlab.com/ee/api/repositories.html#list-repository-tree\n */\nexport const treeToDirectoryListing = (tree) => {\n  const isDirectory = (it) => it.type === 'tree';\n  return fromJS(\n    tree\n      .filter((it) => isDirectory(it) || it.name.match(orgFileExtensions))\n      .map((it) => ({\n        id: it.id,\n        name: it.name,\n        // Organice requires a leading \"/\", whereas GitLab API doesn't\n        // use one.\n        path: `/${it.path}`,\n        isDirectory: isDirectory(it),\n      }))\n      .sort((a, b) => {\n        // Folders first.\n        if (a.isDirectory && !b.isDirectory) {\n          return -1;\n        } else if (!a.isDirectory && b.isDirectory) {\n          return 1;\n        } else {\n          // Can't have same name, so don't need to check if\n          // equal/return 0.\n          return a.name > b.name ? 1 : -1;\n        }\n      })\n  );\n};\n\nconst API_URL = 'https://gitlab.com/api/v4';\n\n/**\n * GitLab sync backend, implemented using their REST API.\n *\n * @see https://docs.gitlab.com/ee/api/api_resources.html\n * @param {OAuth2AuthCodePKCE} oauthClient\n */\nexport default (oauthClient) => {\n  const decoratedFetch = oauthClient.decorateFetchHTTPClient(fetch);\n\n  const getProjectApi = () => `${API_URL}/projects/${getPersistedField('gitLabProject')}`;\n\n  const isSignedIn = async () => {\n    if (!oauthClient.isAuthorized()) {\n      return false;\n    }\n    // Verify that we have an OAuth token (and refresh if needed).\n    // Don't care about return value, because the library handles\n    // persisting for us.\n    try {\n      await oauthClient.getAccessToken();\n      return true;\n    } catch (e) {\n      console.error('Error trying to get OAuth access token.');\n      console.error(e);\n      return false;\n    }\n  };\n\n  /**\n   * Check that project exists and user is *probably* able to commit\n   * to it. This doesn't take branch protection into consideration, so\n   * it's not perfect... but who uses protected branches for the org\n   * files?\n   *\n   * This is separate from `isSignedIn` to avoid the overhead of\n   * multiple API calls every time the page is loaded.\n   */\n  const isProjectAccessible = async () => {\n    // Check project exists and user is a member who can *probably*\n    // commit.\n    const [userResponse, membersResponse] = await Promise.all([\n      // https://docs.gitlab.com/ee/api/users.html#list-current-user-for-normal-users\n      decoratedFetch(`${API_URL}/user`),\n      // https://docs.gitlab.com/ee/api/members.html#list-all-members-of-a-group-or-project\n      decoratedFetch(`${getProjectApi()}/members`),\n    ]);\n    if (!userResponse.ok || !membersResponse.ok) {\n      return false;\n    }\n    const [user, members] = await Promise.all([userResponse.json(), membersResponse.json()]);\n    const matched = members.find((m) => m.id === user.id);\n    // Access levels:\n    // https://docs.gitlab.com/ee/api/members.html#valid-access-levels\n    // Permissions:\n    // https://docs.gitlab.com/ee/user/permissions.html#project-members-permissions\n    // 30 is developer, which is the minimum to commit to a\n    // non-protected branch. If branch is protected then they still\n    // might be be able to commit, but this is good enough.\n    return matched && matched.access_level >= 30;\n  };\n\n  let cachedDefaultBranch;\n  const getDefaultBranch = async () => {\n    if (!cachedDefaultBranch) {\n      // https://docs.gitlab.com/ee/api/projects.html#get-single-project\n      const response = await decoratedFetch(getProjectApi());\n      if (!response.ok) {\n        throw new Error(`Unexpected response from project API. Status code: ${response.status}`);\n      }\n      const body = await response.json();\n      cachedDefaultBranch = body.default_branch;\n    }\n    return cachedDefaultBranch;\n  };\n\n  const fetchDirectory = async (url) => {\n    const response = await decoratedFetch(url);\n    if (!response.ok) {\n      throw new Error(`Unexpected response from directory API. Status code: ${response.status}`);\n    }\n    const pages = parseLinkHeader(response.headers.get('link'));\n    const data = await response.json();\n    return {\n      listing: treeToDirectoryListing(data),\n      hasMore: !!pages.next,\n      additionalSyncBackendState: Map({\n        cursor: pages.next,\n      }),\n    };\n  };\n\n  const getDirectoryListing = async (path) => {\n    const params = new URLSearchParams({\n      pagination: 'keyset',\n      ref: await getDefaultBranch(),\n      // Organice requires a leading \"/\", whereas GitLab API requires\n      // there *not* be one.\n      path: path.replace(/^\\//, ''),\n      per_page: 100,\n    });\n    // https://docs.gitlab.com/ee/api/repositories.html#list-repository-tree\n    return await fetchDirectory(`${getProjectApi()}/repository/tree?${params}`);\n  };\n\n  const getMoreDirectoryListing = async (additionalSyncBackendState) =>\n    await fetchDirectory(additionalSyncBackendState.get('cursor'));\n\n  const getRawFile = async (path) => {\n    const params = new URLSearchParams({\n      ref: await getDefaultBranch(),\n    });\n    const encodedPath = encodeURIComponent(path.replace(/^\\//, ''));\n    // https://docs.gitlab.com/ee/api/repository_files.html#get-raw-file-from-repository\n    const response = await decoratedFetch(\n      `${getProjectApi()}/repository/files/${encodedPath}/raw?${params}`\n    );\n    if (!response.ok) {\n      throw new Error(`Unexpected response from file API. Status code: ${response.status}`);\n    }\n    return {\n      contents: await response.text(),\n      commit: response.headers.get('x-gitlab-last-commit-id'),\n    };\n  };\n\n  const getCommitDate = async (sha) => {\n    // https://docs.gitlab.com/ee/api/commits.html#get-a-single-commit\n    const response = await decoratedFetch(\n      `${getProjectApi()}/repository/commits/${sha}?stats=false`\n    );\n    if (!response.ok) {\n      throw new Error(`Unexpected response from commit API. Status code: ${response.status}`);\n    }\n    const body = await response.json();\n    // Dates are ISO-8601. Note: while commit date *should* generally\n    // be the same as or later than the author date, that isn't\n    // guaranteed since history can be rewritten at will. So we pick\n    // the newer of the two.\n    const committed = new Date(body.committed_date);\n    const authored = new Date(body.authored_date);\n    // Use Date objects for comparison, but need to return as strings.\n    return committed > authored ? committed.toISOString() : authored.toISOString();\n  };\n\n  const getFileContentsAndMetadata = async (path) => {\n    const file = await getRawFile(path);\n    return {\n      contents: file.contents,\n      lastModifiedAt: await getCommitDate(file.commit),\n    };\n  };\n\n  // Parentheses are necessarily to await the actual promise. Yay,\n  // foot-guns.\n  const getFileContents = async (path) => (await getRawFile(path)).contents;\n\n  const doCommit = async (action) => {\n    const capitalizedAction = action.action.charAt(0).toUpperCase() + action.action.slice(1);\n    // Two newlines because Git commits should have an empty line\n    // between title and body.\n    const message =\n      `[organice] ${capitalizedAction} ${action.file_path}\\n\\n` +\n      'Automatic commit from organice app.';\n    // It's also possible to modify files using the files API instead\n    // of commits API. For this use case they're about equal, but I\n    // picked commits because it doesn't require non-standard encoding\n    // for file paths, whereas the files API requires URI encoding\n    // plus converting period characters to %2E. Also, the commits API\n    // is more flexible in case of future changes, since it allows\n    // modifying multiple files at a time.\n    //\n    // https://docs.gitlab.com/ee/api/commits.html#create-a-commit-with-multiple-files-and-actions\n    // https://docs.gitlab.com/ee/api/repository_files.html\n    await decoratedFetch(`${getProjectApi()}/repository/commits`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        branch: await getDefaultBranch(),\n        commit_message: message,\n        // Organice only modifies a single file at a time, so only one action.\n        actions: [action],\n        stats: false,\n      }),\n    });\n  };\n\n  const createFile = async (path, content) => {\n    await doCommit({\n      action: 'create',\n      file_path: path.replace(/^\\//, ''),\n      content,\n    });\n  };\n\n  const updateFile = async (path, content) => {\n    await doCommit({\n      action: 'update',\n      file_path: path.replace(/^\\//, ''),\n      content,\n    });\n  };\n\n  const deleteFile = async (path) => {\n    await doCommit({\n      action: 'delete',\n      file_path: path.replace(/^\\//, ''),\n    });\n  };\n\n  return {\n    type: 'GitLab',\n    isSignedIn,\n    isProjectAccessible,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    deleteFile,\n  };\n};\n","import { ActionCreators } from 'redux-undo';\n\nimport { setLoadingMessage, hideLoadingMessage, clearModalStack, setIsLoading } from './base';\nimport { parseFile, setDirty, setLastSyncAt, setOrgFileErrorMessage } from './org';\nimport { localStorageAvailable, persistField } from '../util/settings_persister';\nimport { createGitlabOAuth } from '../sync_backend_clients/gitlab_sync_backend_client';\n\nimport { addSeconds } from 'date-fns';\n\nimport _ from 'lodash';\n\nimport pathParse from 'path-parse';\n\nexport const signOut = () => (dispatch, getState) => {\n  switch (getState().syncBackend.get('client', {}).type) {\n    case 'WebDAV':\n      ['Endpoint', 'Username', 'Password'].forEach((e) => {\n        persistField('webdav' + e, null);\n      });\n      break;\n    case 'Dropbox':\n      // `dropboxAccessToken` is a legacy token that was relevant\n      // prior to switching to OAuth 2 and PKCE. Still deleting it\n      // here for a consistent state in users localStorage.\n      persistField('dropboxAccessToken', null);\n      persistField('dropboxRefreshToken', null);\n      persistField('codeVerifier', null);\n      break;\n    case 'GitLab':\n      persistField('gitLabProject', null);\n      createGitlabOAuth().reset();\n      break;\n    default:\n  }\n\n  persistField('authenticatedSyncService', null);\n\n  dispatch({ type: 'SIGN_OUT' });\n  dispatch(clearModalStack());\n  dispatch(hideLoadingMessage());\n\n  if (localStorageAvailable) {\n    localStorage.clear();\n  }\n};\n\nexport const setCurrentFileBrowserDirectoryListing = (\n  directoryListing,\n  hasMore,\n  additionalSyncBackendState,\n  path\n) => ({\n  type: 'SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING',\n  directoryListing,\n  hasMore,\n  additionalSyncBackendState,\n  path,\n});\n\nexport const setIsLoadingMoreDirectoryListing = (isLoadingMore) => ({\n  type: 'SET_IS_LOADING_MORE_DIRECTORY_LISTING',\n  isLoadingMore,\n});\n\nexport const getDirectoryListing = (path) => (dispatch, getState) => {\n  dispatch(setLoadingMessage('Getting listing...'));\n\n  const client = getState().syncBackend.get('client');\n  client\n    .getDirectoryListing(path)\n    .then(({ listing, hasMore, additionalSyncBackendState }) => {\n      dispatch(\n        setCurrentFileBrowserDirectoryListing(listing, hasMore, additionalSyncBackendState, path)\n      );\n      dispatch(hideLoadingMessage());\n    })\n    .catch((error) => {\n      dispatch(hideLoadingMessage());\n      const error_summary = _.get(error, 'error.error_summary') || '';\n      if ([400, 401].includes(error.status) || error_summary.includes('expired_access_token')) {\n        dispatch(signOut());\n      } else {\n        alert('There was an error retrieving files!');\n        console.error(error);\n      }\n    });\n};\n\nexport const loadMoreDirectoryListing = () => (dispatch, getState) => {\n  dispatch(setIsLoadingMoreDirectoryListing(true));\n\n  const client = getState().syncBackend.get('client');\n  const currentFileBrowserDirectoryListing = getState().syncBackend.get(\n    'currentFileBrowserDirectoryListing'\n  );\n  client\n    .getMoreDirectoryListing(currentFileBrowserDirectoryListing.get('additionalSyncBackendState'))\n    .then(({ listing, hasMore, additionalSyncBackendState }) => {\n      const extendedListing = currentFileBrowserDirectoryListing.get('listing').concat(listing);\n      dispatch(\n        setCurrentFileBrowserDirectoryListing(extendedListing, hasMore, additionalSyncBackendState)\n      );\n      dispatch(setIsLoadingMoreDirectoryListing(false));\n    });\n};\n\nexport const pushBackup = (pathOrFileId, contents) => {\n  return (dispatch, getState) => {\n    const client = getState().syncBackend.get('client');\n    switch (client.type) {\n      case 'Dropbox':\n      case 'WebDAV':\n        client.createFile(`${pathOrFileId}.organice-bak`, contents);\n        break;\n      case 'GitLab':\n        // No-op for GitLab, because the beauty of version control makes backup files redundant.\n        break;\n      default:\n    }\n  };\n};\n\nexport const downloadFile = (path) => {\n  return (dispatch, getState) => {\n    dispatch(setLoadingMessage(`Downloading file ...`));\n    getState()\n      .syncBackend.get('client')\n      .getFileContents(path)\n      .then((fileContents) => {\n        dispatch(hideLoadingMessage());\n        dispatch(pushBackup(path, fileContents));\n        dispatch(parseFile(path, fileContents));\n        dispatch(setLastSyncAt(addSeconds(new Date(), 5), path));\n        dispatch(setDirty(false, path));\n        dispatch(ActionCreators.clearHistory());\n      })\n      .catch(() => {\n        dispatch(hideLoadingMessage());\n        dispatch(setIsLoading(false, path));\n        dispatch(setOrgFileErrorMessage(`File ${path} not found`));\n      });\n  };\n};\n\n/**\n * @param {String} path Returns the directory name of `path`.\n */\nfunction dirName(path) {\n  return pathParse(path).dir;\n}\n\nexport const createFile = (path, content) => {\n  return (dispatch, getState) => {\n    dispatch(setLoadingMessage(`Creating file: ${path}`));\n    getState()\n      .syncBackend.get('client')\n      .createFile(path, content)\n      .then(() => {\n        dispatch(setLastSyncAt(addSeconds(new Date(), 5), path));\n        dispatch(hideLoadingMessage());\n        dispatch(getDirectoryListing(dirName(path)));\n      })\n      .catch(() => {\n        dispatch(hideLoadingMessage());\n        dispatch(setIsLoading(false, path));\n        dispatch(setOrgFileErrorMessage(`File ${path} not found`));\n      });\n  };\n};\n","/* global process */\n\nimport { isEmpty } from 'lodash';\nimport { orgFileExtensions } from '../lib/org_utils';\n\nimport { persistField, getPersistedField } from '../util/settings_persister';\n\nimport { Dropbox } from 'dropbox';\n\nimport parseQueryString from '../util/parse_query_string';\n\nimport { fromJS, Map } from 'immutable';\n\n/**\n * Gets a directory listing ready to be rendered by organice.\n *  - Filters files from `listing` down to org files.\n *  - Sorts folders atop of files.\n *  - Sorts both folders and files alphabetically.\n * @param {Array} listing\n */\nexport const filterAndSortDirectoryListing = (listing) => {\n  const filteredListing = listing.filter((file) => {\n    // Show all folders\n    if (file['.tag'] === 'folder') return true;\n    // Filter out all non-org files\n    return file.name.match(orgFileExtensions);\n  });\n  return filteredListing.sort((a, b) => {\n    // Folders before files\n    if (a['.tag'] === 'folder' && b['.tag'] === 'file') {\n      return -1;\n    } else {\n      // Sorth both folders and files alphabetically\n      return a.name > b.name ? 1 : -1;\n    }\n  });\n};\n\nfunction getCodeFromUrl() {\n  return parseQueryString(window.location.search).code;\n}\n\nexport default () => {\n  let dbxPromise;\n\n  const isSignedIn = () => new Promise((resolve) => resolve(true));\n\n  const transformDirectoryListing = (listing) => {\n    const sortedListing = filterAndSortDirectoryListing(listing);\n    return fromJS(\n      sortedListing.map((entry) => ({\n        id: entry.id,\n        name: entry.name,\n        isDirectory: entry['.tag'] === 'folder',\n        path: entry.path_display,\n      }))\n    );\n  };\n\n  const getDirectoryListing = (path) =>\n    new Promise((resolve, reject) => {\n      dbxPromise\n        .then((dbx) => {\n          dbx.filesListFolder({ path }).then((response) => {\n            resolve({\n              listing: transformDirectoryListing(response.result.entries),\n              hasMore: response.result.has_more,\n              additionalSyncBackendState: Map({\n                cursor: response.result.cursor,\n              }),\n            });\n          });\n        })\n        .catch(reject);\n    });\n\n  const getMoreDirectoryListing = (additionalSyncBackendState) => {\n    const cursor = additionalSyncBackendState.get('cursor');\n    return new Promise((resolve, reject) =>\n      dbxPromise.then((dbx) => {\n        dbx.filesListFolderContinue({ cursor }).then((response) =>\n          resolve({\n            listing: transformDirectoryListing(response.result.entries),\n            hasMore: response.result.has_more,\n            additionalSyncBackendState: Map({\n              cursor: response.result.cursor,\n            }),\n          })\n        );\n      })\n    );\n  };\n\n  const uploadFile = (path, contents) =>\n    new Promise((resolve, reject) =>\n      dbxPromise.then((dbx) => {\n        dbx\n          .filesUpload({\n            path,\n            contents,\n            mode: {\n              '.tag': 'overwrite',\n            },\n            autorename: true,\n          })\n          .then(resolve)\n          .catch(reject);\n      })\n    );\n\n  const updateFile = uploadFile;\n  const createFile = uploadFile;\n\n  const getFileContentsAndMetadata = (path) =>\n    new Promise((resolve, reject) =>\n      dbxPromise.then((dbx) => {\n        dbx\n          .filesDownload({ path })\n          .then((response) => {\n            const reader = new FileReader();\n            reader.addEventListener('loadend', () =>\n              resolve({\n                contents: reader.result,\n                lastModifiedAt: response.result.server_modified,\n              })\n            );\n            reader.readAsText(response.result.fileBlob);\n          })\n          .catch((error) => {\n            // INFO: It's possible organice is using the Dropbox API\n            // wrongly. In any case, for some files and only sometimes,\n            // when a file is requested, there's either:\n            //   - a 400 with a plain text error or\n            //   - a 409 with an embedded JSON error\n            //   - a 409 with a plain text error under `.error`\n            // coming back. Sometimes, there's even two API calls to\n            // `/download` happening at the same time (of types `json`\n            // and `octet-stream`) where one might fail and the other\n            // might prevail.\n            // More debug information in this issue:\n            // https://github.com/200ok-ch/organice/issues/108\n            const objectContainsTagErrorP = (function () {\n              try {\n                return JSON.parse(error.error).error.path['.tag'] === 'not_found';\n              } catch (e) {\n                return false;\n              }\n            })();\n            if (\n              (typeof error === 'string' && error.match(/missing required field 'path'/)) ||\n              objectContainsTagErrorP\n            ) {\n              reject();\n            }\n          });\n      })\n    );\n\n  const getFileContents = (path) => {\n    if (isEmpty(path)) return Promise.reject('No path given');\n    return new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(path)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n  };\n\n  const deleteFile = (path) =>\n    new Promise((resolve, reject) =>\n      dbxPromise.then((dbx) => {\n        dbx\n          .filesDelete({ path })\n          .then(resolve)\n          .catch((error) => reject(error.error.error['.tag'] === 'path_lookup', error));\n      })\n    );\n\n  /* Dropbox documentation on OAuth2 and PKCE:\n\n  -  SDK Repo: https://github.com/dropbox/dropbox-sdk-js\n  -  OAuth Guide: https://developers.dropbox.com/oauth-guide\n  -  PKCE: What and Why?: https://dropbox.tech/developers/pkce--what-and-why-\n  -  Single HTML file example: https://github.com/dropbox/dropbox-sdk-js/blob/main/examples/javascript/pkce-browser/index.html\n  -  SDK Docs: https://dropbox.github.io/dropbox-sdk-js/index.html\n  -  Migrating App Permissions and Access Tokens: https://dropbox.tech/developers/migrating-app-permissions-and-access-tokens */\n\n  const REDIRECT_URI = window.location.origin + '/';\n\n  dbxPromise = new Promise((resolve, reject) => {\n    const dbx = new Dropbox({\n      clientId: process.env.REACT_APP_DROPBOX_CLIENT_ID,\n      fetch: fetch.bind(window),\n    });\n    const dbxAuth = dbx.auth;\n\n    if (getCodeFromUrl()) {\n      dbxAuth.setCodeVerifier(getPersistedField('codeVerifier'));\n      dbxAuth\n        .getAccessTokenFromCode(REDIRECT_URI, getCodeFromUrl())\n        .then((response) => {\n          dbxAuth.setRefreshToken(response.result.refresh_token);\n          persistField('dropboxRefreshToken', response.result.refresh_token);\n\n          resolve(dbx);\n        })\n        .catch((error) => {\n          console.error(error);\n        });\n    } else {\n      dbxAuth.setCodeVerifier(getPersistedField('codeVerifier'));\n      dbxAuth.setRefreshToken(getPersistedField('dropboxRefreshToken'));\n      resolve(dbx);\n    }\n  });\n\n  return {\n    type: 'Dropbox',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    deleteFile,\n  };\n};\n","import { fromJS } from 'immutable';\nimport { createClient } from 'webdav';\nimport { isEmpty } from 'lodash';\n\n/**\n * Gets a directory listing ready to be rendered by organice.\n *  - Filters files from `listing` down to org files.\n *  - Sorts folders atop of files.\n *  - Sorts both folders and files alphabetically.\n * @param {Array} listing\n */\nexport const filterAndSortDirectoryListing = (listing) => {\n  return listing\n    .filter((file) => {\n      // Show all folders\n      if (file.type === 'directory') return true;\n      // And only file with the 'org' extension\n      return file.basename.match(/org$|org_archive$/);\n    })\n    .sort((a, b) => {\n      // Folders before files\n      if (a.type === 'directory' && b.type !== 'directory') {\n        return -1;\n      } else {\n        return a.basename > b.basename ? 1 : -1;\n      }\n    });\n};\n\nexport default (url, login, password) => {\n  const webdavClient = createClient(url, { username: login, password: password });\n  const isSignedIn = () =>\n    new Promise((resolve) => {\n      // There's no direct API to know if the login worked. So, let's\n      // check if the root folder contents can be accessed.\n      getDirectoryListing('/')\n        .then(() => {\n          resolve(true);\n        })\n        .catch((error) => {\n          console.error(\"Login didn't work, error: \", JSON.stringify(error));\n          resolve(false);\n        });\n    });\n\n  const transformDirectoryListing = (listing) => {\n    const sortedListing = filterAndSortDirectoryListing(listing);\n    return fromJS(\n      sortedListing.map((entry) => ({\n        id: entry.filename,\n        name: entry.basename,\n        isDirectory: entry.type === 'directory',\n        path: entry.filename,\n      }))\n    );\n  };\n\n  const getDirectoryListing = (path) =>\n    new Promise((resolve, reject) => {\n      webdavClient\n        .getDirectoryContents(path)\n        .then((response) =>\n          resolve({\n            listing: transformDirectoryListing(response),\n          })\n        )\n        .catch(reject);\n    });\n\n  const getMoreDirectoryListing = (_additionalSyncBackendState) => {\n    // TODO\n    return new Promise((resolve, reject) => resolve());\n  };\n\n  const uploadFile = (path, contents) =>\n    new Promise((resolve, reject) =>\n      webdavClient\n        .putFileContents(path, contents, { overwrite: true })\n        .then(resolve())\n        .catch(reject)\n    );\n\n  const updateFile = uploadFile;\n  const createFile = uploadFile;\n\n  const getFileContentsAndMetadata = (path) =>\n    new Promise((resolve, reject) =>\n      webdavClient\n        .stat(path)\n        .then((stat) => {\n          webdavClient\n            .getFileContents(path, { format: 'text' })\n            .then((response) => {\n              resolve({\n                contents: response,\n                lastModifiedAt: new Date(Date.parse(stat.lastmod)).toISOString(),\n              });\n            })\n            .catch((error) => {\n              console.error(path, ': get file failed', error);\n              reject();\n            });\n        })\n        .catch((error) => {\n          if (error && error.response && [401, 403].indexOf(error.response.status) !== -1)\n            alert(login + '@' + url + ': ' + error.response.statusText);\n          console.error(path, ': get stat failed', error);\n          reject();\n        })\n    );\n\n  const getFileContents = (path) => {\n    if (isEmpty(path)) return Promise.reject('No path given');\n    return new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(path)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n  };\n\n  const deleteFile = (path) =>\n    new Promise((resolve, reject) =>\n      webdavClient\n        .deleteFile(path)\n        .then(resolve)\n        .catch((error) => {\n          if (error && error.response && error.response.status === 404) return;\n          console.error(path, ': delete failed', error);\n          reject();\n        })\n    );\n\n  return {\n    type: 'WebDAV',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    deleteFile,\n  };\n};\n","export default __webpack_public_path__ + \"static/media/organice.5121bc75.svg\";","import React from 'react';\nimport { Link } from 'react-router-dom';\n\n// NOTE: Importing of the scss file works for `yarn start` just fine\n//       as it should according to the docs:\n//       https://create-react-app.dev/docs/adding-a-sass-stylesheet/\n//       However, after leaving node 12 behind, `yarn build` will\n//       throw an error. Since we don't really update the scss a whole\n//       lot, we import the compiled css file and a task `yarn\n//       compile-sass`.\n\n// import './vendor_css/template.scss';\nimport './vendor_css/template.css';\n\nimport './stylesheet.css';\n\n// import AOS from 'aos';\n// import 'aos/dist/aos.css';\n\nimport logo from '../../images/organice.svg';\n// import ExternalLink from '../UI/ExternalLink';\n\nimport { useEffect } from 'react';\n\nimport { Menu, ArrowRight, CheckSquare, EyeOff, Calendar } from 'react-feather';\n\nexport default () => {\n  // FIXME: AOS does not animate/show the screenshot section in the\n  // middle. It works for the hero. On https://200ok.ch/organice.html\n  // it works for all elements weirdly enough. Could be related to\n  // <Landing /> being implemented in React.\n\n  // useEffect(() => {\n  //   AOS.init({\n  //     disable: 'mobile',\n  //     duration: 1000,\n  //     once: true,\n  //   });\n  // }, []);\n\n  // Working around the fact that the original LP was designed with\n  // stateful libraries in mind.\n  useEffect(() => {\n    const files = [\n      'font_awesome_all.min.js',\n      // TODO: Reprogram false_bottom the React way\n      // 'false_bottom.js',\n      'bootstrap.bundle.min.js',\n      // XXX: Some parts of scripts.js are implemented the React way\n      // (Feather), others are worked around (navbar is always black),\n      // the remainder is not implemented atm.\n      // 'scripts.js',\n    ];\n\n    for (const file of files) {\n      const script = document.createElement('script');\n      // Do not download/eval asynchronously\n      script.async = false;\n      script.src = `https://200ok.ch/landing_page/js/${file}`;\n      document.head.appendChild(script);\n    }\n\n    // HACK: scripts.js waits for this event. Since we're already in a\n    // `useEffect` handler, this event has been fired long ago.\n    // setTimeout(function () {\n    //   window.dispatchEvent(new Event('DOMContentLoaded'));\n    // }, 500);\n  }, []);\n\n  return (\n    <>\n      <div id=\"layoutDefault\">\n        <div id=\"layoutDefault_content\">\n          <main>\n            {/* Navbar */}\n            <nav className=\"navbar navbar-marketing navbar-expand-lg bg-transparent navbar-dark fixed-top navbar-scrolled\">\n              <div className=\"container px-5\">\n                <img\n                  className=\"landing-logo\"\n                  src={logo}\n                  alt=\"Logo\"\n                  style={{\n                    height: '4rem',\n                    filter: 'drop-shadow(0px 0px 18px #fdf6e3)',\n                  }}\n                />\n                <button\n                  className=\"navbar-toggler\"\n                  type=\"button\"\n                  data-bs-toggle=\"collapse\"\n                  data-bs-target=\"#navbarSupportedContent\"\n                  aria-controls=\"navbarSupportedContent\"\n                  aria-expanded=\"false\"\n                  aria-label=\"Toggle navigation\"\n                >\n                  <Menu />\n                </button>\n                <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\n                  <ul className=\"navbar-nav ms-auto me-lg-5\">\n                    <li className=\"nav-item\">\n                      <a\n                        target=\"_blank\"\n                        className=\"nav-link navbar-brand\"\n                        href=\"https://github.com/sponsors/200ok-ch\"\n                        rel=\"noreferrer noopener\"\n                      >\n                        Pricing\n                      </a>\n                    </li>\n\n                    <li className=\"nav-item\">\n                      <a\n                        target=\"_blank\"\n                        className=\"nav-link navbar-brand\"\n                        href=\"https://github.com/200ok-ch/organice\"\n                        rel=\"noreferrer noopener\"\n                      >\n                        Code\n                      </a>\n                    </li>\n\n                    <li className=\"nav-item\">\n                      <a\n                        target=\"_blank\"\n                        className=\"nav-link navbar-brand\"\n                        href=\"https://organice.200ok.ch/documentation.html\"\n                        rel=\"noreferrer noopener\"\n                      >\n                        Documentation\n                      </a>\n                    </li>\n                  </ul>\n                  <a className=\"btn fw-500 ms-lg-4 btn-teal\" href=\"/sign_in\">\n                    Sign in\n                    {/* <i className=\"ms-2\" data-feather=\"arrow-right\"></i> */}\n                    <ArrowRight className=\"ms-2\" />\n                  </a>\n                </div>\n              </div>\n            </nav>\n            {/* Page Header */}\n            <header className=\"page-header-ui page-header-ui-dark bg-gradient-primary-to-secondary\">\n              <div className=\"page-header-ui-content pt-10\">\n                <div className=\"container px-5\">\n                  <div className=\"row gx-5 align-items-center\">\n                    <div className=\"col-lg-6\" data-aos=\"fade-up\">\n                      <h1 className=\"page-header-ui-title\">\n                        organice is the best way to get stuff done\n                      </h1>\n                      <p>\n                        Whether you're planning multiple work projects, sharing a shopping list with\n                        your partner or you're planing a holiday, organice is here to help you\n                        complete all your personal and professional tasks.\n                      </p>\n                      <p>\n                        organice is Free and Open Source software that works on top of Org mode\n                        files.\n                      </p>\n\n                      <a className=\"btn btn-teal fw-500 me-2\" href=\"/sample\">\n                        Live demo\n                        {/* <i className=\"ms-2\" data-feather=\"arrow-right\"></i> */}\n                        <ArrowRight className=\"ms-2\" />\n                      </a>\n\n                      <a className=\"btn btn-white fw-500 me-2\" href=\"/sign_in\">\n                        Sign in\n                        {/* <i className=\"ms-2\" data-feather=\"arrow-right\"></i> */}\n                        <ArrowRight className=\"ms-2\" />\n                      </a>\n                    </div>\n                    <div\n                      className=\"col-lg-6 mt-5 mt-lg-0 d-lg-block text-center\"\n                      data-aos=\"fade-up\"\n                      data-aos-delay=\"1000\"\n                    >\n                      <img\n                        className=\"img-fluid main-image\"\n                        alt=\"\"\n                        src=\"https://200ok.ch/landing_page/img/organice/screenshot-overview.png\"\n                        style={{ filter: 'drop-shadow(0.5em 0.5em 0.5em #444)' }}\n                      />\n                    </div>\n                  </div>\n                </div>\n                <div className=\"svg-border-rounded text-white\">\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    viewBox=\"0 0 144.54 17.34\"\n                    preserveAspectRatio=\"none\"\n                    fill=\"currentColor\"\n                  >\n                    <path d=\"M144.54,17.34H0V0H144.54ZM0,0S32.36,17.34,72.27,17.34,144.54,0,144.54,0\"></path>\n                  </svg>\n                </div>\n              </div>\n            </header>\n\n            <div className=\"row\">\n              {/* TODO: Reprogram false_bottom the React way */}\n              {/* <div id=\"false-bottom-preventor\" className=\"fixed-bottom text-end\"> */}\n              {/*   <p> */}\n              {/*     Learn more <i className=\"fas fa-arrow-circle-down\"></i> */}\n              {/*   </p> */}\n              {/* </div> */}\n              <section className=\"bg-white py-10\">\n                <div className=\"container px-5\">\n                  <div className=\"row gx-5 text-center\">\n                    <div className=\"col-lg-4 mb-5 mb-lg-0\">\n                      <div className=\"icon-stack icon-stack-xl bg-gradient-primary-to-secondary text-white mb-4\">\n                        {/* <i data-feather=\"check-square\"></i> */}\n                        <CheckSquare />\n                      </div>\n                      <h3>Plan for anything</h3>\n                      <p className=\"mb-0\">\n                        Organize and share your to-do, work, grocery, movies and household lists. No\n                        matter what you’re planning, how big or small the task may be, organice\n                        makes it super easy to get stuff done.\n                      </p>\n                    </div>\n\n                    <div className=\"col-lg-4 mb-5 mb-lg-0\">\n                      <div className=\"icon-stack icon-stack-xl bg-gradient-primary-to-secondary text-white mb-4\">\n                        {/* <i data-feather=\"calendar\"></i> */}\n                        <Calendar />\n                      </div>\n                      <h3>See your agenda anytime</h3>\n                      <p className=\"mb-0\">\n                        Set schedules and deadlines on to-dos. No matter whether your tasks are work\n                        related or just for fun, you will never miss a deadline again with organice\n                        in charge.\n                      </p>\n                    </div>\n\n                    <div className=\"col-lg-4 mb-5 mb-lg-0\">\n                      <div className=\"icon-stack icon-stack-xl bg-gradient-primary-to-secondary text-white mb-4\">\n                        {/* <i data-feather=\"eye-off\"></i> */}\n                        <EyeOff />\n                      </div>\n                      <h3>Privacy and freedom first</h3>\n                      <p className=\"mb-0\">\n                        organice is Free and Open Source software protecting your freedom to run,\n                        copy, distribute, study, change and improve the software. Your most\n                        important data should never be in a closed silo.\n                        <br />\n                        <br />\n                        We also never see your data - only you and your personal storage provider\n                        does. organice saves your files in the free format Org mode, so you can\n                        always access it with any tool at any time!\n                      </p>\n                    </div>\n                  </div>\n\n                  <div id=\"icons\" className=\"row pt-10 d-flex flex-wrap align-items-center\">\n                    <h1 className=\"text-center mb-5\">Access from anywhere</h1>\n                    <strong className=\"text-center mb-5\">\n                      Available on iPhone, Android, and the Web, organice works seamlessly across\n                      all major devices.\n                    </strong>\n\n                    <div className=\"col-md-4\">\n                      <i className=\"fas fa-mobile-alt\"></i>\n                    </div>\n\n                    <div className=\"col-md-4\">\n                      <i className=\"fab fa-android\"></i>\n                    </div>\n\n                    <div className=\"col-md-4\">\n                      <i className=\"fab fa-firefox-browser\"></i>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"svg-border-rounded text-light\">\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    viewBox=\"0 0 144.54 17.34\"\n                    preserveAspectRatio=\"none\"\n                    fill=\"currentColor\"\n                  >\n                    <path d=\"M144.54,17.34H0V0H144.54ZM0,0S32.36,17.34,72.27,17.34,144.54,0,144.54,0\"></path>\n                  </svg>\n                </div>\n              </section>\n\n              <section className=\"bg-light py-10\">\n                <div className=\"container px-5\">\n                  <div className=\"row gx-5 align-items-center justify-content-center\">\n                    <div className=\"col-md-9 col-lg-6 order-1 order-lg-0\" data-aos=\"fade-right\">\n                      <div className=\"content-skewed content-skewed-right\">\n                        <img\n                          className=\"content-skewed-item img-fluid shadow-lg rounded-3\"\n                          src=\"https://200ok.ch/landing_page/img/organice/screenshot-wide.png\"\n                          alt=\"Sample organice document\"\n                        />\n                      </div>\n                    </div>\n                    <div className=\"col-lg-6 order-0 order-lg-1 mb-5 mb-lg-0\" data-aos=\"fade-left\">\n                      <div className=\"mb-5\">\n                        <h2>Remember all the things</h2>\n                        <p className=\"lead\">Succeed with every project</p>\n                      </div>\n\n                      <div className=\"row gx-5\">\n                        <div className=\"col-md-6 mb-4\">\n                          <h6>Work anywhere</h6>\n                          <p className=\"mb-2 small mb-0\">\n                            organice works on all major platforms, so you can access your\n                            information wherever you are.\n                          </p>\n                        </div>\n\n                        <div className=\"col-md-6 mb-4\">\n                          <h6>Find your content quickly</h6>\n                          <p className=\"mb-2 small mb-0\">\n                            Thanks to a flexible query language and a bookmarking system, you can\n                            find your important content quickly and reliably.\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </section>\n\n              <section className=\"bg-white pt-10\">\n                <div className=\"container px-5\">\n                  <div className=\"row gx-5 mb-10\">\n                    <h1 className=\"text-center mb-5\">What our users say</h1>\n                    <div\n                      className=\"col-lg-6 mb-5 mb-lg-0 divider-right aos-init aos-animate\"\n                      data-aos=\"fade\"\n                    >\n                      <div className=\"testimonial p-lg-5\">\n                        <p className=\"testimonial-quote text-primary\">\n                          \"This is a SPECTACULAR project and I am glad that I found it. organice\n                          takes the extreme power of org mode and makes it simple to use. When\n                          combined with the option to self-host your own data rganice has created an\n                          extremely flexible and secure option to help fulfill everyone's\n                          organizational needs.\"\n                        </p>\n                        <div className=\"row\">\n                          <div className=\"col-3\">\n                            <img\n                              className=\"card-img\"\n                              src=\"https://github.com/dmorlitz.png\"\n                              alt=\"@dmorlitz\"\n                            />\n                          </div>\n                          <div className=\"col-9\">\n                            <div className=\"testimonial-name\">\n                              <a\n                                target=\"_blank\"\n                                href=\"https://github.com/dmorlitz\"\n                                style={{ color: '#363d47' }}\n                                rel=\"noopener noreferrer\"\n                              >\n                                @dmorlitz\n                              </a>\n                            </div>\n                            <div className=\"testimonial-position\">Contributor</div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div\n                      className=\"col-lg-6 aos-init aos-animate\"\n                      data-aos=\"fade\"\n                      data-aos-delay=\"100\"\n                    >\n                      <div className=\"testimonial p-lg-5\">\n                        <p className=\"testimonial-quote text-primary\">\n                          \"Been using organice for years. To me, it’s by far the most usable\n                          solution for interacting with org files on a mobile device.\"\n                        </p>\n                        <div className=\"row\">\n                          <div className=\"col-3\">\n                            <img\n                              className=\"card-img\"\n                              src=\"https://github.com/jcpst.png\"\n                              alt=\"@jcpst\"\n                            />\n                          </div>\n                          <div className=\"col-9\">\n                            <div className=\"testimonial-name\">\n                              <a\n                                target=\"_blank\"\n                                href=\"https://github.com/jcpst\"\n                                style={{ color: '#363d47' }}\n                                rel=\"noopener noreferrer\"\n                              >\n                                @jcpst\n                              </a>\n                            </div>\n                            <div className=\"testimonial-position\">User</div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </section>\n\n              <hr className=\"m-0\" />\n\n              <section className=\"bg-dark py-10\">\n                <div className=\"container px-5\">\n                  <div className=\"row gx-5 my-10\">\n                    <div className=\"col-lg-6 mb-5\">\n                      <div className=\"d-flex h-100\">\n                        <div className=\"icon-stack flex-shrink-0 bg-teal text-white\">\n                          <i className=\"fas fa-question\"></i>\n                        </div>\n\n                        <div className=\"ms-4\">\n                          <h5 className=\"text-white\">Intro video</h5>\n                          <p className=\"text-white-50\">\n                            If you are interested into the 'why did we get started with organice',\n                            we have got you covered. For{' '}\n                            <a\n                              target=\"_blank\"\n                              href=\"https://emacsconf.org/2019/\"\n                              rel=\"noreferrer noopener\"\n                            >\n                              {' '}\n                              EmacsConf 2019\n                            </a>\n                            , we have created a 10 minute introductory video into the rationale and\n                            usability of organice.\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"col-lg-6 mb-5\">\n                      <div className=\"d-flex h-100\">\n                        <div className=\"tutorial container text-center my-5 ratio ratio-16x9\">\n                          <iframe\n                            src=\"https://www.youtube.com/embed/aQKc0hcFXCk\"\n                            title=\"YouTube video player\"\n                            allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n                            allowFullScreen\n                          ></iframe>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"row gx-5 justify-content-center text-center\">\n                    <div className=\"col-lg-8\">\n                      <div className=\"badge bg-transparent-light rounded-pill badge-marketing mb-4\"></div>\n                      <h2 className=\"text-white\">Get started</h2>\n                      <div className=\"lead text-white-50 mb-5\">\n                        <p>\n                          organice is{' '}\n                          <a\n                            target=\"_blank\"\n                            href=\"https://www.gnu.org/philosophy/free-sw.en.html\"\n                            rel=\"noreferrer noopener\"\n                          >\n                            free software\n                          </a>{' '}\n                          and will stay this way. Leave the closed silos behind and let your\n                          knowledge roam free. Start with the live demo - you don't even need to\n                          sign up. Check it out first and sign up later.\n                        </p>\n                      </div>\n\n                      <a className=\"btn btn-teal fw-500\" href=\"/sample\">\n                        Live demo\n                      </a>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"svg-border-rounded text-white\">\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    viewBox=\"0 0 144.54 17.34\"\n                    preserveAspectRatio=\"none\"\n                    fill=\"currentColor\"\n                  >\n                    <path d=\"M144.54,17.34H0V0H144.54ZM0,0S32.36,17.34,72.27,17.34,144.54,0,144.54,0\"></path>\n                  </svg>\n                </div>\n              </section>\n\n              <section className=\"bg-light py-10\">\n                <div className=\"container px-5 mt-5\">\n                  <div className=\"row gx-5 align-items-center\">\n                    <div className=\"col-lg-6\">\n                      <h4>Do you have further questions?</h4>\n                      <p className=\"lead mb-5 mb-lg-0 text-gray-500\">\n                        Join the inclusive and friendly community chat, and let's have a talk.\n                      </p>\n                    </div>\n                    <div className=\"col-lg-6 text-lg-end\">\n                      <a\n                        className=\"btn btn-primary fw-500 me-3 my-2\"\n                        href=\"https://matrix.to/#/#organice:matrix.org\"\n                      >\n                        Matrix\n                      </a>\n\n                      <a\n                        className=\"btn btn-white fw-500 my-2 shadow\"\n                        href=\"https://web.libera.chat/\"\n                      >\n                        IRC (&#35;organice)\n                      </a>\n                    </div>\n                  </div>\n                </div>\n              </section>\n              <hr className=\"m-0\" />\n            </div>\n          </main>\n        </div>\n\n        <div id=\"layoutDefault_footer\">\n          <footer className=\"footer pt-10 pb-5 mt-auto bg-light footer-light\">\n            <div className=\"container px-5\">\n              <div className=\"row gx-5\">\n                <div className=\"col-lg-3\">\n                  <div className=\"footer-brand\">200ok GmbH</div>\n                  <div className=\"mb-3\">Glarus, Switzerland</div>\n                  <div>\n                    <a href=\"tel:+41764050567\">\n                      <i className=\"fas fa-phone-square\"></i>&nbsp;+41 76 405 05 67\n                    </a>\n                  </div>\n                  <div>\n                    <a href=\"mailto:info@200ok.ch\">\n                      <i className=\"fas fa-envelope-square\"></i>&nbsp;info@200ok.ch\n                    </a>\n                  </div>\n                </div>\n                <div className=\"col-lg-9\">\n                  <div className=\"row gx-5\">\n                    <div className=\"col-lg-6\">\n                      <div className=\"footer-brand\">&nbsp;</div>\n                      <div className=\"mb-3\">Follow us on Social Media</div>\n                      <div className=\"icon-list-social mb-5\">\n                        <a\n                          className=\"icon-list-social-link\"\n                          target=\"_blank\"\n                          href=\"https://200ok.ch/atom.xml\"\n                          rel=\"noreferrer noopener\"\n                        >\n                          <i className=\"fas fa-rss-square\"></i>\n                        </a>\n                        <a\n                          className=\"icon-list-social-link\"\n                          target=\"_blank\"\n                          href=\"https://github.com/200ok-ch/\"\n                          rel=\"noreferrer noopener\"\n                        >\n                          <i className=\"fab fa-github\"></i>\n                        </a>\n                        <a\n                          className=\"icon-list-social-link\"\n                          target=\"_blank\"\n                          href=\"https://www.linkedin.com/in/alafon/\"\n                          rel=\"noreferrer noopener\"\n                        >\n                          <i className=\"fab fa-linkedin\"></i>\n                        </a>\n                        <a\n                          className=\"icon-list-social-link\"\n                          target=\"_blank\"\n                          href=\"https://twitter.com/munen_200ok\"\n                          rel=\"noreferrer noopener\"\n                        >\n                          <i className=\"fab fa-twitter\"></i>\n                        </a>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <hr className=\"my-5\" />\n              <div className=\"row gx-5 align-items-center\">\n                <div className=\"col-md-6 small\">Copyright &copy; 200ok GmbH 2022</div>\n                <div className=\"col-md-6 text-md-end small\">\n                  {/* TODO: Privacy Policy could have the same design as LP */}\n                  <Link to=\"/privacy-policy\">Privacy Policy</Link>\n                  &middot;\n                  {/* TODO: Create a TOS */}\n                  {/* <a href=\"/terms-of-service.html\">Terms &amp; Conditions</a> */}\n                </div>\n              </div>\n            </div>\n          </footer>\n        </div>\n      </div>\n    </>\n  );\n};\n","import React from 'react';\nexport default ({ href, children }) => {\n  return (\n    <a href={href} target=\"_blank\" rel=\"noopener noreferrer\">\n      {children ? children : href}\n    </a>\n  );\n};\n","import React from 'react';\nimport './stylesheet.css';\nimport ExternalLink from '../UI/ExternalLink';\nconst PrivacyPolicy = () => {\n  return (\n    <div className=\"privacy-policy-container\">\n      <h1>organice privacy policy</h1>\n      <p>Last updated: May 9th, 2020</p>\n\n      <p>\n        <ExternalLink href=\"https://200ok.ch/\">200ok llc</ExternalLink> operates the{' '}\n        <ExternalLink href=\"https://organice.200ok.ch\" /> website and mobile apps.\n      </p>\n\n      <p>\n        This page is used to inform website visitors regarding our policies with the collection,\n        use, and disclosure of Personal Information if anyone decided to use our Service.\n      </p>\n      <p>\n        If you choose to use our Service, then you agree to the collection and use of information in\n        relation with this policy. The Personal Information that we collect are used for providing\n        and improving the Service. We will not use or share your information with anyone except as\n        described in this Privacy Policy.\n      </p>\n      {/* <p> */}\n      {/*   <span> */}\n      {/*     The terms used in this Privacy Policy have the same meanings as in our */}\n      {/*     <a href=\"/static/terms-of-service\">Terms and Conditions</a> */}\n      {/*   </span> */}\n      {/*   <span>, unless otherwise defined in this Privacy Policy.</span> */}\n      {/* </p> */}\n      <p>\n        <strong>Information Collection and Use</strong>\n      </p>\n      <p>\n        For a better experience while using our Service, we may require you to provide us with\n        certain personally identifiable information, including but not limited to your name, phone\n        number, and postal address. The information that we collect will be used to contact or\n        identify you.\n      </p>\n      <p>\n        <strong>Log Data</strong>\n      </p>\n      <p>\n        We want to inform you that whenever you visit our Service, we collect information that your\n        browser sends to us that is called Log Data. This Log Data may include information such as\n        your computer’s Internet Protocol (“IP”) address, browser version, pages of our Service that\n        you visit, the time and date of your visit, the time spent on those pages, and other\n        statistics.\n      </p>\n      <p>\n        <strong>User data</strong>\n      </p>\n      <p>\n        No user data, including user data from third-party services such as Dropbox will be stored\n        or monitored by our Service. All access to user data is done through the proper APIs of the\n        respective services, and all data is only processed by the browser. No data will be shared\n        with any other service.\n      </p>\n\n      <p>\n        <strong>Cookies</strong>\n      </p>\n      <p>\n        Cookies are files with small amount of data that is commonly used an anonymous unique\n        identifier. These are sent to your browser from the website that you visit and are stored on\n        your computer’s hard drive.\n      </p>\n      <p>\n        Our website uses these “cookies” to collection information and to improve our Service. You\n        have the option to either accept or refuse these cookies, and know when a cookie is being\n        sent to your computer. If you choose to refuse our cookies, you may not be able to use some\n        portions of our Service.\n      </p>\n      <p>\n        <strong>Service Providers</strong>\n      </p>\n      <p>We may employ third-party companies and individuals due to the following reasons:</p>\n      <ul>\n        <li>To facilitate our Service;</li>\n        <li>To provide the Service on our behalf;</li>\n        <li>To perform Service-related services; or</li>\n        <li>To assist us in analyzing how our Service is used.</li>\n      </ul>\n\n      <p>\n        We want to inform our Service users that these third parties have access to your Personal\n        Information. The reason is to perform the tasks assigned to them on our behalf. However,\n        they are obligated not to disclose or use the information for any other purpose.\n      </p>\n      <p>\n        <strong>Security</strong>\n      </p>\n      <p>\n        We value your trust in providing us your Personal Information, thus we are striving to use\n        commercially acceptable means of protecting it. But remember that no method of transmission\n        over the internet, or method of electronic storage is 100% secure and reliable, and we\n        cannot guarantee its absolute security.\n      </p>\n\n      <p>\n        <strong>Links to Other Sites</strong>\n      </p>\n      <p>\n        Our Service may contain links to other sites. If you click on a third-party link, you will\n        be directed to that site. Note that these external sites are not operated by us. Therefore,\n        we strongly advise you to review the Privacy Policy of these websites. We have no control\n        over, and assume no responsibility for the content, privacy policies, or practices of any\n        third-party sites or services.\n      </p>\n      <p>\n        <strong>Children’s Privacy</strong>\n      </p>\n      <p>\n        Our Services do not address anyone under the age of 13. We do not knowingly collect personal\n        identifiable information from children under 13. In the case we discover that a child under\n        13 has provided us with personal information, we immediately delete this from our servers.\n        If you are a parent or guardian and you are aware that your child has provided us with\n        personal information, please contact us so that we will be able to do necessary actions.\n      </p>\n      <p>\n        <strong>Changes to This Privacy Policy</strong>\n      </p>\n      <p>\n        We may update our Privacy Policy from time to time. Thus, we advise you to review this page\n        periodically for any changes. We will notify you of any changes by posting the new Privacy\n        Policy on this page. These changes are effective immediately, after they are posted on this\n        page.\n      </p>\n\n      <p>\n        <strong>Contact us</strong>\n      </p>\n\n      <p>\n        If you have any questions about this Privacy Policy, please{' '}\n        <a href=\"mailto:info@200ok.ch\">contact us</a>.\n      </p>\n    </div>\n  );\n};\nexport default PrivacyPolicy;\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { isLandingPage } from '../../util/misc';\n\nimport { Link, withRouter } from 'react-router-dom';\n\nimport logo from '../../images/organice.svg';\n\nimport './stylesheet.css';\n\nimport * as baseActions from '../../actions/base';\nimport * as orgActions from '../../actions/org';\nimport { ActionCreators as undoActions } from 'redux-undo';\n\nimport ExternalLink from '../UI/ExternalLink';\n\nimport { List } from 'immutable';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nclass HeaderBar extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleChangelogClick',\n      'handleModalPageDoneClick',\n      'handleHeaderBarTitleClick',\n      'handleBackClick',\n      'handleUndoClick',\n      'handleRedoClick',\n      'handleHelpClick',\n      'handleSettingsClick',\n    ]);\n  }\n\n  getPathRoot() {\n    const {\n      location: { pathname },\n    } = this.props;\n    return pathname.split('/')[1];\n  }\n\n  getFilename() {\n    const {\n      location: { pathname },\n    } = this.props;\n    // only show a filename if it's a file and not a path\n    if (pathname.includes('.org')) {\n      return pathname.substring(pathname.lastIndexOf('/') + 1, pathname.lastIndexOf('.'));\n    } else {\n      return '';\n    }\n  }\n\n  renderFileBrowserBackButton() {\n    let backPath = 'Back';\n    const fileParts = window.location.href.split('/').map((e) => decodeURIComponent(e));\n    if (_.includes(fileParts, 'files')) {\n      backPath = _.last(fileParts);\n    }\n\n    return (\n      <div\n        onClick={() => {\n          window.history.back();\n        }}\n        className=\"header-bar__back-button\"\n      >\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">{backPath}</span>\n      </div>\n    );\n  }\n\n  renderOrgFileBackButton() {\n    const {\n      location: { pathname },\n    } = this.props;\n\n    let filePath = pathname.substr('/file'.length);\n    if (filePath.endsWith('/')) {\n      filePath = filePath.substring(0, filePath.length - 1);\n    }\n\n    const pathParts = filePath.split('/');\n    const directoryPath = pathParts.slice(0, pathParts.length - 1).join('/');\n\n    return (\n      <Link\n        to={`/files${directoryPath}`}\n        onClick={this.handleBackClick}\n        className=\"header-bar__back-button\"\n      >\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">File browser</span>\n      </Link>\n    );\n  }\n\n  renderLogo() {\n    return (\n      <div className=\"header-bar__logo-container\">\n        <img className=\"header-bar__logo\" src={logo} alt=\"Logo\" width=\"30\" height=\"30\" />\n        <h2 className=\"header-bar__app-name\">organice</h2>\n      </div>\n    );\n  }\n\n  renderHomeFileBackButton() {\n    return (\n      <Link to={`/`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Home</span>\n      </Link>\n    );\n  }\n\n  renderSignInBackButton() {\n    return (\n      <Link to={`/`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Home</span>\n      </Link>\n    );\n  }\n\n  handleBackClick() {\n    this.props.base.popModalPage();\n  }\n\n  renderSettingsSubPageBackButton() {\n    return (\n      <div className=\"header-bar__back-button\" onClick={this.handleBackClick}>\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Settings</span>\n      </div>\n    );\n  }\n\n  renderBackButton() {\n    const { activeModalPage } = this.props;\n\n    switch (activeModalPage) {\n      case 'changelog':\n        return this.renderSettingsSubPageBackButton();\n      case 'keyboard_shortcuts_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'capture_templates_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'file_settings_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'sample':\n        return this.renderOrgFileBackButton();\n      default:\n    }\n\n    switch (this.getPathRoot()) {\n      case '':\n        return this.renderLogo();\n      case 'files':\n        return this.renderFileBrowserBackButton();\n      case 'file':\n        return this.renderOrgFileBackButton();\n      case 'sample':\n        return this.renderHomeFileBackButton();\n      case 'sign_in':\n        return this.renderSignInBackButton();\n      case 'settings':\n        return this.renderFileBrowserBackButton();\n      case 'changelog':\n        return this.renderFileBrowserBackButton();\n      default:\n        return <div />;\n    }\n  }\n\n  renderTitle() {\n    const titleContainerWithText = (text) => (\n      <div className=\"header-bar__title\" onClick={this.handleHeaderBarTitleClick}>\n        {text}\n      </div>\n    );\n\n    switch (this.props.activeModalPage) {\n      case 'changelog':\n        return titleContainerWithText('Changelog');\n      case 'settings':\n        return titleContainerWithText('Settings');\n      case 'keyboard_shortcuts_editor':\n        return titleContainerWithText('Shortcuts');\n      case 'capture_templates_editor':\n        return titleContainerWithText('Capture');\n      case 'file_settings_editor':\n        return titleContainerWithText('Files');\n      case 'sample':\n        return titleContainerWithText('Sample');\n      default:\n    }\n\n    switch (this.getPathRoot()) {\n      case 'sample':\n        return titleContainerWithText('Sample');\n      case 'sign_in':\n        return titleContainerWithText('Sign in');\n      case 'settings':\n        return titleContainerWithText('Settings');\n      default:\n    }\n\n    return titleContainerWithText(this.props.shouldShowTitleInOrgFile ? this.getFilename() : '');\n  }\n\n  handleChangelogClick() {\n    this.props.base.restoreStaticFile('changelog');\n    this.props.base.pushModalPage('changelog');\n  }\n\n  handleModalPageDoneClick() {\n    this.props.base.clearModalStack();\n  }\n\n  handleHeaderBarTitleClick() {\n    this.props.org.selectHeader(null);\n  }\n\n  handleUndoClick() {\n    if (this.props.isUndoEnabled) {\n      this.props.undo.undo();\n    }\n  }\n\n  handleRedoClick() {\n    if (this.props.isRedoEnabled) {\n      this.props.undo.redo();\n    }\n  }\n\n  handleHelpClick() {\n    this.props.base.restoreStaticFile('sample');\n    this.props.base.pushModalPage('sample');\n  }\n\n  handleSettingsClick() {\n    this.props.base.setLastViewedFile(this.props.path);\n  }\n\n  renderActions() {\n    const {\n      isAuthenticated,\n      hasUnseenChangelog,\n      activeModalPage,\n      path,\n      isUndoEnabled,\n      isRedoEnabled,\n    } = this.props;\n\n    if (!!activeModalPage) {\n      return (\n        <div className=\"header-bar__actions\" onClick={this.handleModalPageDoneClick}>\n          Done\n        </div>\n      );\n    } else if (this.getPathRoot() !== 'settings') {\n      const undoIconClassName = classNames('fas fa-undo header-bar__actions__item', {\n        'header-bar__actions__item--disabled': !isUndoEnabled,\n      });\n      const redoIconClassName = classNames('fas fa-redo header-bar__actions__item', {\n        'header-bar__actions__item--disabled': !isRedoEnabled,\n      });\n\n      const settingsIconClassName = classNames('fas fa-cogs header-bar__actions__item');\n\n      return (\n        <div className=\"header-bar__actions\">\n          {!isAuthenticated && this.getPathRoot() !== 'sign_in' && (\n            <Link to=\"/sign_in\">\n              <div className=\"header-bar__actions__item\" title=\"Sign in\">\n                Sign in\n              </div>\n            </Link>\n          )}\n\n          {!isAuthenticated && (\n            <ExternalLink href=\"https://github.com/200ok-ch/organice\">\n              <i className=\"fab fa-github header-bar__actions__item\" />\n            </ExternalLink>\n          )}\n\n          {isAuthenticated && !activeModalPage && !!path && (\n            <Fragment>\n              <i className={undoIconClassName} onClick={this.handleUndoClick} title=\"Undo\" />\n              <i className={redoIconClassName} onClick={this.handleRedoClick} title=\"Redo\" />\n              <i\n                className=\"fas fa-question-circle header-bar__actions__item\"\n                onClick={this.handleHelpClick}\n                title=\"Help\"\n              />\n            </Fragment>\n          )}\n\n          {isAuthenticated && (\n            <div>\n              {hasUnseenChangelog && (\n                <Link to=\"/changelog\">\n                  <i\n                    className=\"changelog-icon--has-unseen-changelog header-bar__actions__item fas fa-gift\"\n                    title=\"Changelog\"\n                  />\n                </Link>\n              )}\n              <Link to=\"/settings\" onClick={this.handleSettingsClick}>\n                <i className={settingsIconClassName} title=\"Settings\" />\n              </Link>\n            </div>\n          )}\n        </div>\n      );\n    }\n  }\n\n  render() {\n    const className = classNames('header-bar', {\n      'header-bar--with-logo': this.getPathRoot() === '',\n    });\n\n    // The LP does not show the HeaderBar\n    if (!isLandingPage()) {\n      return (\n        <div className={className}>\n          {this.renderBackButton()}\n          {this.renderTitle()}\n          {this.renderActions()}\n        </div>\n      );\n    }\n    return null;\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    isAuthenticated: state.syncBackend.get('isAuthenticated'),\n    hasUnseenChangelog: state.base.get('hasUnseenChangelog'),\n    activeModalPage: state.base.get('modalPageStack', List()).last(),\n    shouldShowTitleInOrgFile: state.base.get('shouldShowTitleInOrgFile'),\n    path: state.org.present.get('path'),\n    isUndoEnabled: state.org.past.length > 0,\n    isRedoEnabled: state.org.future.length > 0,\n    syncBackendType: state.syncBackend.get('client') && state.syncBackend.get('client').type,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n    undo: bindActionCreators(undoActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(HeaderBar));\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nexport default class ActionButton extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleClick']);\n  }\n\n  handleClick() {\n    const { onClick, isDisabled } = this.props;\n\n    if (isDisabled) {\n      return;\n    }\n\n    onClick();\n  }\n\n  render() {\n    const {\n      iconName,\n      subIconName,\n      isDisabled,\n      shouldRotateSubIcon,\n      letter,\n      additionalClassName,\n      style,\n      tooltip,\n      shouldSpinSubIcon,\n      onRef,\n    } = this.props;\n\n    const className = classNames(\n      'btn',\n      'btn--circle',\n      'action-drawer__btn',\n      additionalClassName || '',\n      {\n        fas: !letter,\n        'fa-lg': !letter,\n        [`fa-${iconName}`]: !letter,\n        'action-drawer__btn--with-sub-icon': !!subIconName,\n        'btn--disabled': isDisabled,\n        'action-drawer__btn--letter': !!letter,\n      }\n    );\n\n    const subIconClassName = classNames(\n      'fas',\n      'fa-xs',\n      `fa-${subIconName}`,\n      'action-drawer__btn__sub-icon',\n      {\n        'action-drawer__btn__sub-icon--rotated': shouldRotateSubIcon,\n        'fa-spin': shouldSpinSubIcon,\n      }\n    );\n\n    return (\n      <button\n        className={className}\n        onClick={this.handleClick}\n        style={style}\n        title={tooltip}\n        ref={onRef}\n      >\n        {!!letter && letter}\n        {!!subIconName && <i className={subIconClassName} />}\n      </button>\n    );\n  }\n}\n","// INFO: There's an <ActionDrawer> component within the <OrgFile>\n// component, as well.\n\nimport React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport _ from 'lodash';\n\nimport './../../../OrgFile/components/ActionDrawer/stylesheet.css';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as syncActions from '../../../../actions/sync_backend';\n\nimport ActionButton from '../../../OrgFile/components/ActionDrawer/components/ActionButton';\n\nconst ensureCompleteFilename = (fileName) => {\n  return fileName.endsWith('.org') ? fileName : `${fileName}.org`;\n};\n\nconst ActionDrawer = ({ org, files, syncBackend, path }) => {\n  const handleAddNewOrgFileClick = () => {\n    const content = '* First header\\nExtend the file from here.';\n    let fileName = prompt('New filename:');\n\n    if (!fileName) return;\n\n    fileName = ensureCompleteFilename(fileName);\n    let newPath = `${path}/${fileName}`;\n\n    if (_.includes(files, newPath)) {\n      alert('File already exists. Aborting.');\n    } else {\n      syncBackend.createFile(newPath, content);\n      org.addNewFile(newPath, content);\n    }\n  };\n\n  const mainButtonStyle = {\n    opacity: 1,\n    position: 'relative',\n    zIndex: 1,\n  };\n\n  return (\n    <div className=\"action-drawer-container nice-scroll\">\n      {\n        <Fragment>\n          <div\n            className=\"action-drawer__capture-buttons-container\"\n            style={{\n              marginLeft: 'auto',\n              marginRight: 0,\n            }}\n          >\n            <ActionButton\n              iconName=\"plus\"\n              isDisabled={false}\n              onClick={handleAddNewOrgFileClick}\n              style={mainButtonStyle}\n              tooltip=\"Add new Org file\"\n            />\n          </div>\n        </Fragment>\n      }\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  const path = state.syncBackend.get('currentPath');\n  let files = state.syncBackend.getIn(['currentFileBrowserDirectoryListing', 'listing']);\n  files = files ? files.map((e) => e.get('id')).toJS() : [];\n  return {\n    path,\n    files,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    syncBackend: bindActionCreators(syncActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ActionDrawer);\n","import React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Link } from 'react-router-dom';\n\nimport ActionDrawer from './components/ActionDrawer';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\n\nconst FileBrowser = ({\n  path,\n  listing,\n  hasMore,\n  isLoadingMore,\n  syncBackendType,\n  syncBackend,\n  // INFO: This was required back when we had Google Drive support.\n  // Leaving it here in case another sync backend requires it.\n  // additionalSyncBackendState,\n}) => {\n  useEffect(() => syncBackend.getDirectoryListing(path), [syncBackend, path]);\n\n  const handleLoadMoreClick = () => syncBackend.loadMoreDirectoryListing();\n\n  const getParentDirectoryPath = () => {\n    switch (syncBackendType) {\n      case 'Dropbox':\n      case 'GitLab':\n      case 'WebDAV':\n        const pathParts = path.split('/');\n        return pathParts.slice(0, pathParts.length - 1).join('/');\n      default:\n        return null;\n    }\n  };\n\n  const isTopLevelDirectory = path === '';\n\n  return (\n    <div className=\"file-browser-container\">\n      {syncBackendType === 'Dropbox' && (\n        <h3 className=\"file-browser__header\">Directory: {isTopLevelDirectory ? '/' : path}</h3>\n      )}\n\n      <ActionDrawer />\n\n      <ul className=\"file-browser__file-list\">\n        {!isTopLevelDirectory && (\n          <Link to={`/files${getParentDirectoryPath()}`}>\n            <li className=\"file-browser__file-list__element\">\n              <i className=\"fas fa-folder file-browser__file-list__icon--directory\" /> ..\n            </li>\n          </Link>\n        )}\n\n        {(listing || []).map((file) => {\n          const isDirectory = file.get('isDirectory');\n          const isBackupFile = file.get('name').endsWith('.organice-bak');\n          const isOrgFile = file.get('name').endsWith('.org');\n          const isSettingsFile = file.get('name') === '.organice-config.json';\n\n          const iconClass = classNames('file-browser__file-list__icon fas', {\n            'fa-folder': isDirectory,\n            'file-browser__file-list__icon--directory': isDirectory,\n            'fa-file': !isDirectory && !isBackupFile && !isSettingsFile,\n            'file-browser__file-list__icon--not-org': !isOrgFile,\n            'fa-copy': isBackupFile,\n            'fa-cogs': isSettingsFile,\n          });\n\n          if (file.get('isDirectory')) {\n            return (\n              <Link to={`/files${file.get('path')}`} key={file.get('id')}>\n                <li className=\"file-browser__file-list__element\">\n                  <i className={iconClass} /> {file.get('name')}/\n                </li>\n              </Link>\n            );\n          } else {\n            return (\n              <Link to={`/file${file.get('path')}`} key={file.get('id')}>\n                <li className=\"file-browser__file-list__element\">\n                  <i className={iconClass} /> {file.get('name')}\n                </li>\n              </Link>\n            );\n          }\n        })}\n\n        {hasMore &&\n          (isLoadingMore ? (\n            <li className=\"file-browser__file-list__loading-more-container\">\n              <i className=\"fas fa-spinner fa-lg fa-spin\" />\n            </li>\n          ) : (\n            <li\n              className=\"file-browser__file-list__element file-browser__file-list__element--load-more-row\"\n              onClick={handleLoadMoreClick}\n            >\n              Load more...\n            </li>\n          ))}\n      </ul>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  const currentFileBrowserDirectoryListing = state.syncBackend.get(\n    'currentFileBrowserDirectoryListing'\n  );\n  return {\n    syncBackendType: state.syncBackend.get('client').type,\n    listing: !!currentFileBrowserDirectoryListing\n      ? currentFileBrowserDirectoryListing.get('listing')\n      : null,\n    hasMore:\n      !!currentFileBrowserDirectoryListing && currentFileBrowserDirectoryListing.get('hasMore'),\n    isLoadingMore:\n      !!currentFileBrowserDirectoryListing &&\n      currentFileBrowserDirectoryListing.get('isLoadingMore'),\n    additionalSyncBackendState:\n      !!currentFileBrowserDirectoryListing &&\n      currentFileBrowserDirectoryListing.get('additionalSyncBackendState'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FileBrowser);\n","import React, { useState, useEffect } from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport './stylesheet.css';\n\nexport default ({ message }) => {\n  const [shouldRenderIndicator, setShouldRenderIndicator] = useState(true);\n  const [lastMessage, setLastMessage] = useState(message);\n\n  useEffect(() => {\n    if (!!message) {\n      setLastMessage(message);\n      setShouldRenderIndicator(true);\n    }\n  }, [message]);\n\n  const handleAnimationRest = () => {\n    if (!!message) {\n      return;\n    }\n\n    setShouldRenderIndicator(false);\n    setLastMessage(null);\n  };\n\n  const handleClick = () => setShouldRenderIndicator(false);\n\n  if (!shouldRenderIndicator) {\n    return null;\n  }\n\n  const style = {\n    opacity: spring(!!message ? 0.9 : 0, { stiffness: 300 }),\n  };\n\n  return (\n    <Motion style={style} onRest={handleAnimationRest}>\n      {(style) => (\n        <div className=\"loading-indicator\" style={style} onClick={handleClick}>\n          {lastMessage}\n        </div>\n      )}\n    </Motion>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { Map } from 'immutable';\n\nexport default class TablePart extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleTableSelect']);\n\n    this.state = {\n      rawCellValues: this.generateCellValueMap(props.table),\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      subPartDataAndHandlers: { onTableCellValueUpdate, selectedTableCellId, inTableEditMode },\n    } = this.props;\n    const { rawCellValues } = this.state;\n\n    if (prevProps.subPartDataAndHandlers.inTableEditMode && !inTableEditMode) {\n      if (rawCellValues.has(selectedTableCellId)) {\n        onTableCellValueUpdate(selectedTableCellId, rawCellValues.get(selectedTableCellId));\n      }\n    }\n\n    if (this.props.table !== prevProps.table) {\n      this.setState({ rawCellValues: this.generateCellValueMap(this.props.table) });\n    }\n  }\n\n  generateCellValueMap(table) {\n    return Map(\n      table\n        .get('contents')\n        .map((row) => row.get('contents').map((cell) => [cell.get('id'), cell.get('rawContents')]))\n        .flatten()\n    );\n  }\n\n  handleTableSelect(tableId) {\n    this.props.subPartDataAndHandlers.onTableSelect(tableId);\n  }\n\n  render() {\n    const { table } = this.props;\n    return (\n      <Fragment>\n        <table className=\"table-part\" onClick={() => this.handleTableSelect(table.get('id'))}>\n          <tbody>\n            {table.get('contents').map((row) => (\n              <tr key={row.get('id')}>\n                {row.get('contents').map((cell) => {\n                  const className = classNames('table-part__cell');\n                  return (\n                    <td className={className} key={cell.get('id')}>\n                      {cell.get('contents').size > 0 ? (\n                        <AttributedString\n                          parts={cell.get('contents')}\n                          subPartDataAndHandlers={this.props.subPartDataAndHandlers}\n                        />\n                      ) : (\n                        '   '\n                      )}\n                    </td>\n                  );\n                })}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </Fragment>\n    );\n  }\n}\n","// Interpolates between two colors.\n// colorA and colorB should be objects with keys {r, g, b, a}.\n// interpolationFactor should be a number between 0 and 1 representing how far from colorA to\n// colorB it should interpolate.\n// An object with keys {r, g, b, a} will be returned.\nexport const interpolateColors = (colorA, colorB, interpolationFactor) => {\n  return {\n    r: parseInt((colorB.r - colorA.r) * interpolationFactor + colorA.r, 10),\n    g: parseInt((colorB.g - colorA.g) * interpolationFactor + colorA.g, 10),\n    b: parseInt((colorB.b - colorA.b) * interpolationFactor + colorA.b, 10),\n    a: (colorB.a - colorA.a) * interpolationFactor + colorA.a,\n  };\n};\n\nexport const rgbaObject = (r, g, b, a) => {\n  return { r, g, b, a };\n};\n\nexport const rgbaString = (rgba) => {\n  return `rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;\n};\n\n// assumes var is either a longform-hex or rgb(a) color value\nexport const readRgbaVariable = (varName) => {\n  const varValue = getComputedStyle(document.documentElement).getPropertyValue(varName);\n  if (varValue.charAt(0) === '#') {\n    const hexValue = varValue.substring(1, 7);\n    return rgbaObject(\n      parseInt(hexValue.substring(0, 2), 16),\n      parseInt(hexValue.substring(2, 4), 16),\n      parseInt(hexValue.substring(4, 6), 16),\n      1\n    );\n  } else {\n    const rgbaValues = [...varValue.matchAll(/[0-9.]+/g)].map((a) => +a[0]);\n    if (rgbaValues.length === 3) {\n      return rgbaObject(...rgbaValues, 0);\n    } else if (rgbaValues.length === 4) {\n      return rgbaObject(...rgbaValues);\n    } else {\n      return rgbaObject(0, 0, 0, 0);\n    }\n  }\n};\n\nconst themes = {\n  Solarized: {\n    /* \n      https://ethanschoonover.com/solarized/ \n    */\n    Light: {\n      '--base3': '#fdf6e3',\n      '--base2': '#eee8d5',\n      '--base1': '#93a1a1',\n      '--base0': '#839496',\n      // highlights\n      '--base00': '#657b83',\n      '--base01': '#586e75',\n      '--base02': '#073642',\n      '--base03': '#002b36',\n      // shadows\n      '--base0-soft': 'rgba(131, 148, 150, 0.75)',\n      // highlighted backgrounds\n      '--base1-soft': 'rgba(147, 161, 161, 0.4)',\n      // header colors\n      '--blue': '#268bd2',\n      '--green': '#859900',\n      '--cyan': '#2aa198',\n      '--yellow': '#b58900',\n      // additional colors\n      '--orange': '#cb4b16',\n      '--red': '#dc322f',\n      '--magenta': '#d33682',\n      '--violet': '#6c71c4',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n    Dark: {\n      // backgrounds\n      '--base3': '#002b36',\n      '--base2': '#073642',\n      '--base1': '#586e75',\n      '--base0': '#657b83',\n      // highlights\n      '--base03': '#fdf6e3',\n      '--base02': '#eee8d5',\n      '--base01': '#93a1a1',\n      '--base00': '#839496',\n      // shadows\n      '--base0-soft': 'rgba(0, 21, 27, 0.75)',\n      // highlighted backgrounds\n      '--base1-soft': 'rgba(0, 21, 27, 0.4)',\n      // header colors\n      '--blue': '#268bd2',\n      '--green': '#859900',\n      '--cyan': '#2aa198',\n      '--yellow': '#b58900',\n      // additional colors\n      '--orange': '#cb4b16',\n      '--red': '#dc322f',\n      '--magenta': '#6c71c4',\n      '--violet': '#d33682',\n      // table highlight\n      '--green-soft:': 'rgba(133, 153, 0, 0.28)',\n    },\n  },\n  Gruvbox: {\n    Light: {\n      /*\n        see https://github.com/morhetz/gruvbox for palette\n        this theme uses the 'faded' version of the color palette\n      */\n      // background and highlights\n      '--base3': '#fbf1c7', // bg0\n      '--base2': '#d5c4a1', // bg2\n      '--base1': '#bdae93', // bg3\n      '--base0': '#a89984', // bg4\n      '--base00': '#7c6f64', // fg4\n      '--base01': '#665c54', // fg3\n      '--base02': '#504945', // fg2\n      '--base03': '#282828', // fg0\n      // transparent versions\n      '--base0-soft': 'rgba(168, 153, 132, 0.75)',\n      '--base1-soft': 'rgba(189, 174, 147, 0.4)',\n      // header colors\n      '--blue': '#076678',\n      '--green': '#79740e',\n      '--cyan': '#427b58',\n      '--yellow': '#b57614',\n      // additional colors\n      '--orange': '#af3a03',\n      '--red': '#9d0006',\n      '--magenta': '#8f3f71', // faded purple\n      '--violet': '#b16286', // neutral purple\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n    Dark: {\n      /*\n        see https://github.com/morhetz/gruvbox for palette\n        this theme uses the 'neutral' version of the color palette\n      */\n      // background and highlights\n      '--base3': '#282828', // bg0\n      '--base2': '#504945', // bg2\n      '--base1': '#665c54', // bg3\n      '--base0': '#7c6f64', // bg4\n      '--base00': '#a89984', // fg4\n      '--base01': '#bdae93', // fg3\n      '--base02': '#d5c4a1', // fg2\n      '--base03': '#fbf1c7', // fg0\n      // transparent versions\n      '--base0-soft': 'rgba(20, 20, 20, 0.75)',\n      '--base1-soft': 'rgba(20, 20, 20, 0.4)',\n      // header colors\n      '--blue': '#458588',\n      '--green': '#98971a',\n      '--cyan': '#689d6a',\n      '--yellow': '#d79921',\n      // additional colors\n      '--orange': '#d65d0e',\n      '--red': '#cc241d',\n      '--magenta': '#b16286', // neutral purple\n      '--violet': '#d3869b', // bright purple\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n  },\n  One: {\n    Light: {\n      /*\n        adaptation of atom one light theme\n        https://github.com/atom/atom/tree/master/packages/one-light-ui\n      */\n      // background and highlights\n      '--base03': '#383A42',\n      '--base02': '#585A5F',\n      '--base01': '#79797C',\n      '--base00': '#999999',\n      '--base0': '#A0A1A7',\n      '--base1': '#C0C0C4',\n      '--base2': '#DFE0E2',\n      '--base3': '#FFFFFF',\n      // transparent versions\n      '--base0-soft': 'rgba(160, 161, 167, 0.75)',\n      '--base1-soft': 'rgba(192, 192, 196, 0.4)',\n      // header colors\n      '--blue': '#1492ff',\n      '--green': '#2db448',\n      '--cyan': '#D831B0', // pink\n      '--yellow': '#d5880b',\n      // additional colors\n      '--orange': '#f42a2a', //red\n      '--red': '#f42a2a',\n      '--magenta': 'hsl(208, 100%, 56%)', // blue\n      '--violet': '#D831B0', // pink\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n    Dark: {\n      /*\n        adaptation of atom one dark theme\n        https://github.com/atom/atom/tree/master/packages/one-dark-ui\n      */\n      // background and highlights\n      '--base03': '#abb2bf',\n      '--base02': '#9198A5',\n      '--base01': '#767D8A',\n      '--base00': '#5c6370',\n      '--base0': '#4c5263',\n      '--base1': '#404553',\n      '--base2': '#343944',\n      '--base3': '#282c34',\n      // transparent versions\n      '--base0-soft': 'rgba(20, 22, 26, 0.75)',\n      '--base1-soft': 'rgba(20, 22, 26, 0.4)',\n      // header colors\n      '--blue': 'rgb(100, 148, 237)',\n      '--green': 'rgb(115, 201, 144)',\n      '--cyan': 'rgb(204, 133, 51)', //orange\n      '--yellow': 'rgb(226, 192, 141)',\n      // additional colors\n      '--orange': 'rgb(255, 99, 71)', //red\n      '--red': '#D831B0', //pink\n      '--magenta': 'rgb(0, 136, 255)', //blue\n      '--violet': '#d33682',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n  },\n  Smyck: {\n    /*\n      see http://color.smyck.org/ for palette\n    */\n    Light: {\n      // background and highlights\n      '--base3': '#F7F7F7',\n      '--base2': '#DFDFDF',\n      '--base1': '#C8C8C8',\n      '--base0': '#B0B0B0',\n      '--base00': '#5D5D5D',\n      '--base01': '#3E3E3E',\n      '--base02': '#1F1F1F',\n      '--base03': '#000000',\n      // transparent versions\n      '--base0-soft': 'rgba(176, 176, 176, 0.75)',\n      '--base1-soft': 'rgba(200, 200, 200, 0.4)',\n      // header colors\n      '--blue': '#72B3CC',\n      '--green': '#8EB33B',\n      '--cyan': '#218693',\n      '--yellow': '#D0B03C',\n      // additional colors\n      '--orange': '#C75646',\n      '--red': '#E09690',\n      '--magenta': '#77DFD8',\n      '--violet': '#FBB1F9',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n    Dark: {\n      // background and highlights\n      '--base3': '#000000',\n      '--base2': '#1F1F1F',\n      '--base1': '#3E3E3E',\n      '--base0': '#5D5D5D',\n      '--base00': '#B0B0B0',\n      '--base01': '#C8C8C8',\n      '--base02': '#DFDFDF',\n      '--base03': '#F7F7F7',\n      // transparent versions\n      '--base0-soft': 'rgba(31, 31, 31, 0.75)',\n      '--base1-soft': 'rgba(31, 31, 31, 0.4)',\n      // header colors\n      '--blue': '#72B3CC',\n      '--green': '#8EB33B',\n      '--cyan': '#218693',\n      '--yellow': '#D0B03C',\n      // additional colors\n      '--orange': '#C75646',\n      '--red': '#E09690',\n      '--magenta': '#77DFD8',\n      '--violet': '#FBB1F9',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n  },\n  Code: {\n    Light: {\n      /*\n        a rough approximation of Light+ (default light theme of VS Code)\n        https://github.com/microsoft/vscode/blob/master/extensions/theme-defaults/themes/dark_plus.json\n      */\n      // backgrounds\n      '--base3': '#FFFFFF',\n      '--base2': '#DBDBDB',\n      '--base1': '#B6B6B6',\n      '--base0': '#929292',\n      // highlights\n      '--base00': '#6D6D6D',\n      '--base01': '#494949',\n      '--base02': '#242424',\n      '--base03': '#000000',\n      // shadows\n      '--base0-soft': 'rgba(146, 146, 146, 0.75)',\n      // highlighted backgrounds\n      '--base1-soft': 'rgba(172, 172, 172, 0.4)',\n      // header colors\n      '--blue': '#0000ff',\n      '--green': '#098658',\n      '--cyan': '#267f99',\n      '--yellow': '#795e26',\n      // additional colors\n      '--orange': '#ee0000',\n      '--red': '#a31515',\n      '--magenta': '#0070c1',\n      '--violet': '#811f3f',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n    Dark: {\n      /*\n        a rough approximation of Dark+ (default dark theme of VS Code)\n        https://github.com/microsoft/vscode/blob/master/extensions/theme-defaults/themes/dark_plus.json\n      */\n      // backgrounds\n      '--base3': '#1E1E1E',\n      '--base2': '#2C2C32',\n      '--base1': '#303036',\n      '--base0': '#34343a',\n      // highlights\n      '--base00': '#C8C8C8',\n      '--base01': '#cccccc',\n      '--base02': '#D0D0D0',\n      '--base03': '#D4D4D4',\n      // shadows\n      '--base0-soft': 'rgba(15, 15, 15, 0.75)',\n      // highlighted backgrounds\n      '--base1-soft': 'rgba(15, 15, 15, 0.4)',\n      // header colors\n      '--blue': 'rgb(79,193,255)',\n      '--green': 'rgb(106, 153, 85)',\n      '--cyan': '#ce9178', // orange (cyan is #4EC9B0)\n      '--yellow': '#d7ba7d',\n      // additional colors\n      '--orange': '#d16969', // red\n      '--red': '#d16969',\n      '--magenta': '#569cd6', // light blue\n      '--violet': '#C586C0',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n  },\n};\n\nexport const loadTheme = (theme = 'Solarized', colorScheme = 'Light') => {\n  if (colorScheme === 'OS') {\n    const osPreference = window.matchMedia('(prefers-color-scheme: dark)');\n    if ('matches' in osPreference) {\n      colorScheme = osPreference.matches ? 'Dark' : 'Light';\n    } else {\n      colorScheme = 'Light';\n    }\n  }\n  const style = document.documentElement.style;\n  Object.entries(themes[theme][colorScheme]).forEach(([k, v]) => style.setProperty(k, v));\n\n  // set theme color on android\n  document\n    .querySelector('meta[name=\"theme-color\"]')\n    .setAttribute('content', themes[theme]['--base3']);\n};\n","import React from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../lib/color';\n\nimport './stylesheet.css';\n\nexport default ({ state, onClick }) => {\n  const uncheckedColor = rgbaObject(255, 255, 255, 1);\n  const checkedColor = rgbaObject(238, 232, 213, 1);\n\n  const checkboxStyle = {\n    colorFactor: spring(\n      {\n        checked: 1,\n        partial: 1,\n        unchecked: 0,\n      }[state],\n      { stiffness: 300 }\n    ),\n  };\n\n  return (\n    <Motion style={checkboxStyle}>\n      {(style) => {\n        const backgroundColor = rgbaString(\n          interpolateColors(uncheckedColor, checkedColor, style.colorFactor)\n        );\n\n        return (\n          <div className=\"checkbox\" onClick={onClick} style={{ backgroundColor }}>\n            <div className=\"checkbox__inner-container\">\n              {state === 'checked' && <i className=\"fas fa-check\" />}\n              {state === 'partial' && <i className=\"fas fa-minus\" />}\n              {state === 'unchecked' && <i className=\"fas fa-square\" />}\n            </div>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nexport default ({\n  subPartDataAndHandlers: {\n    onEnterListTitleEditMode,\n    onEnterListContentsEditMode,\n    onAddNewListItem,\n    onRemoveListItem,\n  },\n}) => {\n  return (\n    <div className=\"list-action-drawer-container\">\n      <div className=\"list-action-drawer__row\">\n        <div className=\"list-action-drawer__edit-icon-container\" onClick={onEnterListTitleEditMode}>\n          <i className=\"fas fa-pencil-alt fa-lg\" title=\"Edit list item title\" />\n        </div>\n\n        <span className=\"list-action-drawer__separator\" />\n\n        <div\n          className=\"list-action-drawer__edit-icon-container\"\n          onClick={onEnterListContentsEditMode}\n          title=\"Edit list item contents\"\n        >\n          <i className=\"fas fa-edit fa-lg\" />\n        </div>\n\n        <span className=\"list-action-drawer__separator\" />\n\n        <div className=\"list-action-drawer__edit-icon-container\" onClick={onAddNewListItem}>\n          <i\n            className=\"fas fa-plus fa-lg\"\n            data-testid=\"list-item-action-plus\"\n            title=\"Create list item below\"\n          />\n        </div>\n\n        <span className=\"list-action-drawer__separator\" />\n\n        <div className=\"list-action-drawer__edit-icon-container\" onClick={onRemoveListItem}>\n          <i className=\"fas fa-times fa-lg\" title=\"Delete list item\" />\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString/';\nimport Checkbox from '../../../../../UI/Checkbox/';\nimport ListActionDrawer from './ListActionDrawer';\nimport { listPartContainsItemId } from '../../../../../../lib/org_utils';\n\nimport { attributedStringToRawText } from '../../../../../../lib/export_org';\n\nimport { getCurrentTimestampAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { Map } from 'immutable';\n\nexport default class ListPart extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleListItemSelect',\n      'handleCheckboxClick',\n      'handleTextareaBlur',\n      'handleListTitleChange',\n      'handleListContentsChange',\n      'handleInsertTimestampListTitle',\n      'handleInsertTimestampListContents',\n      'handleTextareaRef',\n    ]);\n\n    this.state = {\n      listTitleValues: this.generateListTitleValueMap(props.part),\n      listContentsValues: this.generateListContentsValueMap(props.part),\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      subPartDataAndHandlers: {\n        onListTitleValueUpdate,\n        onListContentsValueUpdate,\n        inListTitleEditMode,\n        inListContentsEditMode,\n        selectedListItemId,\n      },\n    } = this.props;\n    const { listTitleValues, listContentsValues } = this.state;\n\n    if (prevProps.subPartDataAndHandlers.inListTitleEditMode && !inListTitleEditMode) {\n      if (listTitleValues.has(selectedListItemId)) {\n        onListTitleValueUpdate(selectedListItemId, listTitleValues.get(selectedListItemId));\n      }\n    }\n\n    const prevSelectedListItemId = prevProps.subPartDataAndHandlers.selectedListItemId;\n    if (\n      prevSelectedListItemId !== selectedListItemId &&\n      inListTitleEditMode &&\n      prevProps.subPartDataAndHandlers.inListTitleEditMode\n    ) {\n      if (\n        listTitleValues.has(prevSelectedListItemId) &&\n        listPartContainsItemId(this.props.part, prevSelectedListItemId)\n      ) {\n        onListTitleValueUpdate(prevSelectedListItemId, listTitleValues.get(prevSelectedListItemId));\n      }\n    }\n\n    if (prevProps.subPartDataAndHandlers.inListContentsEditMode && !inListContentsEditMode) {\n      if (listContentsValues.has(selectedListItemId)) {\n        onListContentsValueUpdate(selectedListItemId, listContentsValues.get(selectedListItemId));\n      }\n    }\n\n    if (\n      prevSelectedListItemId !== selectedListItemId &&\n      inListContentsEditMode &&\n      prevProps.subPartDataAndHandlers.inListContentsEditMode\n    ) {\n      if (\n        listContentsValues.has(prevSelectedListItemId) &&\n        listPartContainsItemId(this.props.part, prevSelectedListItemId)\n      ) {\n        onListContentsValueUpdate(\n          prevSelectedListItemId,\n          listContentsValues.get(prevSelectedListItemId)\n        );\n      }\n    }\n\n    if (this.props.part !== prevProps.part) {\n      this.setState({ listTitleValues: this.generateListTitleValueMap(this.props.part) });\n      this.setState({ listContentsValues: this.generateListContentsValueMap(this.props.part) });\n    }\n  }\n\n  generateListTitleValueMap(part) {\n    return Map(\n      part\n        .get('items')\n        .map((item) => [item.get('id'), attributedStringToRawText(item.get('titleLine'))])\n    );\n  }\n\n  generateListContentsValueMap(part) {\n    return Map(\n      part\n        .get('items')\n        .map((item) => [item.get('id'), attributedStringToRawText(item.get('contents'))])\n    );\n  }\n\n  handleListItemSelect(itemId) {\n    return () => this.props.subPartDataAndHandlers.onListItemSelect(itemId);\n  }\n\n  handleCheckboxClick(e, itemId) {\n    // Ticking a checkbox should only tick the checkbox, not enable\n    // the list item manipulating functions from\n    // `handleListItemSelect`.\n    // Relevant discussion:\n    // https://github.com/200ok-ch/organice/discussions/950\n    e.stopPropagation();\n    return this.props.subPartDataAndHandlers.onCheckboxClick(itemId);\n  }\n\n  handleTextareaBlur() {\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.subPartDataAndHandlers.onExitListTitleEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 0);\n  }\n\n  handleListTitleChange(event) {\n    const { listTitleValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n\n    this.setState({\n      listTitleValues: listTitleValues.set(selectedListItemId, event.target.value),\n    });\n  }\n\n  handleListContentsChange(event) {\n    const { listContentsValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n\n    this.setState({\n      listContentsValues: listContentsValues.set(selectedListItemId, event.target.value),\n    });\n  }\n\n  handleInsertTimestampListTitle() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { listTitleValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n    const listTitleValue = listTitleValues.get(selectedListItemId);\n\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      listTitleValues: listTitleValues.set(\n        selectedListItemId,\n        listTitleValue.substring(0, insertionIndex) +\n          getCurrentTimestampAsText() +\n          listTitleValue.substring(this.textarea.selectionEnd || insertionIndex)\n      ),\n    });\n\n    this.textarea.focus();\n  }\n\n  handleInsertTimestampListContents() {\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { listContentsValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n    const listContentsValue = listContentsValues.get(selectedListItemId);\n\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      listContentsValues: listContentsValues.set(\n        selectedListItemId,\n        listContentsValue.substring(0, insertionIndex) +\n          getCurrentTimestampAsText() +\n          listContentsValue.substring(this.textarea.selectionEnd || insertionIndex)\n      ),\n    });\n\n    this.textarea.focus();\n  }\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  renderContent() {\n    const {\n      part,\n      subPartDataAndHandlers: {\n        selectedListItemId,\n        inListTitleEditMode,\n        inListContentsEditMode,\n        shouldDisableActions,\n      },\n    } = this.props;\n    const { listTitleValues, listContentsValues } = this.state;\n\n    return part.get('items').map((item) => {\n      const isItemSelected = item.get('id') === selectedListItemId;\n      const lineContainerClass = classNames({\n        'list-part__not_checkbox-container': !item.get('isCheckbox'),\n        'list-part__checkbox-container': item.get('isCheckbox'),\n        'list-part__item--selected': isItemSelected,\n      });\n\n      return (\n        <li key={item.get('id')} value={item.get('forceNumber')}>\n          <div className={lineContainerClass} onClick={this.handleListItemSelect(item.get('id'))}>\n            {item.get('isCheckbox') && (\n              <Checkbox\n                onClick={(e) => this.handleCheckboxClick(e, item.get('id'))}\n                state={item.get('checkboxState')}\n              />\n            )}\n            {isItemSelected && inListTitleEditMode ? (\n              <div className=\"list-title-line__edit-container\">\n                <textarea\n                  autoFocus\n                  className=\"textarea\"\n                  data-testid=\"list-item-edit\"\n                  rows=\"3\"\n                  ref={this.handleTextareaRef}\n                  value={listTitleValues.get(item.get('id'))}\n                  onBlur={this.handleTextareaBlur}\n                  onChange={this.handleListTitleChange}\n                />\n                <div\n                  className=\"list-title-line__insert-timestamp-button\"\n                  onClick={this.handleInsertTimestampListTitle}\n                >\n                  <i className=\"fas fa-plus insert-timestamp-icon\" />\n                  Insert timestamp\n                </div>\n              </div>\n            ) : listTitleValues.get(item.get('id')) ? (\n              <AttributedString\n                parts={item.get('titleLine')}\n                subPartDataAndHandlers={this.props.subPartDataAndHandlers}\n              />\n            ) : (\n              <span>&nbsp;</span>\n            )}\n          </div>\n          <Collapse isOpened={isItemSelected && !shouldDisableActions}>\n            <ListActionDrawer subPartDataAndHandlers={this.props.subPartDataAndHandlers} />\n          </Collapse>\n          {isItemSelected && inListContentsEditMode ? (\n            <div className=\"list-contents__edit-container\">\n              <textarea\n                autoFocus\n                className=\"textarea\"\n                rows=\"8\"\n                ref={this.handleTextareaRef}\n                value={listContentsValues.get(item.get('id'))}\n                onBlur={this.handleTextareaBlur}\n                onChange={this.handleListContentsChange}\n              />\n              <div\n                className=\"list-contents__insert-timestamp-button\"\n                onClick={this.handleInsertTimestampListContents}\n              >\n                <i className=\"fas fa-plus insert-timestamp-icon\" />\n                Insert timestamp\n              </div>\n            </div>\n          ) : (\n            <AttributedString\n              parts={item.get('contents')}\n              subPartDataAndHandlers={this.props.subPartDataAndHandlers}\n            />\n          )}\n        </li>\n      );\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        {this.props.part.get('isOrdered') ? (\n          <ol className=\"attributed-string__list-part attributed-string__list-part--ordered\">\n            {this.renderContent()}\n          </ol>\n        ) : (\n          <ul className=\"attributed-string__list-part\">{this.renderContent()}</ul>\n        )}\n      </Fragment>\n    );\n  }\n}\n","import React, { Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nexport default ({ part, subPartDataAndHandlers: { onTimestampClick, shouldDisableActions } }) => {\n  const handleClick = () => (shouldDisableActions ? void 0 : onTimestampClick(part.get('id')));\n\n  const firstTimestamp = part.get('firstTimestamp');\n  const secondTimestamp = part.get('secondTimestamp');\n\n  return (\n    <span className=\"attributed-string__timestamp-part\" onClick={handleClick}>\n      {!!firstTimestamp && renderAsText(firstTimestamp)}\n      {!!secondTimestamp && (\n        <Fragment>\n          {'--'}\n          {renderAsText(secondTimestamp)}\n        </Fragment>\n      )}\n    </span>\n  );\n};\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Link, useLocation } from 'react-router-dom';\n\nimport './stylesheet.css';\n\nimport TablePart from './components/TablePart';\nimport ListPart from './components/ListPart';\nimport TimestampPart from './components/TimestampPart';\nimport ExternalLink from '../../../UI/ExternalLink';\n\nimport { orgFileExtensions } from '../../../../lib/org_utils';\nimport * as orgActions from '../../../../actions/org';\n\nimport classNames from 'classnames';\n\nconst AttributedString = ({ org, parts, subPartDataAndHandlers }) => {\n  let className;\n\n  let location = useLocation();\n\n  const renderLink = (part) => {\n    const id = part.get('id');\n    const uri = part.getIn(['contents', 'uri']);\n    const title = part.getIn(['contents', 'title']) || uri;\n    let target = uri;\n    if (uri.startsWith('file:')) {\n      target = uri.substr(5);\n      const isRelativeFileLink = !target.startsWith('/') && !target.startsWith('~');\n      if (isRelativeFileLink) {\n        // N.B. Later on we may improve this conditional by performing\n        // an existence check on the backend if it allows that\n        // operation.\n\n        target = normalisePath(target);\n        if (!target.includes('/../')) {\n          // Normalisation succeeded, so we can safely return a <Link>\n          if (!uri.match(orgFileExtensions)) {\n            // Optimistically assume that the link is pointing to a\n            // directory.\n            target = target.replace(/^\\/file\\//, '/files/');\n            return (\n              <Link key={id} to={target}>\n                {title}\n              </Link>\n            );\n          }\n        }\n      }\n      target = target.replace(/^\\/file\\//, '/');\n      return (\n        <span\n          key={id}\n          style={{ textDecoration: 'underline' }}\n          data-target={target}\n          onClick={() => org.setPath(target)}\n        >\n          {title}\n        </span>\n      );\n    }\n\n    return (\n      <ExternalLink key={id} href={target}>\n        {title}\n      </ExternalLink>\n    );\n  };\n\n  const normalisePath = (target) => {\n    let dir = location.pathname.match(/(.*)\\//)[1];\n    let normalised = target;\n    while (normalised.startsWith('../')) {\n      if (!dir.match(/^\\/file\\/.+/)) {\n        // We're already at the top; can't break out of the area accessible\n        // via HTTP, so just the original non-normalised path\n        return target;\n      }\n      normalised = normalised.substr(3);\n      dir = dir.match(/(.*)\\//)[1];\n    }\n    return dir + '/' + normalised;\n  };\n\n  return (\n    <span>\n      {parts.map((part) => {\n        switch (part.get('type')) {\n          case 'text':\n            return part.get('contents');\n          case 'link':\n            return renderLink(part);\n          case 'percentage-cookie':\n            className = classNames('attributed-string__cookie-part', {\n              'attributed-string__cookie-part--complete':\n                parseInt(part.get('percentage'), 10) === 100,\n            });\n\n            return (\n              <span key={part.get('id')} className={className}>\n                [{part.get('percentage')}\n                %]\n              </span>\n            );\n          case 'fraction-cookie':\n            className = classNames('attributed-string__cookie-part', {\n              'attributed-string__cookie-part--complete':\n                part.getIn(['fraction', 0]) !== '' &&\n                part.getIn(['fraction', 0]) === part.getIn(['fraction', 1]),\n            });\n\n            return (\n              <span key={part.get('id')} className={className}>\n                [{part.getIn(['fraction', 0])}/{part.getIn(['fraction', 1])}]\n              </span>\n            );\n          case 'table':\n            return (\n              <TablePart\n                key={part.get('id')}\n                table={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'list':\n            return (\n              <ListPart\n                key={part.get('id')}\n                part={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'inline-markup':\n            className = classNames(\n              'attributed-string__inline-markup',\n              `attributed-string__inline-markup--${part.get('markupType')}`\n            );\n\n            return (\n              <span key={part.get('id')} className={className}>\n                {part.get('content')}\n              </span>\n            );\n          case 'timestamp':\n            return (\n              <TimestampPart\n                key={part.get('id')}\n                part={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'url':\n            return (\n              <ExternalLink href={part.get('content')} key={part.get('id')}>\n                {part.get('content')}\n              </ExternalLink>\n            );\n          case 'www-url':\n            return (\n              <ExternalLink href={`https://${part.get('content')}`} key={part.get('id')}>\n                {part.get('content')}\n              </ExternalLink>\n            );\n          case 'e-mail':\n            return (\n              <a href={`mailto:${part.get('content')}`} key={part.get('id')}>\n                {part.get('content')}\n              </a>\n            );\n          case 'phone-number':\n            return (\n              <a href={`tel:${part.get('content')}`} key={part.get('id')}>\n                {part.get('content')}\n              </a>\n            );\n          default:\n            console.error(`Unrecognized attributed string part type! ${part.get('type')}`);\n            return '';\n        }\n      })}\n    </span>\n  );\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n  };\n};\n\nexport default connect(null, mapDispatchToProps)(AttributedString);\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport { createIsTodoKeywordInDoneState } from '../../../../lib/org_utils';\n\nimport { generateTitleLine } from '../../../../lib/export_org';\nimport AttributedString from '../AttributedString';\n\nclass TitleLine extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleTitleClick', 'handleTodoClick', 'handleTimestampClick']);\n\n    this.state = {\n      titleValue: this.calculateRawTitle(props.header),\n      containerWidth: null,\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  storeContainerWidth() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  componentDidMount() {\n    this.storeContainerWidth();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header } = this.props;\n\n    if (prevProps.header !== header) {\n      this.setState(\n        {\n          titleValue: this.calculateRawTitle(header),\n        },\n        () => this.storeContainerWidth()\n      );\n    }\n  }\n\n  calculateRawTitle(header) {\n    return generateTitleLine(header.toJS(), false);\n  }\n\n  handleTitleClick() {\n    const { header, hasContent, isSelected, onClick, closeSubheadersRecursively } = this.props;\n\n    if (!!onClick) {\n      onClick();\n    } else {\n      if (hasContent && (!header.get('opened') || isSelected)) {\n        this.props.org.toggleHeaderOpened(header.get('id'), closeSubheadersRecursively);\n      }\n\n      this.props.org.selectHeader(header.get('id'));\n    }\n  }\n\n  handleTodoClick(event) {\n    const { header, shouldTapTodoToAdvance, setShouldLogIntoDrawer, onClick } = this.props;\n\n    if (!!onClick) {\n      onClick();\n      event.stopPropagation();\n    } else {\n      this.props.org.selectHeader(header.get('id'));\n\n      if (shouldTapTodoToAdvance) {\n        this.props.org.advanceTodoState(null, setShouldLogIntoDrawer);\n      }\n    }\n  }\n\n  handleTitleFieldClick(event) {\n    event.stopPropagation();\n  }\n\n  handleTimestampClick(timestampId) {\n    this.props.base.activatePopup('timestamp-editor', {\n      headerId: this.props.header.get('id'),\n      timestampId,\n    });\n  }\n\n  render() {\n    const {\n      header,\n      color,\n      hasContent,\n      shouldDisableActions,\n      shouldDisableExplicitWidth,\n      todoKeywordSets,\n      addition,\n    } = this.props;\n    const { containerWidth } = this.state;\n\n    const isTodoKeywordInDoneState = createIsTodoKeywordInDoneState(todoKeywordSets);\n    const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n\n    const titleStyle = {\n      color,\n      wordBreak: 'break-word',\n    };\n\n    const additionStyle = {\n      color,\n      minWidth: '5em',\n      textAlign: 'right',\n      marginRight: '2em',\n      whiteSpace: 'nowrap',\n    };\n\n    return (\n      <div\n        className=\"title-line\"\n        onClick={this.handleTitleClick}\n        style={{ width: shouldDisableExplicitWidth ? '' : containerWidth }}\n      >\n        {!!todoKeyword ? (\n          <span\n            // INFO: Instead of `todoKeyword.toLowerCase()` it would\n            // be best to render todo-keyword--done if the keyword is\n            // the last of a keywordSet. Then it would get rendered\n            // with the appropriate color, no matter what the keyword\n            // is.\n            // Relevant issue: https://github.com/200ok-ch/organice/issues/16\n            className={classNames(\n              'todo-keyword',\n              isTodoKeywordInDoneState(todoKeyword) ? 'todo-keyword--done-state' : null\n            )}\n            onClick={this.handleTodoClick}\n          >\n            {todoKeyword}\n          </span>\n        ) : (\n          ''\n        )}\n\n        {\n          <div style={{ width: '100%' }}>\n            <div className=\"title-line-text\">\n              <span style={titleStyle}>\n                <AttributedString\n                  parts={header.getIn(['titleLine', 'title'])}\n                  subPartDataAndHandlers={{\n                    onTimestampClick: this.handleTimestampClick,\n                    shouldDisableActions,\n                  }}\n                />\n                {!header.get('opened') && hasContent ? '...' : ''}\n              </span>\n              {addition ? <span style={additionStyle}>{addition}</span> : null}\n            </div>\n            {header.getIn(['titleLine', 'tags']).size > 0 && (\n              <div>\n                {header\n                  .getIn(['titleLine', 'tags'])\n                  .toSet()\n                  .toList()\n                  .filter((tag) => !!tag)\n                  .map((tag) => (\n                    <div className=\"header-tag\" key={tag}>\n                      {tag}\n                    </div>\n                  ))}\n              </div>\n            )}\n          </div>\n        }\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path]);\n  return {\n    setShouldLogIntoDrawer: state.base.get('shouldLogIntoDrawer'),\n    shouldTapTodoToAdvance: state.base.get('shouldTapTodoToAdvance'),\n    closeSubheadersRecursively: state.base.get('closeSubheadersRecursively'),\n    isSelected: file.get('selectedHeaderId') === ownProps.header.get('id'),\n    todoKeywordSets: file.get('todoKeywordSets'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TitleLine);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\nimport { isRegularPlanningItem } from '../../../../../../lib/org_utils';\n\nimport _ from 'lodash';\n\nexport default class PlanningItems extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleTimestampClick']);\n  }\n\n  handleTimestampClick(planningType, planningItemIndex) {\n    return () => this.props.onClick(planningType, planningItemIndex);\n  }\n\n  render() {\n    const { planningItems } = this.props;\n\n    const planningItemsToRender = planningItems.filter((x) => isRegularPlanningItem(x));\n    if (planningItemsToRender.isEmpty()) return null;\n\n    return (\n      <div>\n        {planningItemsToRender.map((planningItem, index) => (\n          <div key={planningItem.get('id')} className=\"planning-items__item-container\">\n            <div className=\"planning-item__type\">{planningItem.get('type')}: </div>\n            <div\n              className=\"planning-item__timestamp\"\n              onClick={this.handleTimestampClick(planningItem.get('type'), index)}\n            >\n              {renderAsText(planningItem.get('timestamp'))}\n            </div>\n          </div>\n        ))}\n      </div>\n    );\n  }\n}\n","import React, { Fragment, useState } from 'react';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString';\n\nexport default ({ propertyListItems, shouldDisableActions, onTimestampClick, onEdit }) => {\n  const [isDrawerCollapsed, setIsDrawerCollapsed] = useState(true);\n\n  const handleCollapseToggle = () => setIsDrawerCollapsed(!isDrawerCollapsed);\n\n  return propertyListItems.size === 0 ? null : (\n    <div className=\"property-list-container\">\n      <div className=\"property-list__property\" onClick={handleCollapseToggle}>\n        :PROPERTIES:\n        {isDrawerCollapsed ? '...' : ''}\n      </div>\n\n      {!isDrawerCollapsed && (\n        <Fragment>\n          {propertyListItems.map((propertyListItem) => (\n            <div className=\"property-list__item-container\" key={propertyListItem.get('id')}>\n              <div\n                className=\"property-list__property\"\n                onClick={shouldDisableActions ? null : onEdit}\n              >\n                :{propertyListItem.get('property')}:\n              </div>\n              <div className=\"property-list__value\">\n                <AttributedString\n                  parts={propertyListItem.get('value') || []}\n                  subPartDataAndHandlers={{\n                    onTimestampClick,\n                    shouldDisableActions,\n                  }}\n                />\n              </div>\n            </div>\n          ))}\n\n          <div className=\"property-list__property\" onClick={onEdit}>\n            :END:\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n};\n","import React, { Fragment, useState } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText, timestampDuration } from '../../../../../../lib/timestamps';\n\nexport default ({ logBookEntries, onTimestampClick, shouldDisableActions }) => {\n  const [isDrawerCollapsed, setIsDrawerCollapsed] = useState(true);\n\n  const handleCollapseToggle = () => setIsDrawerCollapsed(!isDrawerCollapsed);\n\n  const onClick = (entryIndex, type) => () =>\n    shouldDisableActions ? void 0 : onTimestampClick(entryIndex, type);\n\n  return logBookEntries.size === 0 ? null : (\n    <div className=\"logbook-entries-container\">\n      <div className=\"logbook-entries__logbook\" onClick={handleCollapseToggle}>\n        :LOGBOOK:\n        {isDrawerCollapsed ? '...' : ''}\n      </div>\n      {!isDrawerCollapsed && (\n        <Fragment>\n          {logBookEntries.map((entry, index) =>\n            entry.get('raw') !== undefined ? (\n              <div className=\"logbook-entries__item-container\" key={entry.get('id')}>\n                {entry.get('raw') || ' '}\n              </div>\n            ) : (\n              <div className=\"logbook-entries__item-container\" key={entry.get('id')}>\n                <span className=\"logbook-entries__item-clock\">CLOCK:</span>\n                <span className=\"logbook-entries__item-start\" onClick={onClick(index, 'start')}>\n                  {renderAsText(entry.get('start'))}\n                </span>\n                {entry.get('end') === null ? (\n                  ''\n                ) : (\n                  <Fragment>\n                    --\n                    <span className=\"logbook-entries__item-end\" onClick={onClick(index, 'end')}>\n                      {renderAsText(entry.get('end'))}\n                    </span>\n                    <span className=\"logbook-entries__item-duration\">\n                      => {timestampDuration(entry.get('start'), entry.get('end'))}\n                    </span>\n                  </Fragment>\n                )}\n              </div>\n            )\n          )}\n          <div className=\"logbook-entries__logbook\">:END:</div>\n        </Fragment>\n      )}\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport PlanningItems from './components/PlanningItems';\nimport PropertyListItems from './components/PropertyListItems';\nimport LogBookEntries from './components/LogBookEntries';\n\nimport _ from 'lodash';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport { getCurrentTimestampAsText } from '../../../../lib/timestamps';\nimport { createRawDescriptionText } from '../../../../lib/export_org';\n\nimport AttributedString from '../AttributedString';\n\nclass HeaderContent extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleTableSelect',\n      'handleCheckboxClick',\n      'handleListItemSelect',\n      'handleEnterListTitleEditMode',\n      'handleExitListTitleEditMode',\n      'handleListTitleValueUpdate',\n      'handleEnterListContentsEditMode',\n      'handleExitListContentsEditMode',\n      'handleListContentsValueUpdate',\n      'handleAddNewListItem',\n      'handleRemoveListItem',\n      'handleTimestampClick',\n      'handleLogEntryTimestampClick',\n      'handleInsertTimestamp',\n      'handlePlanningItemTimestampClick',\n      'handlePropertyListEdit',\n    ]);\n\n    this.state = {\n      descriptionValue: this.calculateRawDescription(props.header),\n      containerWidth: null,\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  storeContainerWidth() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  componentDidMount() {\n    this.storeContainerWidth();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header } = this.props;\n\n    if (prevProps.header !== header) {\n      this.setState(\n        {\n          descriptionValue: this.calculateRawDescription(header),\n        },\n        () => this.storeContainerWidth()\n      );\n    }\n  }\n\n  calculateRawDescription(header) {\n    // This generates the text that appears in the description text field.\n    const dontIndent = this.props.dontIndent;\n    return createRawDescriptionText(header, false, dontIndent);\n  }\n\n  handleTableSelect(tableId) {\n    this.props.org.selectHeader(this.props.header.get('id'));\n    this.props.org.setSelectedTableId(tableId);\n    this.props.base.activatePopup('table-editor');\n  }\n\n  handleCheckboxClick(listItemId) {\n    this.props.org.advanceCheckboxState(listItemId);\n  }\n\n  handleListItemSelect(listItemId) {\n    this.props.org.setSelectedListItemId(listItemId);\n  }\n\n  handleEnterListTitleEditMode() {\n    this.props.org.enterEditMode('list-title');\n  }\n\n  handleExitListTitleEditMode() {\n    this.props.org.exitEditMode();\n  }\n\n  handleListTitleValueUpdate(listItemId, newValue) {\n    this.props.org.updateListTitleValue(listItemId, newValue);\n  }\n\n  handleEnterListContentsEditMode() {\n    this.props.org.enterEditMode('list-contents');\n  }\n\n  handleExitListContentsEditMode() {\n    this.props.org.exitEditMode();\n  }\n\n  handleListContentsValueUpdate(listItemId, newValue) {\n    this.props.org.updateListContentsValue(listItemId, newValue);\n  }\n\n  handleAddNewListItem() {\n    this.props.org.addNewListItemAndEdit();\n  }\n\n  handleRemoveListItem() {\n    this.props.org.removeListItem();\n  }\n\n  handleTimestampClick(timestampId) {\n    this.props.base.activatePopup('timestamp-editor', {\n      timestampId,\n      headerId: this.props.header.get('id'),\n    });\n  }\n\n  handleLogEntryTimestampClick(headerId) {\n    return (logEntryIndex, entryType) =>\n      this.props.base.activatePopup('timestamp-editor', {\n        headerId,\n        logEntryIndex,\n        entryType,\n      });\n  }\n\n  handleInsertTimestamp() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { descriptionValue } = this.state;\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      descriptionValue:\n        descriptionValue.substring(0, insertionIndex) +\n        getCurrentTimestampAsText() +\n        descriptionValue.substring(this.textarea.selectionEnd || insertionIndex),\n    });\n    this.textarea.focus();\n  }\n\n  handlePlanningItemTimestampClick(headerId) {\n    return (planningType, planningItemIndex) => {\n      const popupType =\n        {\n          DEADLINE: 'deadline-editor',\n          SCHEDULED: 'scheduled-editor',\n        }[planningType] || 'timestamp-editor';\n      this.props.base.activatePopup(popupType, { headerId, planningItemIndex });\n    };\n  }\n\n  handlePropertyListEdit() {\n    const { header } = this.props;\n    this.props.base.activatePopup('property-list-editor', { headerId: header.get('id') });\n  }\n\n  render() {\n    const {\n      header,\n      shouldDisableActions,\n      selectedListItemId,\n      inListTitleEditMode,\n      inListContentsEditMode,\n    } = this.props;\n    const { containerWidth } = this.state;\n\n    if (!header.get('opened')) {\n      return <div />;\n    }\n\n    return (\n      <div className=\"header-content-container nice-scroll\" style={{ width: containerWidth }}>\n        {\n          <Fragment>\n            <PlanningItems\n              planningItems={header.get('planningItems')}\n              onClick={this.handlePlanningItemTimestampClick(header.get('id'))}\n            />\n            <PropertyListItems\n              propertyListItems={header.get('propertyListItems')}\n              onTimestampClick={this.handleTimestampClick}\n              shouldDisableActions={shouldDisableActions}\n              onEdit={this.handlePropertyListEdit}\n            />\n            <AttributedString\n              parts={header.get('logNotes')}\n              subPartDataAndHandlers={{\n                onTimestampClick: this.handleTimestampClick,\n                shouldDisableActions,\n              }}\n            />\n            <LogBookEntries\n              logBookEntries={header.get('logBookEntries')}\n              onTimestampClick={this.handleLogEntryTimestampClick(header.get('id'))}\n              shouldDisableActions={shouldDisableActions}\n            />\n            <AttributedString\n              parts={header.get('description')}\n              subPartDataAndHandlers={{\n                onTableSelect: shouldDisableActions ? undefined : this.handleTableSelect,\n                onCheckboxClick: this.handleCheckboxClick,\n                onListItemSelect: this.handleListItemSelect,\n                onEnterListTitleEditMode: this.handleEnterListTitleEditMode,\n                onExitListTitleEditMode: this.handleExitListTitleEditMode,\n                onListTitleValueUpdate: this.handleListTitleValueUpdate,\n                onEnterListContentsEditMode: this.handleEnterListContentsEditMode,\n                onExitListContentsEditMode: this.handleExitListContentsEditMode,\n                onListContentsValueUpdate: this.handleListContentsValueUpdate,\n                onAddNewListItem: this.handleAddNewListItem,\n                onRemoveListItem: this.handleRemoveListItem,\n                selectedListItemId: selectedListItemId,\n                inListTitleEditMode: inListTitleEditMode,\n                inListContentsEditMode: inListContentsEditMode,\n                onTimestampClick: this.handleTimestampClick,\n                shouldDisableActions,\n              }}\n            />\n          </Fragment>\n        }\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path]);\n  return {\n    isSelected: file.get('selectedHeaderId') === ownProps.header.get('id'),\n    dontIndent: state.base.get('shouldNotIndentOnExport'),\n    selectedListItemId: file.get('selectedListItemId'),\n    inListTitleEditMode: file.get('editMode') === 'list-title',\n    inListContentsEditMode: file.get('editMode') === 'list-contents',\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderContent);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nexport default class HeaderActionDrawer extends PureComponent {\n  // A nasty hack required to get click handling to work properly in Firefox. No idea why its\n  // broken in the first place or why this fixes it.\n  iconWithFFClickCatcher({ className, onClick, title, testId = '' }) {\n    return (\n      <div\n        title={title}\n        onClick={onClick}\n        className=\"header-action-drawer__ff-click-catcher-container\"\n      >\n        <div className=\"header-action-drawer__ff-click-catcher\" />\n        <i className={className} data-testid={testId} />\n      </div>\n    );\n  }\n\n  render() {\n    const {\n      onTitleClick,\n      onDescriptionClick,\n      onTagsClick,\n      onPropertiesClick,\n      isNarrowed,\n      onNarrow,\n      onWiden,\n      onAddNewHeader,\n      onDeadlineClick,\n      onClockInOutClick,\n      onScheduledClick,\n      hasActiveClock,\n      onShareHeader,\n      onRefileHeader,\n      onAddNote,\n    } = this.props;\n\n    return (\n      <div className=\"header-action-drawer-container\">\n        <div className=\"header-action-drawer__row\">\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-pencil-alt fa-lg',\n            onClick: onTitleClick,\n            title: 'Edit header title',\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-edit fa-lg',\n            onClick: onDescriptionClick,\n            title: 'Edit header description',\n            testId: 'edit-header-title',\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-tags fa-lg',\n            onClick: onTagsClick,\n            title: 'Modify tags',\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-list fa-lg',\n            onClick: onPropertiesClick,\n            title: 'Modify properties',\n          })}\n\n          {isNarrowed\n            ? this.iconWithFFClickCatcher({\n                className: 'fas fa-expand fa-lg',\n                onClick: onWiden,\n                title: 'Widen (Cancelling the narrowing.)',\n              })\n            : this.iconWithFFClickCatcher({\n                className: 'fas fa-compress fa-lg',\n                onClick: onNarrow,\n                testId: 'header-action-narrow',\n                title:\n                  'Narrow to subtree (focusing in on some portion of the buffer, making the rest temporarily inaccessible.)',\n              })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-plus fa-lg',\n            onClick: onAddNewHeader,\n            testId: 'header-action-plus',\n            title: 'Create new header below',\n          })}\n        </div>\n\n        <div className=\"header-action-drawer__row\">\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-envelope fa-lg',\n            onClick: onShareHeader,\n            testId: 'share',\n            title: 'Share this header via email',\n          })}\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-calendar-check fa-lg',\n            onClick: onDeadlineClick,\n            title: 'Set deadline datetime',\n          })}\n          {this.iconWithFFClickCatcher({\n            className: 'far fa-calendar-check fa-lg',\n            onClick: onScheduledClick,\n            title: 'Set scheduled datetime',\n          })}\n          {hasActiveClock\n            ? this.iconWithFFClickCatcher({\n                className: 'fas fa-hourglass-end fa-lg',\n                onClick: onClockInOutClick,\n                testId: 'org-clock-out',\n                title: 'Clock out (Stop the clock)',\n              })\n            : this.iconWithFFClickCatcher({\n                className: 'fas fa-hourglass-start fa-lg',\n                onClick: onClockInOutClick,\n                testId: 'org-clock-in',\n                title: 'Clock in (Start the clock)',\n              })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-file-export fa-lg',\n            onClick: onRefileHeader,\n            testId: 'org-refile',\n            title: 'Refile this header to another header',\n          })}\n          {this.iconWithFFClickCatcher({\n            className: 'far fa-sticky-note fa-lg',\n            onClick: onAddNote,\n            title: 'Add a note',\n          })}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Motion, spring } from 'react-motion';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nimport TitleLine from '../TitleLine';\nimport HeaderContent from '../HeaderContent';\nimport HeaderActionDrawer from './components/HeaderActionDrawer';\n\nimport { headerWithId } from '../../../../lib/org_utils';\nimport { interpolateColors, rgbaObject, rgbaString, readRgbaVariable } from '../../../../lib/color';\nimport { getCurrentTimestamp, millisDuration } from '../../../../lib/timestamps';\nimport { Map } from 'immutable';\n\nclass Header extends PureComponent {\n  SWIPE_ACTION_ACTIVATION_DISTANCE = 80;\n  FREE_DRAG_ACTIVATION_DISTANCE = 10;\n\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleMouseDown',\n      'handleTouchStart',\n      'handleTouchCancel',\n      'handleHeaderClick',\n      'handleShowTitleModal',\n      'handleShowDescriptionModal',\n      'handleShowTagsModal',\n      'handleShowPropertyListEditorModal',\n      'handleNarrow',\n      'handleWiden',\n      'handleAddNewHeader',\n      'handleRest',\n      'handleDeadlineClick',\n      'handleClockInOutClick',\n      'handleScheduledClick',\n      'handleShareHeaderClick',\n      'handleRefileHeaderRequest',\n      'handleAddNoteClick',\n    ]);\n\n    this.state = {\n      isDraggingFreely: false,\n      dragStartX: null,\n      currentDragX: null,\n      containerWidth: null,\n      isPlayingRemoveAnimation: false,\n      heightBeforeRemove: null,\n      disabledBackgroundColor: readRgbaVariable('--base3'),\n      // Track vertical touch positions to detect vertical scrolling intent\n      touchStartY: null,\n      currentTouchY: null,\n    };\n\n    // Store member callbacks handling global mouse/touch events to be able to handle dragging\n    // interactions outside of the current component.\n    this.globalMouseMoveHandler = this.handleMouseMove.bind(this);\n    this.globalMouseUpHandler = this.handleMouseUp.bind(this);\n    this.globalTouchMoveHandler = this.handleTouchMove.bind(this);\n    this.globalTouchEndHandler = this.handleTouchEnd.bind(this);\n  }\n\n  addGlobalDragHandlers() {\n    // Begin listening for global mouse/touch events after dragging begins\n    window.addEventListener('mousemove', this.globalMouseMoveHandler);\n    window.addEventListener('mouseup', this.globalMouseUpHandler);\n    window.addEventListener('touchmove', this.globalTouchMoveHandler);\n    window.addEventListener('touchend', this.globalTouchEndHandler);\n  }\n\n  removeGlobalDragHandlers() {\n    // Stop listening for global mouse/touch events after dragging ends\n    window.removeEventListener('mousemove', this.globalMouseMoveHandler);\n    window.removeEventListener('mouseup', this.globalMouseUpHandler);\n    window.removeEventListener('touchmove', this.globalTouchMoveHandler);\n    window.removeEventListener('touchend', this.globalTouchEndHandler);\n  }\n\n  componentDidMount() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  componentWillUnmount() {\n    this.removeGlobalDragHandlers();\n  }\n\n  handleRef(containerDiv) {\n    this.containerDiv = containerDiv;\n    this.props.onRef(containerDiv);\n  }\n\n  handleDragStart(event, dragX) {\n    if (this.props.shouldDisableActions) {\n      return;\n    }\n\n    if (!!event.target.closest('.table-part')) {\n      return;\n    }\n\n    this.setState({\n      dragStartX: dragX,\n    });\n\n    // Begin listening to global mouse/touch events to allow dragging outside of the current\n    // component.\n    this.addGlobalDragHandlers();\n  }\n\n  handleDragMove(dragX) {\n    if (this.state.dragStartX === null) {\n      return;\n    }\n\n    if (!this.state.isDraggingFreely) {\n      if (Math.abs(dragX - this.state.dragStartX) >= this.FREE_DRAG_ACTIVATION_DISTANCE) {\n        this.setState({ isDraggingFreely: true });\n      }\n    }\n\n    this.setState({ currentDragX: dragX });\n  }\n\n  handleDragEnd() {\n    const { dragStartX, currentDragX } = this.state;\n\n    if (!!dragStartX && !!currentDragX) {\n      const swipeDistance = currentDragX - dragStartX;\n\n      if (swipeDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE) {\n        this.props.org.advanceTodoState(\n          this.props.header.get('id'),\n          this.props.shouldLogIntoDrawer\n        );\n      }\n\n      if (-1 * swipeDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE) {\n        this.setState({\n          isPlayingRemoveAnimation: true,\n          heightBeforeRemove: this.containerDiv.offsetHeight,\n        });\n      }\n    }\n\n    this.setState({\n      dragStartX: null,\n      currentDragX: null,\n      isDraggingFreely: false,\n    });\n\n    this.removeGlobalDragHandlers();\n  }\n\n  handleDragCancel() {\n    this.setState({\n      dragStartX: null,\n      currentDragX: null,\n      isDraggingFreely: false,\n    });\n  }\n\n  handleMouseDown(event) {\n    this.handleDragStart(event, event.clientX);\n  }\n\n  handleMouseMove(event) {\n    this.handleDragMove(event.clientX, event.clientY);\n  }\n\n  handleMouseUp() {\n    this.handleDragEnd();\n  }\n\n  handleTouchStart(event) {\n    // Capture the initial Y position of the touch to track vertical movement\n    const touch = event.changedTouches[0];\n    this.setState({\n      touchStartY: touch.clientY,\n    });\n    this.handleDragStart(event, touch.clientX);\n  }\n\n  handleTouchMove(event) {\n    const touch = event.changedTouches[0];\n    const currentY = touch.clientY;\n    const currentX = touch.clientX;\n\n    // Update the current Y position for vertical movement tracking\n    this.setState({ currentTouchY: currentY });\n\n    // Detect if this is primarily a vertical scroll gesture\n    // If the user is moving more vertically than horizontally, we should\n    // cancel the horizontal drag to allow normal page scrolling\n    if (this.state.touchStartY !== null && this.state.dragStartX !== null) {\n      const verticalDistance = Math.abs(currentY - this.state.touchStartY);\n      const horizontalDistance = Math.abs(currentX - this.state.dragStartX);\n\n      // If vertical movement is significantly greater than horizontal movement,\n      // cancel the drag operation to allow normal page scrolling\n      // The threshold of 10px ensures small movements don't trigger cancellation\n      if (verticalDistance > horizontalDistance && verticalDistance > 10) {\n        this.handleDragCancel();\n        return;\n      }\n    }\n\n    this.handleDragMove(currentX, currentY);\n  }\n\n  handleTouchEnd() {\n    // Reset vertical touch tracking when touch ends\n    this.setState({\n      touchStartY: null,\n      currentTouchY: null,\n    });\n    this.handleDragEnd();\n  }\n\n  handleTouchCancel() {\n    // Reset vertical touch tracking when touch is cancelled\n    this.setState({\n      touchStartY: null,\n      currentTouchY: null,\n    });\n    this.handleDragCancel();\n  }\n\n  handleHeaderClick(event) {\n    const classList = event.target.classList;\n    if (classList.contains('header') || classList.contains('header__bullet')) {\n      const { header, hasContent, isSelected, closeSubheadersRecursively } = this.props;\n\n      if (hasContent && (!header.get('opened') || isSelected)) {\n        this.props.org.toggleHeaderOpened(header.get('id'), closeSubheadersRecursively);\n      }\n\n      this.props.org.selectHeader(header.get('id'));\n    }\n  }\n\n  handleShowTitleModal() {\n    this.props.base.activatePopup('title-editor');\n  }\n\n  handleShowDescriptionModal() {\n    this.props.base.activatePopup('description-editor');\n  }\n\n  handleShowTagsModal() {\n    this.props.base.activatePopup('tags-editor');\n  }\n\n  handleShowPropertyListEditorModal() {\n    this.props.base.activatePopup('property-list-editor');\n  }\n\n  handleNarrow() {\n    this.props.org.narrowHeader(this.props.header.get('id'));\n  }\n\n  handleWiden() {\n    this.props.org.widenHeader();\n  }\n\n  handleAddNewHeader() {\n    this.props.org.addHeaderAndEdit(this.props.header.get('id'));\n  }\n\n  handleRest() {\n    if (this.state.isPlayingRemoveAnimation) {\n      this.props.org.removeHeader(this.props.header.get('id'));\n    }\n  }\n\n  handleDeadlineAndScheduledClick(planningType) {\n    const { header } = this.props;\n    const popupType = {\n      DEADLINE: 'deadline-editor',\n      SCHEDULED: 'scheduled-editor',\n    }[planningType];\n\n    const existingDeadlinePlanningItemIndex = header\n      .get('planningItems', [])\n      .findIndex((planningItem) => planningItem.get('type') === planningType);\n\n    this.props.base.activatePopup(popupType, {\n      headerId: header.get('id'),\n      planningItemIndex: existingDeadlinePlanningItemIndex,\n    });\n\n    this.props.org.openHeader(header.get('id'));\n  }\n\n  handleDeadlineClick() {\n    this.handleDeadlineAndScheduledClick('DEADLINE');\n  }\n\n  handleClockInOutClick() {\n    const { header } = this.props;\n    const logBook = header.get('logBookEntries', []);\n    const existingClockIndex = logBook.findIndex((entry) => entry.get('end') === null);\n    const now = getCurrentTimestamp({ isActive: false, withStartTime: true });\n    if (existingClockIndex !== -1) {\n      this.props.org.setLogEntryStop(\n        header.get('id'),\n        logBook.getIn([existingClockIndex, 'id']),\n        now\n      );\n    } else {\n      this.props.org.createLogEntryStart(header.get('id'), now);\n    }\n  }\n\n  handleScheduledClick() {\n    this.handleDeadlineAndScheduledClick('SCHEDULED');\n  }\n\n  handleShareHeaderClick() {\n    const { header } = this.props;\n\n    const titleLine = header.get('titleLine');\n    const todoKeyword = titleLine.get('todoKeyword');\n    const tags = titleLine.get('tags');\n    const title = titleLine.get('rawTitle').trim();\n    const subject = todoKeyword ? `${todoKeyword} ${title}` : title;\n    const body = `\n${tags.isEmpty() ? '' : `Tags: ${tags.join(' ')}\\n`}\n${header.get('rawDescription')}`;\n    //const titleParts = titleLine.get('title'); // List of parsed tokens in title\n    //const properties = header.get('propertyListItem'); //.get(0) .get('property') or .get('value')\n    //const planningItems = header.get('planningItems'); //.get(0) .get('type') [DEADLINE|SCHEDULED] or .get('timestamp')\n    const mailtoURI = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(\n      body\n    )}`;\n    // TODO: If available, use webshare\n    // Maybe there's synergy with this PR: https://github.com/200ok-ch/organice/pull/138/files\n\n    window.open(mailtoURI);\n    // INFO: Alternative implementation that works without having a\n    // popup window. We didn't go this route, because it's non-trivial\n    // to mock the window object, so it's harder to test. Having\n    // slightly worse UX in favor of having a test is not optimal, as\n    // well, of course.\n    // window.location.href = mailtoURI;\n  }\n\n  handleAddNoteClick() {\n    this.props.base.activatePopup('note-editor');\n  }\n\n  handlePopupClose() {\n    this.props.base.closePopup();\n  }\n\n  handleRefileHeaderRequest() {\n    this.props.base.activatePopup('refile');\n  }\n\n  render() {\n    const {\n      header,\n      color,\n      hasContent,\n      isSelected,\n      bulletStyle,\n      narrowedHeader,\n      isNarrowed,\n      shouldDisableActions,\n      showClockDisplay,\n      showDeadlineDisplay,\n    } = this.props;\n    const indentLevel = !!narrowedHeader\n      ? header.get('nestingLevel') - narrowedHeader.get('nestingLevel') + 1\n      : header.get('nestingLevel');\n\n    const headerDeadlineMap = header\n      .get('planningItems')\n      .filter((p) => p.get('type') === 'DEADLINE')\n      .map((p) => p.get('timestamp'))\n      .get(0);\n\n    const headerDeadline =\n      headerDeadlineMap !== undefined\n        ? headerDeadlineMap.get('month') +\n          '-' +\n          headerDeadlineMap.get('day') +\n          '-' +\n          headerDeadlineMap.get('year')\n        : '';\n\n    const {\n      dragStartX,\n      currentDragX,\n      isDraggingFreely,\n      isPlayingRemoveAnimation,\n      containerWidth,\n    } = this.state;\n    const marginLeft =\n      !!dragStartX && !!currentDragX && isDraggingFreely\n        ? currentDragX - dragStartX\n        : isPlayingRemoveAnimation\n        ? spring(-1 * containerWidth, { stiffness: 300 })\n        : spring(0, { stiffness: 300 });\n\n    const style = {\n      paddingLeft: 20 * indentLevel,\n      marginLeft,\n      heightFactor: isPlayingRemoveAnimation ? spring(0, { stiffness: 300 }) : 1,\n    };\n\n    const className = classNames('header', {\n      'header--selected': isSelected,\n      'header--removing': isPlayingRemoveAnimation,\n    });\n\n    const logBookEntries = header\n      .get('logBookEntries')\n      .filter((entry) => entry.get('raw') === undefined);\n    const hasActiveClock =\n      logBookEntries.size !== 0 && logBookEntries.filter((entry) => !entry.get('end')).size !== 0;\n\n    return (\n      <Motion style={style} onRest={this.handleRest}>\n        {(interpolatedStyle) => {\n          const swipedDistance = interpolatedStyle.marginLeft;\n          const isLeftActionActivated = swipedDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE;\n          const isRightActionActivated =\n            -1 * swipedDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE;\n\n          const leftActivatedBackgroundColor = rgbaObject(0, 128, 0, 1);\n          const rightActivatedBackgroundColor = rgbaObject(255, 0, 0, 1);\n\n          const disabledIconColor = rgbaObject(0, 0, 0, 1);\n          const activatedIconColor = rgbaObject(255, 255, 255, 1);\n\n          const leftSwipeActionContainerStyle = {\n            width: interpolatedStyle.marginLeft,\n            backgroundColorFactor: spring(isLeftActionActivated ? 1 : 0, { stiffness: 300 }),\n          };\n          const rightSwipeActionContainerStyle = {\n            width: -1 * interpolatedStyle.marginLeft,\n            backgroundColorFactor: spring(isRightActionActivated ? 1 : 0, { stiffness: 300 }),\n          };\n\n          const { heightFactor, ...headerStyle } = interpolatedStyle;\n\n          if (isPlayingRemoveAnimation) {\n            headerStyle.height = this.state.heightBeforeRemove * heightFactor;\n          }\n\n          return (\n            <div\n              className={className}\n              style={headerStyle}\n              ref={this.handleRef}\n              onClick={this.handleHeaderClick}\n              onMouseDown={this.handleMouseDown}\n              onTouchStart={this.handleTouchStart}\n              onTouchCancel={this.handleTouchCancel}\n            >\n              <Motion style={leftSwipeActionContainerStyle}>\n                {(leftInterpolatedStyle) => {\n                  const leftStyle = {\n                    width: leftInterpolatedStyle.width,\n                    backgroundColor: rgbaString(\n                      interpolateColors(\n                        this.state.disabledBackgroundColor,\n                        leftActivatedBackgroundColor,\n                        leftInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  const leftIconStyle = {\n                    display: swipedDistance > 30 ? '' : 'none',\n                    color: rgbaString(\n                      interpolateColors(\n                        disabledIconColor,\n                        activatedIconColor,\n                        leftInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  return (\n                    <div className=\"left-swipe-action-container\" style={leftStyle}>\n                      <i\n                        className=\"fas fa-check swipe-action-container__icon swipe-action-container__icon--left\"\n                        style={leftIconStyle}\n                      />\n                    </div>\n                  );\n                }}\n              </Motion>\n              <Motion style={rightSwipeActionContainerStyle}>\n                {(rightInterpolatedStyle) => {\n                  const rightStyle = {\n                    width: rightInterpolatedStyle.width,\n                    backgroundColor: rgbaString(\n                      interpolateColors(\n                        this.state.disabledBackgroundColor,\n                        rightActivatedBackgroundColor,\n                        rightInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  const rightIconStyle = {\n                    display: -1 * swipedDistance > 30 ? '' : 'none',\n                    color: rgbaString(\n                      interpolateColors(\n                        disabledIconColor,\n                        activatedIconColor,\n                        rightInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  return (\n                    <div className=\"right-swipe-action-container\" style={rightStyle}>\n                      <i\n                        className=\"fas fa-times swipe-action-container__icon swipe-action-container__icon--right\"\n                        style={rightIconStyle}\n                      />\n                    </div>\n                  );\n                }}\n              </Motion>\n\n              <div style={{ marginLeft: -16, color }} className=\"header__bullet\">\n                {bulletStyle === 'Fancy' ? '●' : '*'}\n              </div>\n              <TitleLine\n                header={header}\n                color={color}\n                hasContent={hasContent}\n                isSelected={isSelected}\n                shouldDisableExplicitWidth={swipedDistance === 0}\n                shouldDisableActions={shouldDisableActions}\n                addition={\n                  (showClockDisplay && header.get('totalTimeLoggedRecursive') !== 0\n                    ? millisDuration(header.get('totalTimeLoggedRecursive'))\n                    : '') +\n                  // Spacing between 'clock display' and 'deadline\n                  // display' overlays\n                  (showClockDisplay && showDeadlineDisplay ? ' ' : '') +\n                  (showDeadlineDisplay && headerDeadline !== undefined ? headerDeadline : '')\n                }\n              />\n\n              <Collapse\n                isOpened={isSelected && !shouldDisableActions}\n                springConfig={{ stiffness: 300 }}\n                style={{ marginRight: rightSwipeActionContainerStyle.width }}\n              >\n                <HeaderActionDrawer\n                  onTitleClick={this.handleShowTitleModal}\n                  onDescriptionClick={this.handleShowDescriptionModal}\n                  isNarrowed={isNarrowed}\n                  onTagsClick={this.handleShowTagsModal}\n                  onPropertiesClick={this.handleShowPropertyListEditorModal}\n                  onNarrow={this.handleNarrow}\n                  onWiden={this.handleWiden}\n                  onAddNewHeader={this.handleAddNewHeader}\n                  onDeadlineClick={this.handleDeadlineClick}\n                  onClockInOutClick={this.handleClockInOutClick}\n                  onScheduledClick={this.handleScheduledClick}\n                  hasActiveClock={hasActiveClock}\n                  onShareHeader={this.handleShareHeaderClick}\n                  onRefileHeader={this.handleRefileHeaderRequest}\n                  onAddNote={this.handleAddNoteClick}\n                />\n              </Collapse>\n\n              <HeaderContent header={header} shouldDisableActions={shouldDisableActions} />\n            </div>\n          );\n        }}\n      </Motion>\n    );\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path], Map());\n  const narrowedHeader = !!file.get('narrowedHeaderId')\n    ? headerWithId(file.get('headers'), file.get('narrowedHeaderId'))\n    : null;\n\n  return {\n    bulletStyle: state.base.get('bulletStyle'),\n    shouldLogIntoDrawer: state.base.get('shouldLogIntoDrawer'),\n    closeSubheadersRecursively: state.base.get('closeSubheadersRecursively'),\n    narrowedHeader,\n    isNarrowed: !!narrowedHeader && narrowedHeader.get('id') === ownProps.header.get('id'),\n    showClockDisplay: state.org.present.get('showClockDisplay'),\n    showDeadlineDisplay: state.base.get('showDeadlineDisplay'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n  base: bindActionCreators(baseActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Header);\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport './stylesheet.css';\n\nimport Header from '../Header';\n\nimport { numSubheadersOfHeaderWithId, hasHeaderContent } from '../../../../lib/org_utils';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { List, Map } from 'immutable';\n\nclass HeaderList extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.headerRefs = {};\n\n    _.bindAll(this, ['handleHeaderRef']);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.selectedHeaderId !== this.props.selectedHeaderId) {\n      const selectedHeaderDiv = this.headerRefs[this.props.selectedHeaderId];\n      if (!!selectedHeaderDiv) {\n        const boundingRectangle = selectedHeaderDiv.getBoundingClientRect();\n        const viewportHeight = document.documentElement.clientHeight;\n\n        if (boundingRectangle.top > viewportHeight * 0.9 || boundingRectangle.bottom < 0) {\n          selectedHeaderDiv.scrollIntoView();\n        }\n      }\n    }\n  }\n\n  handleHeaderRef(headerId) {\n    return (div) => (this.headerRefs[headerId] = div);\n  }\n\n  render() {\n    const { headers, selectedHeaderId, narrowedHeaderId, shouldDisableActions } = this.props;\n    const headerRenderData = headers\n      .map((header) => {\n        return {\n          header,\n          displayed: false,\n          hasContent: hasHeaderContent(header),\n        };\n      })\n      .toArray();\n\n    headerRenderData.forEach((headerRenderDatum, index) => {\n      const nestingLevel = headerRenderDatum.header.get('nestingLevel');\n\n      const hasNoParents = headerRenderData\n        .slice(0, index)\n        .every(\n          (previousRenderDatum) => previousRenderDatum.header.get('nestingLevel') >= nestingLevel\n        );\n      if (hasNoParents) {\n        headerRenderDatum.displayed = true;\n      }\n\n      const followingHeaders = headerRenderData.slice(index + 1);\n      for (\n        let followingHeaderIndex = 0;\n        followingHeaderIndex < followingHeaders.length;\n        ++followingHeaderIndex\n      ) {\n        const followingHeader = followingHeaders[followingHeaderIndex];\n        if (followingHeader.header.get('nestingLevel') <= nestingLevel) {\n          break;\n        }\n\n        headerRenderDatum.hasContent = true;\n\n        followingHeader.displayed =\n          headerRenderDatum.header.get('opened') && headerRenderDatum.displayed;\n      }\n    });\n\n    if (!!narrowedHeaderId) {\n      const narrowedHeaderIndex = headerRenderData.findIndex(\n        (headerRenderDatum) => headerRenderDatum.header.get('id') === narrowedHeaderId\n      );\n\n      const previousHeaders = headerRenderData.slice(0, narrowedHeaderIndex);\n      previousHeaders.forEach((headerRenderDatum) => (headerRenderDatum.displayed = false));\n\n      const numSubheaders = numSubheadersOfHeaderWithId(headers, narrowedHeaderId);\n      const followingHeaders = headerRenderData.slice(narrowedHeaderIndex + numSubheaders + 1);\n      followingHeaders.forEach((headerRenderDatum) => (headerRenderDatum.displayed = false));\n    }\n\n    const headerColors = [\n      'var(--blue)',\n      'var(--green)',\n      'var(--cyan)',\n      'var(--yellow)',\n      'var(--blue)',\n      'var(--green)',\n      'var(--cyan)',\n      'var(--yellow)',\n    ];\n\n    const displayedHeaderRenderData = headerRenderData.filter(\n      (headerRenderDatum) => headerRenderDatum.displayed\n    );\n\n    const className = classNames('header-list-container', {\n      'header-list-container--narrowed': !!narrowedHeaderId,\n    });\n    return (\n      <div className={className}>\n        {displayedHeaderRenderData.map((headerRenderDatum) => {\n          const header = headerRenderDatum.header;\n          const color = headerColors[(header.get('nestingLevel') - 1) % headerColors.length];\n\n          return (\n            <Header\n              key={header.get('id')}\n              header={header}\n              color={color}\n              hasContent={headerRenderDatum.hasContent}\n              isSelected={header.get('id') === selectedHeaderId}\n              onRef={this.handleHeaderRef(header.get('id'))}\n              shouldDisableActions={shouldDisableActions}\n            />\n          );\n        })}\n        <div style={{ height: '90px' }} />\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path], Map());\n  return {\n    headers: file.get('headers', List()),\n    selectedHeaderId: file.get('selectedHeaderId'),\n    narrowedHeaderId: file.get('narrowedHeaderId'),\n  };\n};\n\nexport default connect(mapStateToProps)(HeaderList);\n","import React, { Fragment, useState, useMemo, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Motion, spring } from 'react-motion';\n\nimport './stylesheet.css';\n\nimport { List, Map } from 'immutable';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as captureActions from '../../../../actions/capture';\nimport * as baseActions from '../../../../actions/base';\n\nimport sampleCaptureTemplates from '../../../../lib/sample_capture_templates';\n\nimport ActionButton from './components/ActionButton/';\nimport { determineIncludedFiles } from '../../../../reducers/org';\n\nconst ActionDrawer = ({\n  org,\n  selectedHeaderId,\n  base,\n  staticFile,\n  captureTemplates,\n  path,\n  selectedTableCellId,\n  selectedListItemId,\n  isLoading,\n  online,\n  shouldDisableSyncButtons,\n  activeClocks,\n}) => {\n  const [isDisplayingArrowButtons, setIsDisplayingArrowButtons] = useState(false);\n  const [isDisplayingCaptureButtons, setIsDisplayingCaptureButtons] = useState(false);\n\n  const mainArrowButton = useRef(null);\n\n  const mainArrowButtonBoundingRect = useMemo(\n    () => (!!mainArrowButton.current ? mainArrowButton.current.getBoundingClientRect() : null),\n    [mainArrowButton]\n  );\n\n  const handleUpClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderUp(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableRowUp()\n      : org.moveListItemUp();\n\n  const handleDownClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderDown(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableRowDown()\n      : org.moveListItemDown();\n\n  const handleLeftClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderLeft(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableColumnLeft()\n      : org.moveListItemLeft();\n\n  const handleRightClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderRight(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableColumnRight()\n      : org.moveListItemRight();\n\n  const handleMoveSubtreeLeftClick = () =>\n    !!selectedHeaderId ? org.moveSubtreeLeft(selectedHeaderId) : org.moveListSubtreeLeft();\n\n  const handleMoveSubtreeRightClick = () =>\n    !!selectedHeaderId ? org.moveSubtreeRight(selectedHeaderId) : org.moveListSubtreeRight();\n\n  const handleCaptureButtonClick = (templateId) => () => {\n    setIsDisplayingCaptureButtons(false);\n    base.activatePopup('capture', { templateId });\n  };\n\n  const getSampleCaptureTemplates = () => sampleCaptureTemplates;\n\n  const getAvailableCaptureTemplates = () =>\n    staticFile === 'sample'\n      ? getSampleCaptureTemplates()\n      : captureTemplates.filter(\n          (template) =>\n            template.get('isAvailableInAllOrgFiles') ||\n            template\n              .get('orgFilesWhereAvailable')\n              .map((availablePath) =>\n                availablePath.trim().startsWith('/')\n                  ? availablePath.trim()\n                  : '/' + availablePath.trim()\n              )\n              .includes((path || '').trim())\n        );\n\n  const handleSync = () => org.sync({ forceAction: 'manual' });\n\n  const handleMainArrowButtonClick = () => setIsDisplayingArrowButtons(!isDisplayingArrowButtons);\n\n  const handleSearchButtonClick = () => {\n    base.activatePopup('search');\n  };\n\n  const handleMainCaptureButtonClick = () => {\n    if (!isDisplayingCaptureButtons && getAvailableCaptureTemplates().size === 0) {\n      alert(\n        `You don't have any capture templates set up for this file! Add some in Settings > Capture Templates`\n      );\n      return;\n    }\n\n    setIsDisplayingCaptureButtons(!isDisplayingCaptureButtons);\n  };\n\n  const renderCaptureButtons = () => {\n    const availableCaptureTemplates = getAvailableCaptureTemplates();\n\n    const baseCaptureButtonStyle = {\n      position: 'absolute',\n      zIndex: 0,\n      left: 0,\n      opacity: isDisplayingArrowButtons ? 0 : 1,\n    };\n    if (!isDisplayingCaptureButtons) {\n      baseCaptureButtonStyle.boxShadow = 'none';\n    }\n\n    const mainButtonStyle = {\n      opacity: isDisplayingArrowButtons ? 0 : 1,\n      position: 'relative',\n      zIndex: 1,\n    };\n\n    const animatedStyle = {\n      bottom: spring(isDisplayingCaptureButtons ? 70 : 0, { stiffness: 300 }),\n    };\n\n    return (\n      <Motion style={animatedStyle}>\n        {(style) => (\n          <div className=\"action-drawer__capture-buttons-container\">\n            <ActionButton\n              iconName={isDisplayingCaptureButtons ? 'times' : 'plus'}\n              isDisabled={false}\n              onClick={handleMainCaptureButtonClick}\n              style={mainButtonStyle}\n              tooltip={\n                isDisplayingCaptureButtons ? 'Hide capture templates' : 'Show capture templates'\n              }\n            />\n\n            {availableCaptureTemplates.map((template, index) => (\n              <ActionButton\n                key={template.get('id')}\n                letter={template.get('letter')}\n                iconName={template.get('iconName')}\n                isDisabled={false}\n                onClick={handleCaptureButtonClick(template.get('id'))}\n                style={{ ...baseCaptureButtonStyle, bottom: style.bottom * (index + 1) }}\n                tooltip={`Activate \"${template.get('description')}\" capture template`}\n              />\n            ))}\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const renderMovementButtons = () => {\n    const baseArrowButtonStyle = {\n      opacity: isDisplayingCaptureButtons ? 0 : 1,\n    };\n    if (!isDisplayingArrowButtons) {\n      baseArrowButtonStyle.boxShadow = 'none';\n    }\n\n    let centerXOffset = 0;\n    if (!!mainArrowButtonBoundingRect) {\n      centerXOffset =\n        window.screen.width / 2 -\n        (mainArrowButtonBoundingRect.x + mainArrowButtonBoundingRect.width / 2);\n    }\n\n    const animatedStyles = {\n      centerXOffset: spring(isDisplayingArrowButtons ? centerXOffset : 0, { stiffness: 300 }),\n      topRowYOffset: spring(isDisplayingArrowButtons ? 150 : 0, { stiffness: 300 }),\n      bottomRowYOffset: spring(isDisplayingArrowButtons ? 80 : 0, { stiffness: 300 }),\n      firstColumnXOffset: spring(isDisplayingArrowButtons ? 70 : 0, {\n        stiffness: 300,\n      }),\n      secondColumnXOffset: spring(isDisplayingArrowButtons ? 140 : 0, {\n        stiffness: 300,\n      }),\n    };\n\n    let subIconNameStr = null;\n    let tooltipUpStr = 'Move header up';\n    let tooltipDownStr = 'Move header down';\n    let tooltipLeftStr = 'Move header left';\n    let tooltipRightStr = 'Move header right';\n    if (!!selectedTableCellId) {\n      subIconNameStr = 'table';\n      tooltipUpStr = 'Move row up';\n      tooltipDownStr = 'Move row down';\n      tooltipLeftStr = 'Move column left';\n      tooltipRightStr = 'Move column right';\n    } else if (!!selectedListItemId) {\n      subIconNameStr = 'list';\n      tooltipUpStr = 'Move list up';\n      tooltipDownStr = 'Move list down';\n      tooltipLeftStr = 'Move list left';\n      tooltipRightStr = 'Move list right';\n    }\n\n    return (\n      <Motion style={animatedStyles}>\n        {(style) => (\n          <div\n            className=\"action-drawer__arrow-buttons-container\"\n            style={{ left: style.centerXOffset }}\n          >\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-up\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleUpClick}\n              style={{ ...baseArrowButtonStyle, bottom: style.topRowYOffset }}\n              tooltip={tooltipUpStr}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-down\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleDownClick}\n              style={{ ...baseArrowButtonStyle, bottom: style.bottomRowYOffset }}\n              tooltip={tooltipDownStr}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-left\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleLeftClick}\n              style={{\n                ...baseArrowButtonStyle,\n                bottom: style.bottomRowYOffset,\n                right: style.firstColumnXOffset,\n              }}\n              tooltip={tooltipLeftStr}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-right\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleRightClick}\n              style={{\n                ...baseArrowButtonStyle,\n                bottom: style.bottomRowYOffset,\n                left: style.firstColumnXOffset,\n              }}\n              tooltip={tooltipRightStr}\n            />\n            {!selectedTableCellId && (\n              <Fragment>\n                <ActionButton\n                  additionalClassName=\"action-drawer__arrow-button\"\n                  iconName=\"chevron-left\"\n                  subIconName={subIconNameStr}\n                  isDisabled={false}\n                  onClick={handleMoveSubtreeLeftClick}\n                  style={{\n                    ...baseArrowButtonStyle,\n                    bottom: style.bottomRowYOffset,\n                    right: style.secondColumnXOffset,\n                  }}\n                  tooltip=\"Move entire subtree left\"\n                />\n                <ActionButton\n                  additionalClassName=\"action-drawer__arrow-button\"\n                  iconName=\"chevron-right\"\n                  subIconName={subIconNameStr}\n                  isDisabled={false}\n                  onClick={handleMoveSubtreeRightClick}\n                  style={{\n                    ...baseArrowButtonStyle,\n                    bottom: style.bottomRowYOffset,\n                    left: style.secondColumnXOffset,\n                  }}\n                  tooltip=\"Move entire subtree right\"\n                />\n              </Fragment>\n            )}\n\n            <ActionButton\n              iconName={isDisplayingArrowButtons ? 'times' : 'arrows-alt'}\n              subIconName={subIconNameStr}\n              additionalClassName=\"action-drawer__main-arrow-button\"\n              isDisabled={false}\n              onClick={handleMainArrowButtonClick}\n              style={{ opacity: isDisplayingCaptureButtons ? 0 : 1 }}\n              tooltip={isDisplayingArrowButtons ? 'Hide movement buttons' : 'Show movement buttons'}\n              onRef={mainArrowButton}\n            />\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const handleAgendaClick = () => base.activatePopup('agenda');\n\n  return (\n    <div className=\"action-drawer-container nice-scroll\">\n      {\n        <Fragment>\n          <ActionButton\n            iconName=\"cloud\"\n            subIconName=\"sync-alt\"\n            shouldSpinSubIcon={isLoading}\n            isDisabled={shouldDisableSyncButtons || !online}\n            onClick={handleSync}\n            style={{\n              opacity: isDisplayingArrowButtons || isDisplayingCaptureButtons ? 0 : 1,\n            }}\n            tooltip=\"Sync changes\"\n          />\n\n          <ActionButton\n            iconName=\"calendar-alt\"\n            isDisabled={false}\n            onClick={handleAgendaClick}\n            style={{\n              opacity: isDisplayingArrowButtons || isDisplayingCaptureButtons ? 0 : 1,\n            }}\n            tooltip=\"Show agenda\"\n          />\n\n          {renderMovementButtons()}\n\n          <ActionButton\n            iconName={'search'}\n            isDisabled={false}\n            onClick={handleSearchButtonClick}\n            additionalClassName={activeClocks !== 0 ? 'active-clock-indicator' : undefined}\n            style={{\n              opacity: isDisplayingArrowButtons || isDisplayingCaptureButtons ? 0 : 1,\n              position: 'relative',\n              zIndex: 1,\n            }}\n            tooltip=\"Show Search / Task List\"\n          />\n\n          {renderCaptureButtons()}\n        </Fragment>\n      }\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  const path = state.org.present.get('path');\n  const files = state.org.present.get('files');\n  const file = state.org.present.getIn(['files', path], Map());\n  const fileSettings = state.org.present.get('fileSettings');\n  const searchFiles = determineIncludedFiles(files, fileSettings, path, 'includeInSearch', false);\n  const activeClocks = Object.values(\n    searchFiles.map((f) => (f.get('headers').size ? f.get('activeClocks') : 0)).toJS()\n  ).reduce((acc, val) => (typeof val === 'number' ? acc + val : acc), 0);\n  return {\n    selectedHeaderId: file.get('selectedHeaderId'),\n    isDirty: file.get('isDirty'),\n    isNarrowedHeaderActive: !!file.get('narrowedHeaderId'),\n    selectedTableCellId: file.get('selectedTableCellId'),\n    selectedListItemId: file.get('selectedListItemId'),\n    captureTemplates: state.capture.get('captureTemplates', List()),\n    path,\n    isLoading: !state.base.get('isLoading').isEmpty(),\n    online: state.base.get('online'),\n    activeClocks,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    capture: bindActionCreators(captureActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ActionDrawer);\n","import Bowser from 'bowser';\n\nconst browser = Bowser.getParser(window.navigator.userAgent);\n\n/** Is the browser Mobile Safari with iOS version of at least 13, but\nless than 13.3 */\nexport const isMobileSafari13 = (() => {\n  return (\n    browser.satisfies({\n      mobile: {\n        safari: '>=13',\n      },\n    }) &&\n    browser.satisfies({\n      mobile: {\n        safari: '<13.0.4',\n      },\n    })\n  );\n})();\n\n/** Is the OS iOS or Android? */\nexport const isMobileBrowser = (() => {\n  return browser.getPlatformType() !== 'desktop';\n})();\n\nexport const isIos = () => {\n  return browser.getOS().name === 'iOS';\n};\n\n/** Is iPhone Model X (tested with Xs) */\nexport const isIphoneX = window.matchMedia\n  ? window.matchMedia('(max-device-width: 812px) and (-webkit-device-pixel-ratio : 3)').matches\n  : false;\n\n/** Is iPhone Model 6, 7 or 8 (tested with 6s) */\nexport const isIphone678 = window.matchMedia\n  ? window.matchMedia('(min-device-width: 375px) and (-webkit-device-pixel-ratio : 2)').matches\n  : false;\n\n/** Is running in standalone mode (not in Mobile Safari) */\nexport const isRunningAsPWA = 'standalone' in window.navigator && window.navigator.standalone;\n\n/** Is running in Landscape Mode (as opposed to Portrait Mode) */\nexport function isInLandscapeMode() {\n  return [90, -90].includes(window.orientation);\n}\n","import React from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../lib/color';\n\nimport './stylesheet.css';\n\nexport default ({ isEnabled, onToggle }) => {\n  const disabledColor = rgbaObject(255, 255, 255, 1);\n  const enabledColor = rgbaObject(238, 232, 213, 1);\n\n  const switchStyle = {\n    colorFactor: spring(isEnabled ? 1 : 0, { stiffness: 300 }),\n  };\n\n  const grabberStyle = {\n    marginLeft: spring(isEnabled ? 42 : 0, { stiffness: 300 }),\n  };\n\n  return (\n    <Motion style={switchStyle}>\n      {(style) => {\n        const backgroundColor = rgbaString(\n          interpolateColors(disabledColor, enabledColor, style.colorFactor)\n        );\n\n        return (\n          <div className=\"switch\" style={{ backgroundColor }} onClick={onToggle}>\n            <Motion style={grabberStyle}>\n              {(style) => <div className=\"switch__grabber\" style={style} />}\n            </Motion>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React, { Fragment, useState, useEffect, useRef, useMemo } from 'react';\nimport {\n  isMobileSafari13,\n  isRunningAsPWA,\n  isInLandscapeMode,\n  isIphoneX,\n  isIphone678,\n} from '../../../../lib/browser_utils';\n\nimport './stylesheet.css';\n\nimport ActionButton from '../ActionDrawer/components/ActionButton/';\nimport Switch from '../../../UI/Switch/';\n\nimport { headerWithPath } from '../../../../lib/org_utils';\nimport substituteTemplateVariables from '../../../../lib/capture_template_substitution';\n\nexport default ({ template, onCapture, headers }) => {\n  const [substitutedTemplate, initialCursorIndex] = useMemo(\n    () => substituteTemplateVariables(template.get('template')),\n    [template]\n  );\n\n  const targetHeader = useMemo(\n    () =>\n      template.get('headerPaths').size === 0\n        ? 'FILE'\n        : headerWithPath(headers, template.get('headerPaths')),\n    [headers, template]\n  );\n\n  const [textareaValue, setTextareaValue] = useState(substitutedTemplate);\n  const [shouldPrepend, setShouldPrepend] = useState(template.get('shouldPrepend'));\n\n  /** INFO: Some versions of Mobile Safari do _not_ like it when the\n  focus is set without an explicit user interaction. This is the case\n  in organice, because the user interaction is on a button which in\n  turn opens a textarea which should have the focus. It will open the\n  software keyboard, but the capture template will stay on the bottom\n  of the view, so it will be hidden by the keyboard. The user would\n  have to manually scroll down. On iOS 12, it worked without this\n  workaround. Starting with iOS 13.3, the workaround isn't needed,\n  anymore. */\n  const getMinHeight = () => {\n    // Only Mobile Safari needs the shenannigans for moving the input\n    // above the software keyboard.\n    if (isMobileSafari13) {\n      if (isRunningAsPWA) {\n        if (isInLandscapeMode()) {\n          return '9em';\n        } else {\n          if (isIphoneX) {\n            return '23em';\n          } else if (isIphone678) {\n            return '19em';\n          }\n          // For unmeasured models, it's safest to stick with the\n          // default iOS behavior - even if the keyboard hides the\n          // input field it's better than if it's moved too far up.\n          else {\n            return 'auto';\n          }\n        }\n      }\n      // Portrait mode\n      else {\n        if (isInLandscapeMode()) {\n          return '9em';\n        } else {\n          if (isIphoneX) {\n            return '18em';\n          } else if (isIphone678) {\n            return '18em';\n          } else {\n            return 'auto';\n          }\n        }\n      }\n    } else {\n      return 'auto';\n    }\n  };\n\n  const textarea = useRef(null);\n\n  useEffect(() => {\n    if (textarea.current) {\n      textarea.current.focus();\n      // Set Cursor position to the %? part of the template.\n      textarea.current.setSelectionRange(initialCursorIndex, initialCursorIndex);\n    }\n  }, [textarea, initialCursorIndex]);\n\n  const handleCaptureClick = () => onCapture(template.get('id'), textareaValue, shouldPrepend);\n\n  const handleTextareaChange = (event) => setTextareaValue(event.target.value);\n\n  const handlePrependSwitchToggle = () => setShouldPrepend(!shouldPrepend);\n\n  return (\n    <>\n      <div className=\"capture-modal-header\">\n        <ActionButton\n          letter={template.get('letter')}\n          iconName={template.get('iconName')}\n          isDisabled={false}\n          onClick={() => {}}\n          style={{ marginRight: 20 }}\n        />\n\n        <span>{template.get('description')}</span>\n      </div>\n\n      <div className=\"capture-modal-header-path\">\n        {template\n          .get('headerPaths')\n          .map((hP) => substituteTemplateVariables(hP)[0])\n          .join(' > ')}\n      </div>\n\n      {targetHeader ? (\n        <Fragment>\n          <textarea\n            className=\"textarea capture-modal-textarea\"\n            rows=\"4\"\n            value={textareaValue}\n            onChange={handleTextareaChange}\n            autoFocus\n            ref={textarea}\n          />\n          <div className=\"capture-modal-button-container\">\n            <div className=\"capture-modal-prepend-container\">\n              <span className=\"capture-modal-prepend-label\">Prepend:</span>\n              <Switch isEnabled={shouldPrepend} onToggle={handlePrependSwitchToggle} />\n            </div>\n\n            <button className=\"btn capture-modal-button\" onClick={handleCaptureClick}>\n              Capture\n            </button>\n          </div>\n          {/* Add padding to move the above textarea above the fold.\n          More documentation, see getMinHeight(). */}\n          {isMobileSafari13 && <div style={{ minHeight: getMinHeight() }} />}\n        </Fragment>\n      ) : (\n        <div className=\"capture-modal-error-message\">\n          The specified header path doesn't exist in this org file!\n        </div>\n      )}\n\n      <br />\n    </>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport { customFormatDistanceToNow } from '../../../../lib/org_utils';\nimport format from 'date-fns/format';\n\nexport default ({ lastServerModifiedAt, lastSyncAt, path, onPull, onPush, onCancel }) => {\n  return (\n    <>\n      <h2 className=\"sync-confirmation-modal__header\">Sync conflict</h2>\n      Since you last pulled {path}, a newer version of the file has been pushed to the server. The\n      newer version is from:\n      <br />\n      &nbsp;\n      <br />\n      <div className=\"sync-confirmation-modal__last-sync-time\">\n        {format(lastServerModifiedAt, 'MMMM do, yyyy [at] h:mm:ss a')}\n        <br />({customFormatDistanceToNow(lastServerModifiedAt)})\n      </div>\n      <br />\n      &nbsp;\n      <br />\n      While your version is from:\n      <br />\n      &nbsp;\n      <br />\n      <div className=\"sync-confirmation-modal__last-sync-time\">\n        {format(lastSyncAt, 'MMMM do, yyyy [at] h:mm:ss a')}\n        <br />({customFormatDistanceToNow(lastSyncAt)})\n      </div>\n      <div className=\"sync-confirmation-modal__buttons-container\">\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onPull}>\n          Pull latest version from server\n        </button>\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onPush}>\n          Overwrite server version\n        </button>\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onCancel}>\n          Cancel sync\n        </button>\n      </div>\n      <br />\n    </>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\n\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nexport default class TagsEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleRemoveTag', 'handleAddNewTag', 'handleTagChange']);\n\n    this.state = {\n      allTags: props.allTags,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const prevTags = prevProps.header.getIn(['titleLine', 'tags']);\n    const currentTags = this.props.header.getIn(['titleLine', 'tags']);\n    if (prevTags.size === currentTags.size - 1 && currentTags.last() === '') {\n      if (this.lastTextfield) {\n        this.lastTextfield.focus();\n      }\n    }\n  }\n\n  handleTagChange(tagIndex) {\n    return (event) => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      this.props.onChange(tags.set(tagIndex, event.target.value.replace(/(\\s+|:)/g, '')));\n    };\n  }\n\n  handleRemoveTag(tagIndex) {\n    return () => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      this.props.onChange(tags.delete(tagIndex));\n    };\n  }\n\n  handleAddNewTag() {\n    const tags = this.props.header.getIn(['titleLine', 'tags']);\n    this.props.onChange(tags.push(''));\n  }\n\n  handleExistingTagClick(newTag) {\n    return () => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      if (tags.includes(newTag)) {\n        this.props.onChange(tags.filter((tag) => tag !== newTag));\n      } else {\n        this.props.onChange(tags.push(newTag));\n      }\n    };\n  }\n\n  render() {\n    const { header } = this.props;\n    const { allTags } = this.state;\n\n    const headerTags = header.getIn(['titleLine', 'tags']);\n\n    return (\n      <>\n        <h2 className=\"drawer-modal__title\">Edit tags</h2>\n\n        <datalist id=\"drawer-modal__datalist-tag-names\">\n          {allTags.map((tagName, idx) => (\n            <option key={idx} value={tagName} />\n          ))}\n        </datalist>\n\n        {headerTags.size === 0 ? (\n          <div className=\"no-tags-message\">\n            This header doesn't have any tags.\n            <br />\n            <br />\n            Click the <i className=\"fas fa-plus\" /> button to add a new one, or choose from the list\n            of all of your tags below.\n          </div>\n        ) : (\n          <Droppable droppableId=\"tags-editor-droppable\" type=\"TAG\">\n            {(provided, _snapshot) => (\n              <div className=\"tags-container\" ref={provided.innerRef} {...provided.droppableProps}>\n                <Fragment>\n                  {headerTags.map((tag, index) => (\n                    <Draggable draggableId={`tag--${index}`} index={index} key={index}>\n                      {(provided, snapshot) => (\n                        <div\n                          className={classNames('tag-container', {\n                            'tag-container--dragging': snapshot.isDragging,\n                          })}\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                        >\n                          <input\n                            type=\"text\"\n                            className=\"textfield tag-container__textfield\"\n                            value={tag}\n                            onChange={this.handleTagChange(index)}\n                            ref={(textfield) => (this.lastTextfield = textfield)}\n                            list=\"drawer-modal__datalist-tag-names\"\n                          />\n                          <div className=\"tag-container__actions-container\">\n                            <i\n                              className=\"fas fa-times fa-lg\"\n                              onClick={this.handleRemoveTag(index)}\n                            />\n                            <i\n                              className=\"fas fa-bars fa-lg tag-container__drag-handle drag-handle\"\n                              {...provided.dragHandleProps}\n                            />\n                          </div>\n                        </div>\n                      )}\n                    </Draggable>\n                  ))}\n\n                  {provided.placeholder}\n                </Fragment>\n              </div>\n            )}\n          </Droppable>\n        )}\n\n        <div className=\"tags-editor__add-new-container\">\n          <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={this.handleAddNewTag} />\n        </div>\n\n        <hr className=\"tags-editor__separator\" />\n\n        <h2 className=\"tags-editor__title\">All tags</h2>\n\n        <div className=\"all-tags-container\">\n          {allTags\n            .filter((tag) => !!tag)\n            .map((tag) => {\n              const className = classNames('all-tags__tag', {\n                'all-tags__tag--in-use': headerTags.includes(tag),\n              });\n\n              return (\n                <div className={className} key={tag} onClick={this.handleExistingTagClick(tag)}>\n                  {tag}\n                </div>\n              );\n            })}\n        </div>\n      </>\n    );\n  }\n}\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\n\nexport default ({ buttons, titles, values, selectedButton, useEqualWidthTabs, onSelect }) => {\n  const handleButtonClick = (buttonName) => () => onSelect(buttonName);\n\n  const containerClassName = classNames('tab-buttons', {\n    'tab-buttons--equal-width-tabs': useEqualWidthTabs,\n  });\n\n  const style = {\n    gridTemplateColumns: useEqualWidthTabs ? `repeat(${buttons.length}, 1fr)` : null,\n  };\n\n  return (\n    <div className={containerClassName} style={style}>\n      {buttons.map((buttonName, index) => {\n        const value = values ? values[index] : buttonName;\n        const className = classNames('tab-buttons__btn', {\n          'tab-buttons__btn--selected': value === selectedButton,\n        });\n        // Optionally add a title\n        let title = '';\n        if (titles) {\n          title = titles[index];\n        }\n\n        return (\n          <div\n            key={buttonName + index}\n            title={title}\n            className={className}\n            onClick={handleButtonClick(value)}\n          >\n            {buttonName}\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { Map } from 'immutable';\n\nimport './stylesheet.css';\n\nimport Switch from '../../../../../UI/Switch/';\nimport TabButtons from '../../../../../UI/TabButtons/';\n\nimport * as orgActions from '../../../../../../actions/org';\nimport * as baseActions from '../../../../../../actions/base';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\nimport { getSelectedHeader } from '../../../../../../lib/org_utils';\n\nimport _ from 'lodash';\nimport { parseISO } from 'date-fns';\nimport format from 'date-fns/format';\n\nclass TimestampEditor extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleActiveToggle',\n      'handleDateChange',\n      'handleAddRepeater',\n      'handleRemoveRepeater',\n      'handleRepeaterTypeChange',\n      'handleRepeaterValueChange',\n      'handleRepeaterUnitChange',\n      'handleAddDelay',\n      'handleRemoveDelay',\n      'handleDelayTypeChange',\n      'handleDelayValueChange',\n      'handleDelayUnitChange',\n      'createPlanningItem',\n    ]);\n  }\n\n  handleActiveToggle() {\n    this.props.onChange(this.props.timestamp.update('isActive', (isActive) => !isActive));\n  }\n\n  handleDateChange(event, planningItemIndex, timestampId) {\n    // The user deleted the timestamp\n    if (_.isEmpty(event.target.value)) {\n      // It's a planning item and the parser knows which one.\n      if (_.isNumber(planningItemIndex)) {\n        this.props.org.removePlanningItem(this.props.headerId, planningItemIndex);\n      } else if (_.isNumber(timestampId)) {\n        this.props.org.removeTimestamp(this.props.headerId, timestampId);\n      }\n      if (\n        this.props.activePopupType !== 'scheduled-editor' &&\n        this.props.activePopupType !== 'deadline-editor'\n      ) {\n        // for scheduled timestamp and deadline the modal can be open when no timestamp exists\n        this.props.onClose();\n      }\n    } else {\n      const { onChange, timestamp } = this.props;\n\n      const [newYear, newMonth, newDay, newDayName] = format(\n        parseISO(event.target.value),\n        'yyyy MM dd eee'\n      ).split(' ');\n      onChange(\n        timestamp\n          .set('year', newYear)\n          .set('month', newMonth)\n          .set('day', newDay)\n          .set('dayName', newDayName)\n      );\n    }\n  }\n\n  handleAddTime(startOrEnd) {\n    return () => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      const [hour, minute] = format(new Date(), 'HH:mm').split(':');\n      onChange(timestamp.set(hourKey, hour).set(minuteKey, minute));\n    };\n  }\n\n  handleRemoveTime(startOrEnd) {\n    return () => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      onChange(timestamp.set(hourKey, null).set(minuteKey, null));\n    };\n  }\n\n  handleTimeChange(startOrEnd) {\n    return (event) => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      let [hour, minute] = event.target.value.split(':');\n      hour = hour.startsWith('0') ? hour.substring(1) : hour;\n      onChange(timestamp.set(hourKey, hour).set(minuteKey, minute));\n    };\n  }\n\n  handleAddRepeater() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterType', '+').set('repeaterValue', 1).set('repeaterUnit', 'h'));\n  }\n\n  handleRemoveRepeater() {\n    const { onChange, timestamp } = this.props;\n    onChange(\n      timestamp.set('repeaterType', null).set('repeaterValue', null).set('repeaterUnit', null)\n    );\n  }\n\n  handleRepeaterTypeChange(newRepeaterType) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterType', newRepeaterType));\n  }\n\n  handleRepeaterValueChange(event) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterValue', event.target.value));\n  }\n\n  handleRepeaterUnitChange(newRepeaterUnit) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterUnit', newRepeaterUnit));\n  }\n\n  handleAddDelay() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', '-').set('delayValue', 1).set('delayUnit', 'h'));\n  }\n\n  handleRemoveDelay() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', null).set('delayValue', null).set('delayUnit', null));\n  }\n\n  handleDelayTypeChange(newDelayType) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', newDelayType));\n  }\n\n  handleDelayValueChange(event) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayValue', event.target.value));\n  }\n\n  handleDelayUnitChange(newDelayUnit) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayUnit', newDelayUnit));\n  }\n\n  renderTimeField(label, timeKey, hour, minute, showRemoveButton = true) {\n    return (\n      <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n        <div className=\"timestamp-editor__field-title\">{label}</div>\n        <div className=\"timestamp-editor__field\">\n          {!!hour ? (\n            <Fragment>\n              <input\n                type=\"time\"\n                className=\"timestamp-editor__time-input\"\n                value={`${hour.padStart(2, '0')}:${minute.padStart(2, '0')}`}\n                onChange={this.handleTimeChange(timeKey)}\n              />\n              {showRemoveButton && (\n                <i\n                  className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                  onClick={this.handleRemoveTime(timeKey)}\n                />\n              )}\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddTime(timeKey)}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  renderRepeater() {\n    const { repeaterType, repeaterValue, repeaterUnit } = this.props.timestamp.toJS();\n\n    return (\n      <div className=\"timestamp-editor__field-container\">\n        <div className=\"timestamp-editor__field-title\">Repeater</div>\n        <div className=\"timestamp-editor__field timestamp-editor__field--delay-repeater\">\n          {!!repeaterType ? (\n            <Fragment>\n              <div className=\"timestamp-editor__delay-repeater-type\">\n                <TabButtons\n                  buttons={['+', '++', '.+']}\n                  titles={[\n                    'Shift exactly the amount of time in the repeater (i.e. one month for +1m).',\n                    'Shift the date by as many intervals of the amount of time in the repeater (i.e. one or many months for for ++1m) as it takes to get this date into the future.',\n                    'Shift the date exactly the amount of time of the repeater relative to the time of the state change.',\n                  ]}\n                  selectedButton={repeaterType || '+'}\n                  onSelect={this.handleRepeaterTypeChange}\n                />\n              </div>\n              <input\n                type=\"number\"\n                min=\"1\"\n                className=\"textfield delay-repeater-value-input\"\n                value={repeaterValue || 1}\n                onChange={this.handleRepeaterValueChange}\n              />\n              <div>\n                <TabButtons\n                  buttons={['h', 'd', 'w', 'm', 'y']}\n                  titles={['hours', 'days', 'weeks', 'months', 'years']}\n                  selectedButton={repeaterUnit || 'h'}\n                  onSelect={this.handleRepeaterUnitChange}\n                />\n              </div>\n              <i\n                className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                onClick={this.handleRemoveRepeater}\n              />\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddRepeater}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  renderDelay() {\n    const { delayType, delayValue, delayUnit } = this.props.timestamp.toJS();\n\n    return (\n      <div className=\"timestamp-editor__field-container\">\n        <div className=\"timestamp-editor__field-title\">Delay</div>\n        <div className=\"timestamp-editor__field\">\n          {!!delayType ? (\n            <Fragment>\n              <div className=\"timestamp-editor__delay-repeater-type\">\n                <TabButtons\n                  buttons={['-', '--']}\n                  titles={[\n                    'Set a different lead time before the entry is put into the agenda.',\n                    \"In case the task contains a repeater, the delay is considered to affect all occurrences; if you want the delay to only affect the first scheduled occurrence of the task, use '--' instead.\",\n                  ]}\n                  selectedButton={delayType || '-'}\n                  onSelect={this.handleDelayTypeChange}\n                />\n              </div>\n              <input\n                type=\"number\"\n                min=\"1\"\n                className=\"textfield delay-repeater-value-input\"\n                value={delayValue || 1}\n                onChange={this.handleDelayValueChange}\n              />\n              <div>\n                <TabButtons\n                  buttons={['h', 'd', 'w', 'm', 'y']}\n                  titles={['hours', 'days', 'weeks', 'months', 'years']}\n                  selectedButton={delayUnit || 'h'}\n                  onSelect={this.handleDelayUnitChange}\n                />\n              </div>\n              <i\n                className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                onClick={this.handleRemoveDelay}\n              />\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddDelay}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  createPlanningItem() {\n    const { selectedHeaderId, header, activePopupType } = this.props;\n    const planningType = { 'deadline-editor': 'DEADLINE', 'scheduled-editor': 'SCHEDULED' }[\n      activePopupType\n    ];\n    this.props.org.addNewPlanningItem(selectedHeaderId, planningType);\n    this.props.base.activatePopup(activePopupType, {\n      headerId: selectedHeaderId,\n      planningItemIndex: header.get('planningItems').size,\n    });\n  }\n\n  render() {\n    const { timestamp, timestampId, planningItemIndex } = this.props;\n    if (!timestamp) {\n      // for scheduled timestamp and deadline the modal can be opened when no timestamp exists\n      return (\n        <>\n          <div className=\"timestamp-editor__field-title\">Add Timestamp</div>\n          <div className=\"timestamp-editor__field\">\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.createPlanningItem}\n            />\n          </div>\n        </>\n      );\n    }\n    const {\n      isActive,\n      year,\n      month,\n      day,\n      startHour,\n      startMinute,\n      endHour,\n      endMinute,\n    } = timestamp.toJS();\n    return (\n      <div>\n        <div className=\"timestamp-editor__render\">{renderAsText(timestamp)}</div>\n\n        <div className=\"timestamp-editor__date-time-fields-container\">\n          <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n            <div className=\"timestamp-editor__field-title\">Active</div>\n            <div className=\"timestamp-editor__field\">\n              <Switch isEnabled={isActive} onToggle={this.handleActiveToggle} />\n            </div>\n          </div>\n\n          <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n            <div className=\"timestamp-editor__field-title\">Date</div>\n            <div className=\"timestamp-editor__field\">\n              <input\n                data-testid=\"timestamp-selector\"\n                type=\"date\"\n                className=\"timestamp-editor__date-input\"\n                onChange={(event) => this.handleDateChange(event, planningItemIndex, timestampId)}\n                // Needed for iOS due to React bug\n                // https://github.com/facebook/react/issues/8938#issuecomment-519074141\n                onFocus={(event) => (event.nativeEvent.target.defaultValue = '')}\n                value={`${year}-${month}-${day}`}\n              />\n            </div>\n          </div>\n\n          {this.renderTimeField('Start time', 'start', startHour, startMinute, !endHour)}\n          {!!startHour && this.renderTimeField('End time', 'end', endHour, endMinute)}\n        </div>\n\n        {this.renderRepeater()}\n        {this.renderDelay()}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path], Map());\n  const activePopup = state.base.get('activePopup');\n  return {\n    selectedHeaderId: file.get('selectedHeaderId'),\n    header: getSelectedHeader(state),\n    activePopupType: !!activePopup ? activePopup.get('type') : null,\n    activePopupData: !!activePopup ? activePopup.get('data') : null,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n  base: bindActionCreators(baseActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TimestampEditor);\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport TimestampEditor from './components/TimestampEditor';\n\nimport _ from 'lodash';\nimport format from 'date-fns/format';\nimport { Map } from 'immutable';\n\nexport default class TimestampEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleAddEndTimestamp', 'handleRemoveEndTimestamp']);\n  }\n\n  handleChange(key) {\n    return (newTimestamp) => this.props.onChange(this.props.timestamp.set(key, newTimestamp));\n  }\n\n  handleAddEndTimestamp() {\n    const { timestamp } = this.props;\n    const [year, month, day, dayName] = format(new Date(), 'yyyy MM dd eee').split(' ');\n    this.props.onChange(\n      timestamp.set(\n        'secondTimestamp',\n        Map({\n          year,\n          month,\n          day,\n          dayName,\n          isActive: timestamp.getIn(['firstTimestamp', 'isActive']),\n        })\n      )\n    );\n  }\n\n  handleRemoveEndTimestamp() {\n    this.props.onChange(this.props.timestamp.set('secondTimestamp', null));\n  }\n\n  render() {\n    const {\n      headerId,\n      timestamp,\n      timestampId,\n      popupType,\n      onClose,\n      singleTimestampOnly,\n      planningItemIndex,\n    } = this.props;\n\n    const timestampTitles = {\n      'timestamp-editor': 'Edit timestamp',\n      'scheduled-editor': 'Edit scheduled timestamp',\n      'deadline-editor': 'Edit deadline',\n    };\n\n    return (\n      <>\n        <h2 className=\"timestamp-editor__title\">{timestampTitles[popupType]}</h2>\n\n        <TimestampEditor\n          headerId={headerId}\n          timestamp={timestamp && timestamp.get('firstTimestamp')}\n          timestampId={timestampId}\n          planningItemIndex={planningItemIndex}\n          onClose={onClose}\n          onChange={this.handleChange('firstTimestamp')}\n        />\n\n        {!singleTimestampOnly &&\n          (!!timestamp.get('secondTimestamp') ? (\n            <Fragment>\n              <div className=\"timestamp-editor__separator\">\n                <div className=\"timestamp-editor__separator__margin-line\" />\n                to\n                <div className=\"timestamp-editor__separator__margin-line\" />\n              </div>\n\n              <TimestampEditor\n                headerId={headerId}\n                timestamp={timestamp.get('secondTimestamp')}\n                timestampId={timestampId}\n                onChange={this.handleChange('secondTimestamp')}\n              />\n\n              <div className=\"timestamp-editor__button-container\">\n                <button\n                  className=\"btn timestamp-editor__add-new-button\"\n                  onClick={this.handleRemoveEndTimestamp}\n                >\n                  Remove end timestamp\n                </button>\n              </div>\n            </Fragment>\n          ) : (\n            <div className=\"timestamp-editor__button-container\">\n              <button\n                className=\"btn timestamp-editor__add-new-button\"\n                onClick={this.handleAddEndTimestamp}\n              >\n                Add end timestamp\n              </button>\n            </div>\n          ))}\n\n        <br />\n      </>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport { attributedStringToRawText } from '../../../../lib/export_org';\nimport generateId from '../../../../lib/id_generator';\nimport { parseMarkupAndCookies } from '../../../../lib/parse_org';\n\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\nimport classNames from 'classnames';\nimport { fromJS } from 'immutable';\nimport _ from 'lodash';\nimport { computeAllPropertyNames, computeAllPropertyValuesFor } from '../../../../lib/org_utils';\n\nexport default class PropertyListEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleAddNewItem']);\n  }\n\n  componentDidUpdate(prevProps) {\n    const prevItems = prevProps.propertyListItems;\n    const currentItems = this.props.propertyListItems;\n    if (prevItems.size === currentItems.size - 1 && currentItems.last().get('property') === '') {\n      if (this.lastTextfield) {\n        this.lastTextfield.focus();\n      }\n    }\n  }\n\n  handlePropertyChange(propertyListItemId) {\n    return (event) => {\n      const propertyListItemIndex = this.props.propertyListItems.findIndex(\n        (propertyListItem) => propertyListItem.get('id') === propertyListItemId\n      );\n      this.props.onChange(\n        this.props.propertyListItems.setIn([propertyListItemIndex, 'property'], event.target.value)\n      );\n    };\n  }\n\n  handleValueChange(propertyListItemId) {\n    return (event) => {\n      const { propertyListItems, onChange } = this.props;\n\n      const propertyListItemIndex = propertyListItems.findIndex(\n        (propertyListItem) => propertyListItem.get('id') === propertyListItemId\n      );\n      onChange(\n        propertyListItems.setIn(\n          [propertyListItemIndex, 'value'],\n          fromJS(parseMarkupAndCookies(event.target.value))\n        )\n      );\n    };\n  }\n\n  handleRemoveItem(propertyListItemId) {\n    return () =>\n      this.props.onChange(\n        this.props.propertyListItems.filter(\n          (propertyListItem) => propertyListItem.get('id') !== propertyListItemId\n        )\n      );\n  }\n\n  handleAddNewItem() {\n    this.props.onChange(\n      this.props.propertyListItems.push(\n        fromJS({\n          property: '',\n          value: '',\n          id: generateId(),\n        })\n      )\n    );\n  }\n\n  render() {\n    const { propertyListItems, allOrgProperties } = this.props;\n    const allPropertyNames = computeAllPropertyNames(allOrgProperties);\n\n    const propertyListItemsWithAllPropVals = propertyListItems.map((p) => {\n      const propertyName = p.get('property');\n      const allPropertyValues = computeAllPropertyValuesFor(allOrgProperties, propertyName);\n      return [p, allPropertyValues];\n    });\n\n    return (\n      <>\n        <h2 className=\"drawer-modal__title\">Edit property list</h2>\n\n        <datalist id=\"drawer-modal__datalist-property-names\">\n          {allPropertyNames.map((propertyName, idx) => (\n            <option key={idx} value={propertyName} />\n          ))}\n        </datalist>\n\n        {propertyListItems.size === 0 ? (\n          <div className=\"no-items-message\">\n            There are no items in this property list.\n            <br />\n            <br />\n            Click the <i className=\"fas fa-plus\" /> button to add a new one.\n          </div>\n        ) : (\n          <Droppable droppableId=\"property-list-editor-droppable\" type=\"PROPERTY-LIST\">\n            {(provided) => (\n              <div\n                className=\"property-list-editor__items-container\"\n                ref={provided.innerRef}\n                {...provided.droppableProps}\n              >\n                <Fragment>\n                  {propertyListItemsWithAllPropVals.map(\n                    ([propertyListItem, allPropertyValues], index) => (\n                      <Draggable\n                        draggableId={`property-list-item--${index}`}\n                        index={index}\n                        key={propertyListItem.get('id')}\n                      >\n                        {(provided, snapshot) => (\n                          <div\n                            className={classNames('property-list-editor__item-container', {\n                              'property-list-editor__item-container--dragging': snapshot.isDragging,\n                            })}\n                            ref={provided.innerRef}\n                            {...provided.draggableProps}\n                          >\n                            <div className=\"item__textfields-container\">\n                              <input\n                                type=\"text\"\n                                className=\"textfield item-container__textfield\"\n                                value={propertyListItem.get('property')}\n                                onChange={this.handlePropertyChange(propertyListItem.get('id'))}\n                                ref={(textfield) => (this.lastTextfield = textfield)}\n                                list=\"drawer-modal__datalist-property-names\"\n                              />\n                              <input\n                                type=\"text\"\n                                className=\"textfield item-container__textfield\"\n                                value={attributedStringToRawText(propertyListItem.get('value'))}\n                                onChange={this.handleValueChange(propertyListItem.get('id'))}\n                                list={`drawer-modal__datalist-property-${index}-values`}\n                              />\n                              <datalist id={`drawer-modal__datalist-property-${index}-values`}>\n                                {allPropertyValues.map((propertyValue, idx) => (\n                                  <option key={idx} value={propertyValue} />\n                                ))}\n                              </datalist>\n                            </div>\n                            <div className=\"item-container__actions-container\">\n                              <i\n                                className=\"fas fa-times fa-lg\"\n                                onClick={this.handleRemoveItem(propertyListItem.get('id'))}\n                              />\n                              <i\n                                className=\"fas fa-bars fa-lg item-container__drag-handle drag-handle\"\n                                {...provided.dragHandleProps}\n                              />\n                            </div>\n                          </div>\n                        )}\n                      </Draggable>\n                    )\n                  )}\n\n                  {provided.placeholder}\n                </Fragment>\n              </div>\n            )}\n          </Droppable>\n        )}\n\n        <div className=\"property-list-editor__add-new-container\">\n          <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={this.handleAddNewItem} />\n        </div>\n      </>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\n\nimport TabButtons from '../../../UI/TabButtons';\n\nimport { generateTitleLine } from '../../../../lib/export_org';\nimport { getCurrentTimestampAsText } from '../../../../lib/timestamps';\nimport { todoKeywordSetForKeyword } from '../../../../lib/org_utils';\n\nexport default class TitleEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleTextareaRef',\n      'handleTextareaFocus',\n      'handleTitleChange',\n      'handleTitleFieldClick',\n      'handleInsertTimestamp',\n      'chooseTodoKeywordSet',\n      'handleTodoChange',\n      'handleNextTodoKeywordSet',\n    ]);\n\n    const todoKeywordSet = this.chooseTodoKeywordSet(\n      props.todoKeywordSets,\n      props.header.getIn(['titleLine', 'todoKeyword'])\n    );\n\n    this.state = {\n      todoKeywordSet,\n      todoKeywordSetIndex: props.todoKeywordSets.indexOf(todoKeywordSet),\n      titleValue: props.editRawValues\n        ? this.calculateRawTitle(props.header)\n        : props.header.getIn(['titleLine', 'rawTitle']),\n    };\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  componentDidMount() {\n    this.props.setPopupCloseActionValuesAccessor(() => [this.state.titleValue]);\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header, editRawValues } = this.props;\n    if (prevProps.header !== header || prevProps.editRawValues !== editRawValues) {\n      this.setState({\n        titleValue: editRawValues\n          ? this.calculateRawTitle(header)\n          : header.getIn(['titleLine', 'rawTitle']),\n      });\n      this.textarea.focus();\n    }\n  }\n\n  handleTextareaFocus(event) {\n    const { header } = this.props;\n    const rawTitle = header.getIn(['titleLine', 'rawTitle']);\n    if (rawTitle === '') {\n      const text = event.target.value;\n      event.target.selectionStart = text.length;\n      event.target.selectionEnd = text.length;\n    }\n  }\n\n  handleTitleChange(event) {\n    // If the last character typed was a newline at the end, exit edit mode.\n    const newTitle = event.target.value;\n    const lastCharacter = newTitle[newTitle.length - 1];\n    if (\n      this.state.titleValue === newTitle.substring(0, newTitle.length - 1) &&\n      lastCharacter === '\\n'\n    ) {\n      this.props.onClose(newTitle);\n      return;\n    }\n\n    this.setState({ titleValue: newTitle });\n  }\n\n  handleTitleFieldClick(event) {\n    event.stopPropagation();\n  }\n\n  calculateRawTitle(header) {\n    return generateTitleLine(header.toJS(), false);\n  }\n\n  handleInsertTimestamp(event) {\n    const { titleValue } = this.state;\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      titleValue:\n        titleValue.substring(0, insertionIndex) +\n        getCurrentTimestampAsText() +\n        titleValue.substring(this.textarea.selectionEnd || insertionIndex),\n    });\n\n    this.textarea.focus();\n\n    event.stopPropagation();\n  }\n\n  chooseTodoKeywordSet(todoKeywordSets, todoKeyword) {\n    return todoKeywordSetForKeyword(todoKeywordSets, todoKeyword);\n  }\n\n  handleTodoChange(newTodoKeyword) {\n    const currentTodoKeyword = this.props.header.getIn(['titleLine', 'todoKeyword']);\n    // Unselecting a keyword happens by writing an empty string as\n    // keyword. Checking if the newly clicked todo keyword is the same\n    // as the currently set todo keyword.\n    const keyword = currentTodoKeyword === newTodoKeyword ? '' : newTodoKeyword;\n    this.props.saveTitle(this.state.titleValue);\n    this.props.onTodoClicked(keyword);\n  }\n\n  handleNextTodoKeywordSet() {\n    const { todoKeywordSets } = this.props;\n    const newIndex =\n      this.state.todoKeywordSetIndex + 1 !== todoKeywordSets.size\n        ? this.state.todoKeywordSetIndex + 1\n        : 0;\n    const newTodoKeywordSet =\n      newIndex !== todoKeywordSets.size ? todoKeywordSets.get(newIndex) : todoKeywordSets.get(0);\n    this.setState({\n      todoKeywordSet: newTodoKeywordSet,\n      todoKeywordSetIndex: newIndex,\n    });\n  }\n\n  render() {\n    return (\n      <>\n        <h2 className=\"drawer-modal__title\">\n          {this.props.editRawValues ? 'Edit full title' : 'Edit title'}\n        </h2>\n\n        {this.props.editRawValues ? null : (\n          <div className=\"todo-container\">\n            <TabButtons\n              buttons={this.state.todoKeywordSet\n                .get('keywords')\n                .filter(\n                  (todo) =>\n                    this.state.todoKeywordSet\n                      .get('completedKeywords')\n                      .filter((completed) => todo === completed).size === 0\n                )}\n              selectedButton={this.props.header.getIn(['titleLine', 'todoKeyword'])}\n              onSelect={this.handleTodoChange}\n            />\n            <TabButtons\n              buttons={this.state.todoKeywordSet\n                .get('completedKeywords')\n                .filter((todo) => todo !== '')}\n              selectedButton={this.props.header.getIn(['titleLine', 'todoKeyword'])}\n              onSelect={this.handleTodoChange}\n            />\n\n            {this.props.todoKeywordSets.size > 1 ? (\n              <button\n                className=\"btn-passive\"\n                onClick={this.handleNextTodoKeywordSet}\n                title=\"Next keyword set\"\n              >\n                Next set\n              </button>\n            ) : null}\n          </div>\n        )}\n\n        <div className=\"title-line__edit-container\">\n          <textarea\n            autoFocus\n            className=\"textarea drag-handle\"\n            data-testid=\"titleLineInput\"\n            rows=\"3\"\n            ref={this.handleTextareaRef}\n            value={this.state.titleValue}\n            onFocus={this.handleTextareaFocus}\n            onChange={this.handleTitleChange}\n            onClick={this.handleTitleFieldClick}\n          />\n          <div className=\"title-line__insert-timestamp-button\" onClick={this.handleInsertTimestamp}>\n            <i className=\"fas fa-plus insert-timestamp-icon\" />\n            Insert timestamp\n          </div>\n        </div>\n      </>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\n\nimport { connect } from 'react-redux';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\n\nimport { isMobileBrowser } from '../../../../lib/browser_utils';\nimport { createRawDescriptionText } from '../../../../lib/export_org';\nimport { getCurrentTimestampAsText } from '../../../../lib/timestamps';\n\nclass DescriptionEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleTextareaRef', 'handleDescriptionChange', 'handleInsertTimestamp']);\n\n    this.state = {\n      descriptionValue: props.editRawValues\n        ? this.calculateRawDescription(props.header)\n        : props.header.get('rawDescription'),\n      editorDescriptionHeightValue: props.editorDescriptionHeightValue\n        ? props.editorDescriptionHeightValue\n        : '8',\n    };\n  }\n\n  componentDidMount() {\n    this.props.setPopupCloseActionValuesAccessor(() => [this.state.descriptionValue]);\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header, editRawValues } = this.props;\n    if (prevProps.header !== header || prevProps.editRawValues !== editRawValues) {\n      this.setState({\n        descriptionValue: this.props.editRawValues\n          ? this.calculateRawDescription(header)\n          : header.get('rawDescription'),\n      });\n      this.textarea.focus();\n    }\n  }\n\n  calculateRawDescription(header) {\n    // This generates the text that appears in the description text field.\n    const dontIndent = this.props.dontIndent;\n    return createRawDescriptionText(header, false, dontIndent);\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  descriptionModifier(event) {\n    // converting leading '* ' to '- ' to avoid converting them to headers\n    const {\n      target: { value },\n    } = event;\n    const eachValList = value.split('\\n');\n    eachValList.forEach((item, index) => {\n      if (item.startsWith('* ')) {\n        eachValList[index] = '- ' + item.slice(2);\n      }\n    });\n    return eachValList.join('\\n');\n  }\n\n  handleDescriptionChange(event) {\n    this.setState({ descriptionValue: this.descriptionModifier(event) });\n  }\n\n  handleInsertTimestamp() {\n    const { descriptionValue } = this.state;\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      descriptionValue:\n        descriptionValue.substring(0, insertionIndex) +\n        getCurrentTimestampAsText() +\n        descriptionValue.substring(this.textarea.selectionEnd || insertionIndex),\n    });\n    this.textarea.focus();\n  }\n\n  render() {\n    return (\n      <>\n        <h2 className=\"drawer-modal__title\">\n          {this.props.editRawValues ? 'Edit full description' : 'Edit description'}\n        </h2>\n\n        <div className=\"header-content__edit-container\">\n          <textarea\n            autoFocus\n            className=\"textarea drag-handle\"\n            rows={isMobileBrowser ? '8' : this.state.editorDescriptionHeightValue}\n            ref={this.handleTextareaRef}\n            value={this.state.descriptionValue}\n            onChange={this.handleDescriptionChange}\n          />\n          <div\n            className=\"header-content__insert-timestamp-button\"\n            onClick={this.handleInsertTimestamp}\n          >\n            <i className=\"fas fa-plus insert-timestamp-icon\" />\n            Insert timestamp\n          </div>\n        </div>\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const editorDescriptionHeightValue = state.base.get('editorDescriptionHeightValue');\n  return {\n    editorDescriptionHeightValue,\n  };\n};\n\nexport default connect(mapStateToProps)(DescriptionEditorModal);\n","import React from 'react';\n\nimport './stylesheet.css';\n\nexport default ({\n  subPartDataAndHandlers: {\n    selectedTableCellId,\n    onEnterTableEditMode,\n    onAddNewTableRow,\n    onRemoveTableRow,\n    onAddNewTableColumn,\n    onRemoveTableColumn,\n    onUpClick,\n    onLeftClick,\n    onRightClick,\n    onDownClick,\n  },\n}) => {\n  return (\n    <div className=\"table-action-drawer\">\n      {\n        <>\n          <div className=\"table-action-drawer-container\">\n            <div\n              className=\" table-action-drawer__edit-icon-container\"\n              onClick={() => (selectedTableCellId ? onEnterTableEditMode() : undefined)}\n            >\n              <i className=\"fas fa-pencil-alt fa-lg\" />\n            </div>\n\n            <div\n              className=\"table-action-drawer__sub-icon-container\"\n              onClick={() => (selectedTableCellId ? onAddNewTableRow() : undefined)}\n            >\n              <i className=\"fas fa-plus fa-lg table-action-drawer__main-icon\" />\n              <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated\" />\n            </div>\n\n            <div\n              className=\"table-action-drawer__sub-icon-container\"\n              onClick={() => (selectedTableCellId ? onRemoveTableRow() : undefined)}\n            >\n              <i className=\"fas fa-times fa-lg table-action-drawer__main-icon\" />\n              <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated\" />\n            </div>\n\n            <div\n              className=\"table-action-drawer__sub-icon-container\"\n              onClick={() => (selectedTableCellId ? onAddNewTableColumn() : undefined)}\n            >\n              <i className=\"fas fa-plus fa-lg table-action-drawer__main-icon\" />\n              <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon\" />\n            </div>\n\n            <div\n              className=\"table-action-drawer__sub-icon-container\"\n              onClick={() => (selectedTableCellId ? onRemoveTableColumn() : undefined)}\n            >\n              <i className=\"fas fa-times fa-lg table-action-drawer__main-icon\" />\n              <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon\" />\n            </div>\n          </div>\n\n          <div className=\"table-action-movement-container\">\n            <div\n              className=\"table-action-movement__up\"\n              onClick={() => (selectedTableCellId ? onUpClick() : undefined)}\n            >\n              <i className=\"fas fa-arrow-up fa-lg table-action-drawer__main-icon\" />\n            </div>\n            <div\n              className=\"table-action-movement__left\"\n              onClick={() => (selectedTableCellId ? onLeftClick() : undefined)}\n            >\n              <i className=\"fas fa-arrow-left fa-lg table-action-drawer__main-icon\" />\n            </div>\n\n            <div\n              className=\"table-action-movement__right\"\n              onClick={() => (selectedTableCellId ? onRightClick() : undefined)}\n            >\n              <i className=\"fas fa-arrow-right fa-lg table-action-drawer__main-icon\" />\n            </div>\n            <div\n              className=\"table-action-movement__down\"\n              onClick={() => (selectedTableCellId ? onDownClick() : undefined)}\n            >\n              <i className=\"fas fa-arrow-down fa-lg table-action-drawer__main-icon\" />\n            </div>\n          </div>\n        </>\n      }\n    </div>\n  );\n};\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../AttributedString';\nimport TableActionButtons from './components/TableActionButtons';\n\nimport * as baseActions from '../../../../actions/base';\nimport * as orgActions from '../../../../actions/org';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { Map } from 'immutable';\n\nimport { headerWithId } from '../../../../lib/org_utils';\nimport { getCurrentTimestampAsText } from '../../../../lib/timestamps';\n\nclass TableEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n    _.bindAll(this, [\n      'handleCellSelect',\n      'handleTextareaBlur',\n      'handleCellChange',\n      'handleInsertTimestamp',\n      'handleTextareaRef',\n      'handleTableCellSelect',\n      'handleTableCellValueUpdate',\n      'handlePopupClose',\n      'handleExitTableEditMode',\n      'handleEnterTableEditMode',\n      'handleAddNewTableRow',\n      'handleRemoveTableRow',\n      'handleAddNewTableColumn',\n      'handleRemoveTableColumn',\n      'handleCheckboxClick',\n      'handleTimestampClick',\n      'handleUpClick',\n      'handleDownClick',\n      'handleLeftClick',\n      'handleRightClick',\n    ]);\n\n    this.state = {\n      rawCellValues: this.generateCellValueMap(props.table),\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const { selectedTableCellId, inTableEditMode } = this.props;\n    const { rawCellValues } = this.state;\n\n    if (prevProps.inTableEditMode && !inTableEditMode) {\n      if (rawCellValues.has(selectedTableCellId)) {\n        this.handleTableCellValueUpdate(\n          selectedTableCellId,\n          rawCellValues.get(selectedTableCellId)\n        );\n      }\n    }\n\n    if (this.props.table !== prevProps.table) {\n      this.setState({ rawCellValues: this.generateCellValueMap(this.props.table) });\n    }\n  }\n\n  generateCellValueMap(table) {\n    return Map(\n      table\n        .get('contents')\n        .map((row) => row.get('contents').map((cell) => [cell.get('id'), cell.get('rawContents')]))\n        .flatten()\n    );\n  }\n\n  handleCellSelect(cellId) {\n    return () => this.handleTableCellSelect(cellId);\n  }\n\n  handleTextareaBlur() {\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.handleExitTableEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 0);\n  }\n\n  handleCellChange(event) {\n    const { rawCellValues } = this.state;\n    const { selectedTableCellId } = this.props;\n\n    this.setState({\n      rawCellValues: rawCellValues.set(selectedTableCellId, event.target.value),\n    });\n  }\n\n  handleInsertTimestamp() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { rawCellValues } = this.state;\n    const { selectedTableCellId } = this.props;\n    const cellValue = rawCellValues.get(selectedTableCellId);\n\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      rawCellValues: rawCellValues.set(\n        selectedTableCellId,\n        cellValue.substring(0, insertionIndex) +\n          getCurrentTimestampAsText() +\n          cellValue.substring(this.textarea.selectionEnd || insertionIndex)\n      ),\n    });\n\n    this.textarea.focus();\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  handleTableCellSelect(cellId) {\n    this.props.org.setSelectedTableCellId(cellId);\n  }\n\n  handleTableCellValueUpdate(cellId, newValue) {\n    this.props.org.updateTableCellValue(cellId, newValue);\n  }\n\n  handlePopupClose() {\n    this.props.base.closePopup();\n  }\n\n  handleExitTableEditMode() {\n    this.props.org.exitEditMode();\n  }\n\n  handleEnterTableEditMode() {\n    this.props.org.enterEditMode('table');\n  }\n\n  handleAddNewTableRow() {\n    this.props.org.addNewTableRow();\n  }\n\n  handleRemoveTableRow() {\n    this.props.org.removeTableRow();\n  }\n\n  handleAddNewTableColumn() {\n    this.props.org.addNewTableColumn();\n  }\n\n  handleRemoveTableColumn() {\n    this.props.org.removeTableColumn();\n  }\n\n  handleCheckboxClick(listItemId) {\n    this.props.org.advanceCheckboxState(listItemId);\n  }\n\n  handleTimestampClick(timestampId) {\n    this.props.base.activatePopup('timestamp-editor', { timestampId });\n  }\n\n  handleUpClick() {\n    this.props.org.moveTableRowUp();\n  }\n\n  handleDownClick() {\n    this.props.org.moveTableRowDown();\n  }\n\n  handleLeftClick() {\n    this.props.org.moveTableColumnLeft();\n  }\n\n  handleRightClick() {\n    this.props.org.moveTableColumnRight();\n  }\n\n  render() {\n    const { table, selectedTableCellId, inTableEditMode, shouldDisableActions } = this.props;\n    const { rawCellValues } = this.state;\n\n    const subPartDataAndHandlers = {\n      onTableCellSelect: this.handleTableCellSelect,\n      selectedTableCellId: selectedTableCellId,\n      inTableEditMode: inTableEditMode,\n      onExitTableEditMode: this.handleExitTableEditMode,\n      onTableCellValueUpdate: this.handleTableCellValueUpdate,\n      onEnterTableEditMode: this.handleEnterTableEditMode,\n      onAddNewTableRow: this.handleAddNewTableRow,\n      onRemoveTableRow: this.handleRemoveTableRow,\n      onAddNewTableColumn: this.handleAddNewTableColumn,\n      onRemoveTableColumn: this.handleRemoveTableColumn,\n      onCheckboxClick: this.handleCheckboxClick,\n      onTimestampClick: this.handleTimestampClick,\n      onUpClick: this.handleUpClick,\n      onDownClick: this.handleDownClick,\n      onLeftClick: this.handleLeftClick,\n      onRightClick: this.handleRightClick,\n      shouldDisableActions,\n    };\n\n    if (table.get('contents').size === 0 || table.getIn(['contents', 0, 'contents']).size === 0) {\n      this.handlePopupClose();\n    }\n\n    return (\n      <>\n        <h2 className=\"drawer-modal__title\">Edit table</h2>\n        <div style={{ overflowX: 'auto', overflowY: 'auto' }}>\n          <table className=\"table-part\">\n            <tbody>\n              {table.get('contents').map((row) => (\n                <tr key={row.get('id')}>\n                  {row.get('contents').map((cell) => {\n                    const isCellSelected = cell.get('id') === selectedTableCellId;\n\n                    const className = classNames('table-part__cell', {\n                      'table-part__cell--selected': isCellSelected,\n                    });\n\n                    return (\n                      <td\n                        className={className}\n                        key={cell.get('id')}\n                        onClick={this.handleCellSelect(cell.get('id'))}\n                      >\n                        {isCellSelected && inTableEditMode ? (\n                          <div className=\"table-cell__edit-container\">\n                            <textarea\n                              autoFocus\n                              className=\"textarea\"\n                              rows=\"3\"\n                              value={rawCellValues.get(cell.get('id'))}\n                              onBlur={this.handleTextareaBlur}\n                              onChange={this.handleCellChange}\n                              ref={this.handleTextareaRef}\n                            />\n                            <div\n                              className=\"table-cell__insert-timestamp-button\"\n                              onClick={this.handleInsertTimestamp}\n                            >\n                              <i className=\"fas fa-plus insert-timestamp-icon\" />\n                              Insert timestamp\n                            </div>\n                          </div>\n                        ) : cell.get('contents').size > 0 ? (\n                          <AttributedString\n                            parts={cell.get('contents')}\n                            subPartDataAndHandlers={subPartDataAndHandlers}\n                          />\n                        ) : (\n                          '   '\n                        )}\n                      </td>\n                    );\n                  })}\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n        <TableActionButtons subPartDataAndHandlers={subPartDataAndHandlers} />\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path], Map());\n  const headers = file.get('headers');\n  const selectedHeaderId = file.get('selectedHeaderId');\n  const selectedHeader = headers && selectedHeaderId && headerWithId(headers, selectedHeaderId);\n  const selectedTableId = file.get('selectedTableId');\n  const table = selectedHeader\n    ? selectedHeader.get('description').find((part) => part.get('id') === selectedTableId)\n    : null;\n  return {\n    table,\n    selectedTableCellId: file.get('selectedTableCellId'),\n    inTableEditMode: file.get('editMode') === 'table',\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TableEditorModal);\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport * as baseActions from '../../../../actions/base';\nimport * as orgActions from '../../../../actions/org';\n\nimport _ from 'lodash';\n\nclass NoteEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleTextareaRef', 'addNote', 'handleDescriptionChange']);\n\n    this.state = {\n      allTags: props.allTags,\n      note: '',\n    };\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  addNote() {\n    let { note } = this.state;\n    if (note !== null) note = note.trim();\n    if (!note) return;\n\n    this.props.org.addNote(note, new Date());\n    this.setState({ note: '' });\n  }\n\n  handleNoteFieldClick(event) {\n    event.stopPropagation();\n  }\n\n  handleDescriptionChange(event) {\n    this.setState({ note: event.target.value });\n  }\n\n  render() {\n    return (\n      <>\n        <h2 className=\"drawer-modal__title\">Add note</h2>\n        <div>Enter a note to add to the header:</div>\n        <textarea\n          autoFocus\n          className=\"textarea drag-handle\"\n          data-testid=\"titleLineInput\"\n          rows=\"3\"\n          ref={this.handleTextareaRef}\n          value={this.state.note}\n          onClick={this.handleNoteFieldClick}\n          onChange={this.handleDescriptionChange}\n        />\n        <button className=\"btn note-editor__done-btn\" onClick={() => this.addNote()}>\n          Add\n        </button>\n      </>\n    );\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n  };\n};\n\nexport default connect(null, mapDispatchToProps)(NoteEditorModal);\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport TitleLine from '../../../TitleLine';\n\nimport {\n  isTodoKeywordCompleted,\n  customFormatDistanceToNow,\n  getPlanningItemTypeText,\n} from '../../../../../../lib/org_utils';\nimport {\n  dateForTimestamp,\n  subtractTimestampUnitFromDate,\n  addTimestampUnitToDate,\n} from '../../../../../../lib/timestamps';\n\nimport {\n  format,\n  isToday,\n  startOfDay,\n  endOfDay,\n  isBefore,\n  isAfter,\n  isEqual,\n  isWithinInterval,\n  isPast,\n} from 'date-fns';\nimport classNames from 'classnames';\nimport { List } from 'immutable';\n\nexport default class AgendaDay extends PureComponent {\n  handleHeaderClick(path, headerId) {\n    return () => this.props.onHeaderClick(path, headerId);\n  }\n\n  render() {\n    const {\n      date,\n      files,\n      dateDisplayType,\n      onToggleDateDisplayType,\n      agendaDefaultDeadlineDelayValue,\n      agendaDefaultDeadlineDelayUnit,\n    } = this.props;\n\n    const dateStart = startOfDay(date);\n    const dateEnd = endOfDay(date);\n\n    const planningItemsAndHeaders = this.getPlanningItemsAndHeaders({\n      files,\n      date,\n      agendaDefaultDeadlineDelayValue,\n      agendaDefaultDeadlineDelayUnit,\n      dateStart,\n      dateEnd,\n    });\n\n    return (\n      <div className=\"agenda-day__container\">\n        <div className=\"agenda-day__title\">\n          {isToday(date) && <div className=\"agenda-day__today-indicator\" />}\n          <div className=\"agenda-day__title__day-name\">{format(date, 'eeee')}</div>\n          <div className=\"agenda-day__title__date\">{format(date, 'MMMM do, yyyy')}</div>\n        </div>\n\n        <div className=\"agenda-day__headers-container\">\n          <div>\n            {planningItemsAndHeaders.map(([planningItem, header]) => {\n              const planningItemDate = dateForTimestamp(planningItem.get('timestamp'));\n              const hasTodoKeyword = !!header.getIn(['titleLine', 'todoKeyword']);\n\n              const dateClassName = classNames('agenda-day__header-planning-date', {\n                'agenda-day__header-planning-date--overdue':\n                  hasTodoKeyword && isPast(planningItemDate),\n              });\n\n              return (\n                <div key={planningItem.get('id')} className=\"agenda-day__header-container\">\n                  <div className=\"agenda-day__header__planning-item-container\">\n                    <div className=\"agenda-day__header-planning-type\">\n                      {getPlanningItemTypeText(planningItem)}\n                    </div>\n                    <div className={dateClassName} onClick={onToggleDateDisplayType}>\n                      {dateDisplayType === 'absolute'\n                        ? format(planningItemDate, 'MM/dd')\n                        : customFormatDistanceToNow(planningItemDate)}\n\n                      {planningItem.getIn(['timestamp', 'startHour']) && (\n                        <Fragment>\n                          <br />\n                          {format(planningItemDate, 'h:mma')}\n                        </Fragment>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"agenda-day__header__header-container\">\n                    <TitleLine\n                      header={header}\n                      color=\"var(--base03)\"\n                      hasContent={false}\n                      isSelected={false}\n                      shouldDisableActions\n                      shouldDisableExplicitWidth\n                      onClick={this.handleHeaderClick(header.get('path'), header.get('id'))}\n                    />\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  getPlanningItemsAndHeaders({\n    files,\n    date,\n    agendaDefaultDeadlineDelayValue,\n    agendaDefaultDeadlineDelayUnit,\n    dateStart,\n    dateEnd,\n  }) {\n    const headers = List().concat(\n      ...files\n        .mapEntries(([path, file]) => [\n          path,\n          file.get('headers').map((header) => header.set('path', path)),\n        ])\n        .valueSeq()\n    );\n    const todoKeywordSets = files.map((file) => file.get('todoKeywordSets'));\n\n    return headers\n      .flatMap((header) => {\n        const planningItemsforDate = header.get('planningItems').filter((planningItem) => {\n          const timestamp = planningItem.get('timestamp');\n          if (!timestamp.get('isActive')) {\n            return false;\n          }\n          const planningItemDate = dateForTimestamp(timestamp);\n          const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n          const isCompletedTodo =\n            todoKeyword &&\n            isTodoKeywordCompleted(todoKeywordSets.get(header.get('path')), todoKeyword);\n          if (isCompletedTodo) {\n            return false;\n          }\n          switch (planningItem.get('type')) {\n            case 'DEADLINE':\n              if (isToday(date)) {\n                if (isBefore(planningItemDate, new Date())) {\n                  return true;\n                }\n                const [delayValue, delayUnit] = timestamp.get('delayType')\n                  ? [timestamp.get('delayValue'), timestamp.get('delayUnit')]\n                  : [agendaDefaultDeadlineDelayValue, agendaDefaultDeadlineDelayUnit];\n                const appearDate = subtractTimestampUnitFromDate(\n                  planningItemDate,\n                  delayValue,\n                  delayUnit\n                );\n                return isAfter(date, appearDate) || isEqual(date, appearDate);\n              } else {\n                return isWithinInterval(planningItemDate, { start: dateStart, end: dateEnd });\n              }\n            case 'SCHEDULED':\n              let appearDate = planningItemDate;\n              if (timestamp.get('delayType')) {\n                const hasBeenRepeated = header\n                  .get('propertyListItems')\n                  .some((propertyListItem) => propertyListItem.get('property') === 'LAST_REPEAT');\n                if (timestamp.get('delayType') === '--' && !hasBeenRepeated) {\n                  appearDate = addTimestampUnitToDate(\n                    planningItemDate,\n                    timestamp.get('delayValue'),\n                    timestamp.get('delayUnit')\n                  );\n                }\n              }\n              if (isToday(date) && isAfter(date, appearDate)) {\n                return true;\n              }\n              return isWithinInterval(appearDate, { start: dateStart, end: dateEnd });\n            default:\n              return isWithinInterval(planningItemDate, { start: dateStart, end: dateEnd });\n          }\n        });\n        return planningItemsforDate.map((planningItem) => [planningItem, header]);\n      })\n      .sortBy(([planningItem]) => {\n        const { startHour, startMinute, endHour, endMinute, month, day } = planningItem\n          .get('timestamp')\n          .toJS();\n        return [startHour ? 0 : 1, startHour, startMinute, endHour, endMinute, month, day];\n      });\n  }\n}\n","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport AgendaDay from './components/AgendaDay';\nimport TabButtons from '../../../UI/TabButtons';\n\nimport { isMobileBrowser } from '../../../../lib/browser_utils';\nimport * as baseActions from '../../../../actions/base';\nimport * as orgActions from '../../../../actions/org';\nimport { determineIncludedFiles } from '../../../../reducers/org';\n\nimport _ from 'lodash';\nimport {\n  addDays,\n  addWeeks,\n  addMonths,\n  getDay,\n  subDays,\n  subWeeks,\n  subMonths,\n  startOfWeek,\n  startOfMonth,\n  getDaysInMonth,\n} from 'date-fns';\nimport format from 'date-fns/format';\n\n// INFO: SearchModal, AgendaModal and TaskListModal are very similar\n// in structure and partially in logic. When changing one, consider\n// changing all.\nfunction AgendaModal(props) {\n  const {\n    files,\n    todoKeywordSets,\n    agendaTimeframe,\n    agendaDefaultDeadlineDelayValue,\n    agendaDefaultDeadlineDelayUnit,\n    agendaStartOnWeekday,\n  } = props;\n\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [dateDisplayType, setDateDisplayType] = useState('absolute');\n\n  const weekStartsOn = agendaStartOnWeekday < 0 ? getDay(selectedDate) : agendaStartOnWeekday;\n\n  function handleTimeframeTypeChange(agendaTimeframe) {\n    props.base.setAgendaTimeframe(agendaTimeframe);\n  }\n\n  function handleNextDateClick() {\n    switch (agendaTimeframe) {\n      case 'Day':\n        setSelectedDate(addDays(selectedDate, 1));\n        break;\n      case 'Week':\n        setSelectedDate(addWeeks(selectedDate, 1));\n        break;\n      case 'Month':\n        setSelectedDate(addMonths(selectedDate, 1));\n        break;\n      default:\n        return '';\n    }\n  }\n\n  function handleHeaderClick(path, headerId) {\n    props.onClose();\n    props.org.selectHeaderAndOpenParents(path, headerId);\n  }\n\n  function handlePreviousDateClick() {\n    switch (agendaTimeframe) {\n      case 'Day':\n        setSelectedDate(subDays(selectedDate, 1));\n        break;\n      case 'Week':\n        setSelectedDate(subWeeks(selectedDate, 1));\n        break;\n      case 'Month':\n        setSelectedDate(subMonths(selectedDate, 1));\n        break;\n      default:\n        return '';\n    }\n  }\n\n  function handleToggleDateDisplayType() {\n    setDateDisplayType(dateDisplayType === 'absolute' ? 'relative' : 'absolute');\n  }\n\n  function calculateTimeframeHeader() {\n    switch (agendaTimeframe) {\n      case 'Day':\n        return format(selectedDate, 'MMMM do');\n      case 'Week':\n        const weekStart = startOfWeek(selectedDate, { weekStartsOn });\n        const weekEnd = addWeeks(weekStart, 1);\n        return `${format(weekStart, 'MMM do')} - ${format(weekEnd, 'MMM do')} (W${format(\n          weekStart,\n          'w'\n        )})`;\n      case 'Month':\n        return format(selectedDate, 'MMMM');\n      default:\n        return '';\n    }\n  }\n\n  let dates = [];\n  switch (agendaTimeframe) {\n    case 'Day':\n      dates = [selectedDate];\n      break;\n    case 'Week':\n      const weekStart = startOfWeek(selectedDate, { weekStartsOn });\n      dates = _.range(7).map((daysAfter) => addDays(weekStart, daysAfter));\n      break;\n    case 'Month':\n      const monthStart = startOfMonth(selectedDate);\n      dates = _.range(getDaysInMonth(selectedDate)).map((daysAfter) =>\n        addDays(monthStart, daysAfter)\n      );\n      break;\n    default:\n  }\n\n  return (\n    <>\n      <h2 className=\"agenda__title\">Agenda</h2>\n\n      <div className=\"agenda__tab-container\">\n        <TabButtons\n          buttons={['Day', 'Week', 'Month']}\n          selectedButton={agendaTimeframe}\n          onSelect={handleTimeframeTypeChange}\n          useEqualWidthTabs\n        />\n      </div>\n\n      <div className=\"agenda__timeframe-header-container\">\n        <i className=\"fas fa-chevron-left fa-lg\" onClick={handlePreviousDateClick} />\n        <div className=\"agenda__timeframe-header\">{calculateTimeframeHeader()}</div>\n        <i className=\"fas fa-chevron-right fa-lg\" onClick={handleNextDateClick} />\n      </div>\n\n      <div\n        className=\"agenda__days-container\"\n        style={isMobileBrowser ? undefined : { overflow: 'auto' }}\n      >\n        {dates.map((date) => (\n          <AgendaDay\n            key={format(date, 'yyyy MM dd')}\n            date={date}\n            files={files}\n            onHeaderClick={handleHeaderClick}\n            todoKeywordSets={todoKeywordSets}\n            dateDisplayType={dateDisplayType}\n            onToggleDateDisplayType={handleToggleDateDisplayType}\n            agendaDefaultDeadlineDelayValue={agendaDefaultDeadlineDelayValue}\n            agendaDefaultDeadlineDelayUnit={agendaDefaultDeadlineDelayUnit}\n          />\n        ))}\n      </div>\n\n      <br />\n    </>\n  );\n}\n\nconst mapStateToProps = (state) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path]);\n  const allFiles = state.org.present.get('files');\n  const fileSettings = state.org.present.get('fileSettings');\n  const agendaStartOnWeekday = state.base.get('agendaStartOnWeekday');\n  return {\n    files: determineIncludedFiles(allFiles, fileSettings, path, 'includeInAgenda', false),\n    todoKeywordSets: file.get('todoKeywordSets'),\n    agendaTimeframe: state.base.get('agendaTimeframe'),\n    agendaDefaultDeadlineDelayValue: state.base.get('agendaDefaultDeadlineDelayValue') || 5,\n    agendaDefaultDeadlineDelayUnit: state.base.get('agendaDefaultDeadlineDelayUnit') || 'd',\n    agendaStartOnWeekday: agendaStartOnWeekday == null ? 1 : +agendaStartOnWeekday,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n  base: bindActionCreators(baseActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AgendaModal);\n","import React, { useEffect } from 'react';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nimport { Map } from 'immutable';\n\nimport * as orgActions from '../../../../../../actions/org';\nimport './stylesheet.css';\n\nimport { millisDuration } from '../../../../../../lib/timestamps';\n\nimport TitleLine from '../../../TitleLine';\nimport { getBreadcrumbsStringFunction } from '../../../../../../lib/org_utils';\n\nfunction HeaderListView(props) {\n  const { context } = props;\n  function handleHeaderClick(path, headerId) {\n    return () => props.onHeaderClick(path, headerId);\n  }\n\n  // Populate filteredHeaders\n  useEffect(() => {\n    // No specific searchFilter and cursorPosition, but set the\n    // context (like 'search' or 'refile')\n    if (context === 'Clock List') {\n      props.org.setSearchFilterInformation('clock:now', 0, 'search');\n    } else {\n      props.org.setSearchFilterInformation('', 0, context);\n    }\n  }, [context, props.org]);\n\n  const { headers, allHeaders, showClockedTimes } = props;\n\n  return (\n    <div className=\"agenda-day__container\">\n      <div className=\"agenda-day__headers-container\">\n        {Array.from(headers.entries(), ([path, headersOfFile]) => {\n          const getBreadcrumbs = getBreadcrumbsStringFunction(allHeaders, path);\n          return headersOfFile.map((header) => {\n            return (\n              <div key={header.get('id')} className=\"agenda-day__header-container\">\n                <div className=\"search__breadcrumbs\">{getBreadcrumbs(header)}</div>\n                <div className=\"agenda-day__header__header-container\">\n                  <TitleLine\n                    header={header}\n                    color=\"var(--base03)\"\n                    hasContent={false}\n                    isSelected={false}\n                    shouldDisableActions\n                    shouldDisableExplicitWidth\n                    onClick={handleHeaderClick(path, header.get('id'))}\n                    addition={\n                      showClockedTimes && header.get('totalFilteredTimeLoggedRecursive') !== 0\n                        ? millisDuration(header.get('totalFilteredTimeLoggedRecursive'))\n                        : null\n                    }\n                  />\n                </div>\n              </div>\n            );\n          });\n        })}\n      </div>\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => {\n  const files = state.org.present.get('files');\n  return {\n    allHeaders: files.map((file) => file.get('headers')),\n    headers: state.org.present.getIn(['search', 'filteredHeaders']) || Map(),\n    showClockedTimes: state.org.present.getIn(['search', 'showClockedTimes']),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderListView);\n","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { capitalize } from 'lodash';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport HeaderListView from './components/HeaderListView';\n\nimport { isMobileBrowser, isIos } from '../../../../lib/browser_utils';\nimport { millisDuration } from '../../../../lib/timestamps';\n\nimport * as orgActions from '../../../../actions/org';\n\n// INFO: SearchModal, AgendaModal and TaskListModal are very similar\n// in structure and partially in logic. When changing one, consider\n// changing all.\nfunction SearchModal(props) {\n  const [dateDisplayType, setdateDisplayType] = useState('absolute');\n  const {\n    searchFilter,\n    searchFilterValid,\n    searchFilterSuggestions,\n    allBookmarks,\n    context,\n    showClockedTimes,\n    clockedTime,\n    activeClocks,\n  } = props;\n  const bookmarks = allBookmarks.get(context);\n  const bookmarkChosen = bookmarks.contains(searchFilter);\n  const canSaveBookmark = searchFilterValid && searchFilter.length !== 0;\n\n  function handleHeaderClick(path, headerId) {\n    props.onClose(path, headerId);\n  }\n\n  function handleToggleDateDisplayType() {\n    setdateDisplayType(dateDisplayType === 'absolute' ? 'relative' : 'absolute');\n  }\n\n  function handleFilterChange(event) {\n    props.org.setSearchFilterInformation(event.target.value, event.target.selectionStart, context);\n  }\n\n  function onBookmarkButtonClick() {\n    if (bookmarkChosen) {\n      props.org.deleteBookmark(context, searchFilter);\n    } else if (canSaveBookmark) {\n      props.org.saveBookmark(context, searchFilter);\n    }\n  }\n\n  return (\n    <>\n      {context === 'search' ? (\n        <div className=\"task-list__modal-title_search\">\n          {showClockedTimes ? (\n            <span title=\"Sum of time logged on all search results directly (not including time logged on their children)\">\n              {millisDuration(clockedTime)}\n            </span>\n          ) : null}\n        </div>\n      ) : (\n        <div className=\"task-list__modal-title\">\n          <h2 className=\"agenda__title\">{capitalize(context)}</h2>\n        </div>\n      )}\n\n      {activeClocks ? null : (\n        <div className=\"search-input-container\">\n          <div className=\"search-input-line\">\n            <datalist id=\"task-list__datalist-filter\">\n              {(searchFilter.length === 0 ? bookmarks : searchFilterSuggestions).map(\n                (string, idx) => (\n                  <option key={idx} value={string} />\n                )\n              )}\n            </datalist>\n\n            <div className=\"search__input-container\">\n              <input\n                type=\"text\"\n                value={searchFilter}\n                // On iOS, setting autoFocus here will move the contents of\n                // the drawer off the screen, because the keyboard pops up\n                // late when the height is already set to '92%'. Some other\n                // complications: There's no API to check if the keyboard is\n                // open or not. When setting the height of the container to\n                // something like 48% for iOS, this works on iPhone (tested\n                // on Xs and 6S), but when the keyboard is closed, the\n                // container is still small when the user wants to read the\n                // longer list without the keyboard in the way. There might\n                // be a better way: If the drawer wouldn't move, iOS likely\n                // would set the heights correctly automatically.\n                autoFocus={!isIos()}\n                // Disable auto-capitalization for convenience (autoComplete must also be off to\n                // achieve this on Android).\n                autoCapitalize=\"none\"\n                autoComplete=\"off\"\n                className={classNames('textfield', 'task-list__filter-input', {\n                  'task-list__filter-input--invalid': !!searchFilter && !searchFilterValid,\n                })}\n                placeholder=\"e.g. -DONE doc|man :simple|easy :assignee:nobody|none\"\n                list=\"task-list__datalist-filter\"\n                onChange={handleFilterChange}\n              />\n            </div>\n\n            <i\n              className={classNames('fas fa-lg bookmark__icon ', {\n                'fa-star': !bookmarkChosen,\n                'fa-trash': bookmarkChosen,\n                bookmark__icon__enabled: canSaveBookmark,\n              })}\n              onClick={onBookmarkButtonClick}\n            />\n          </div>\n        </div>\n      )}\n\n      <div\n        className=\"task-list__headers-container\"\n        // On mobile devices, the Drawer already handles the touch\n        // event. Hence, scrolling within the Drawers container does\n        // not work with the same event. Therefore, we're just opting\n        // to scroll the whole drawer. That's not the best UX. And a\n        // better CSS juggler than me is welcome to improve on it.\n        style={isMobileBrowser ? undefined : { overflow: 'auto' }}\n      >\n        <HeaderListView\n          onHeaderClick={handleHeaderClick}\n          dateDisplayType={dateDisplayType}\n          onToggleDateDisplayType={handleToggleDateDisplayType}\n          context={activeClocks ? 'Clock List' : context}\n        />\n      </div>\n    </>\n  );\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    path: state.org.present.get('path'),\n    searchFilter: state.org.present.getIn(['search', 'searchFilter']),\n    searchFilterValid: state.org.present.getIn(['search', 'searchFilterValid']),\n    searchFilterSuggestions: state.org.present.getIn(['search', 'searchFilterSuggestions']) || [],\n    allBookmarks: state.org.present.get('bookmarks'),\n    showClockedTimes: state.org.present.getIn(['search', 'showClockedTimes']),\n    clockedTime: state.org.present.getIn(['search', 'clockedTime']),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchModal);\n","import React, { useState, useEffect, useLayoutEffect, useRef } from 'react';\n\nimport './stylesheet.css';\n\nimport { Motion, spring } from 'react-motion';\nimport classNames from 'classnames';\n\nexport default ({ children, shouldIncludeCloseButton, onClose, maxSize = false }) => {\n  const [isVisible, setIsVisible] = useState(false);\n  const [dragOffsetY, setDragOffsetY] = useState(null);\n\n  useLayoutEffect(() => {\n    setIsVisible(true);\n  }, []);\n\n  const initialClientY = useRef();\n  const innerContainer = useRef();\n\n  const innerContainerHeight = useRef();\n  useLayoutEffect(() => {\n    innerContainerHeight.current = innerContainer.current.offsetHeight;\n  });\n\n  const handleInnerContainerClick = (event) => event.stopPropagation();\n\n  const handleClose = () => setIsVisible(false);\n\n  const handleAnimationRest = () => (!isVisible && !!onClose ? onClose() : void 0);\n\n  const handleTouchStart = (event) => (initialClientY.current = event.targetTouches[0].clientY);\n\n  const handleTouchMove = (event) => {\n    if (event.target.classList.contains('drag-handle')) {\n      return;\n    }\n\n    const isScrollingDown = initialClientY.current > event.targetTouches[0].clientY;\n\n    if (\n      isScrollingDown &&\n      innerContainer.current.scrollHeight - innerContainer.current.scrollTop <=\n        innerContainer.current.clientHeight\n    ) {\n      event.preventDefault();\n    } else if (!isScrollingDown && innerContainer.current.scrollTop === 0) {\n      event.preventDefault();\n\n      setDragOffsetY(event.targetTouches[0].clientY - initialClientY.current);\n    }\n  };\n\n  useEffect(() => {\n    const endInnerContainerDrag = () => {\n      setIsVisible(dragOffsetY <= innerContainerHeight.current * 0.3);\n      setDragOffsetY(null);\n    };\n    const handleTouchEndOrCancel = () => endInnerContainerDrag();\n\n    if (!!innerContainer.current) {\n      // Super annoying logic for disabling scrolling of the body when a slide up is active.\n      // Briefly: if we're already at the top of our Drawer and trying to scroll up, disable\n      // scrolling. Likewise, if we're already at the bottom of our Drawer and trying to scroll\n      // down, disable scrolling.\n      innerContainer.current.addEventListener('touchstart', handleTouchStart);\n      innerContainer.current.addEventListener('touchmove', handleTouchMove);\n      innerContainer.current.addEventListener('touchend', handleTouchEndOrCancel);\n      innerContainer.current.addEventListener('touchcancel', handleTouchEndOrCancel);\n\n      // Tmp variable for cleanup. Otherwise the linter will complain\n      // that the `current` value will change. It suggested this tmp\n      // variable.\n      const innerContainerCurrent = innerContainer.current;\n\n      return () => {\n        innerContainerCurrent.removeEventListener('touchstart', handleTouchStart);\n        innerContainerCurrent.removeEventListener('touchmove', handleTouchMove);\n        innerContainerCurrent.removeEventListener('touchend', handleTouchEndOrCancel);\n        innerContainerCurrent.removeEventListener('touchcancel', handleTouchEndOrCancel);\n      };\n    } else {\n      return null;\n    }\n  }, [innerContainer, dragOffsetY]);\n\n  const outerClassName = classNames('drawer-outer-container', {\n    'drawer-outer-container--visible': isVisible,\n  });\n\n  const innerStyle = {\n    offsetY:\n      dragOffsetY ||\n      spring(isVisible ? 0 : innerContainerHeight.current || window.innerHeight, {\n        stiffness: 300,\n      }),\n  };\n\n  return (\n    <Motion style={innerStyle} onRest={handleAnimationRest}>\n      {(style) => {\n        const interpolatedStyle = {\n          transform: `translateY(${style.offsetY}px)`,\n        };\n\n        // For maximized drawers, there's different rules:\n        if (maxSize) {\n          interpolatedStyle.height = '92%';\n          interpolatedStyle.overflow = 'none';\n        }\n\n        return (\n          <div className={outerClassName} onClick={!!onClose ? handleClose : null}>\n            <div\n              onClick={handleInnerContainerClick}\n              className=\"drawer-inner-container nice-scroll\"\n              data-testid=\"drawer\"\n              ref={innerContainer}\n              style={interpolatedStyle}\n            >\n              <div className=\"drawer__grabber\" />\n\n              {shouldIncludeCloseButton && (\n                <button className=\"fas fa-times fa-lg drawer__close-button\" onClick={handleClose} />\n              )}\n\n              {children}\n            </div>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nexport default class DrawerActionButtons extends PureComponent {\n  // A nasty hack required to get click handling to work properly in Firefox. No idea why its\n  // broken in the first place or why this fixes it.\n  iconWithFFClickCatcher({ className, onClick, title, disabled, testId = '' }) {\n    return (\n      <div\n        title={title}\n        onClick={!disabled ? onClick : undefined}\n        className=\"header-action-drawer__ff-click-catcher-container\"\n      >\n        <div className=\"header-action-drawer__ff-click-catcher\" />\n        <i className={className} data-testid={testId} />\n      </div>\n    );\n  }\n\n  render() {\n    const {\n      onSwitch,\n      onTitleClick,\n      onDescriptionClick,\n      onTagsClick,\n      onPropertiesClick,\n      onDeadlineClick,\n      onScheduledClick,\n      onAddNote,\n      onRemoveHeader,\n      activePopupType,\n      editRawValues,\n      setEditRawValues,\n      restorePreferEditRawValues,\n    } = this.props;\n\n    return (\n      <div className=\"header-action-drawer-container\">\n        <div className=\"header-action-drawer__row\">\n          {this.iconWithFFClickCatcher({\n            className:\n              'fas fa-pencil-alt fa-lg' +\n              ('title-editor' === activePopupType ? ' drawer-action-button--selected' : ''),\n            onClick: () => {\n              if ('title-editor' === activePopupType) {\n                onSwitch();\n                setEditRawValues(!editRawValues);\n              } else {\n                restorePreferEditRawValues();\n              }\n              onTitleClick();\n            },\n            title: 'Edit title',\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className:\n              'fas fa-edit fa-lg' +\n              ('description-editor' === activePopupType ? ' drawer-action-button--selected' : ''),\n            onClick: () => {\n              if ('description-editor' === activePopupType) {\n                onSwitch();\n                setEditRawValues(!editRawValues);\n              } else {\n                restorePreferEditRawValues();\n              }\n              onDescriptionClick();\n            },\n            title: 'Edit description',\n            testId: 'edit-header-title',\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className:\n              'fas fa-tags fa-lg' +\n              ('tags-editor' === activePopupType ? ' drawer-action-button--selected' : ''),\n            onClick: onTagsClick,\n            title: 'Modify tags',\n            disabled: 'tags-editor' === activePopupType,\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className:\n              'fas fa-list fa-lg' +\n              ('property-list-editor' === activePopupType ? ' drawer-action-button--selected' : ''),\n            onClick: onPropertiesClick,\n            title: 'Modify properties',\n            disabled: 'property-list-editor' === activePopupType,\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className:\n              'fas fa-calendar-check fa-lg' +\n              ('deadline-editor' === activePopupType ? ' drawer-action-button--selected' : ''),\n            onClick: onDeadlineClick,\n            title: 'Set deadline datetime',\n            disabled: 'deadline-editor' === activePopupType,\n          })}\n          {this.iconWithFFClickCatcher({\n            className:\n              'far fa-calendar-times fa-lg' +\n              ('scheduled-editor' === activePopupType ? ' drawer-action-button--selected' : ''),\n            onClick: onScheduledClick,\n            title: 'Set scheduled datetime',\n            disabled: 'scheduled-editor' === activePopupType,\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className:\n              'far fa-sticky-note fa-lg' +\n              ('note-editor' === activePopupType ? ' drawer-action-button--selected' : ''),\n            onClick: onAddNote,\n            title: 'Add a note',\n            disabled: 'note-editor' === activePopupType,\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className:\n              'fas fa-trash fa-lg' +\n              ('note-editor' === activePopupType ? ' drawer-action-button--selected' : ''),\n            onClick: onRemoveHeader,\n            title: 'Delete this header',\n            disabled: 'note-editor' === activePopupType,\n          })}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Map } from 'immutable';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\n\nimport DrawerActionButtons from './components/DrawerActionButtons';\n\nimport { getSelectedHeader } from '../../../../lib/org_utils';\n\nclass DrawerActionBar extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleShowTitleEditModal',\n      'handleShowDescriptionEditModal',\n      'handleShowTagsModal',\n      'handleShowPropertyListEditorModal',\n      'handleShowDeadlineModal',\n      'handleShowScheduledModal',\n      'handleShowNoteModal',\n      'handleRemoveHeader',\n    ]);\n  }\n\n  handleShowTitleEditModal() {\n    this.props.onSwitch();\n    this.props.base.activatePopup('title-editor');\n  }\n\n  handleShowDescriptionEditModal() {\n    this.props.onSwitch();\n    this.props.org.openHeader(this.props.selectedHeaderId);\n    this.props.base.activatePopup('description-editor');\n  }\n\n  handleShowTagsModal() {\n    this.props.onSwitch();\n    this.props.base.activatePopup('tags-editor');\n  }\n\n  handleShowPropertyListEditorModal() {\n    this.props.onSwitch();\n    this.props.base.activatePopup('property-list-editor');\n  }\n\n  handleDeadlineAndScheduledClick(planningType) {\n    const { header, selectedHeaderId } = this.props;\n    const popupType = {\n      DEADLINE: 'deadline-editor',\n      SCHEDULED: 'scheduled-editor',\n    }[planningType];\n\n    const existingDeadlinePlanningItemIndex = header\n      .get('planningItems', [])\n      .findIndex((planningItem) => planningItem.get('type') === planningType);\n    this.props.base.activatePopup(popupType, {\n      headerId: header.get('id'),\n      planningItemIndex: existingDeadlinePlanningItemIndex,\n    });\n\n    this.props.org.openHeader(selectedHeaderId);\n  }\n\n  handleShowDeadlineModal() {\n    this.props.onSwitch();\n    this.handleDeadlineAndScheduledClick('DEADLINE');\n  }\n\n  handleShowScheduledModal() {\n    this.props.onSwitch();\n    this.handleDeadlineAndScheduledClick('SCHEDULED');\n  }\n\n  handleShowNoteModal() {\n    this.props.onSwitch();\n    this.props.base.activatePopup('note-editor');\n  }\n\n  handleRemoveHeader() {\n    this.props.base.closePopup();\n    this.props.org.selectHeader(null);\n    this.props.org.removeHeader(this.props.header.get('id'));\n  }\n\n  render() {\n    return (\n      <div className=\"static-action-bar\">\n        <DrawerActionButtons\n          activePopupType={this.props.activePopupType}\n          onSwitch={this.props.onSwitch}\n          onTitleClick={this.handleShowTitleEditModal}\n          onDescriptionClick={this.handleShowDescriptionEditModal}\n          onTagsClick={this.handleShowTagsModal}\n          onPropertiesClick={this.handleShowPropertyListEditorModal}\n          onDeadlineClick={this.handleShowDeadlineModal}\n          onScheduledClick={this.handleShowScheduledModal}\n          onAddNote={this.handleShowNoteModal}\n          onRemoveHeader={this.handleRemoveHeader}\n          editRawValues={this.props.editRawValues}\n          setEditRawValues={this.props.setEditRawValues}\n          restorePreferEditRawValues={this.props.restorePreferEditRawValues}\n        />\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path], Map());\n  const activePopup = state.base.get('activePopup');\n  return {\n    selectedHeaderId: file.get('selectedHeaderId'),\n    header: getSelectedHeader(state),\n    activePopupType: !!activePopup ? activePopup.get('type') : null,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DrawerActionBar);\n","const DEFAULT_BINDINGS = [\n  ['Select next header', 'selectNextVisibleHeader', 'ctrl+down'],\n  ['Select previous header', 'selectPreviousVisibleHeader', 'ctrl+up'],\n  ['Toggle header opened', 'toggleHeaderOpened', 'tab'],\n  ['Advance todo state', 'advanceTodo', 'alt+t'],\n  ['Edit title', 'editTitle', 'ctrl+h'],\n  ['Edit description', 'editDescription', 'ctrl+d'],\n  ['Exit edit mode', 'exitEditMode', 'alt+enter'],\n  ['Add header', 'addHeader', 'ctrl+enter'],\n  ['Remove header', 'removeHeader', 'backspace'],\n  ['Move header up', 'moveHeaderUp', 'alt+up'],\n  ['Move header down', 'moveHeaderDown', 'alt+down'],\n  ['Move header left', 'moveHeaderLeft', 'alt+shift+left'],\n  ['Move header right', 'moveHeaderRight', 'alt+shift+right'],\n  ['Undo', 'undo', 'ctrl+/'],\n];\n\nexport const calculateNamedKeybindings = (customKeybindings) =>\n  DEFAULT_BINDINGS.map(([bindingName, _bindingAction, binding]) => [\n    bindingName,\n    customKeybindings.get(bindingName, binding),\n  ]);\n\nexport const calculateActionedKeybindings = (customKeybindings) =>\n  DEFAULT_BINDINGS.map(([bindingName, bindingAction, binding]) => [\n    bindingAction,\n    customKeybindings.get(bindingName, binding),\n  ]);\n","import React, { Fragment, useEffect } from 'react';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { List, Map } from 'immutable';\n\nimport * as orgActions from '../../../../../../actions/org';\n\nimport './stylesheet.css';\n\nimport TitleLine from '../../../TitleLine';\n\nimport { dateForTimestamp } from '../../../../../../lib/timestamps';\nimport {\n  createIsTodoKeywordInDoneState,\n  getPlanningItemTypeText,\n  customFormatDistanceToNow,\n} from '../../../../../../lib/org_utils';\n\nimport { format, isPast } from 'date-fns';\nimport classNames from 'classnames';\n\nfunction TaskListView(props) {\n  function handleHeaderClick(path, headerId) {\n    return () => props.onHeaderClick(path, headerId);\n  }\n\n  const {\n    dateDisplayType,\n    onToggleDateDisplayType,\n    headersForFiles,\n    todoKeywordSetsForFiles,\n  } = props;\n\n  // Populate filteredHeaders\n  useEffect(() => {\n    props.org.setSearchFilterInformation('', 0, 'task-list');\n  }, [props.org]);\n\n  const planningItemsAndHeaders = getPlanningItemsAndHeaders({\n    headersForFiles,\n    todoKeywordSetsForFiles,\n  });\n\n  return (\n    <div className=\"agenda-day__container\">\n      <div className=\"agenda-day__headers-container\">\n        {planningItemsAndHeaders.map(([planningItem, header]) => {\n          const planningItemDate = planningItem\n            ? dateForTimestamp(planningItem.get('timestamp'))\n            : null;\n          const hasTodoKeyword = !!header.getIn(['titleLine', 'todoKeyword']);\n\n          const dateClassName = classNames('task-list__header-planning-date', {\n            'task-list__header-planning-date--overdue':\n              hasTodoKeyword && planningItem && isPast(planningItemDate),\n          });\n\n          let planningInformation = <div />;\n          if (planningItemDate) {\n            planningInformation = (\n              <div className=\"agenda-day__header__planning-item-container\">\n                <div className=\"task-list__header-planning-type\">\n                  {getPlanningItemTypeText(planningItem)}\n                </div>\n                <div className={dateClassName} onClick={onToggleDateDisplayType}>\n                  {dateDisplayType === 'absolute'\n                    ? format(planningItemDate, 'MM/dd')\n                    : customFormatDistanceToNow(planningItemDate)}\n\n                  {!!planningItem.getIn(['timestamp', 'startHour']) && (\n                    <Fragment>\n                      <br />\n                      {format(planningItemDate, 'h:mma')}\n                    </Fragment>\n                  )}\n                </div>\n              </div>\n            );\n          }\n          return (\n            <div key={header.get('id')} className=\"agenda-day__header-container\">\n              <div className=\"agenda-day__header__header-container\">\n                <TitleLine\n                  header={header}\n                  color=\"var(--base03)\"\n                  hasContent={false}\n                  isSelected={false}\n                  shouldDisableActions\n                  shouldDisableExplicitWidth\n                  onClick={handleHeaderClick(header.get('path'), header.get('id'))}\n                />\n                {planningInformation}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n\n  // Doing this on every render of the TaskListView is potentially\n  // inefficient and could be done in the reducer. However, doing it\n  // on every update of the headers state when not even looking at the\n  // Agenda is certainly more inefficient. Hence, we're doing it on\n  // every render.\n  function getPlanningItemsAndHeaders({ headersForFiles, todoKeywordSetsForFiles }) {\n    const headers = List().concat(\n      ...headersForFiles\n        .mapEntries(([path, headersOfFile]) => [\n          path,\n          headersOfFile.map((header) => header.set('path', path)),\n        ])\n        .valueSeq()\n    );\n    const isTodoKeywordInDoneState = todoKeywordSetsForFiles.map((todoKeywordSets) =>\n      createIsTodoKeywordInDoneState(todoKeywordSets)\n    );\n\n    return headers\n      .filter((header) => header.getIn(['titleLine', 'todoKeyword']))\n      .map((header) => {\n        const earliestPlanningItem = header\n          .get('planningItems')\n          .sortBy(getTimeFromPlanningItem)\n          .first();\n        return [earliestPlanningItem, header];\n      })\n      .sortBy(([planningItem, header]) => {\n        const doneState = isTodoKeywordInDoneState.get(header.get('path'))(\n          header.getIn(['titleLine', 'todoKeyword'])\n        );\n\n        const timeAsSortCriterion = planningItem\n          ? getTimeFromPlanningItem(planningItem)\n          : Number.MAX_SAFE_INTEGER; // Sort tasks without timestamp last\n        const title = header.getIn(['titleLine', 'rawTitle']);\n        return [doneState, timeAsSortCriterion, title];\n      });\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const files = state.org.present.get('files');\n  return {\n    // When no filtering has happened, yet (initial state), use all headers.\n    headersForFiles: state.org.present.getIn(['search', 'filteredHeaders']) || Map(),\n    todoKeywordSetsForFiles: files.map((file) => file.get('todoKeywordSets')),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nconst getTimeFromPlanningItem = (planningItem) =>\n  dateForTimestamp(planningItem.get('timestamp')).getTime();\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TaskListView);\n","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport TaskListView from './components/TaskListView';\n\nimport { isMobileBrowser, isIos } from '../../../../lib/browser_utils';\n\nimport * as orgActions from '../../../../actions/org';\n\n// INFO: SearchModal, AgendaModal and TaskListModal are very similar\n// in structure and partially in logic. When changing one, consider\n// changing all.\nfunction TaskListModal(props) {\n  const { searchFilter, searchFilterValid, searchFilterSuggestions, bookmarks } = props;\n  const bookmarkChosen = bookmarks.contains(searchFilter);\n  const canSaveBookmark = searchFilterValid && searchFilter.length !== 0;\n\n  const [dateDisplayType, setdateDisplayType] = useState('absolute');\n\n  function handleHeaderClick(path, headerId) {\n    props.onClose();\n    props.org.selectHeaderAndOpenParents(path, headerId);\n  }\n\n  function handleToggleDateDisplayType() {\n    setdateDisplayType(dateDisplayType === 'absolute' ? 'relative' : 'absolute');\n  }\n\n  function handleFilterChange(event) {\n    props.org.setSearchFilterInformation(\n      event.target.value,\n      event.target.selectionStart,\n      'task-list'\n    );\n  }\n\n  function onBookmarkButtonClick() {\n    if (bookmarkChosen) {\n      props.org.deleteBookmark('task-list', searchFilter);\n    } else if (canSaveBookmark) {\n      props.org.saveBookmark('task-list', searchFilter);\n    }\n  }\n\n  return (\n    <>\n      <div className=\"task-list__modal-title_search\" />\n      <div className=\"search-input-container\">\n        <div className=\"search-input-line\">\n          <datalist id=\"task-list__datalist-filter\">\n            {(searchFilter.length === 0 ? bookmarks : searchFilterSuggestions).map(\n              (string, idx) => (\n                <option key={idx} value={string} />\n              )\n            )}\n          </datalist>\n\n          <div className=\"search__input-container\">\n            <input\n              type=\"text\"\n              value={searchFilter}\n              // Rationale: See SearchModal: index.js\n              autoFocus={!isIos()}\n              // Disable auto-capitalization for convenience (autoComplete must also be off to\n              // achieve this on Android).\n              autoCapitalize=\"none\"\n              autoComplete=\"off\"\n              className={classNames('textfield', 'task-list__filter-input', {\n                'task-list__filter-input--invalid': !!searchFilter && !searchFilterValid,\n              })}\n              placeholder=\"e.g. -DONE doc|man :simple|easy :assignee:nobody|none\"\n              list=\"task-list__datalist-filter\"\n              onChange={handleFilterChange}\n            />\n          </div>\n\n          <i\n            className={classNames('fas fa-lg bookmark__icon ', {\n              'fa-star': !bookmarkChosen,\n              'fa-trash': bookmarkChosen,\n              bookmark__icon__enabled: canSaveBookmark,\n            })}\n            onClick={onBookmarkButtonClick}\n          />\n        </div>\n      </div>\n\n      <div\n        className=\"task-list__headers-container\"\n        // On mobile devices, the Drawer already handles the touch\n        // event. Hence, scrolling within the Drawers container does\n        // not work with the same event. Therefore, we're just opting\n        // to scroll the whole drawer. That's not the best UX. And a\n        // better CSS juggler than me is welcome to improve on it.\n        style={isMobileBrowser ? undefined : { overflow: 'auto' }}\n      >\n        <TaskListView\n          onHeaderClick={handleHeaderClick}\n          dateDisplayType={dateDisplayType}\n          onToggleDateDisplayType={handleToggleDateDisplayType}\n        />\n      </div>\n    </>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n  searchFilter: state.org.present.getIn(['search', 'searchFilter']) || '',\n  searchFilterValid: state.org.present.getIn(['search', 'searchFilterValid']),\n  searchFilterSuggestions: state.org.present.getIn(['search', 'searchFilterSuggestions']) || [],\n  bookmarks: state.org.present.getIn(['bookmarks', 'task-list']),\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TaskListModal);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport TabButtons from '../../../UI/TabButtons';\nimport TaskListModal from '../TaskListModal';\nimport SearchModal from '../SearchModal';\n\nimport * as baseActions from '../../../../actions/base';\nimport * as orgActions from '../../../../actions/org';\nimport { determineIncludedFiles } from '../../../../reducers/org';\n\nfunction FinderModal(props) {\n  const { finderTab, onClose, headers, activeClocks } = props;\n\n  function handleTabChange(finderTab) {\n    props.base.setFinderTab(finderTab);\n  }\n\n  function renderTab(finderTab) {\n    if (!activeClocks && finderTab === 'Clock List') {\n      props.base.setFinderTab('Search');\n      return;\n    }\n    switch (finderTab) {\n      case 'Search':\n        return <SearchModal context=\"search\" onClose={onClose} />;\n      case 'Task List':\n        return <TaskListModal headers={headers} onClose={onClose} />;\n      case 'Clock List':\n        return <SearchModal activeClocks={activeClocks} context=\"search\" onClose={onClose} />;\n      default:\n        return <h2>Error</h2>;\n    }\n  }\n\n  return (\n    <>\n      <div className=\"agenda__tab-container\">\n        <TabButtons\n          buttons={activeClocks ? ['Search', 'Task List', 'Clock List'] : ['Search', 'Task List']}\n          selectedButton={finderTab}\n          onSelect={handleTabChange}\n          useEqualWidthTabs\n        />\n      </div>\n      {renderTab(finderTab)}\n      <br />\n    </>\n  );\n}\n\nconst mapStateToProps = (state) => {\n  const path = state.org.present.get('path');\n  const files = state.org.present.get('files');\n  const fileSettings = state.org.present.get('fileSettings');\n  const searchFiles = determineIncludedFiles(files, fileSettings, path, 'includeInSearch', false);\n  const activeClocks = Object.values(\n    searchFiles.map((f) => (f.get('headers').size ? f.get('activeClocks') : 0)).toJS()\n  ).reduce((acc, val) => (typeof val === 'number' ? acc + val : acc), 0);\n  return {\n    finderTab: state.base.get('finderTab'),\n    activeClocks,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n  base: bindActionCreators(baseActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FinderModal);\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Redirect } from 'react-router-dom';\n\nimport { GlobalHotKeys } from 'react-hotkeys';\n\nimport './stylesheet.css';\n\nimport HeaderList from './components/HeaderList';\nimport ActionDrawer from './components/ActionDrawer';\nimport CaptureModal from './components/CaptureModal';\nimport SyncConfirmationModal from './components/SyncConfirmationModal';\nimport TagsEditorModal from './components/TagsEditorModal';\nimport TimestampEditorModal from './components/TimestampEditorModal';\nimport PropertyListEditorModal from './components/PropertyListEditorModal';\nimport TitleEditorModal from './components/TitleEditorModal';\nimport DescriptionEditorModal from './components/DescriptionEditorModal';\nimport TableEditorModal from './components/TableEditorModal';\nimport NoteEditorModal from './components/NoteEditorModal';\nimport AgendaModal from './components/AgendaModal';\nimport SearchModal from './components/SearchModal';\nimport ExternalLink from '../UI/ExternalLink';\nimport Drawer from '../UI/Drawer/';\nimport DrawerActionBar from './components/DrawerActionBar';\n\nimport * as baseActions from '../../actions/base';\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as orgActions from '../../actions/org';\nimport * as captureActions from '../../actions/capture';\nimport { ActionCreators as undoActions } from 'redux-undo';\n\nimport sampleCaptureTemplates from '../../lib/sample_capture_templates';\nimport { calculateActionedKeybindings } from '../../lib/keybindings';\nimport {\n  timestampWithId,\n  headerWithId,\n  extractAllOrgTags,\n  extractAllOrgProperties,\n  changelogHash,\n  STATIC_FILE_PREFIX,\n} from '../../lib/org_utils';\n\nimport _ from 'lodash';\nimport { fromJS, List, Map, Set } from 'immutable';\nimport { createRawDescriptionText, generateTitleLine } from '../../lib/export_org';\nimport FinderModal from './components/FinderModal';\n\nclass OrgFile extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleSelectNextVisibleHeaderHotKey',\n      'handleSelectPreviousVisibleHeaderHotKey',\n      'handleToggleHeaderOpenedHotKey',\n      'handleAdvanceTodoHotKey',\n      'handleEditTitleHotKey',\n      'handleEditDescriptionHotKey',\n      'handleExitEditModeHotKey',\n      'handleAddHeaderHotKey',\n      'handleCreateFirstHeader',\n      'handleRemoveHeaderHotKey',\n      'handleMoveHeaderUpHotKey',\n      'handleMoveHeaderDownHotKey',\n      'handleMoveHeaderLeftHotKey',\n      'handleMoveHeaderRightHotKey',\n      'handleUndoHotKey',\n      'handleContainerRef',\n      'handleCapture',\n      'handlePopupClose',\n      'handleSearchPopupClose',\n      'handleRefilePopupClose',\n      'handleTitlePopupClose',\n      'saveTitle',\n      'handleTodoChange',\n      'handleDescriptionPopupClose',\n      'handleTablePopupClose',\n      'handleSyncConfirmationPull',\n      'handleSyncConfirmationPush',\n      'handleSyncConfirmationCancel',\n      'handleTagsChange',\n      'handlePropertyListItemsChange',\n      'getPopupCloseAction',\n      'getPopupSwitchAction',\n      'checkPopupAndHeader',\n      'checkPopup',\n    ]);\n\n    this.state = {\n      hasUncaughtError: false,\n      editRawValues: props.preferEditRawValues,\n    };\n  }\n\n  componentDidMount() {\n    const { staticFile, path } = this.props;\n\n    if (!!staticFile) {\n      this.props.org.setPath(STATIC_FILE_PREFIX + staticFile);\n      if (staticFile === 'changelog') {\n        this.props.base.setHasUnseenChangelog(false);\n        changelogHash().then((hash) => {\n          this.props.base.setLastSeenChangelogHeader(hash);\n        });\n      }\n\n      setTimeout(() => (document.querySelector('.App').scrollTop = 0), 0);\n    } else if (!_.isEmpty(path)) {\n      if (this.props.fileIsLoaded(path)) {\n        this.props.org.sync({ path, shouldSuppressMessages: true });\n      } else {\n        this.props.syncBackend.downloadFile(path);\n      }\n      this.props.org.setPath(path);\n    }\n\n    this.activatePopup();\n  }\n\n  // If a fragment is set in the URL (by the activatePopup base\n  // action), activate the appropriate pop-up\n  activatePopup() {\n    const urlFragment = window.location.hash.substr(1);\n    if (!_.isEmpty(urlFragment)) {\n      this.props.base.activatePopup(urlFragment);\n    }\n  }\n\n  componentWillUnmount() {\n    const { staticFile } = this.props;\n\n    if (!!staticFile) {\n      this.props.base.unloadStaticFile();\n    } else {\n      this.props.org.resetFileDisplay();\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const { headers, pendingCapture } = this.props;\n    if (!!pendingCapture && !!headers && headers.size > 0) {\n      this.props.org.insertPendingCapture();\n    }\n\n    const { path } = this.props;\n    if (!_.isEmpty(path) && path !== prevProps.path) {\n      this.props.syncBackend.downloadFile(path);\n      this.props.org.setPath(path);\n    }\n  }\n\n  componentDidCatch() {\n    // TODO: Track the `error` into a bug tracker\n    this.setState({ hasUncaughtError: true });\n  }\n\n  handleSelectNextVisibleHeaderHotKey() {\n    this.props.org.selectNextVisibleHeader();\n  }\n\n  handleSelectPreviousVisibleHeaderHotKey() {\n    this.props.org.selectPreviousVisibleHeader();\n  }\n\n  handleToggleHeaderOpenedHotKey() {\n    const { selectedHeaderId, closeSubheadersRecursively } = this.props;\n\n    if (selectedHeaderId) {\n      this.props.org.toggleHeaderOpened(selectedHeaderId, closeSubheadersRecursively);\n    }\n  }\n\n  handleAdvanceTodoHotKey() {\n    this.props.org.advanceTodoState(null, this.props.shouldLogIntoDrawer);\n  }\n\n  handleEditTitleHotKey() {\n    this.props.base.activatePopup('title-editor');\n  }\n\n  handleEditDescriptionHotKey() {\n    this.props.base.activatePopup('description-editor');\n  }\n\n  handleExitEditModeHotKey() {\n    const onClose = this.getPopupSwitchAction(this.props.activePopupType);\n    onClose(\n      ...(this.state.popupCloseActionValuesAccessor\n        ? this.state.popupCloseActionValuesAccessor()\n        : [])\n    );\n    this.props.base.closePopup();\n    this.container.focus();\n  }\n\n  handleAddHeaderHotKey() {\n    this.props.org.addHeaderAndEdit(this.props.selectedHeaderId);\n  }\n\n  handleCreateFirstHeader() {\n    this.props.org.createFirstHeader();\n  }\n\n  handleRemoveHeaderHotKey() {\n    const { selectedHeaderId } = this.props;\n\n    this.props.org.selectNextSiblingHeader(selectedHeaderId);\n    this.props.org.removeHeader(selectedHeaderId);\n  }\n\n  handleMoveHeaderUpHotKey() {\n    this.props.org.moveHeaderUp(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderDownHotKey() {\n    this.props.org.moveHeaderDown(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderLeftHotKey() {\n    this.props.org.moveHeaderLeft(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderRightHotKey() {\n    this.props.org.moveHeaderRight(this.props.selectedHeaderId);\n  }\n\n  handleUndoHotKey() {\n    this.props.undo.undo();\n  }\n\n  handleContainerRef(container) {\n    this.container = container;\n    if (this.container) {\n      this.container.focus();\n    }\n  }\n\n  handleCapture(templateId, content, shouldPrepend) {\n    this.props.org.insertCapture(templateId, content, shouldPrepend);\n  }\n\n  handlePopupClose() {\n    this.props.base.closePopup();\n  }\n\n  handleSearchPopupClose(path, headerId) {\n    this.props.base.closePopup();\n    if (path && headerId) {\n      this.props.org.selectHeaderAndOpenParents(path, headerId);\n    }\n  }\n\n  handleRefilePopupClose(targetPath, targetHeaderId) {\n    this.props.base.closePopup();\n    // When the user closes the drawer without selecting a header, do\n    // not trigger refiling.\n    if (targetHeaderId) {\n      const { loadedPath, selectedHeaderId } = this.props;\n      this.props.org.refileSubtree(loadedPath, selectedHeaderId, targetPath, targetHeaderId);\n    }\n  }\n\n  saveTitle(titleValue) {\n    const { selectedHeader } = this.props;\n    if (this.state.editRawValues) {\n      if (generateTitleLine(selectedHeader.toJS(), false) !== titleValue) {\n        this.props.org.updateHeaderTitle(selectedHeader.get('id'), titleValue);\n      }\n    } else {\n      if (selectedHeader.getIn(['titleLine', 'rawTitle']) !== titleValue) {\n        this.props.org.updateHeaderTitle(\n          selectedHeader.get('id'),\n          generateTitleLine(\n            selectedHeader.setIn(['titleLine', 'rawTitle'], titleValue).toJS(),\n            false\n          )\n        );\n      }\n    }\n  }\n\n  handleTitlePopupClose(titleValue) {\n    this.saveTitle(titleValue);\n    this.props.base.closePopup();\n  }\n\n  handleDescriptionPopupClose(descriptionValue) {\n    const { selectedHeader } = this.props;\n    if (this.state.editRawValues) {\n      if (\n        createRawDescriptionText(selectedHeader, false, this.props.dontIndent) !== descriptionValue\n      ) {\n        this.props.org.updateHeaderDescription(selectedHeader.get('id'), descriptionValue);\n      }\n    } else {\n      if (selectedHeader.get('rawDescription') !== descriptionValue) {\n        this.props.org.updateHeaderDescription(\n          selectedHeader.get('id'),\n          createRawDescriptionText(\n            selectedHeader.set('rawDescription', descriptionValue),\n            false,\n            this.props.dontIndent\n          )\n        );\n      }\n    }\n    this.props.base.closePopup();\n  }\n\n  handleTablePopupClose() {\n    this.props.base.closePopup();\n    this.props.org.setSelectedTableCellId(null);\n    this.props.org.setSelectedTableId(null);\n  }\n\n  handleSyncConfirmationPull(path) {\n    this.props.org.sync({ path, forceAction: 'pull' });\n    this.props.base.closePopup();\n  }\n\n  handleSyncConfirmationPush(path) {\n    this.props.org.sync({ path, forceAction: 'push' });\n    this.props.base.closePopup();\n  }\n\n  handleSyncConfirmationCancel() {\n    this.props.base.closePopup();\n  }\n\n  handleTagsChange(newTags) {\n    this.props.org.setHeaderTags(this.props.selectedHeaderId, newTags);\n  }\n\n  handlePropertyListItemsChange(newPropertyListItems) {\n    this.props.org.updatePropertyListItems(this.props.selectedHeaderId, newPropertyListItems);\n  }\n\n  handleTimestampChange(popupData) {\n    if (!!popupData.get('timestampId')) {\n      return (newTimestamp) =>\n        this.props.org.updateTimestampWithId(popupData.get('timestampId'), newTimestamp);\n    } else if (popupData.get('logEntryIndex') !== undefined) {\n      return (newTimestamp) =>\n        this.props.org.updateLogEntryTime(\n          popupData.get('headerId'),\n          popupData.get('logEntryIndex'),\n          popupData.get('entryType'),\n          newTimestamp.get('firstTimestamp')\n        );\n    } else {\n      return (newTimestamp) =>\n        this.props.org.updatePlanningItemTimestamp(\n          popupData.get('headerId'),\n          popupData.get('planningItemIndex'),\n          newTimestamp.get('firstTimestamp')\n        );\n    }\n  }\n\n  handleTodoChange(newTodoKeyword) {\n    this.props.org.setTodoState(\n      this.props.selectedHeaderId,\n      newTodoKeyword,\n      this.props.shouldLogIntoDrawer\n    );\n  }\n\n  getPopupSwitchAction(activePopupType) {\n    switch (activePopupType) {\n      case 'title-editor':\n        return (titleValue) => this.handleTitlePopupClose(titleValue);\n      case 'description-editor':\n        return (descriptionValue) => this.handleDescriptionPopupClose(descriptionValue);\n      default:\n        return () => {};\n    }\n  }\n\n  getPopupCloseAction(activePopupType) {\n    switch (activePopupType) {\n      case 'search':\n        return this.handleSearchPopupClose;\n      case 'refile':\n        return this.handleRefilePopupClose;\n      case 'title-editor':\n        return this.handleTitlePopupClose;\n      case 'description-editor':\n        return this.handleDescriptionPopupClose;\n      case 'table-editor':\n        return this.handleTablePopupClose;\n      default:\n        return this.handlePopupClose;\n    }\n  }\n\n  getPopupMaxSize(activePopupType) {\n    switch (activePopupType) {\n      case 'agenda':\n      case 'task-list':\n      case 'search':\n      case 'refile':\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  renderActivePopup(setPopupCloseActionValuesAccessor) {\n    const {\n      activePopupType,\n      activePopupData,\n      captureTemplates,\n      files,\n      headers,\n      selectedHeader,\n      shouldDisableActions,\n      todoKeywordSets,\n    } = this.props;\n\n    switch (activePopupType) {\n      case 'sync-confirmation':\n        return (\n          <SyncConfirmationModal\n            lastServerModifiedAt={activePopupData.get('lastServerModifiedAt')}\n            lastSyncAt={activePopupData.get('lastSyncAt')}\n            path={activePopupData.get('path')}\n            onPull={() => this.handleSyncConfirmationPull(activePopupData.get('path'))}\n            onPush={() => this.handleSyncConfirmationPush(activePopupData.get('path'))}\n            onCancel={this.handleSyncConfirmationCancel}\n          />\n        );\n      case 'capture':\n        const template = captureTemplates.find(\n          (template) => template.get('id') === activePopupData.get('templateId')\n        );\n        const path = template.get('file');\n        let headersOfCaptureTarget = headers;\n        if (path) {\n          const file = files.get(path);\n          headersOfCaptureTarget = file ? file.get('headers') : List();\n        }\n        return (\n          <CaptureModal\n            template={template}\n            headers={headersOfCaptureTarget}\n            onCapture={this.handleCapture}\n            onClose={this.getPopupCloseAction(activePopupType)}\n          />\n        );\n      case 'tags-editor':\n        const allTags = extractAllOrgTags(headers);\n        return (\n          <TagsEditorModal\n            header={selectedHeader}\n            allTags={allTags}\n            onChange={this.handleTagsChange}\n          />\n        );\n      case 'timestamp-editor':\n      case 'scheduled-editor':\n      case 'deadline-editor':\n        let editingTimestamp = null;\n        if (activePopupData.get('timestampId')) {\n          editingTimestamp = timestampWithId(headers, activePopupData.get('timestampId'));\n        } else if (activePopupData.get('logEntryIndex') !== undefined) {\n          editingTimestamp = fromJS({\n            firstTimestamp: headerWithId(headers, activePopupData.get('headerId')).getIn([\n              'logBookEntries',\n              activePopupData.get('logEntryIndex'),\n              activePopupData.get('entryType'),\n            ]),\n          });\n        } else if (\n          // for scheduled timestamp and deadline the modal can be opened when no timestamp exists\n          (activePopupType !== 'scheduled-editor' && activePopupType !== 'deadline-editor') ||\n          activePopupData.get('planningItemIndex') !== -1\n        ) {\n          editingTimestamp = fromJS({\n            firstTimestamp: headerWithId(headers, activePopupData.get('headerId')).getIn([\n              'planningItems',\n              activePopupData.get('planningItemIndex'),\n              'timestamp',\n            ]),\n          });\n        }\n\n        return (\n          <TimestampEditorModal\n            headerId={activePopupData.get('headerId')}\n            timestamp={editingTimestamp}\n            timestampId={activePopupData.get('timestampId')}\n            popupType={activePopupType}\n            planningItemIndex={activePopupData.get('planningItemIndex')}\n            singleTimestampOnly={!activePopupData.get('timestampId')}\n            onClose={this.getPopupCloseAction(activePopupType)}\n            onChange={this.handleTimestampChange(activePopupData)}\n          />\n        );\n\n      case 'property-list-editor':\n        const allOrgProperties = extractAllOrgProperties(headers);\n        return selectedHeader ? (\n          <PropertyListEditorModal\n            onChange={this.handlePropertyListItemsChange}\n            propertyListItems={selectedHeader.get('propertyListItems')}\n            allOrgProperties={allOrgProperties}\n          />\n        ) : null;\n      case 'agenda':\n        return (\n          <AgendaModal headers={headers} onClose={this.getPopupCloseAction(activePopupType)} />\n        );\n      case 'search':\n        return (\n          <FinderModal headers={headers} onClose={this.getPopupCloseAction(activePopupType)} />\n        );\n      case 'refile':\n        return <SearchModal context=\"refile\" onClose={this.getPopupCloseAction(activePopupType)} />;\n      case 'title-editor':\n        return (\n          <TitleEditorModal\n            editRawValues={this.state.editRawValues}\n            todoKeywordSets={todoKeywordSets}\n            onClose={this.getPopupCloseAction('title-editor')}\n            saveTitle={this.saveTitle}\n            onTodoClicked={this.handleTodoChange}\n            header={selectedHeader}\n            setPopupCloseActionValuesAccessor={setPopupCloseActionValuesAccessor}\n          />\n        );\n      case 'description-editor':\n        return (\n          <DescriptionEditorModal\n            editRawValues={this.state.editRawValues}\n            header={selectedHeader}\n            dontIndent={this.props.dontIndent}\n            setPopupCloseActionValuesAccessor={setPopupCloseActionValuesAccessor}\n          />\n        );\n      case 'table-editor':\n        return <TableEditorModal shouldDisableActions={shouldDisableActions} />;\n      case 'note-editor':\n        return <NoteEditorModal shouldDisableActions={shouldDisableActions} />;\n      default:\n        return null;\n    }\n  }\n\n  // Some keyboard shortcuts only make sense when a header is selected and no popup is open\n  checkPopupAndHeader(callback) {\n    return (event) => {\n      if (\n        this.props.selectedHeader &&\n        !this.props.activePopupType &&\n        !this.props.shouldDisableActions\n      ) {\n        callback(event);\n      }\n    };\n  }\n\n  // Read only actions only need to be disabled when a popup is open\n  checkPopup(callback) {\n    return (event) => {\n      if (!this.props.activePopupType) {\n        callback(event);\n      }\n    };\n  }\n\n  render() {\n    const {\n      headers,\n      linesBeforeHeadings,\n      shouldDisableDirtyIndicator,\n      shouldDisableSyncButtons,\n      shouldDisableActions,\n      isDirty,\n      parsingErrorMessage,\n      path,\n      staticFile,\n      customKeybindings,\n      orgFileErrorMessage,\n      activePopupType,\n    } = this.props;\n\n    if (!path && !staticFile) {\n      return <Redirect to=\"/files\" />;\n    }\n\n    if (this.state.hasUncaughtError) {\n      return (\n        <div className=\"error-message-container\">\n          Uh oh, you ran into a bug!\n          <br />\n          <br />\n          This was probably the result of an error in attempting to parse your org file. It'd be\n          super helpful if you could{' '}\n          <ExternalLink href=\"https://github.com/200ok-ch/organice/issues/new\">\n            create an issue\n          </ExternalLink>{' '}\n          (and include the org file if possible!)\n        </div>\n      );\n    }\n\n    if (!!orgFileErrorMessage) {\n      return <div className=\"error-message-container\">{orgFileErrorMessage}</div>;\n    }\n\n    if (!headers) {\n      return <div />;\n    }\n\n    const keyMap = _.fromPairs(calculateActionedKeybindings(customKeybindings));\n\n    // Automatically call preventDefault on all the keyboard events that come through for\n    // these hotkeys.\n    const preventDefault = (callback) => (event) => {\n      event.preventDefault();\n      callback(event);\n    };\n\n    const handlers = {\n      selectNextVisibleHeader: this.checkPopup(\n        preventDefault(this.handleSelectNextVisibleHeaderHotKey)\n      ),\n      selectPreviousVisibleHeader: this.checkPopup(\n        preventDefault(this.handleSelectPreviousVisibleHeaderHotKey)\n      ),\n      toggleHeaderOpened: this.checkPopup(\n        preventDefault(this.handleToggleHeaderOpenedHotKey, true)\n      ),\n      advanceTodo: this.checkPopupAndHeader(preventDefault(this.handleAdvanceTodoHotKey)),\n      editTitle: this.checkPopupAndHeader(preventDefault(this.handleEditTitleHotKey)),\n      editDescription: this.checkPopupAndHeader(preventDefault(this.handleEditDescriptionHotKey)),\n      exitEditMode: preventDefault(this.handleExitEditModeHotKey),\n      addHeader: this.checkPopupAndHeader(preventDefault(this.handleAddHeaderHotKey)),\n      removeHeader: this.checkPopupAndHeader(preventDefault(this.handleRemoveHeaderHotKey, true)),\n      moveHeaderUp: this.checkPopupAndHeader(preventDefault(this.handleMoveHeaderUpHotKey)),\n      moveHeaderDown: this.checkPopupAndHeader(preventDefault(this.handleMoveHeaderDownHotKey)),\n      moveHeaderLeft: this.checkPopupAndHeader(preventDefault(this.handleMoveHeaderLeftHotKey)),\n      moveHeaderRight: this.checkPopupAndHeader(preventDefault(this.handleMoveHeaderRightHotKey)),\n      undo: this.checkPopupAndHeader(preventDefault(this.handleUndoHotKey)),\n    };\n\n    const setPopupCloseActionValuesAccessor = (v) => {\n      this.setState({ popupCloseActionValuesAccessor: v });\n    };\n\n    // Check if this a legit Org file with content, just no headers\n    const noHeadlineButContent = () => {\n      return headers.size === 0 && linesBeforeHeadings.size > 0;\n    };\n\n    return (\n      <GlobalHotKeys keyMap={keyMap} handlers={handlers}>\n        <div className=\"org-file-container\" tabIndex=\"-1\" ref={this.handleContainerRef}>\n          {headers.size === 0 ? (\n            <div className=\"org-file__parsing-error-message\">\n              <h3>This file has no headlines</h3>\n\n              {!!parsingErrorMessage ? (\n                <Fragment>{parsingErrorMessage}</Fragment>\n              ) : (\n                <Fragment>\n                  {noHeadlineButContent() ? (\n                    <>\n                      <p>Yes, your file has content. Do not worry, it is still there! </p>\n                      <p>\n                        However, interacting with Org files in organice happens on a per headline\n                        basis. To use organice with this file, please create a new headline with the\n                        button below. The existing content is then put into the description of this\n                        new header.\n                      </p>\n                    </>\n                  ) : (\n                    <p></p>\n                  )}\n                  <p>Interact with your file by creating the first headline.</p>\n                  <p>\n                    <button className=\"btn\" onClick={this.handleCreateFirstHeader}>\n                      Create headline\n                    </button>\n                  </p>\n                </Fragment>\n              )}\n            </div>\n          ) : (\n            <HeaderList shouldDisableActions={shouldDisableActions} />\n          )}\n\n          {isDirty && !shouldDisableDirtyIndicator && (\n            <div className=\"dirty-indicator\">Unpushed changes</div>\n          )}\n\n          {!shouldDisableActions && (\n            <ActionDrawer\n              shouldDisableSyncButtons={shouldDisableSyncButtons}\n              staticFile={staticFile}\n            />\n          )}\n\n          {activePopupType ? (\n            <Drawer\n              onClose={() => {\n                this.getPopupCloseAction(activePopupType)(\n                  ...(this.state.popupCloseActionValuesAccessor\n                    ? this.state.popupCloseActionValuesAccessor()\n                    : [])\n                );\n                this.setState({ editRawValues: this.props.preferEditRawValues });\n                this.container.focus();\n              }}\n              maxSize={this.getPopupMaxSize(activePopupType)}\n            >\n              {this.renderActivePopup(setPopupCloseActionValuesAccessor)}\n              {(activePopupType === 'title-editor' ||\n                activePopupType === 'description-editor' ||\n                activePopupType === 'tags-editor' ||\n                activePopupType === 'property-list-editor' ||\n                activePopupType === 'timestamp-editor' ||\n                activePopupType === 'scheduled-editor' ||\n                activePopupType === 'deadline-editor' ||\n                activePopupType === 'note-editor') && (\n                <DrawerActionBar\n                  onSwitch={() => {\n                    this.getPopupSwitchAction(activePopupType)(\n                      ...(this.state.popupCloseActionValuesAccessor\n                        ? this.state.popupCloseActionValuesAccessor()\n                        : [])\n                    );\n                  }}\n                  editRawValues={this.state.editRawValues}\n                  setEditRawValues={(editRawValues) => this.setState({ editRawValues })}\n                  restorePreferEditRawValues={() =>\n                    this.setState({ editRawValues: this.props.preferEditRawValues })\n                  }\n                />\n              )}\n            </Drawer>\n          ) : null}\n        </div>\n      </GlobalHotKeys>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const files = state.org.present.get('files');\n  const path = state.org.present.get('path');\n  const loadedFiles = Set.fromKeys(files);\n  const fileIsLoaded = (path) => loadedFiles.includes(path);\n  const file = state.org.present.getIn(['files', path], Map());\n  const headers = file.get('headers');\n  const linesBeforeHeadings = file.get('linesBeforeHeadings');\n  const selectedHeaderId = file.get('selectedHeaderId', null);\n  const activePopup = state.base.get('activePopup', Map());\n\n  return {\n    loadedPath: path,\n    files,\n    headers,\n    linesBeforeHeadings,\n    selectedHeaderId,\n    isDirty: file.get('isDirty'),\n    fileIsLoaded,\n    selectedHeader: headers && headers.find((header) => header.get('id') === selectedHeaderId),\n    customKeybindings: state.base.get('customKeybindings'),\n    dontIndent: state.base.get('shouldNotIndentOnExport'),\n    shouldLogIntoDrawer: state.base.get('shouldLogIntoDrawer'),\n    shouldLiveSync: state.base.get('shouldLiveSync'),\n    showDeadlineDisplay: state.base.get('showDeadlineDisplay'),\n    activePopupType: !!activePopup ? activePopup.get('type') : null,\n    activePopupData: !!activePopup ? activePopup.get('data') : null,\n    captureTemplates: state.capture.get('captureTemplates').concat(sampleCaptureTemplates),\n    pendingCapture: state.org.present.get('pendingCapture'),\n    closeSubheadersRecursively: state.base.get('closeSubheadersRecursively'),\n    orgFileErrorMessage: state.org.present.get('orgFileErrorMessage'),\n    preferEditRawValues: state.base.get('preferEditRawValues'),\n    todoKeywordSets: file.get('todoKeywordSets'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n    undo: bindActionCreators(undoActions, dispatch),\n    capture: bindActionCreators(captureActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OrgFile);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { withRouter, Link, useHistory } from 'react-router-dom';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as baseActions from '../../actions/base';\nimport * as orgActions from '../../actions/org';\n\nimport './stylesheet.css';\n\nimport TabButtons from '../UI/TabButtons';\nimport Switch from '../UI/Switch';\nimport ExternalLink from '../UI/ExternalLink';\n\nconst Settings = ({\n  fontSize,\n  bulletStyle,\n  shouldTapTodoToAdvance,\n  shouldStoreSettingsInSyncBackend,\n  shouldLiveSync,\n  showDeadlineDisplay,\n  shouldSyncOnBecomingVisibile,\n  shouldShowTitleInOrgFile,\n  shouldLogIntoDrawer,\n  closeSubheadersRecursively,\n  shouldNotIndentOnExport,\n  editorDescriptionHeightValue,\n  agendaDefaultDeadlineDelayValue,\n  agendaDefaultDeadlineDelayUnit,\n  agendaStartOnWeekday,\n  hasUnseenChangelog,\n  syncBackend,\n  preferEditRawValues,\n  showClockDisplay,\n  colorScheme,\n  theme,\n  base,\n  org,\n}) => {\n  const history = useHistory();\n\n  // This looks like hardcoding where it would be possible to dispatch\n  // on the `location.origin`, but here we assure that every instance\n  // of organice has a valid link to documentation. Self-building does\n  // not insure that, because building and hosting docs is not part of\n  // the application itself.\n  const documentationHost = window.location.origin.match(/staging.organice.200ok.ch/)\n    ? 'https://staging.organice.200ok.ch'\n    : 'https://organice.200ok.ch';\n\n  const handleSignOutClick = () => {\n    if (window.confirm('Are you sure you want to sign out?')) {\n      syncBackend.signOut();\n      history.push('/');\n    }\n  };\n\n  const handleKeyboardShortcutsClick = () => base.pushModalPage('keyboard_shortcuts_editor');\n\n  const handleCaptureTemplatesClick = () => base.pushModalPage('capture_templates_editor');\n\n  const handleFileSettingsClick = () => base.pushModalPage('file_settings_editor');\n\n  const handleFontSizeChange = (newFontSize) => base.setFontSize(newFontSize);\n\n  const handleColorSchemeClick = (colorScheme) => base.setColorScheme(colorScheme);\n\n  const handleThemeClick = (theme) => base.setTheme(theme);\n\n  const handleBulletStyleChange = (newBulletStyle) => base.setBulletStyle(newBulletStyle);\n\n  const handleShouldTapTodoToAdvanceChange = () =>\n    base.setShouldTapTodoToAdvance(!shouldTapTodoToAdvance);\n\n  const handleEditorDescriptionHeightValueChange = (event) =>\n    base.setEditorDescriptionHeightValue(event.target.value);\n\n  const handleAgendaDefaultDeadlineDelayValueChange = (event) =>\n    base.setAgendaDefaultDeadlineDelayValue(event.target.value);\n\n  const handleAgendaDefaultDeadlineDelayUnitChange = (newDelayUnit) =>\n    base.setAgendaDefaultDeadlineDelayUnit(newDelayUnit);\n\n  const handleAgendaStartOnWeekdayChange = (value) => base.setAgendaStartOnWeekday(value);\n\n  const handleShouldLiveSyncChange = () => base.setShouldLiveSync(!shouldLiveSync);\n\n  const handleShowDeadlineDisplayChange = () => base.setShowDeadlineDisplay(!showDeadlineDisplay);\n\n  const handleShouldSyncOnBecomingVisibleChange = () =>\n    base.setShouldSyncOnBecomingVisibile(!shouldSyncOnBecomingVisibile);\n\n  const handleShouldShowTitleInOrgFile = () =>\n    base.setShouldShowTitleInOrgFile(!shouldShowTitleInOrgFile);\n\n  const handleShouldLogIntoDrawer = () => base.setShouldLogIntoDrawer(!shouldLogIntoDrawer);\n\n  const handleCloseSubheadersRecursively = () =>\n    base.setCloseSubheadersRecursively(!closeSubheadersRecursively);\n\n  const handleShouldNotIndentOnExport = () =>\n    base.setShouldNotIndentOnExport(!shouldNotIndentOnExport);\n\n  const handleShouldStoreSettingsInSyncBackendChange = () =>\n    base.setShouldStoreSettingsInSyncBackend(!shouldStoreSettingsInSyncBackend);\n\n  const handleShowClockDisplayClick = () => org.setShowClockDisplay(!showClockDisplay);\n\n  const handlePreferEditRawValues = () => base.setPreferEditRawValues(!preferEditRawValues);\n\n  return (\n    <div className=\"settings-container\">\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Font size</div>\n        <TabButtons\n          buttons={['Regular', 'Large']}\n          selectedButton={fontSize}\n          onSelect={handleFontSizeChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Color scheme</div>\n        <TabButtons\n          buttons={['OS', 'Light', 'Dark']}\n          selectedButton={colorScheme}\n          onSelect={handleColorSchemeClick}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Theme</div>\n        <TabButtons\n          buttons={['Solarized', 'One', 'Gruvbox', 'Smyck', 'Code']}\n          selectedButton={theme}\n          onSelect={handleThemeClick}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Bullet style</div>\n        <TabButtons\n          buttons={['Classic', 'Fancy']}\n          selectedButton={bulletStyle}\n          onSelect={handleBulletStyleChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Tap TODO to advance state</div>\n        <Switch isEnabled={shouldTapTodoToAdvance} onToggle={handleShouldTapTodoToAdvanceChange} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Live sync\n          <div className=\"setting-label__description\">\n            If enabled, changes are automatically pushed to the sync backend as you make them.\n          </div>\n        </div>\n        <Switch isEnabled={shouldLiveSync} onToggle={handleShouldLiveSyncChange} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Sync on application becoming visible\n          <div className=\"setting-label__description\">\n            If enabled, the current org file is pulled from the sync backend when the browser tab\n            becomes visible. This prevents you from having a stale file before starting to make\n            changes to it.\n          </div>\n        </div>\n        <Switch\n          isEnabled={shouldSyncOnBecomingVisibile}\n          onToggle={handleShouldSyncOnBecomingVisibleChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Show Org filename as Title\n          <div className=\"setting-label__description\">\n            When in an Org file view, it shows the filename in the HeaderBar.\n          </div>\n        </div>\n        <Switch isEnabled={shouldShowTitleInOrgFile} onToggle={handleShouldShowTitleInOrgFile} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Log into LOGBOOK drawer when item repeats\n          <div className=\"setting-label__description\">\n            Log TODO state changes (currently only for repeating items) into the LOGBOOK drawer\n            instead of into the body of the heading (default). See the Orgmode documentation on{' '}\n            <ExternalLink href=\"https://www.gnu.org/software/emacs/manual/html_node/org/Tracking-TODO-state-changes.html\">\n              <code>org-log-into-drawer</code>\n            </ExternalLink>{' '}\n            for more information.\n          </div>\n        </div>\n        <Switch isEnabled={shouldLogIntoDrawer} onToggle={handleShouldLogIntoDrawer} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          When folding a header, fold all subheaders too\n          <div className=\"setting-label__description\">\n            When folding a header, fold recursively all its subheaders, so that when the header is\n            reopened all subheaders are folded, regardless of their state prior to folding. This is\n            the default in Emacs Org mode. If this turned off, the fold-state of the subheaders is\n            preserved when the header is unfolded.\n          </div>\n        </div>\n        <Switch\n          isEnabled={closeSubheadersRecursively}\n          onToggle={handleCloseSubheadersRecursively}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Disable hard indent on Org export\n          <div className=\"setting-label__description\">\n            By default, the metadata body (including deadlines and drawers) of an exported org\n            heading is indented according to its level. If instead you prefer to keep your body text\n            flush-left, i.e.{' '}\n            <ExternalLink href=\"https://orgmode.org/manual/Hard-indentation.html\">\n              <code>(setq org-adapt-indentation nil)</code>\n            </ExternalLink>\n            , then activate this setting. The raw content text is left unchanged.\n          </div>\n        </div>\n        <Switch isEnabled={shouldNotIndentOnExport} onToggle={handleShouldNotIndentOnExport} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Store settings in sync backend\n          <div className=\"setting-label__description\">\n            Store settings and keyboard shortcuts in a .organice-config.json file in your sync\n            backend to sync between multiple devices.\n          </div>\n        </div>\n        <Switch\n          isEnabled={shouldStoreSettingsInSyncBackend}\n          onToggle={handleShouldStoreSettingsInSyncBackendChange}\n        />\n      </div>\n\n      <div className=\"setting-container setting-container--vertical\">\n        <div className=\"setting-label\">Default DEADLINE warning period</div>\n\n        <div className=\"default-deadline-warning-container\">\n          <input\n            type=\"number\"\n            min=\"0\"\n            className=\"textfield default-deadline-value-textfield\"\n            value={agendaDefaultDeadlineDelayValue}\n            onChange={handleAgendaDefaultDeadlineDelayValueChange}\n          />\n\n          <TabButtons\n            buttons={'hdwmy'.split('')}\n            selectedButton={agendaDefaultDeadlineDelayUnit}\n            onSelect={handleAgendaDefaultDeadlineDelayUnitChange}\n          />\n        </div>\n      </div>\n\n      <div className=\"setting-container setting-container--vertical\">\n        <div className=\"setting-label\">Description editor height</div>\n        <div className=\"setting-label__description\">\n          This setting controls the height of the description editor on computers only. The height\n          will be limited to ensure that all buttons are always visible. On mobile devices this\n          setting is ignored and the editor will always be 8 rows high.\n        </div>\n\n        <div className=\"default-deadline-warning-container\">\n          <input\n            type=\"number\"\n            min=\"2\"\n            className=\"textfield default-deadline-value-textfield\"\n            value={editorDescriptionHeightValue}\n            onChange={handleEditorDescriptionHeightValueChange}\n          />\n        </div>\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Start of week for weekly agenda\n          <div className=\"setting-label__description\">\n            Akin to{' '}\n            <ExternalLink href=\"https://orgmode.org/manual/Weekly_002fdaily-agenda.html\">\n              <code>org-agenda-start-on-weekday</code>\n            </ExternalLink>\n          </div>\n        </div>\n        <TabButtons\n          buttons={['S', 'M', 'T', 'W', 'T', 'F', 'S', 'Today']}\n          values={[0, 1, 2, 3, 4, 5, 6, -1]}\n          titles={['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']}\n          selectedButton={agendaStartOnWeekday}\n          onSelect={handleAgendaStartOnWeekdayChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Display time summaries\n          <div className=\"setting-label__description\">\n            This puts overlays at the end of each headline, showing the total time recorded under\n            that heading, including the time of any subheadings.\n          </div>\n        </div>\n        <Switch isEnabled={showClockDisplay} onToggle={handleShowClockDisplayClick} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Show Deadline Display\n          <div className=\"setting-label__description\">\n            If enabled, the deadline will displayed on each header line.\n          </div>\n        </div>\n        <Switch isEnabled={showDeadlineDisplay} onToggle={handleShowDeadlineDisplayChange} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Prefer raw values\n          <div className=\"setting-label__description\">\n            When editing title or description of a header, you can switch between editing the text\n            part or the full content (including text representation of todo keywords, tags, schedule\n            items, properties etc.) by clicking the \"edit title\" or \"edit description\" icon in the\n            popup. This option allows you to view the full content first instead of on a second\n            click.\n          </div>\n        </div>\n        <Switch isEnabled={preferEditRawValues} onToggle={handlePreferEditRawValues} />\n      </div>\n\n      <div className=\"settings-buttons-container\">\n        <button className=\"btn settings-btn\" onClick={handleCaptureTemplatesClick}>\n          Capture templates\n        </button>\n        <button className=\"btn settings-btn\" onClick={handleKeyboardShortcutsClick}>\n          Keyboard shortcuts\n        </button>\n        <button className=\"btn settings-btn\" onClick={handleFileSettingsClick}>\n          File settings\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <Link to=\"/changelog\" className=\"btn settings-btn\">\n          Changelog\n          {hasUnseenChangelog && (\n            <div className=\"changelog-badge-container\">\n              <i className=\"fas fa-gift\" />\n              &nbsp; What's New?\n            </div>\n          )}\n        </Link>\n\n        <Link to=\"/sample\" className=\"btn settings-btn\">\n          Help\n        </Link>\n\n        <button className=\"btn settings-btn\">\n          <ExternalLink href={`${documentationHost}/documentation.html`}>\n            Documentation\n            <i className=\"fas fa-external-link-alt fa-sm\" />\n          </ExternalLink>{' '}\n        </button>\n\n        <button className=\"btn settings-btn\">\n          <ExternalLink href=\"https://github.com/200ok-ch/organice\">\n            Github repo\n            <i className=\"fas fa-external-link-alt fa-sm\" />\n          </ExternalLink>{' '}\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <button className=\"btn settings-btn\" onClick={handleSignOutClick}>\n          Sign out\n        </button>\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  // The default values here only relate to the settings view. To set\n  // defaults which get loaded on an initial run of organice, look at\n  // `util/settings_persister.js::persistableFields`.\n  const agendaStartOnWeekday = state.base.get('agendaStartOnWeekday');\n  return {\n    fontSize: state.base.get('fontSize') || 'Regular',\n    bulletStyle: state.base.get('bulletStyle'),\n    shouldTapTodoToAdvance: state.base.get('shouldTapTodoToAdvance'),\n    editorDescriptionHeightValue: state.base.get('editorDescriptionHeightValue') || 8,\n    agendaDefaultDeadlineDelayValue: state.base.get('agendaDefaultDeadlineDelayValue') || 5,\n    agendaDefaultDeadlineDelayUnit: state.base.get('agendaDefaultDeadlineDelayUnit') || 'd',\n    agendaStartOnWeekday: agendaStartOnWeekday == null ? 1 : +agendaStartOnWeekday,\n    shouldStoreSettingsInSyncBackend: state.base.get('shouldStoreSettingsInSyncBackend'),\n    shouldLiveSync: state.base.get('shouldLiveSync'),\n    showDeadlineDisplay: state.base.get('showDeadlineDisplay'),\n    shouldSyncOnBecomingVisibile: state.base.get('shouldSyncOnBecomingVisibile'),\n    shouldShowTitleInOrgFile: state.base.get('shouldShowTitleInOrgFile'),\n    shouldLogIntoDrawer: state.base.get('shouldLogIntoDrawer'),\n    closeSubheadersRecursively: state.base.get('closeSubheadersRecursively'),\n    shouldNotIndentOnExport: state.base.get('shouldNotIndentOnExport'),\n    hasUnseenChangelog: state.base.get('hasUnseenChangelog'),\n    showClockDisplay: state.org.present.get('showClockDisplay'),\n    preferEditRawValues: state.base.get('preferEditRawValues'),\n    colorScheme: state.base.get('colorScheme'),\n    theme: state.base.get('theme'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Settings));\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nexport default class ShortcutRow extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleRebindClick', 'handleKeyPress']);\n\n    this.state = {\n      isEditMode: false,\n    };\n  }\n\n  componentDidMount() {\n    this.rebindArea.addEventListener('blur', () => this.setState({ isEditMode: false }));\n  }\n\n  handleRebindClick() {\n    this.setState({ isEditMode: true });\n    document.addEventListener('keypress', this.handleKeyPress);\n  }\n\n  handleKeyPress(event) {\n    this.setState({ isEditMode: false });\n    document.removeEventListener('keypress', this.handleKeyPress);\n\n    let key = null;\n    if (event.code.startsWith('Key')) {\n      key = event.code.substr(3).toLowerCase();\n    } else if (event.code.startsWith('Digit')) {\n      key = event.code.substr(5);\n    } else {\n      key = {\n        Minus: '-',\n        Equal: '=',\n        Backspace: 'backspace',\n        Enter: 'enter',\n        Return: 'return',\n        Tab: 'tab',\n        BracketLeft: '[',\n        BracketRight: ']',\n        Semicolon: ';',\n        Quote: '\"',\n        Backslash: '\\\\',\n        Comma: ',',\n        Period: '.',\n        Slash: '/',\n      }[event.code];\n    }\n\n    if (!key) {\n      return;\n    }\n\n    const modifiers = [\n      ['ctrlKey', 'ctrl'],\n      ['altKey', 'alt'],\n      ['metaKey', 'meta'],\n      ['shiftKey', 'shift'],\n    ];\n\n    const newModifiers = modifiers\n      .filter(([modifier, _]) => event[modifier])\n      .map(([_, symbol]) => symbol)\n      .join('+');\n    const newBinding = `${newModifiers}${!!newModifiers ? '+' : ''}${key}`;\n\n    this.props.onBindingChange(this.props.name, newBinding);\n  }\n\n  symbolizeKeybinding(binding) {\n    if (!binding) {\n      return '';\n    }\n\n    const replacements = [\n      ['ctrl', '^'],\n      ['alt', '⌥'],\n      ['option', '⌥'],\n      ['command', '⌘'],\n      ['meta', '⌘'],\n      ['shift', '⇧'],\n      ['backspace', '⌫'],\n      ['return', '⏎'],\n      ['enter', '⏎'],\n      ['left', '←'],\n      ['right', '→'],\n      ['up', '↑'],\n      ['down', '↓'],\n    ];\n\n    return replacements.reduce(\n      (currentBinding, [name, symbol]) => currentBinding.replace(RegExp(`${name}\\\\+?`), symbol),\n      binding\n    );\n  }\n\n  render() {\n    const { name, binding } = this.props;\n    const { isEditMode } = this.state;\n\n    const rebindAreaClassName = classNames('keyboard-shortcut-container__shortcut-key', {\n      'keyboard-shortcut-container__shortcut-key--edit-mode': isEditMode,\n    });\n\n    return (\n      <div className=\"keyboard-shortcut-container\">\n        <div className=\"keyboard-shortcut-container__shortcut-name\">{name}</div>\n        <div\n          className={rebindAreaClassName}\n          onClick={this.handleRebindClick}\n          tabIndex=\"-1\"\n          ref={(div) => (this.rebindArea = div)}\n        >\n          {isEditMode ? '...' : this.symbolizeKeybinding(binding)}\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { withRouter } from 'react-router-dom';\n\nimport { Map } from 'immutable';\n\nimport ShortcutRow from './components/ShortcutRow';\n\nimport * as baseActions from '../../actions/base';\n\nimport { calculateNamedKeybindings } from '../../lib/keybindings';\n\nimport './stylesheet.css';\n\nconst KeyboardShortcutsEditor = ({ customKeybindings, base }) => {\n  const handleBindingChange = (bindingName, newBinding) => {\n    const alreadyInUseBinding = calculateNamedKeybindings(customKeybindings).filter(\n      ([_, binding]) => binding === newBinding\n    )[0];\n\n    if (!!alreadyInUseBinding) {\n      alert(`That binding is already in use for \"${alreadyInUseBinding[0]}\"`);\n      return;\n    }\n\n    base.setCustomKeybinding(bindingName, newBinding);\n  };\n\n  return (\n    <div className=\"keyboard-shortcuts-editor-container\">\n      {calculateNamedKeybindings(customKeybindings).map(([name, binding]) => (\n        <ShortcutRow\n          key={name}\n          name={name}\n          binding={binding}\n          onBindingChange={handleBindingChange}\n        />\n      ))}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    customKeybindings: state.base.get('customKeybindings') || Map(),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(KeyboardShortcutsEditor));\n","import React, { Fragment, useState } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport { Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport ActionButton from '../../../OrgFile/components/ActionDrawer/components/ActionButton';\nimport Switch from '../../../UI/Switch/';\nimport ExternalLink from '../../../UI/ExternalLink';\n\nimport classNames from 'classnames';\n\nexport default ({\n  template,\n  index,\n  onFieldPathUpdate,\n  onAddNewTemplateOrgFileAvailability,\n  onRemoveTemplateOrgFileAvailability,\n  onAddNewTemplateHeaderPath,\n  onRemoveTemplateHeaderPath,\n  onDeleteTemplate,\n  syncBackendType,\n  loadedFilePaths,\n}) => {\n  const [isCollapsed, setIsCollapsed] = useState(!!template.get('description'));\n  const handleHeaderBarClick = () => setIsCollapsed(!isCollapsed);\n\n  const updateField = (fieldName) => (event) =>\n    onFieldPathUpdate(template.get('id'), [fieldName], event.target.value);\n\n  const toggleAvailabilityInAllOrgFiles = () =>\n    onFieldPathUpdate(\n      template.get('id'),\n      ['isAvailableInAllOrgFiles'],\n      !template.get('isAvailableInAllOrgFiles')\n    );\n\n  const togglePrepend = () =>\n    onFieldPathUpdate(template.get('id'), ['shouldPrepend'], !template.get('shouldPrepend'));\n\n  const handleAddNewOrgFileAvailability = () => {\n    onAddNewTemplateOrgFileAvailability(template.get('id'));\n  };\n\n  const handleRemoveOrgFileAvailability = (index) => () =>\n    onRemoveTemplateOrgFileAvailability(template.get('id'), index);\n\n  const handleOrgFileAvailabilityChange = (orgFileAvailabilityIndex) => (event) =>\n    onFieldPathUpdate(\n      template.get('id'),\n      ['orgFilesWhereAvailable', orgFileAvailabilityIndex],\n      event.target.value\n    );\n\n  const handleAddNewHeaderPath = () => onAddNewTemplateHeaderPath(template.get('id'));\n\n  const handleRemoveHeaderPath = (headerPathIndex) => () =>\n    onRemoveTemplateHeaderPath(template.get('id'), headerPathIndex);\n\n  const handleHeaderPathChange = (headerPathIndex) => (event) =>\n    onFieldPathUpdate(template.get('id'), ['headerPaths', headerPathIndex], event.target.value);\n\n  const handleDeleteClick = () => {\n    if (\n      window.confirm(\n        `Are you sure you want to delete the \"${template.get('description')}\" template?`\n      )\n    ) {\n      onDeleteTemplate(template.get('id'));\n    }\n  };\n\n  const renderDescriptionField = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Description:</div>\n        <input\n          type=\"text\"\n          className=\"textfield\"\n          value={template.get('description', '')}\n          onChange={updateField('description')}\n        />\n      </div>\n    </div>\n  );\n\n  const renderIconField = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Letter:</div>\n        <input\n          type=\"text\"\n          className=\"textfield capture-template__letter-textfield\"\n          maxLength=\"1\"\n          value={template.get('letter', '')}\n          onChange={updateField('letter')}\n          autoCapitalize=\"none\"\n        />\n      </div>\n\n      <div className=\"capture-template__field__or-container\">\n        <div className=\"capture-template__field__or-line\" />\n        <div className=\"capture-template__field__or\">or</div>\n        <div className=\"capture-template__field__or-line\" />\n      </div>\n\n      <div className=\"capture-template__field\">\n        <div>Icon name:</div>\n        <input\n          type=\"text\"\n          className=\"textfield\"\n          value={template.get('iconName')}\n          onChange={updateField('iconName')}\n          autoCapitalize=\"none\"\n          autoCorrect=\"none\"\n        />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        Instead of a letter, you can specify the name of any free Font Awesome icon (like lemon or\n        calendar-plus) to use as the capture icon. You can search the available icons{' '}\n        <ExternalLink href=\"https://fontawesome.com/icons?d=gallery&s=solid&m=free\">\n          here\n        </ExternalLink>\n        .\n      </div>\n    </div>\n  );\n\n  const renderOrgFileAvailability = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Available in all org files?</div>\n        <Switch\n          isEnabled={template.get('isAvailableInAllOrgFiles')}\n          onToggle={toggleAvailabilityInAllOrgFiles}\n        />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        You can make this capture template available in all org files, or just the ones you specify.\n        {syncBackendType === 'Dropbox' && (\n          <Fragment>\n            {' '}\n            Specify full paths starting from the root of your Dropbox, like{' '}\n            <code>/org/todo.org</code>\n          </Fragment>\n        )}\n      </div>\n\n      <Collapse\n        isOpened={!template.get('isAvailableInAllOrgFiles')}\n        springConfig={{ stiffness: 300 }}\n      >\n        <div className=\"multi-textfields-container\">\n          {template.get('orgFilesWhereAvailable').map((orgFilePath, index) => (\n            <div key={`org-file-availability-${index}`} className=\"multi-textfield-container\">\n              <input\n                type=\"text\"\n                placeholder=\"e.g., /org/todo.org\"\n                className=\"textfield multi-textfield-field\"\n                value={orgFilePath}\n                onChange={handleOrgFileAvailabilityChange(index)}\n              />\n              <button\n                className=\"fas fa-times fa-lg remove-multi-textfield-button\"\n                onClick={handleRemoveOrgFileAvailability(index)}\n              />\n            </div>\n          ))}\n        </div>\n\n        <div className=\"add-new-multi-textfield-button-container\">\n          <button\n            className=\"fas fa-plus add-new-multi-textfield-button\"\n            onClick={handleAddNewOrgFileAvailability}\n          />\n        </div>\n      </Collapse>\n    </div>\n  );\n\n  const renderFilePath = (template) => {\n    return (\n      <div className=\"capture-template__field-container\">\n        <div className=\"capture-template__field\">\n          <div>File: </div>\n          <select onChange={updateField('file')} style={{ width: '90%' }}>\n            {(loadedFilePaths.filter((path) => (path === template.get('file', '')).length) !== 0\n              ? loadedFilePaths\n              : [template.get('file'), ...loadedFilePaths]\n            ).map((path) => (\n              <option key={path} value={path} selected={path === template.get('file')}>\n                {path}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div className=\"capture-template__help-text\">\n          By default the file opened when capturing is the capture target. Select a specific file if\n          you want this template to always capture to that file. Make sure the file is loaded for it\n          to be selectable here. You might also consider to set the file to load on startup in the\n          file settings so it's always available.\n        </div>\n      </div>\n    );\n  };\n\n  const renderHeaderPaths = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\" style={{ marginTop: 7 }}>\n        <div>Header path</div>\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        Specify the path to the header under which the new header should be filed. One header per\n        textfield.\n      </div>\n\n      <div className=\"multi-textfields-container\">\n        {template.get('headerPaths').map((headerPath, index) => (\n          <div key={`header-path-${index}`} className=\"multi-textfield-container\">\n            <input\n              type=\"text\"\n              placeholder=\"e.g., Todos\"\n              className=\"textfield multi-textfield-field\"\n              value={headerPath}\n              onChange={handleHeaderPathChange(index)}\n            />\n            <button\n              className=\"fas fa-times fa-lg remove-multi-textfield-button\"\n              onClick={handleRemoveHeaderPath(index)}\n            />\n          </div>\n        ))}\n      </div>\n\n      <div className=\"add-new-multi-textfield-button-container\">\n        <button\n          className=\"fas fa-plus add-new-multi-textfield-button\"\n          onClick={handleAddNewHeaderPath}\n        />\n      </div>\n    </div>\n  );\n\n  const renderPrependField = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Prepend?</div>\n        <Switch isEnabled={template.get('shouldPrepend')} onToggle={togglePrepend} />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        By default, new captured headers are appended to the specified header path. Enable this\n        setting to prepend them instead.\n      </div>\n    </div>\n  );\n\n  const renderTemplateField = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\" style={{ marginTop: 7 }}>\n        <div>Template</div>\n      </div>\n\n      <textarea\n        className=\"textarea template-textarea\"\n        rows=\"3\"\n        value={template.get('template')}\n        onChange={updateField('template')}\n      />\n\n      <div className=\"capture-template__help-text\">\n        The template for creating the capture item. You can use the following template variables\n        that will be expanded upon capture:\n        <ul>\n          <li>\n            <code>%?</code> - Place the cursor here.\n          </li>\n          <li>\n            <code>%t</code> - Timestamp, date only.\n          </li>\n          <li>\n            <code>%T</code> - Timestamp, with date and time.\n          </li>\n          <li>\n            <code>%u</code> - Inactive timestamp, date only.\n          </li>\n          <li>\n            <code>%U</code> - Inactive timestamp, with date and time.\n          </li>\n          <li>\n            <code>%r</code> - Raw timestamp, date only, no surrounding punctation.\n            <ul>\n              <li>\n                Build custom expressions like{' '}\n                <code>TODO Monthly - %?\\n DEADLINE: &lt;%r .+1m&gt;</code>\n              </li>\n            </ul>\n          </li>\n          <li>\n            <code>%R</code> - Raw timestamp, with date and time, no surrounding punctuation.\n          </li>\n          <li>\n            <code>%y</code> - Raw year\n          </li>\n          <li>\n            <code>%{'<custom variable>'}</code> - A custom variable from a URL param capture. See{' '}\n            <ExternalLink href=\"https://organice.200ok.ch/documentation.html#capture_templates\">\n              the README file\n            </ExternalLink>{' '}\n            for more details.\n          </li>\n        </ul>\n        You can also use <code>%u</code> and <code>%t</code> as part of the header path.\n      </div>\n    </div>\n  );\n\n  const renderDeleteButton = () => (\n    <div className=\"capture-template__field-container capture-template__delete-button-container\">\n      <button\n        className=\"btn settings-btn capture-template__delete-button\"\n        onClick={handleDeleteClick}\n      >\n        Delete template\n      </button>\n    </div>\n  );\n\n  const caretClassName = classNames(\n    'fas fa-2x fa-caret-right capture-template-container__header__caret',\n    {\n      'capture-template-container__header__caret--rotated': !isCollapsed,\n    }\n  );\n\n  return (\n    <Draggable draggableId={`capture-template--${template.get('id')}`} index={index}>\n      {(provided, snapshot) => (\n        <div\n          className={classNames('capture-template-container', {\n            'capture-template-container--dragging': snapshot.isDragging,\n          })}\n          ref={provided.innerRef}\n          {...provided.draggableProps}\n        >\n          <div className=\"capture-template-container__header\" onClick={handleHeaderBarClick}>\n            <i className={caretClassName} />\n            <ActionButton\n              iconName={template.get('iconName')}\n              letter={template.get('letter')}\n              onClick={() => {}}\n              style={{ marginRight: 20 }}\n            />\n            <span className=\"capture-template-container__header__title\">\n              {template.get('description')}\n            </span>\n            <i\n              className=\"fas fa-bars fa-lg capture-template-container__header__drag-handle\"\n              {...provided.dragHandleProps}\n            />\n          </div>\n\n          <Collapse isOpened={!isCollapsed} springConfig={{ stiffness: 300 }}>\n            <div className=\"capture-template-container__content\">\n              {renderDescriptionField(template)}\n              {renderIconField(template)}\n              {renderOrgFileAvailability(template)}\n              {renderFilePath(template)}\n              {renderHeaderPaths(template)}\n              {renderPrependField(template)}\n              {renderTemplateField(template)}\n              {renderDeleteButton()}\n            </div>\n          </Collapse>\n        </div>\n      )}\n    </Draggable>\n  );\n};\n","import React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Droppable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport * as captureActions from '../../actions/capture';\n\nimport CaptureTemplate from './components/CaptureTemplate';\n\nimport { List } from 'immutable';\nimport { STATIC_FILE_PREFIX } from '../../lib/org_utils';\n\nconst CaptureTemplatesEditor = ({\n  captureTemplates,\n  syncBackendType,\n  capture,\n  loadedFilePaths,\n}) => {\n  const handleAddNewTemplateClick = () => capture.addNewEmptyCaptureTemplate();\n\n  const handleFieldPathUpdate = (templateId, fieldPath, newValue) =>\n    capture.updateTemplateFieldPathValue(templateId, fieldPath, newValue);\n\n  const handleAddNewTemplateOrgFileAvailability = (templateId) =>\n    capture.addNewTemplateOrgFileAvailability(templateId);\n\n  const handleRemoveTemplateOrgFileAvailability = (templateId, orgFileAvailabilityIndex) =>\n    capture.removeTemplateOrgFileAvailability(templateId, orgFileAvailabilityIndex);\n\n  const handleAddNewTemplateHeaderPath = (templateId) =>\n    capture.addNewTemplateHeaderPath(templateId);\n\n  const handleRemoveTemplateHeaderPath = (templateId, headerPathIndex) =>\n    capture.removeTemplateHeaderPath(templateId, headerPathIndex);\n\n  const handleDeleteTemplate = (templateId) => capture.deleteTemplate(templateId);\n\n  const handleReorderTemplate = (fromIndex, toIndex) =>\n    capture.reorderCaptureTemplate(fromIndex, toIndex);\n\n  return (\n    <div>\n      <Droppable droppableId=\"capture-templates-editor-droppable\" type=\"CAPTURE-TEMPLATE\">\n        {(provided) => (\n          <div\n            className=\"capture-templates-container\"\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n          >\n            {captureTemplates.size === 0 ? (\n              <div className=\"no-capture-templates-message\">\n                You don't currently have any capture templates - add one by pressing the{' '}\n                <i className=\"fas fa-plus\" /> button.\n                <br />\n                <br />\n                Capture templates show up in the action drawer and give you quick access to creating\n                new headers (like org-capture).\n              </div>\n            ) : (\n              <Fragment>\n                {captureTemplates.map((template, index) => (\n                  <CaptureTemplate\n                    key={template.get('id')}\n                    index={index}\n                    template={template}\n                    syncBackendType={syncBackendType}\n                    loadedFilePaths={loadedFilePaths}\n                    onFieldPathUpdate={handleFieldPathUpdate}\n                    onAddNewTemplateOrgFileAvailability={handleAddNewTemplateOrgFileAvailability}\n                    onRemoveTemplateOrgFileAvailability={handleRemoveTemplateOrgFileAvailability}\n                    onAddNewTemplateHeaderPath={handleAddNewTemplateHeaderPath}\n                    onRemoveTemplateHeaderPath={handleRemoveTemplateHeaderPath}\n                    onDeleteTemplate={handleDeleteTemplate}\n                    onReorder={handleReorderTemplate}\n                  />\n                ))}\n\n                {provided.placeholder}\n              </Fragment>\n            )}\n          </div>\n        )}\n      </Droppable>\n\n      <div className=\"new-capture-template-button-container\">\n        <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={handleAddNewTemplateClick} />\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  const loadedFilePaths = state.org.present\n    .get('files', List())\n    .keySeq()\n    .toJS()\n    .filter((path) => !path.startsWith(STATIC_FILE_PREFIX));\n  loadedFilePaths.unshift('');\n  return {\n    captureTemplates: state.capture.get('captureTemplates', List()),\n    syncBackendType: state.syncBackend.get('client').type,\n    loadedFilePaths,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    capture: bindActionCreators(captureActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CaptureTemplatesEditor);\n","import React, { useState } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport { Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport Switch from '../../../UI/Switch';\n\nimport classNames from 'classnames';\n\nexport default ({ setting, index, onFieldPathUpdate, onDeleteSetting, loadedFilepaths, path }) => {\n  const [isCollapsed, setIsCollapsed] = useState(true);\n  const handleHeaderBarClick = () => setIsCollapsed(!isCollapsed);\n\n  const updateField = (fieldName) => (event) =>\n    onFieldPathUpdate(setting.get('id'), [fieldName], event.target.value);\n\n  const toggleDefaultOnStartup = () =>\n    onFieldPathUpdate(setting.get('id'), ['defaultOnStartup'], !setting.get('defaultOnStartup'));\n\n  const toggleLoadOnStartup = () =>\n    onFieldPathUpdate(setting.get('id'), ['loadOnStartup'], !setting.get('loadOnStartup'));\n\n  const toggleIncludeInAgenda = () =>\n    onFieldPathUpdate(setting.get('id'), ['includeInAgenda'], !setting.get('includeInAgenda'));\n\n  const toggleIncludeInSearch = () =>\n    onFieldPathUpdate(setting.get('id'), ['includeInSearch'], !setting.get('includeInSearch'));\n\n  const toggleIncludeInTasklist = () =>\n    onFieldPathUpdate(setting.get('id'), ['includeInTasklist'], !setting.get('includeInTasklist'));\n\n  const toggleIncludeInRefile = () =>\n    onFieldPathUpdate(setting.get('id'), ['includeInRefile'], !setting.get('includeInRefile'));\n\n  const handleDeleteClick = () => {\n    if (\n      window.confirm(`Are you sure you want to delete the settings for \"${setting.get('path')}\"?`)\n    ) {\n      onDeleteSetting(setting.get('id'));\n    }\n  };\n\n  const renderPathField = (setting) => {\n    if (setting.get('path') === '') {\n      updateField('path')({ target: { value: path || loadedFilepaths[0] } });\n    }\n    return (\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Path: </div>\n          <select onChange={updateField('path')} style={{ width: '90%' }}>\n            {[setting.get('path'), ...loadedFilepaths].map((path) => (\n              <option key={path} value={path}>\n                {path}\n              </option>\n            ))}\n          </select>\n        </div>\n      </div>\n    );\n  };\n\n  const renderOptionFields = (setting) => (\n    <>\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Is default file to load on startup?</div>\n          <Switch isEnabled={setting.get('defaultOnStartup')} onToggle={toggleDefaultOnStartup} />\n        </div>\n\n        <div className=\"file-setting__help-text\">\n          By default, when you start organice, it will display your root file directory. If you\n          prefer to display a specific Org file instead, enable this option. <br /> Note: There can\n          only be one default file, of course. If you enable this option for multiple files,\n          organice will pick the first one.\n        </div>\n      </div>\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Sync on startup?</div>\n          <Switch isEnabled={setting.get('loadOnStartup')} onToggle={toggleLoadOnStartup} />\n        </div>\n\n        <div className=\"file-setting__help-text\">\n          By default, files are loaded from localStorage when available and are only synced when\n          visited or when a sync is manually triggered. Enable this setting to always sync this file\n          when opening organice.\n        </div>\n      </div>\n\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Include in Agenda?</div>\n          <Switch isEnabled={setting.get('includeInAgenda')} onToggle={toggleIncludeInAgenda} />\n        </div>\n\n        <div className=\"file-setting__help-text\">\n          By default, only the currently opened file is included in the agenda. Enable this setting\n          to always include this file. The currently viewed file is always included.\n        </div>\n      </div>\n\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Include in Search?</div>\n          <Switch isEnabled={setting.get('includeInSearch')} onToggle={toggleIncludeInSearch} />\n        </div>\n\n        <div className=\"file-setting__help-text\">\n          By default, only the current viewed file is included in search. Enable this setting to\n          always include this file. The currently loaded file is always included.\n        </div>\n      </div>\n\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Include in Tasklist?</div>\n          <Switch isEnabled={setting.get('includeInTasklist')} onToggle={toggleIncludeInTasklist} />\n        </div>\n\n        <div className=\"file-setting__help-text\">\n          By default, only the current viewed file is included in the tasklist. Enable this setting\n          to always include this file. The currently loaded file is always included.\n        </div>\n      </div>\n\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Include in Refile?</div>\n          <Switch isEnabled={setting.get('includeInRefile')} onToggle={toggleIncludeInRefile} />\n        </div>\n\n        <div className=\"file-setting__help-text\">\n          By default, only the currently viewed file is available as a refile targets. Enable this\n          setting to always include this file. The currently loaded file is always included.\n        </div>\n      </div>\n    </>\n  );\n\n  const renderDeleteButton = () => (\n    <div className=\"file-setting__field-container file-setting__delete-button-container\">\n      <button className=\"btn settings-btn file-setting__delete-button\" onClick={handleDeleteClick}>\n        Delete setting\n      </button>\n    </div>\n  );\n\n  const caretClassName = classNames(\n    'fas fa-2x fa-caret-right file-setting-container__header__caret',\n    {\n      'file-setting-container__header__caret--rotated': !isCollapsed,\n    }\n  );\n\n  return (\n    <Draggable draggableId={`file-setting--${setting.get('path')}`} index={index}>\n      {(provided, snapshot) => (\n        <div\n          className={classNames('file-setting-container', {\n            'file-setting-container--dragging': snapshot.isDragging,\n          })}\n          ref={provided.innerRef}\n          {...provided.draggableProps}\n        >\n          <div className=\"file-setting-container__header\" onClick={handleHeaderBarClick}>\n            <i className={caretClassName} />\n            <div className=\"file-setting-icons\">\n              <div\n                className={classNames('default-on-startup-icon', {\n                  'fas fa-bookmark fa-lg file-setting-icon': setting.get('defaultOnStartup'),\n                })}\n              />\n              <div\n                className={classNames('load-on-startup-icon', {\n                  'fas fa-sync-alt fa-lg file-setting-icon': setting.get('loadOnStartup'),\n                })}\n              />\n              <div\n                className={classNames({\n                  'fas fa-calendar-alt fa-lg file-setting-icon': setting.get('includeInAgenda'),\n                })}\n              />\n              <div\n                className={classNames({\n                  'fas fa-search fa-lg file-setting-icon': setting.get('includeInSearch'),\n                })}\n              />\n              <div\n                className={classNames({\n                  'fas fa-tasks fa-lg file-setting-icon': setting.get('includeInTasklist'),\n                })}\n              />\n              <div\n                className={classNames({\n                  'fas fa-file-export fa-lg file-setting-icon': setting.get('includeInRefile'),\n                })}\n              />\n            </div>\n\n            <span className=\"file_setting-container__header__title\">{setting.get('path')}</span>\n\n            <i\n              className=\"fas fa-bars fa-lg file-setting-container__header__drag-handle\"\n              {...provided.dragHandleProps}\n            />\n          </div>\n\n          <Collapse isOpened={!isCollapsed} springConfig={{ stiffness: 300 }}>\n            <div className=\"file-setting-container__content\">\n              {renderPathField(setting)}\n              {renderOptionFields(setting)}\n              {renderDeleteButton()}\n            </div>\n          </Collapse>\n        </div>\n      )}\n    </Draggable>\n  );\n};\n","import React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Droppable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport * as orgActions from '../../actions/org';\n\nimport FileSetting from './components/FileSetting';\n\nimport { List } from 'immutable';\nimport { STATIC_FILE_PREFIX } from '../../lib/org_utils';\n\nconst FileSettingsEditor = ({\n  fileSettings,\n  loadedFilepaths,\n  currentPathIfWithoutFileSetting,\n  org,\n}) => {\n  const handleAddNewSettingClick = () => org.addNewEmptyFileSetting();\n\n  const handleFieldPathUpdate = (settingId, fieldPath, newValue) =>\n    org.updateFileSettingFieldPathValue(settingId, fieldPath, newValue);\n\n  const handleDeleteSetting = (settingId) => org.deleteFileSetting(settingId);\n\n  const handleReorderSetting = (fromIndex, toIndex) => org.reorderFileSetting(fromIndex, toIndex);\n\n  return (\n    <div>\n      <Droppable droppableId=\"file-setting-editor-droppable\" type=\"FILE-SETTING\">\n        {(provided) => (\n          <div\n            className=\"file-setting-container\"\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n          >\n            {fileSettings.size === 0 ? (\n              <div className=\"no-file-setting-message\">\n                You don't currently have any file settings - add one by pressing the{' '}\n                <i className=\"fas fa-plus\" /> button.\n                <br />\n                <br />\n                File settings allow you to configure how specific files are handeled when multiple\n                files are loaded. Make sure a file is loaded to create a setting entry.\n              </div>\n            ) : (\n              <Fragment>\n                {fileSettings.map((setting, index) => (\n                  <FileSetting\n                    key={setting.get('id')}\n                    index={index}\n                    setting={setting}\n                    path={currentPathIfWithoutFileSetting}\n                    loadedFilepaths={loadedFilepaths}\n                    onFieldPathUpdate={handleFieldPathUpdate}\n                    onDeleteSetting={handleDeleteSetting}\n                    onReorder={handleReorderSetting}\n                  />\n                ))}\n\n                {provided.placeholder}\n              </Fragment>\n            )}\n          </div>\n        )}\n      </Droppable>\n\n      {loadedFilepaths.length !== 0 && (\n        <div className=\"new-capture-template-button-container\">\n          <button\n            className=\"fas fa-plus fa-lg btn btn--circle\"\n            onClick={handleAddNewSettingClick}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  const path = state.base.get('lastViewedPath');\n  const fileSettings = state.org.present.get('fileSettings', List());\n  const existingSettings = fileSettings.map((setting) => setting.get('path'));\n  const paths = state.org.present.get('files', List()).keySeq();\n  const currentPathIfWithoutFileSetting = !existingSettings.find((filePath) => filePath === path)\n    ? path\n    : null;\n  const loadedFilepaths = paths\n    .filter((path) => !path.startsWith(STATIC_FILE_PREFIX))\n    .filter((path) => !existingSettings.find((settingPath) => settingPath === path))\n    .toJS();\n  return {\n    fileSettings,\n    loadedFilepaths,\n    currentPathIfWithoutFileSetting,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FileSettingsEditor);\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Route, Switch, Redirect, withRouter } from 'react-router-dom';\n\nimport './stylesheet.css';\n\nimport { List, Set } from 'immutable';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nimport { changelogHash, STATIC_FILE_PREFIX } from '../../lib/org_utils';\nimport PrivacyPolicy from '../PrivacyPolicy';\nimport HeaderBar from '../HeaderBar';\nimport FileBrowser from '../FileBrowser';\nimport LoadingIndicator from '../LoadingIndicator';\nimport OrgFile from '../OrgFile';\nimport Settings from '../Settings';\nimport KeyboardShortcutsEditor from '../KeyboardShortcutsEditor';\nimport CaptureTemplatesEditor from '../CaptureTemplatesEditor';\nimport FileSettingsEditor from '../FileSettingsEditor';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as orgActions from '../../actions/org';\nimport * as baseActions from '../../actions/base';\nimport { loadTheme } from '../../lib/color';\n\nclass Entry extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'renderChangelogFile',\n      'renderSampleFile',\n      'renderFileBrowser',\n      'renderFile',\n      'setChangelogUnseenChanges',\n    ]);\n  }\n\n  componentDidMount() {\n    this.setChangelogUnseenChanges();\n    this.props.filesToLoad.forEach((path) => this.props.syncBackend.downloadFile(path));\n    this.props.filesToSync.forEach((path) => this.props.org.sync({ path }));\n  }\n\n  // TODO: Should this maybe done on init of the application and not in the component?\n  setChangelogUnseenChanges() {\n    const { lastSeenChangelogHash, isAuthenticated } = this.props;\n    changelogHash().then((changelogHash) => {\n      const hasChanged =\n        isAuthenticated &&\n        lastSeenChangelogHash &&\n        !_.isEqual(changelogHash, lastSeenChangelogHash);\n\n      this.props.base.setHasUnseenChangelog(hasChanged);\n    });\n  }\n\n  componentDidUpdate() {\n    this.shouldPromptWhenLeaving()\n      ? (window.onbeforeunload = () => true)\n      : (window.onbeforeunload = undefined);\n  }\n\n  componentWillUnmount() {\n    window.onbeforeunload = undefined;\n  }\n\n  renderChangelogFile() {\n    return (\n      <OrgFile\n        staticFile=\"changelog\"\n        shouldDisableDirtyIndicator={true}\n        shouldDisableActions={true}\n        shouldDisableSyncButtons={false}\n        parsingErrorMessage={\n          \"The contents of changelog.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!\"\n        }\n      />\n    );\n  }\n\n  renderSampleFile() {\n    return (\n      <OrgFile\n        staticFile=\"sample\"\n        shouldDisableDirtyIndicator={true}\n        shouldDisableActionDrawer={false}\n        shouldDisableSyncButtons={true}\n        parsingErrorMessage={\n          \"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!\"\n        }\n      />\n    );\n  }\n\n  renderFileBrowser({\n    match: {\n      params: { path = '' },\n    },\n  }) {\n    if (!!path) {\n      path = '/' + path;\n    }\n\n    return <FileBrowser path={path} />;\n  }\n\n  renderFile({\n    match: {\n      params: { path },\n    },\n  }) {\n    if (!!path) {\n      path = '/' + path;\n    }\n    if (\n      this.props.path &&\n      !this.props.path.startsWith(STATIC_FILE_PREFIX) &&\n      this.props.path !== path\n    ) {\n      this.props.org.sync({ path: this.props.path });\n      return <Redirect push to={'/file' + this.props.path} />;\n    } else {\n      return (\n        <OrgFile\n          path={path}\n          shouldDisableDirtyIndicator={false}\n          shouldDisableActionDrawer={false}\n          shouldDisableSyncButtons={false}\n        />\n      );\n    }\n  }\n\n  shouldPromptWhenLeaving() {\n    return this.props.hasDirtyFiles;\n  }\n\n  render() {\n    const {\n      isAuthenticated,\n      loadingMessage,\n      fontSize,\n      activeModalPage,\n      pendingCapture,\n      location: { pathname },\n      colorScheme,\n      theme,\n      defaultFilePath,\n    } = this.props;\n\n    loadTheme(theme, colorScheme);\n\n    const pendingCapturePath = !!pendingCapture && `/file${pendingCapture.get('capturePath')}`;\n    const shouldRedirectToCapturePath = pendingCapturePath && pendingCapturePath !== pathname;\n\n    const className = classNames('App entry-container', {\n      'entry-container--large-font': fontSize === 'Large',\n    });\n\n    return (\n      <div className={className}>\n        <HeaderBar />\n        <LoadingIndicator message={loadingMessage} />\n\n        {isAuthenticated &&\n          ([\n            'keyboard_shortcuts_editor',\n            'settings',\n            'capture_templates_editor',\n            'file_settings_editor',\n            'sample',\n          ].includes(activeModalPage) ? (\n            <Fragment>\n              {activeModalPage === 'keyboard_shortcuts_editor' && <KeyboardShortcutsEditor />}\n              {activeModalPage === 'capture_templates_editor' && <CaptureTemplatesEditor />}\n              {activeModalPage === 'file_settings_editor' && <FileSettingsEditor />}\n            </Fragment>\n          ) : (\n            <Switch>\n              {shouldRedirectToCapturePath && <Redirect to={pendingCapturePath} />}\n              <Route path=\"/privacy-policy\" exact component={PrivacyPolicy} />\n              <Route path=\"/file/:path+\" render={this.renderFile} />\n              <Route path=\"/files/:path*\" render={this.renderFileBrowser} />\n              <Route path=\"/sample\" exact={true} render={this.renderSampleFile} />\n              <Route path=\"/changelog\" exact={true} render={this.renderChangelogFile} />\n              <Route path=\"/settings\" exact={true}>\n                <Settings />\n              </Route>\n              {defaultFilePath ? <Redirect to={defaultFilePath} /> : <Redirect to=\"/files\" />}\n            </Switch>\n          ))}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const files = state.org.present.get('files');\n  const path = state.org.present.get('path');\n  const defaultFilePath = state.org.present\n    .get('fileSettings')\n    .filter((setting) => setting.get('defaultOnStartup'))\n    .map((setting) => `file${setting.get('path')}`)\n    .first();\n  const filesToLoadOnStartup = state.org.present\n    .get('fileSettings')\n    .filter((setting) => setting.get('loadOnStartup'))\n    .map((setting) => setting.get('path'));\n  const loadedFiles = Set.fromKeys(files);\n  const fileIsLoaded = (path) => loadedFiles.includes(path);\n  const filesToLoad = filesToLoadOnStartup.filter((path) => !fileIsLoaded(path));\n  const filesToSync = filesToLoadOnStartup.filter((path) => fileIsLoaded(path));\n  const hasDirtyFiles = !!files.find((file) => file.get('isDirty'));\n  return {\n    path,\n    filesToLoad,\n    filesToSync,\n    defaultFilePath,\n    loadingMessage: state.base.get('loadingMessage'),\n    isAuthenticated: state.syncBackend.get('isAuthenticated'),\n    fontSize: state.base.get('fontSize'),\n    lastSeenChangelogHash: state.base.get('lastSeenChangelogHash'),\n    activeModalPage: state.base.get('modalPageStack', List()).last(),\n    pendingCapture: state.org.present.get('pendingCapture'),\n    hasDirtyFiles,\n    colorScheme: state.base.get('colorScheme'),\n    theme: state.base.get('theme'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Entry));\n","export default __webpack_public_path__ + \"static/media/dropbox.9d61ebe9.svg\";","export default __webpack_public_path__ + \"static/media/gitlab.9ffaa26e.svg\";","/* global process */\n\nimport React, { PureComponent, useState } from 'react';\n\nimport './stylesheet.css';\n\nimport DropboxLogo from './dropbox.svg';\nimport GitLabLogo from './gitlab.svg';\n\nimport { persistField } from '../../util/settings_persister';\nimport {\n  createGitlabOAuth,\n  gitLabProjectIdFromURL,\n} from '../../sync_backend_clients/gitlab_sync_backend_client';\n\nimport { DropboxAuth } from 'dropbox';\nimport _ from 'lodash';\n\nfunction WebDAVForm() {\n  const [isVisible, setIsVisible] = useState(false);\n  const toggleVisible = () => setIsVisible(!isVisible);\n  const [url, setUrl] = useState(process.env.REACT_APP_WEBDAV_URL);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n\n  return (\n    <div id=\"webdavLogin\">\n      <h2>\n        <a href=\"#webdav\" onClick={toggleVisible} style={{ textDecoration: 'none' }}>\n          WebDAV\n        </a>\n      </h2>\n      {isVisible && (\n        <>\n          <form\n            onSubmit={(event) => {\n              event.preventDefault();\n              persistField('authenticatedSyncService', 'WebDAV');\n              persistField('webdavEndpoint', url);\n              persistField('webdavUsername', username);\n              persistField('webdavPassword', password);\n              window.location = window.location.origin + '/';\n            }}\n          >\n            <p>\n              <label htmlFor=\"input-webdav-url\">URL:</label>\n              <input\n                id=\"input-webdav-url\"\n                name=\"url\"\n                type=\"url\"\n                value={url}\n                className=\"textfield\"\n                onChange={(e) => {\n                  setUrl(e.target.value);\n                }}\n              />\n            </p>\n            <p>\n              <label htmlFor=\"input-webdav-user\">Username:</label>\n              <input\n                id=\"input-webdav-user\"\n                type=\"text\"\n                className=\"textfield\"\n                value={username}\n                onChange={(e) => {\n                  setUsername(e.target.value);\n                }}\n              />\n            </p>\n            <p>\n              <label htmlFor=\"input-webdav-password\">Password:</label>\n              <input\n                id=\"input-webdav-password\"\n                type=\"password\"\n                className=\"textfield\"\n                value={password}\n                onChange={(e) => {\n                  setPassword(e.target.value);\n                }}\n              />\n            </p>\n            <input type=\"submit\" value=\"Sign-in\" />\n          </form>\n          <p>\n            Please make sure your WebDAV backend meets the requirements as documented{' '}\n            <a\n              href=\"https://organice.200ok.ch/documentation.html#faq_webdav\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              here\n            </a>\n            , especially{' '}\n            <a\n              href=\"https://organice.200ok.ch/documentation.html#webdav_cors\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              CORS\n            </a>\n            .\n          </p>\n        </>\n      )}\n    </div>\n  );\n}\n\nfunction GitLab() {\n  const [isVisible, setIsVisible] = useState(false);\n  const toggleVisible = () => setIsVisible(!isVisible);\n\n  const defaultProject = 'https://gitlab.com/your/project';\n  const [project, setProject] = useState(defaultProject);\n  const handleSubmit = (evt) => {\n    const projectId = gitLabProjectIdFromURL(project);\n    if (projectId) {\n      persistField('authenticatedSyncService', 'GitLab');\n      persistField('gitLabProject', projectId);\n      createGitlabOAuth().fetchAuthorizationCode();\n    } else {\n      evt.preventDefault();\n      alert('Project does not appear to be a valid gitlab.com URL');\n    }\n  };\n\n  return (\n    <>\n      <a href=\"#gitlab\" onClick={toggleVisible}>\n        <img src={GitLabLogo} alt=\"GitLab logo\" />\n      </a>\n      {isVisible && (\n        <form onSubmit={handleSubmit}>\n          <p>\n            <label htmlFor=\"input-gitlab-project\">Project:</label>\n            <input\n              id=\"input-gitlab-project\"\n              type=\"url\"\n              className=\"textfield\"\n              placeholder={defaultProject}\n              value={project}\n              onChange={(e) => setProject(e.target.value)}\n            />\n          </p>\n          <input type=\"submit\" value=\"Sign-in\" />\n        </form>\n      )}\n    </>\n  );\n}\n\nexport default class SyncServiceSignIn extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleDropboxClick']);\n  }\n\n  handleDropboxClick() {\n    persistField('authenticatedSyncService', 'Dropbox');\n    const REDIRECT_URI = window.location.origin + '/';\n\n    const dbxAuth = new DropboxAuth({\n      clientId: process.env.REACT_APP_DROPBOX_CLIENT_ID,\n      fetch: fetch.bind(window),\n    });\n\n    dbxAuth\n      .getAuthenticationUrl(REDIRECT_URI, undefined, 'code', 'offline', undefined, undefined, true)\n      .then((authUrl) => {\n        persistField('codeVerifier', dbxAuth.codeVerifier);\n        window.location.href = authUrl;\n      })\n      .catch((error) => console.error(error));\n  }\n\n  render() {\n    return (\n      <div className=\"sync-service-sign-in-container\">\n        <p className=\"sync-service-sign-in__help-text\">\n          organice syncs your files with Dropbox, GitLab, and WebDAV.\n        </p>\n        <p className=\"sync-service-sign-in__help-text\">Click to sign in with:</p>\n\n        <div className=\"sync-service-container\">\n          <a href=\"#dropbox\" onClick={this.handleDropboxClick}>\n            <img src={DropboxLogo} alt=\"Dropbox logo\" className=\"dropbox-logo\" />\n          </a>\n        </div>\n\n        <div className=\"sync-service-container\">\n          <GitLab />\n        </div>\n\n        <div className=\"sync-service-container\">\n          <WebDAVForm />\n        </div>\n\n        <footer>\n          For questions regarding synchronization back-ends, please consult the{' '}\n          <a\n            href=\"https://organice.200ok.ch/documentation.html#sync_backends\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            documentation\n          </a>\n          .\n        </footer>\n      </div>\n    );\n  }\n}\n","// organice renders different kinds of components:\n//  - Static pages like the landing page\n//  - The actual application\n// These components do not have many things in common, neither CSS,\n// nor structure. See adr-002 for details <Turnout />\n// ensures rendering either a static page or a dynamic application\n// component.\n\nimport React from 'react';\nimport { connect } from 'react-redux';\n\nimport { Route, Switch, Redirect, withRouter } from 'react-router-dom';\n\nimport Landing from '../Landing';\nimport Entry from '../Entry';\nimport PrivacyPolicy from '../PrivacyPolicy';\nimport SyncServiceSignIn from '../SyncServiceSignIn';\nimport OrgFile from '../OrgFile';\nimport HeaderBar from '../HeaderBar';\n\nconst Turnout = ({ isAuthenticated }) => {\n  if (isAuthenticated) return <Entry />;\n\n  if (!isAuthenticated)\n    return (\n      <div>\n        <Switch>\n          <Route path=\"/privacy-policy\" exact>\n            <div className=\"App entry-container\">\n              <HeaderBar />\n              <PrivacyPolicy />\n            </div>\n          </Route>\n          <Route path=\"/sample\" exact={true}>\n            <div className=\"App entry-container\">\n              <HeaderBar />\n              <OrgFile\n                staticFile=\"sample\"\n                shouldDisableDirtyIndicator={true}\n                shouldDisableActionDrawer={false}\n                shouldDisableSyncButtons={true}\n                parsingErrorMessage={\n                  \"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!\"\n                }\n              />\n            </div>\n          </Route>\n          <Route path=\"/sign_in\" exact={true}>\n            <div className=\"App entry-container\">\n              <HeaderBar />\n              <SyncServiceSignIn />\n            </div>\n          </Route>\n          <Route path=\"/\" exact={true}>\n            <div className=\"App landing-page\">\n              <Landing />\n            </div>\n          </Route>\n          <Redirect to=\"/\" />\n        </Switch>\n      </div>\n    );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    isAuthenticated: state.syncBackend.get('isAuthenticated'),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps)(Turnout));\n","import { debounce } from 'lodash';\n\nimport { setPath, sync } from '../actions/org';\nimport { setIsOnline } from '../actions/base';\nimport { STATIC_FILE_PREFIX } from './org_utils';\n\n// When offline, don't sync and don't enable sync button. When online,\n// enable sync button. When newly online, force sync of all things\n// possibly dirty.\nexport function listenToNetworkConnectionEvents(store) {\n  // Is the user online when starting up the application?\n  store.dispatch(setIsOnline(navigator.onLine));\n\n  window.onoffline = function () {\n    store.dispatch(setIsOnline(false));\n  };\n\n  window.ononline = function () {\n    store.dispatch(setIsOnline(true));\n    // Add grace period, because browsers might get the event `onLine`\n    // too soon to actually do network requests.\n    setTimeout(() => {\n      sync({ shouldSuppressMessages: true, forceAction: 'manual' })(store.dispatch, store.getState);\n    }, 2000);\n  };\n}\n\n// Generally, opening files and other routing is done with the\n// `react-router-dom` package (i.e. `<Link/ > tags). However, organice\n// also should react to browser buttons.\nexport function listenToBrowserButtons(store) {\n  const path = store.getState().org.present.get('path');\n\n  const urlPathMatch = window.location.href.match(/.*file(\\/.*)/);\n\n  let urlPath = path;\n\n  // The user has gone 'back' or 'forward' and is showing a 'file'\n  // URL.\n  if (urlPathMatch) {\n    urlPath = urlPathMatch[1];\n  }\n\n  window.onpopstate = function () {\n    // If the current 'path' in Redux is not the same as the one in\n    // the URL.\n    if (path !== urlPath) {\n      store.dispatch(setPath(path));\n    }\n  };\n}\n\n// BEGIN: Sync on Becoming Visible\n\nconst dispatchSync = (store) => {\n  if (\n    store.getState().syncBackend.get('client') &&\n    store.getState().base.get('shouldSyncOnBecomingVisibile')\n  ) {\n    const path = store.getState().org.present.get('path');\n    let filesToLoadOnStartup = store\n      .getState()\n      .org.present.get('fileSettings')\n      .filter((setting) => setting.get('loadOnStartup'))\n      .map((setting) => setting.get('path'));\n    if (\n      path &&\n      !path.startsWith(STATIC_FILE_PREFIX) &&\n      !filesToLoadOnStartup.find((filepath) => path === filepath)\n    ) {\n      filesToLoadOnStartup = filesToLoadOnStartup.push(path);\n    }\n    filesToLoadOnStartup.forEach((path) => {\n      sync({ path, shouldSuppressMessages: true })(store.dispatch, store.getState);\n    });\n  }\n};\n\n// The 'visibilitychange' event might get triggered in some browsers\n// many times for one 'real' event of the browser becoming visible to\n// the user. Debouncing through lodash ensures that it is called at\n// maximum once every second.\nconst debouncedDispatchSync = debounce(dispatchSync, 1000);\n\n// Dealing with vendor prefixes\nfunction getHiddenProp() {\n  const prefixes = ['webkit', 'moz', 'ms', 'o'];\n\n  // if 'hidden' is natively supported just return it\n  if ('hidden' in document) return 'hidden';\n\n  // otherwise loop over all the known prefixes until we find one\n  for (let i = 0; i < prefixes.length; i++) {\n    if (prefixes[i] + 'Hidden' in document) return prefixes[i] + 'Hidden';\n  }\n\n  // otherwise it's not supported\n  return null;\n}\n\nexport function syncOnBecomingVisible(store) {\n  let visProp = getHiddenProp();\n  if (visProp) {\n    const evtname = visProp.replace(/[H|h]idden/, '') + 'visibilitychange';\n    document.addEventListener(evtname, () => debouncedDispatchSync(store));\n  }\n}\n\n// END: Sync on Becoming Visible\n","import React, { PureComponent } from 'react';\n\nimport { Provider } from 'react-redux';\nimport Store from './store';\nimport parseQueryString from './util/parse_query_string';\nimport {\n  readInitialState,\n  loadSettingsFromConfigFile,\n  subscribeToChanges,\n  getPersistedField,\n} from './util/settings_persister';\n\nimport runAllMigrations from './migrations';\nimport { BrowserRouter } from 'react-router-dom';\n\nimport { DragDropContext } from 'react-beautiful-dnd';\n\nimport { reorderCaptureTemplate } from './actions/capture';\nimport { reorderTags, reorderPropertyList, reorderFileSetting } from './actions/org';\nimport { signOut } from './actions/sync_backend';\nimport { setDisappearingLoadingMessage, restoreStaticFile } from './actions/base';\n\nimport createDropboxSyncBackendClient from './sync_backend_clients/dropbox_sync_backend_client';\nimport createWebDAVSyncBackendClient from './sync_backend_clients/webdav_sync_backend_client';\nimport createGitLabSyncBackendClient, {\n  createGitlabOAuth,\n} from './sync_backend_clients/gitlab_sync_backend_client';\n\nimport './base.css';\n\nimport Turnout from './components/Turnout';\n\nimport {\n  listenToBrowserButtons,\n  syncOnBecomingVisible,\n  listenToNetworkConnectionEvents,\n} from './lib/initial_setup';\n\nimport _ from 'lodash';\nimport { Map } from 'immutable';\n\nimport { configure } from 'react-hotkeys';\n// do handle hotkeys even if they come from within 'input', 'select' or 'textarea'\nconfigure({ ignoreTags: [] });\n\nconst handleGitLabAuthResponse = async (oauthClient) => {\n  let success = false;\n  try {\n    success = await oauthClient.isReturningFromAuthServer();\n    await oauthClient.getAccessToken();\n  } catch {\n    success = false;\n  }\n  if (!success) {\n    // Edge case: somehow OAuth success redirect occurred but there isn't a code in\n    // the current location's search params. This /shouldn't/ happen in practice.\n    alert('Unexpected sign in error, please try again');\n    return;\n  }\n\n  const syncClient = createGitLabSyncBackendClient(oauthClient);\n  const isAccessible = await syncClient.isProjectAccessible();\n  if (!isAccessible) {\n    alert('Failed to access GitLab project - is the URL correct?');\n  } else {\n    window.location.search = '';\n  }\n};\n\nexport default class App extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    runAllMigrations();\n\n    const initialState = readInitialState();\n\n    const authenticatedSyncService = getPersistedField('authenticatedSyncService', true);\n    let client = null;\n\n    if (!!authenticatedSyncService) {\n      switch (authenticatedSyncService) {\n        case 'Dropbox':\n          client = createDropboxSyncBackendClient();\n          initialState.syncBackend = Map({\n            isAuthenticated: true,\n            client: client,\n          });\n          break;\n        case 'GitLab':\n          const gitlabOAuth = createGitlabOAuth();\n          if (gitlabOAuth.isAuthorized()) {\n            client = createGitLabSyncBackendClient(gitlabOAuth);\n            initialState.syncBackend = Map({\n              isAuthenticated: true,\n              client,\n            });\n          } else {\n            handleGitLabAuthResponse(gitlabOAuth);\n          }\n          break;\n        case 'WebDAV':\n          client = createWebDAVSyncBackendClient(\n            getPersistedField('webdavEndpoint'),\n            getPersistedField('webdavUsername'),\n            getPersistedField('webdavPassword')\n          );\n          initialState.syncBackend = Map({\n            isAuthenticated: true,\n            client,\n          });\n          break;\n        default:\n      }\n    }\n\n    const queryStringContents = parseQueryString(window.location.search);\n    const { captureFile, captureTemplateName, captureContent } = queryStringContents;\n    if (!!captureFile && !!captureTemplateName) {\n      const capturePath = captureFile.startsWith('/') ? captureFile : `/${captureFile}`;\n      const customCaptureVariables = Map(\n        Object.entries(queryStringContents)\n          .map(([key, value]) => {\n            const CUSTOM_VARIABLE_PREFIX = 'captureVariable_';\n            if (key.startsWith(CUSTOM_VARIABLE_PREFIX)) {\n              return [key.substring(CUSTOM_VARIABLE_PREFIX.length), value];\n            }\n\n            return null;\n          })\n          .filter((item) => !!item)\n      );\n      initialState.org.present = initialState.org.present.set(\n        'pendingCapture',\n        Map({\n          capturePath,\n          captureTemplateName,\n          captureContent,\n          customCaptureVariables,\n        })\n      );\n    }\n\n    this.store = Store(initialState);\n    this.store.subscribe(subscribeToChanges(this.store));\n\n    if (!!client) {\n      client.isSignedIn().then((isSignedIn) => {\n        if (isSignedIn) {\n          loadSettingsFromConfigFile(this.store.dispatch, this.store.getState);\n        } else {\n          this.store.dispatch(signOut());\n        }\n      });\n    } else {\n      if (!!this.store.getState().org.present.get('pendingCapture')) {\n        this.store.dispatch(\n          setDisappearingLoadingMessage(\n            `You need to sign in before you can use capture templates`,\n            5000\n          )\n        );\n      }\n    }\n\n    // Load static files.\n    this.store.dispatch(restoreStaticFile('sample'));\n    this.store.dispatch(restoreStaticFile('changelog'));\n\n    listenToBrowserButtons(this.store);\n    syncOnBecomingVisible(this.store);\n    listenToNetworkConnectionEvents(this.store);\n\n    _.bindAll(this, ['handleDragEnd']);\n  }\n\n  handleDragEnd(result) {\n    if (!result.destination) {\n      return;\n    }\n\n    if (result.type === 'TAG') {\n      this.store.dispatch(reorderTags(result.source.index, result.destination.index));\n    } else if (result.type === 'PROPERTY-LIST') {\n      this.store.dispatch(reorderPropertyList(result.source.index, result.destination.index));\n    } else if (result.type === 'CAPTURE-TEMPLATE') {\n      this.store.dispatch(reorderCaptureTemplate(result.source.index, result.destination.index));\n    } else if (result.type === 'FILE-SETTING') {\n      this.store.dispatch(reorderFileSetting(result.source.index, result.destination.index));\n    }\n  }\n\n  render() {\n    return (\n      <DragDropContext onDragEnd={this.handleDragEnd}>\n        <BrowserRouter>\n          <Provider store={this.store}>\n            <Turnout />\n          </Provider>\n        </BrowserRouter>\n      </DragDropContext>\n    );\n  }\n}\n","/* global process */\n\n// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}