(this.webpackJsonporganice=this.webpackJsonporganice||[]).push([[0],{157:function(e,t,n){},164:function(e,t,n){"use strict";function a(e,t,n,i){this.message=e,this.expected=t,this.found=n,this.location=i,this.name="SyntaxError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,a)}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(a,Error),a.buildMessage=function(e,t){var n={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var t,n="";for(t=0;t<e.parts.length;t++)n+=e.parts[t]instanceof Array?r(e.parts[t][0])+"-"+r(e.parts[t][1]):r(e.parts[t]);return"["+(e.inverted?"^":"")+n+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function a(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}function r(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}return"Expected "+function(e){var t,a,i,r=new Array(e.length);for(t=0;t<e.length;t++)r[t]=(i=e[t],n[i.type](i));if(r.sort(),r.length>0){for(t=1,a=1;t<r.length;t++)r[t-1]!==r[t]&&(r[a]=r[t],a++);r.length=a}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:a,parse:function(e,t){t=void 0!==t?t:{};var n,i={},r={Expression:dt},s=dt,o=rt("filter expression"),l=function(e,t){return t.reduce(((e,t)=>(e.push(t[1]),e)),[e])},c=function(){return[]},d=function(e){return e.offset=nt().start.offset,e.endOffset=nt().end.offset,e},h=rt("filter term"),u="-",p=at("-",!1),m=function(e){if("field"===e.type&&"desc"!==e.field.type)throw{message:"can't negate timerange searches yet"};return e.exclude=!0,e},g=function(e){return e.exclude=!1,e},f=rt("text filter term"),b=function(e){let t="ignore-case";return tt().match(/[A-Z]/)&&(t="case-sensitive"),{type:t,words:e}},y=rt("tag filter term"),E=":",w=at(":",!1),k=function(e){return{type:"tag",words:e}},v=rt("property filter term"),T=function(e,t){return{type:"property",property:e,words:null===t?[""]:t}},S=rt("search outside of header"),_="date:",I=at("date:",!1),C=function(e){return{type:"field",field:{type:"date",timerange:e}}},D="clock:",A=at("clock:",!1),O=function(e){return{type:"field",field:{type:"clock",timerange:e}}},N="sched:",P=at("sched:",!1),L="scheduled:",R=at("scheduled:",!1),x=function(e){return{type:"field",field:{type:"scheduled",timerange:e}}},M="dead:",F=at("dead:",!1),H="deadline:",j=at("deadline:",!1),B=function(e){return{type:"field",field:{type:"deadline",timerange:e}}},V="desc:",U=at("desc:",!1),W="description:",z=at("description:",!1),G=function(e){return{type:"field",field:{type:"description",text:e}}},$=rt("moments and timeranges"),K="..",Y=at("..",!1),J=function(e,t){return{type:"range",from:e,to:t}},q=function(e){return{type:"range",from:e,to:null}},X=function(e){return{type:"point",point:e}},Z=function(e){return{type:"range",from:null,to:e}},Q=function(){return{type:"all"}},ee=rt("moment"),te="today",ne=at("today",!1),ae="now",ie=at("now",!1),re=function(e){return{type:"special",value:e}},se=/^[\-.\/]/,oe=it(["-",".","/"],!1,!1),le=function(e,t,n){return vt(e,t,n)},ce=function(e,t){return Tt(e,t)},de=function(e){return{type:"timestamp",year:parseInt(e),month:null,day:null}},he=/^[hdwmy]/,ue=it(["h","d","w","m","y"],!1,!1),pe=function(e){return{type:"unit",unit:e}},me=rt("year"),ge=/^[0-9]/,fe=it([["0","9"]],!1,!1),be=function(e){return e},ye=rt("month"),Ee=rt("day"),we=rt("offset"),ke=function(e,t){return{type:"offset",value:parseInt(e),unit:t}},ve=rt("alternatives"),Te="|",Se=at("|",!1),_e=function(e,t){return t.reduce(((e,t)=>(e.push(t[1]),e)),[e])},Ie=rt("tag alternatives"),Ce=rt("string"),De=/^[^: \t|'"]/,Ae=it([":"," ","\t","|","'",'"'],!0,!1),Oe=function(){return tt()},Ne="'",Pe=at("'",!1),Le=/^[^']/,Re=it(["'"],!0,!1),xe=function(e){return e.join("")},Me='"',Fe=at('"',!1),He=/^[^"]/,je=it(['"'],!0,!1),Be=rt("property name"),Ve=/^[^: \t]/,Ue=it([":"," ","\t"],!0,!1),We=rt("tag name"),ze=/^[a-zA-Z0-9_@]/,Ge=it([["a","z"],["A","Z"],["0","9"],"_","@"],!1,!1),$e=rt("whitespace"),Ke=/^[ \t]/,Ye=it([" ","\t"],!1,!1),Je=0,qe=0,Xe=[{line:1,column:1}],Ze=0,Qe=[],et=0;if("startRule"in t){if(!(t.startRule in r))throw new Error("Can't start parsing from rule \""+t.startRule+'".');s=r[t.startRule]}function tt(){return e.substring(qe,Je)}function nt(){return ot(qe,Je)}function at(e,t){return{type:"literal",text:e,ignoreCase:t}}function it(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function rt(e){return{type:"other",description:e}}function st(t){var n,a=Xe[t];if(a)return a;for(n=t-1;!Xe[n];)n--;for(a={line:(a=Xe[n]).line,column:a.column};n<t;)10===e.charCodeAt(n)?(a.line++,a.column=1):a.column++,n++;return Xe[t]=a,a}function ot(e,t){var n=st(e),a=st(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:a.line,column:a.column}}}function lt(e){Je<Ze||(Je>Ze&&(Ze=Je,Qe=[]),Qe.push(e))}function ct(e,t,n){return new a(a.buildMessage(e,t),e,t,n)}function dt(){var e,t,n,a,r,s,d;for(et++,e=Je,t=[],n=kt();n!==i;)t.push(n),n=kt();if(t!==i)if((n=ht())!==i){if(a=[],r=Je,s=[],(d=kt())!==i)for(;d!==i;)s.push(d),d=kt();else s=i;for(s!==i&&(d=ht())!==i?r=s=[s,d]:(Je=r,r=i);r!==i;){if(a.push(r),r=Je,s=[],(d=kt())!==i)for(;d!==i;)s.push(d),d=kt();else s=i;s!==i&&(d=ht())!==i?r=s=[s,d]:(Je=r,r=i)}if(a!==i){for(r=[],s=kt();s!==i;)r.push(s),s=kt();r!==i?(qe=e,e=t=l(n,a)):(Je=e,e=i)}else Je=e,e=i}else Je=e,e=i;else Je=e,e=i;if(e===i){for(e=Je,t=[],n=kt();n!==i;)t.push(n),n=kt();t!==i&&(qe=e,t=c()),e=t}return et--,e===i&&(t=i,0===et&&lt(o)),e}function ht(){var t,n;return t=Je,n=function(){var t,n,a;et++,t=Je,45===e.charCodeAt(Je)?(n=u,Je++):(n=i,0===et&&lt(p));n!==i&&(a=ut())!==i?(qe=t,t=n=m(a)):(Je=t,t=i);t===i&&(t=Je,(n=ut())!==i&&(qe=t,n=g(n)),t=n);et--,t===i&&(n=i,0===et&&lt(h));return t}(),n!==i&&(qe=t,n=d(n)),t=n}function ut(){var t;return(t=function(){var t,n,a;et++,t=Je,e.substr(Je,5)===_?(n=_,Je+=5):(n=i,0===et&&lt(I));n!==i&&(a=mt())!==i?(qe=t,t=n=C(a)):(Je=t,t=i);t===i&&(t=Je,e.substr(Je,6)===D?(n=D,Je+=6):(n=i,0===et&&lt(A)),n!==i&&(a=mt())!==i?(qe=t,t=n=O(a)):(Je=t,t=i),t===i&&(t=Je,e.substr(Je,6)===N?(n=N,Je+=6):(n=i,0===et&&lt(P)),n===i&&(e.substr(Je,10)===L?(n=L,Je+=10):(n=i,0===et&&lt(R))),n!==i&&(a=mt())!==i?(qe=t,t=n=x(a)):(Je=t,t=i),t===i&&(t=Je,e.substr(Je,5)===M?(n=M,Je+=5):(n=i,0===et&&lt(F)),n===i&&(e.substr(Je,9)===H?(n=H,Je+=9):(n=i,0===et&&lt(j))),n!==i&&(a=mt())!==i?(qe=t,t=n=B(a)):(Je=t,t=i),t===i&&(t=Je,e.substr(Je,5)===V?(n=V,Je+=5):(n=i,0===et&&lt(U)),n===i&&(e.substr(Je,12)===W?(n=W,Je+=12):(n=i,0===et&&lt(z))),n!==i&&(a=pt())!==i?(qe=t,t=n=G(a)):(Je=t,t=i)))));et--,t===i&&(n=i,0===et&&lt(S));return t}())===i&&(t=pt())===i&&(t=function(){var t,n,a,r,s;et++,t=Je,58===e.charCodeAt(Je)?(n=E,Je++):(n=i,0===et&&lt(w));n!==i?(a=function(){var t,n,a;et++,t=Je,n=[],Ve.test(e.charAt(Je))?(a=e.charAt(Je),Je++):(a=i,0===et&&lt(Ue));if(a!==i)for(;a!==i;)n.push(a),Ve.test(e.charAt(Je))?(a=e.charAt(Je),Je++):(a=i,0===et&&lt(Ue));else n=i;n!==i&&(qe=t,n=Oe());t=n,et--,t===i&&(n=i,0===et&&lt(Be));return t}(),a!==i?(58===e.charCodeAt(Je)?(r=E,Je++):(r=i,0===et&&lt(w)),r!==i?((s=yt())===i&&(s=null),s!==i?(qe=t,t=n=T(a,s)):(Je=t,t=i)):(Je=t,t=i)):(Je=t,t=i)):(Je=t,t=i);et--,t===i&&(n=i,0===et&&lt(v));return t}())===i&&(t=function(){var t,n,a;et++,t=Je,58===e.charCodeAt(Je)?(n=E,Je++):(n=i,0===et&&lt(w));n!==i?(a=function(){var t,n,a,r,s,o;if(et++,t=Je,n=wt(),n!==i){for(a=[],r=Je,124===e.charCodeAt(Je)?(s=Te,Je++):(s=i,0===et&&lt(Se)),s!==i&&(o=wt())!==i?r=s=[s,o]:(Je=r,r=i);r!==i;)a.push(r),r=Je,124===e.charCodeAt(Je)?(s=Te,Je++):(s=i,0===et&&lt(Se)),s!==i&&(o=wt())!==i?r=s=[s,o]:(Je=r,r=i);a!==i?(qe=t,t=n=_e(n,a)):(Je=t,t=i)}else Je=t,t=i;et--,t===i&&(n=i,0===et&&lt(Ie));return t}(),a!==i?(qe=t,t=n=k(a)):(Je=t,t=i)):(Je=t,t=i);et--,t===i&&(n=i,0===et&&lt(y));return t}()),t}function pt(){var e,t;return et++,e=Je,(t=yt())!==i&&(qe=e,t=b(t)),et--,(e=t)===i&&(t=i,0===et&&lt(f)),e}function mt(){var t,n,a,r;return et++,t=Je,(n=gt())!==i?(e.substr(Je,2)===K?(a=K,Je+=2):(a=i,0===et&&lt(Y)),a!==i&&(r=gt())!==i?(qe=t,t=n=J(n,r)):(Je=t,t=i)):(Je=t,t=i),t===i&&(t=Je,(n=gt())!==i?(e.substr(Je,2)===K?(a=K,Je+=2):(a=i,0===et&&lt(Y)),a!==i?(qe=t,t=n=q(n)):(Je=t,t=i)):(Je=t,t=i),t===i&&(t=Je,(n=gt())!==i&&(qe=t,n=X(n)),(t=n)===i&&(t=Je,e.substr(Je,2)===K?(n=K,Je+=2):(n=i,0===et&&lt(Y)),n!==i&&(a=gt())!==i?(qe=t,t=n=Z(a)):(Je=t,t=i),t===i&&(t=Je,e.substr(Je,2)===K?(n=K,Je+=2):(n=i,0===et&&lt(Y)),n!==i&&(qe=t,n=Q()),t=n)))),et--,t===i&&(n=i,0===et&&lt($)),t}function gt(){var t,n,a;return et++,t=function(){var t,n,a,r;et++,t=Je,n=Je,a=[],ge.test(e.charAt(Je))?(r=e.charAt(Je),Je++):(r=i,0===et&&lt(fe));if(r!==i)for(;r!==i;)a.push(r),ge.test(e.charAt(Je))?(r=e.charAt(Je),Je++):(r=i,0===et&&lt(fe));else a=i;n=a!==i?e.substring(n,Je):a;n!==i?(he.test(e.charAt(Je))?(a=e.charAt(Je),Je++):(a=i,0===et&&lt(ue)),a!==i?(qe=t,t=n=ke(n,a)):(Je=t,t=i)):(Je=t,t=i);et--,t===i&&(n=i,0===et&&lt(we));return t}(),t===i&&(t=function(){var t,n,a,r,s,o;t=Je,n=ft(),n!==i?(se.test(e.charAt(Je))?(a=e.charAt(Je),Je++):(a=i,0===et&&lt(oe)),a===i&&(a=null),a!==i&&(r=bt())!==i?(se.test(e.charAt(Je))?(s=e.charAt(Je),Je++):(s=i,0===et&&lt(oe)),s===i&&(s=null),s!==i?(o=function(){var t,n,a,r,s;et++,t=Je,n=Je,a=Je,ge.test(e.charAt(Je))?(r=e.charAt(Je),Je++):(r=i,0===et&&lt(fe));r!==i?(ge.test(e.charAt(Je))?(s=e.charAt(Je),Je++):(s=i,0===et&&lt(fe)),s!==i?a=r=[r,s]:(Je=a,a=i)):(Je=a,a=i);n=a!==i?e.substring(n,Je):a;n!==i&&(qe=t,n=be(n));t=n,et--,t===i&&(n=i,0===et&&lt(Ee));return t}(),o!==i?(qe=t,t=n=le(n,r,o)):(Je=t,t=i)):(Je=t,t=i)):(Je=t,t=i)):(Je=t,t=i);t===i&&(t=Je,(n=ft())!==i?(se.test(e.charAt(Je))?(a=e.charAt(Je),Je++):(a=i,0===et&&lt(oe)),a===i&&(a=null),a!==i&&(r=bt())!==i?(qe=t,t=n=ce(n,r)):(Je=t,t=i)):(Je=t,t=i),t===i&&(t=Je,(n=ft())!==i&&(qe=t,n=de(n)),t=n));return t}(),t===i&&(t=function(){var t,n;t=Je,he.test(e.charAt(Je))?(n=e.charAt(Je),Je++):(n=i,0===et&&lt(ue));n!==i&&(qe=t,n=pe(n));return t=n,t}(),t===i&&(t=Je,n=Je,e.substr(Je,5)===te?(a=te,Je+=5):(a=i,0===et&&lt(ne)),a===i&&(e.substr(Je,3)===ae?(a=ae,Je+=3):(a=i,0===et&&lt(ie))),(n=a!==i?e.substring(n,Je):a)!==i&&(qe=t,n=re(n)),t=n))),et--,t===i&&(n=i,0===et&&lt(ee)),t}function ft(){var t,n,a,r,s,o,l;return et++,t=Je,n=Je,a=Je,ge.test(e.charAt(Je))?(r=e.charAt(Je),Je++):(r=i,0===et&&lt(fe)),r!==i?(ge.test(e.charAt(Je))?(s=e.charAt(Je),Je++):(s=i,0===et&&lt(fe)),s!==i?(ge.test(e.charAt(Je))?(o=e.charAt(Je),Je++):(o=i,0===et&&lt(fe)),o!==i?(ge.test(e.charAt(Je))?(l=e.charAt(Je),Je++):(l=i,0===et&&lt(fe)),l!==i?a=r=[r,s,o,l]:(Je=a,a=i)):(Je=a,a=i)):(Je=a,a=i)):(Je=a,a=i),(n=a!==i?e.substring(n,Je):a)!==i&&(qe=t,n=be(n)),et--,(t=n)===i&&(n=i,0===et&&lt(me)),t}function bt(){var t,n,a,r,s;return et++,t=Je,n=Je,a=Je,ge.test(e.charAt(Je))?(r=e.charAt(Je),Je++):(r=i,0===et&&lt(fe)),r!==i?(ge.test(e.charAt(Je))?(s=e.charAt(Je),Je++):(s=i,0===et&&lt(fe)),s!==i?a=r=[r,s]:(Je=a,a=i)):(Je=a,a=i),(n=a!==i?e.substring(n,Je):a)!==i&&(qe=t,n=be(n)),et--,(t=n)===i&&(n=i,0===et&&lt(ye)),t}function yt(){var t,n,a,r,s,o;if(et++,t=Je,(n=Et())!==i){for(a=[],r=Je,124===e.charCodeAt(Je)?(s=Te,Je++):(s=i,0===et&&lt(Se)),s!==i&&(o=Et())!==i?r=s=[s,o]:(Je=r,r=i);r!==i;)a.push(r),r=Je,124===e.charCodeAt(Je)?(s=Te,Je++):(s=i,0===et&&lt(Se)),s!==i&&(o=Et())!==i?r=s=[s,o]:(Je=r,r=i);a!==i?(qe=t,t=n=_e(n,a)):(Je=t,t=i)}else Je=t,t=i;return et--,t===i&&(n=i,0===et&&lt(ve)),t}function Et(){var t,n,a,r;if(et++,t=Je,n=[],De.test(e.charAt(Je))?(a=e.charAt(Je),Je++):(a=i,0===et&&lt(Ae)),a!==i)for(;a!==i;)n.push(a),De.test(e.charAt(Je))?(a=e.charAt(Je),Je++):(a=i,0===et&&lt(Ae));else n=i;if(n!==i&&(qe=t,n=Oe()),(t=n)===i){if(t=Je,39===e.charCodeAt(Je)?(n=Ne,Je++):(n=i,0===et&&lt(Pe)),n!==i){if(a=[],Le.test(e.charAt(Je))?(r=e.charAt(Je),Je++):(r=i,0===et&&lt(Re)),r!==i)for(;r!==i;)a.push(r),Le.test(e.charAt(Je))?(r=e.charAt(Je),Je++):(r=i,0===et&&lt(Re));else a=i;a!==i?(39===e.charCodeAt(Je)?(r=Ne,Je++):(r=i,0===et&&lt(Pe)),r!==i?(qe=t,t=n=xe(a)):(Je=t,t=i)):(Je=t,t=i)}else Je=t,t=i;if(t===i)if(t=Je,34===e.charCodeAt(Je)?(n=Me,Je++):(n=i,0===et&&lt(Fe)),n!==i){if(a=[],He.test(e.charAt(Je))?(r=e.charAt(Je),Je++):(r=i,0===et&&lt(je)),r!==i)for(;r!==i;)a.push(r),He.test(e.charAt(Je))?(r=e.charAt(Je),Je++):(r=i,0===et&&lt(je));else a=i;a!==i?(34===e.charCodeAt(Je)?(r=Me,Je++):(r=i,0===et&&lt(Fe)),r!==i?(qe=t,t=n=xe(a)):(Je=t,t=i)):(Je=t,t=i)}else Je=t,t=i}return et--,t===i&&(n=i,0===et&&lt(Ce)),t}function wt(){var t,n,a;if(et++,t=Je,n=[],ze.test(e.charAt(Je))?(a=e.charAt(Je),Je++):(a=i,0===et&&lt(Ge)),a!==i)for(;a!==i;)n.push(a),ze.test(e.charAt(Je))?(a=e.charAt(Je),Je++):(a=i,0===et&&lt(Ge));else n=i;return n!==i&&(qe=t,n=Oe()),et--,(t=n)===i&&(n=i,0===et&&lt(We)),t}function kt(){var t;return et++,Ke.test(e.charAt(Je))?(t=e.charAt(Je),Je++):(t=i,0===et&&lt(Ye)),et--,t===i&&(0===et&&lt($e)),t}const vt=(e,t,n)=>{const a=new Date(e+"-"+t+"-"+n);if(isNaN(a.valueOf()))throw{message:"invalid date"};return{type:"timestamp",year:parseInt(e),month:parseInt(t),day:parseInt(n)}},Tt=(e,t)=>{if(t>=1&&t<=12)return{type:"timestamp",year:parseInt(e),month:parseInt(t),day:null};throw{message:"invalid month"}};if((n=s())!==i&&Je===e.length)return n;throw n!==i&&Je<e.length&&lt({type:"end"}),ct(Qe,Ze<e.length?e.charAt(Ze):null,Ze<e.length?ot(Ze,Ze+1):ot(Ze,Ze))}}},173:function(e,t,n){},180:function(e,t){},182:function(e,t){},217:function(e,t){},218:function(e,t){},312:function(e,t,n){},313:function(e,t,n){},314:function(e,t,n){},316:function(e,t,n){},317:function(e,t,n){},318:function(e,t,n){},319:function(e,t,n){},320:function(e,t,n){},328:function(e,t,n){},330:function(e,t,n){},331:function(e,t,n){},333:function(e,t,n){},334:function(e,t,n){},335:function(e,t,n){},336:function(e,t,n){},337:function(e,t,n){},338:function(e,t,n){},339:function(e,t,n){},340:function(e,t,n){},341:function(e,t,n){},342:function(e,t,n){},343:function(e,t,n){},344:function(e,t,n){},345:function(e,t,n){},346:function(e,t,n){},347:function(e,t,n){},348:function(e,t,n){},349:function(e,t,n){},350:function(e,t,n){},351:function(e,t,n){},352:function(e,t,n){},353:function(e,t,n){},354:function(e,t,n){},355:function(e,t,n){},356:function(e,t,n){},357:function(e,t,n){},358:function(e,t,n){},359:function(e,t,n){},360:function(e,t,n){},361:function(e,t,n){},362:function(e,t,n){},363:function(e,t,n){},364:function(e,t,n){},365:function(e,t,n){},366:function(e,t,n){},367:function(e,t,n){},368:function(e,t,n){},369:function(e,t,n){},370:function(e,t,n){},371:function(e,t,n){},372:function(e,t,n){},373:function(e,t,n){},374:function(e,t,n){},375:function(e,t,n){},376:function(e,t,n){},377:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"setLoadingMessage",(function(){return Ke})),n.d(a,"hideLoadingMessage",(function(){return Ye})),n.d(a,"setIsLoading",(function(){return Je})),n.d(a,"setIsOnline",(function(){return qe})),n.d(a,"setDisappearingLoadingMessage",(function(){return Xe})),n.d(a,"setLastViewedFile",(function(){return Ze})),n.d(a,"restoreStaticFile",(function(){return Qe})),n.d(a,"unloadStaticFile",(function(){return et})),n.d(a,"setFontSize",(function(){return tt})),n.d(a,"setBulletStyle",(function(){return nt})),n.d(a,"setShouldTapTodoToAdvance",(function(){return at})),n.d(a,"setAgendaDefaultDeadlineDelayUnit",(function(){return it})),n.d(a,"setAgendaDefaultDeadlineDelayValue",(function(){return rt})),n.d(a,"setEditorDescriptionHeightValue",(function(){return st})),n.d(a,"setAgendaStartOnWeekday",(function(){return ot})),n.d(a,"setShouldLiveSync",(function(){return lt})),n.d(a,"setShowDeadlineDisplay",(function(){return ct})),n.d(a,"setShouldSyncOnBecomingVisibile",(function(){return dt})),n.d(a,"setShouldShowTitleInOrgFile",(function(){return ht})),n.d(a,"setShouldLogIntoDrawer",(function(){return ut})),n.d(a,"setCloseSubheadersRecursively",(function(){return pt})),n.d(a,"setShouldNotIndentOnExport",(function(){return mt})),n.d(a,"setShouldStoreSettingsInSyncBackend",(function(){return gt})),n.d(a,"setColorScheme",(function(){return ft})),n.d(a,"setTheme",(function(){return bt})),n.d(a,"setHasUnseenChangelog",(function(){return yt})),n.d(a,"setLastSeenChangelogHeader",(function(){return Et})),n.d(a,"setCustomKeybinding",(function(){return wt})),n.d(a,"restoreBaseSettings",(function(){return kt})),n.d(a,"pushModalPage",(function(){return vt})),n.d(a,"popModalPage",(function(){return Tt})),n.d(a,"clearModalStack",(function(){return St})),n.d(a,"activatePopup",(function(){return _t})),n.d(a,"closePopup",(function(){return It})),n.d(a,"setAgendaTimeframe",(function(){return Ct})),n.d(a,"setFinderTab",(function(){return Dt})),n.d(a,"setPreferEditRawValues",(function(){return At}));var i={};n.r(i),n.d(i,"addNewEmptyCaptureTemplate",(function(){return Rt})),n.d(i,"updateTemplateFieldPathValue",(function(){return xt})),n.d(i,"addNewTemplateOrgFileAvailability",(function(){return Mt})),n.d(i,"removeTemplateOrgFileAvailability",(function(){return Ft})),n.d(i,"addNewTemplateHeaderPath",(function(){return Ht})),n.d(i,"removeTemplateHeaderPath",(function(){return jt})),n.d(i,"deleteTemplate",(function(){return Bt})),n.d(i,"restoreCaptureSettings",(function(){return Vt})),n.d(i,"reorderCaptureTemplate",(function(){return Ut}));var r={};n.r(r),n.d(r,"parseFile",(function(){return Ri})),n.d(r,"setLastSyncAt",(function(){return xi})),n.d(r,"resetFileDisplay",(function(){return Mi})),n.d(r,"sync",(function(){return ji})),n.d(r,"openHeader",(function(){return Vi})),n.d(r,"toggleHeaderOpened",(function(){return Ui})),n.d(r,"selectHeader",(function(){return Wi})),n.d(r,"setPath",(function(){return zi})),n.d(r,"selectHeaderAndOpenParents",(function(){return Gi})),n.d(r,"advanceTodoState",(function(){return $i})),n.d(r,"setTodoState",(function(){return Ki})),n.d(r,"enterEditMode",(function(){return Yi})),n.d(r,"exitEditMode",(function(){return Ji})),n.d(r,"updateHeaderTitle",(function(){return qi})),n.d(r,"updateHeaderDescription",(function(){return Xi})),n.d(r,"addHeader",(function(){return Zi})),n.d(r,"createFirstHeader",(function(){return Qi})),n.d(r,"selectNextSiblingHeader",(function(){return er})),n.d(r,"addHeaderAndEdit",(function(){return tr})),n.d(r,"selectNextVisibleHeader",(function(){return nr})),n.d(r,"selectPreviousVisibleHeader",(function(){return ar})),n.d(r,"removeHeader",(function(){return ir})),n.d(r,"moveHeaderUp",(function(){return rr})),n.d(r,"moveHeaderDown",(function(){return sr})),n.d(r,"moveHeaderLeft",(function(){return or})),n.d(r,"moveHeaderRight",(function(){return lr})),n.d(r,"moveSubtreeLeft",(function(){return cr})),n.d(r,"moveSubtreeRight",(function(){return dr})),n.d(r,"refileSubtree",(function(){return hr})),n.d(r,"addNote",(function(){return ur})),n.d(r,"narrowHeader",(function(){return pr})),n.d(r,"widenHeader",(function(){return mr})),n.d(r,"setOpennessState",(function(){return gr})),n.d(r,"applyOpennessState",(function(){return fr})),n.d(r,"dirtyAction",(function(){return br})),n.d(r,"setDirty",(function(){return yr})),n.d(r,"setSelectedTableId",(function(){return Er})),n.d(r,"setSelectedTableCellId",(function(){return wr})),n.d(r,"addNewTableRow",(function(){return kr})),n.d(r,"removeTableRow",(function(){return vr})),n.d(r,"addNewTableColumn",(function(){return Tr})),n.d(r,"removeTableColumn",(function(){return Sr})),n.d(r,"moveTableRowDown",(function(){return _r})),n.d(r,"moveTableRowUp",(function(){return Ir})),n.d(r,"moveTableColumnLeft",(function(){return Cr})),n.d(r,"moveTableColumnRight",(function(){return Dr})),n.d(r,"updateTableCellValue",(function(){return Ar})),n.d(r,"insertCapture",(function(){return Or})),n.d(r,"clearPendingCapture",(function(){return Nr})),n.d(r,"insertPendingCapture",(function(){return Pr})),n.d(r,"advanceCheckboxState",(function(){return Lr})),n.d(r,"setSelectedListItemId",(function(){return Rr})),n.d(r,"updateListTitleValue",(function(){return xr})),n.d(r,"updateListContentsValue",(function(){return Mr})),n.d(r,"addNewListItem",(function(){return Fr})),n.d(r,"selectNextSiblingListItem",(function(){return Hr})),n.d(r,"addNewListItemAndEdit",(function(){return jr})),n.d(r,"removeListItem",(function(){return Br})),n.d(r,"moveListItemUp",(function(){return Vr})),n.d(r,"moveListItemDown",(function(){return Ur})),n.d(r,"moveListItemLeft",(function(){return Wr})),n.d(r,"moveListItemRight",(function(){return zr})),n.d(r,"moveListSubtreeLeft",(function(){return Gr})),n.d(r,"moveListSubtreeRight",(function(){return $r})),n.d(r,"setHeaderTags",(function(){return Kr})),n.d(r,"reorderTags",(function(){return Yr})),n.d(r,"reorderPropertyList",(function(){return Jr})),n.d(r,"updateTimestampWithId",(function(){return qr})),n.d(r,"updatePlanningItemTimestamp",(function(){return Xr})),n.d(r,"addNewPlanningItem",(function(){return Zr})),n.d(r,"removePlanningItem",(function(){return Qr})),n.d(r,"removeTimestamp",(function(){return es})),n.d(r,"updatePropertyListItems",(function(){return ts})),n.d(r,"setOrgFileErrorMessage",(function(){return ns})),n.d(r,"setLogEntryStop",(function(){return as})),n.d(r,"createLogEntryStart",(function(){return is})),n.d(r,"updateLogEntryTime",(function(){return rs})),n.d(r,"setSearchFilterInformation",(function(){return ss})),n.d(r,"setShowClockDisplay",(function(){return os})),n.d(r,"updateFileSettingFieldPathValue",(function(){return ls})),n.d(r,"reorderFileSetting",(function(){return cs})),n.d(r,"deleteFileSetting",(function(){return ds})),n.d(r,"addNewEmptyFileSetting",(function(){return hs})),n.d(r,"restoreFileSettings",(function(){return us})),n.d(r,"saveBookmark",(function(){return ps})),n.d(r,"deleteBookmark",(function(){return ms})),n.d(r,"addNewFile",(function(){return gs}));var s={};n.r(s),n.d(s,"signOut",(function(){return Rs})),n.d(s,"setCurrentFileBrowserDirectoryListing",(function(){return xs})),n.d(s,"setIsLoadingMoreDirectoryListing",(function(){return Ms})),n.d(s,"getDirectoryListing",(function(){return Fs})),n.d(s,"loadMoreDirectoryListing",(function(){return Hs})),n.d(s,"pushBackup",(function(){return js})),n.d(s,"downloadFile",(function(){return Bs})),n.d(s,"createFile",(function(){return Vs}));var o=n(0),l=n.n(o),c=n(46),d=n.n(c),h=(n(173),n(10)),u=n(5),p=n(160),m=n(21),g=n.n(m),f=n(3),b=n.n(f),y=n(1),E=n(412),w=(()=>{let e=1;return()=>e++})(),k=n(15),v=n(413),T=n(161),S=n(71),_=n(162),I=n(72),C=n(163),D=n(379),A=n(380),O=n(381),N=n(382),P=n(383),L=n(384),R=n(385),x=n(386),M=n(387),F=n(388),H=n(389);const j=e=>{const{isActive:t,year:n,month:a,day:i,dayName:r,startHour:s,startMinute:o,endHour:l,endMinute:c,repeaterType:d,repeaterValue:h,repeaterUnit:u,repeaterDeadlineValue:p,repeaterDeadlineUnit:m,delayType:g,delayValue:f,delayUnit:b}=e.toJS();let y="";return y+=t?"<":"[",y+=`${n}-${a}-${i}`,y+=r?` ${r}`:"",y+=s?` ${s}:${o}`:"",y+=l?`-${l}:${c}`:"",y+=d?` ${d}${h}${u}`:"",y+=d&&p?`/${p}${m}`:"",y+=g?` ${g}${f}${b}`:"",y+=t?">":"]",y},B=function(e){let{isActive:t=!0,withStartTime:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a={isActive:t,year:Object(k.a)(e,"yyyy"),month:Object(k.a)(e,"MM"),day:Object(k.a)(e,"dd"),dayName:Object(k.a)(e,"eee"),startHour:null,startMinute:null,endHour:null,endMinute:null,repeaterType:null,repeaterValue:null,repeaterUnit:null,repeaterDeadlineValue:null,repeaterDeadlineUnit:null,delayType:null,delayValue:null,delayUnit:null};return n&&(a.startHour=Object(k.a)(e,"HH"),a.startMinute=Object(k.a)(e,"mm")),a},V=function(){let{isActive:e=!0,withStartTime:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return U(new Date,{isActive:e,withStartTime:t})},U=function(e){let{isActive:t=!0,withStartTime:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=t?"<>":"[]";let i="yyyy-MM-dd eee";return n&&(i+=" HH:mm"),`${a[0]}${Object(k.a)(e,i)}${a[1]}`},W=e=>{const{year:t,month:n,day:a,startHour:i,startMinute:r}=e.toJS();let s=`${t}-${n}-${a}`;return s+=i&&r?` ${i.padStart(2,"0")}:${r}`:" 12:00",Object(v.a)(s,"yyyy-MM-dd HH:mm",new Date)},z=(e,t,n)=>{switch(n){case"h":return Object(T.a)(e,t);case"d":return Object(S.a)(e,t);case"w":return Object(_.a)(e,t);case"m":return Object(I.a)(e,t);case"y":return Object(C.a)(e,t);default:return e}},G=(e,t,n)=>{switch(n){case"h":return Object(D.a)(e,t);case"d":return Object(A.a)(e,t);case"w":return Object(O.a)(e,t);case"m":return Object(N.a)(e,t);case"y":return Object(P.a)(e,t);default:return e}},$=(e,t)=>{let[n,a]=[e,t].map(W);return K(n,a)},K=(e,t)=>{let n=" ";e>t&&(n="-",[e,t]=[t,e]);const a=Object(H.a)(t,e),i=Math.floor(a/60);i>=10&&(n="");const r=a%60;return`${n}${i}:${r>=10?r:`0${r}`}`},Y=e=>void 0===e?"":K(new Date(0),new Date(e)),J=e=>e.map((e=>{switch(e.get("type")){case"text":return e.get("contents");case"link":return e.getIn(["contents","title"])?e.getIn(["contents","title"]):e.getIn(["contents","uri"]);default:return""}})).join(""),q=e=>{if(!e)return"";const t=e.unshift(null);return e.zip(t).map((e=>{let[t,n]=e,a="";switch(t.get("type")){case"text":a=t.get("contents");break;case"inline-markup":a=(e=>{const t={"inline-code":"~",bold:"*",italic:"/",strikethrough:"+",underline:"_",verbatim:"="};return"inline-markup"===e.get("type")&&t[e.get("markupType")]?t[e.get("markupType")]+e.get("content")+t[e.get("markupType")]:e.get("content")})(t);break;case"link":a=(i=t).getIn(["contents","title"])?`[[${i.getIn(["contents","uri"])}][${i.getIn(["contents","title"])}]]`:`[[${i.getIn(["contents","uri"])}]]`;break;case"fraction-cookie":a=`[${t.getIn(["fraction",0])||""}/${t.getIn(["fraction",1])||""}]`;break;case"percentage-cookie":a=`[${t.get("percentage")||""}%]`;break;case"table":a=(e=>{const t=e.get("contents").map((e=>Math.max(...e.get("contents").map((e=>(b.a.countBy(e.get("rawContents"))["\n"]||0)+1))))).toJS(),n=e.getIn(["contents",0,"contents"]);if(void 0===n)return"";const a=n.size,i=b.a.times(a).map((t=>Math.max(...e.get("contents").map((e=>{const n=e.getIn(["contents",t,"contents"]),a=J(n).split("\n").map((e=>e.trim().length));return Math.max(...a)})))));return b.a.dropRight(b.a.flatten(e.get("contents").map(((e,n)=>{const a=t[n],r=b.a.times(a).map((t=>e.get("contents").map(((e,n)=>{const a=e.get("contents"),r=J(a).split("\n").map((e=>e.trim().length)),s=(e.get("rawContents").split("\n")[t]||"").trim(),o=i[n]-r[t];return s+" ".repeat(o)})).toJS().join(" | "))).map((e=>`| ${e} |`)),s="|"+i.map((e=>"-".repeat(e+2))).join("+")+"|";return r.concat(s)})).toJS())).join("\n")})(t);break;case"list":a=(e=>{const t=e.get("bulletCharacter");let n=0;return e.get("items").map((a=>{const i=e.get("isOrdered")||"*"!==t?"":" ",r=q(a.get("titleLine")),s=q(a.get("contents")),o=s.split("\n").map((e=>e.trim()?`${i}  ${e}`:"")).join("\n");let l=null;if(e.get("isOrdered")){let t=++n,i=a.get("forceNumber");i&&(t=i,n=t),l=`${t}${e.get("numberTerminatorCharacter")}`,i&&(l+=` [@${i}]`),a.get("isCheckbox")&&(l+=` [${{checked:"X",unchecked:" ",partial:"-"}[a.get("checkboxState")]}]`),l+=` ${r}`}else l=`${i}${t}`,a.get("isCheckbox")&&(l+=` [${{checked:"X",unchecked:" ",partial:"-"}[a.get("checkboxState")]}]`),l+=` ${r}`;return s&&(l+=`\n${o}`),l})).join("\n")})(t);break;case"timestamp":a=(e=>{let t=j(e.get("firstTimestamp"));return e.get("secondTimestamp")&&(t+=`--${j(e.get("secondTimestamp"))}`),t})(t);break;case"url":case"www-url":case"e-mail":case"phone-number":a=t.get("content");break;default:console.error(`Unknown attributed string part type in attributedStringToRawText: ${t.get("type")}`)}var i;let r="";return n&&(["list","table"].includes(n.get("type"))?r="\n":"list"!==t.get("type")||"text"!==n.get("type")||n.get("contents").endsWith("\n")||(r="\n")),r+a})).join("")},X=(e,t)=>{let n="*".repeat(e.nestingLevel);if(e.titleLine.todoKeyword&&(n+=` ${e.titleLine.todoKeyword}`),n+=` ${e.titleLine.rawTitle}`,e.titleLine.tags.length){let t=`:${e.titleLine.tags.filter((e=>e)).join(":")}:`;if(!n.match(/\s$/)){let e=77-n.length-t.length;n+=" ".repeat(e>0?e:1)}n+=t}return t||(n=n.substring(1+e.nestingLevel)),n},Z=e=>{let{headers:t,linesBeforeHeadings:n,dontIndent:a}=e;return n.map((e=>e+"\n")).join("")+t.map((e=>Q(e,!0,a))).join("")},Q=(e,t,n)=>{const a=e;e=e.toJS();const i=n?"":" ".repeat(e.nestingLevel+1);let r="";t&&(r+=X(e,!0)+"\n");const s=a.get("planningItems").filter(Ue).toJS();if(s.length){const e=s.map((e=>{const t=j(Object(y.fromJS)(e.timestamp));return`${e.type}: ${t}`})).join(" ").trimRight();r+=`${i}${e}\n`}if(e.propertyListItems.length){const t=e.propertyListItems.map((e=>`${i}:${e.property}: ${q(Object(y.fromJS)(e.value))}`)).join("\n");r+=`${i}:PROPERTIES:\n`,r+=`${t}\n`,r+=`${i}:END:\n`}if(r+=q(Object(y.fromJS)(e.logNotes)).split("\n").map((e=>e.trim()?`${i}${e}`:"")).join("\n"),r+=e.logNotes.length?"\n":"",e.logBookEntries.length){const t=e.logBookEntries.map((e=>void 0!==e.raw?e.raw?`${i}${e.raw}`:"":null===e.end?`${i}CLOCK: ${j(Object(y.fromJS)(e.start))}`:`${i}CLOCK: ${j(Object(y.fromJS)(e.start))}--${j(Object(y.fromJS)(e.end))} => ${$(Object(y.fromJS)(e.start),Object(y.fromJS)(e.end))}`)).join("\n").trimRight();r+=`${i}:LOGBOOK:\n`,r+=`${t}\n`,r+=`${i}:END:\n`}let o=e.rawDescription;return e.rawDescription.match(/[^\n]$/)&&(o=e.rawDescription+"\n"),r+=o,r};var ee=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(y.Map)();if(!e)return["",null];const n={"%t":`<${Object(k.a)(new Date,"yyyy-MM-dd eee")}>`,"%T":`<${Object(k.a)(new Date,"yyyy-MM-dd eee HH:mm")}>`,"%u":`[${Object(k.a)(new Date,"yyyy-MM-dd eee")}]`,"%U":`[${Object(k.a)(new Date,"yyyy-MM-dd eee HH:mm")}]`,"%r":`${Object(k.a)(new Date,"yyyy-MM-dd eee")}`,"%R":`${Object(k.a)(new Date,"yyyy-MM-dd eee HH:mm")}`,"%y":`${Object(k.a)(new Date,"yyyy")}`};t.entrySeq().forEach((e=>{let[t,a]=e;n[`%${t}`]=a}));let a=e;b.a.entries(n).forEach((e=>{let[t,n]=e;return a=a.replace(RegExp(t,"g"),n)}));const i=a.includes("%?")?a.indexOf("%?"):null;return a=a.replace(/%\?/,""),[a,i]};const te="organice_internal_";const ne=()=>new Promise(((e,t)=>{var n;(n="# organice will not reflow if there's hard-wrapped content\n# -*- eval: (auto-fill-mode 0) -*-\n\n* General\n\nAll user visible changes to organice will be documented in this file.\n\nWhen there are updates to the changelog, you will be notified and see a 'gift' icon appear on the top right corner.\n\n* [2025-04-05 Sat]\n\n** Fixed\n\n- Create a static =/manifest.json=\n  - This improves the PWA experience for people self hosting organice\n  - PR: https://github.com/200ok-ch/organice/pull/1013\n\n* [2025-04-04 Fri]\n\n** Fixed\n\n- Prevent accidental horizontal swipes during vertical scrolling on iOS\n  - Improved touch handling to detect vertical scrolling intent and prevent unwanted horizontal swipe actions\n  - PR: https://github.com/200ok-ch/organice/pull/1012\n\n* [2024-11-11 Mon]\n\n** Changed\n\n- No UI/UX changes, but lots of tooling upgrades\n- Major version technical upgrades\n  - nodejs (from 12 to 20)\n  - Create React App (from 3 to 4)\n  - eslint (from 6 to 7)\n  - node-sass to sass\n- Minor version technical upgrades\n  - redux-undo\n  - React\n\nPRs:\n\n- https://github.com/200ok-ch/organice/pull/1000\n- https://github.com/200ok-ch/organice/pull/999\n- https://github.com/200ok-ch/organice/pull/998\n\n* [2024-11-09 Sat]\n** Fixed\n\n- Prevent app crash when deleting a list item immediately after exiting edit mode\n  - PR: https://github.com/200ok-ch/organice/pull/996\n  - Thank you [[https://github.com/kjmatsuda][kjmatsuda]] for the PR\ud83d\ude4f\n** Changed\n\n- doc: Clarify where to find docs (interactive tutorial vs. manual)\n  - PR: https://github.com/200ok-ch/organice/pull/991\n* [2024-09-19 Thu]\n\n** Added\n\n- Add a =flake.nix= file to provide a development shell for\n  [[https://nixos.org/][Nix]] users.\n  - PR: https://github.com/200ok-ch/organice/pull/987\n\n* [2023-11-15 Wed]\n\n** Added\n\n- Ability to print all content (including below the fold)\n  - PR: https://github.com/200ok-ch/organice/pull/969\n    \n* [2023-08-29 Tue]\n\n** Added\n\n- Capture template variable =%y= expanding to the raw year\n  - PR: https://github.com/200ok-ch/organice/pull/964\n\n** Fixed\n\n- Using a capture template that is available from all Org files, but should always capture to just one file (not necessarily the currently open one).\n  - PR: https://github.com/200ok-ch/organice/pull/965\n\n* [2023-04-11 Tue]\n\n** Changed\n\n- Ticking a checkbox should only tick the checkbox, not enable the list item manipulating functions from =handleListItemSelect=.\n  - Relevant discussion: https://github.com/200ok-ch/organice/discussions/950\n  - PR: https://github.com/200ok-ch/organice/pull/951\n\n* [2023-04-10 Mon]\n\n** Fixed\n- Color of unchecked checkbox in a list\n  - PR: https://github.com/200ok-ch/organice/pull/949\n\n* [2023-04-03 Mon]\n\n** Added\n\n- Implements list manipulation functions\n  - PR: https://github.com/200ok-ch/organice/pull/945\n  - Thank you [[https://github.com/kjmatsuda][kjmatsuda]] for the PR\ud83d\ude4f\n    \n* [2023-01-28 Sat]\n\n** Fixed\n\n- On a header, don't cancel swipe due to vertical movements\n  - PR: https://github.com/200ok-ch/organice/pull/938\n  - Thank you [[https://github.com/neildavidforrest][neildavidforrest]] for the PR\ud83d\ude4f\n\n* [2023-01-09 Mon]\n\n** Fixed\n\n- Checking or unchecking a checkbox discards text with markup\n  - PR: https://github.com/200ok-ch/organice/pull/928\n  - Thank you [[https://github.com/saikiransathpadi][saikiransathpadi]] for the PR\ud83d\ude4f\n\n- Don\u2019t replace all leading =*= in the description\n  - Only when followed by a space, it would become a headline. Otherwise it\u2019s markup for bold text.\n  - PR: https://github.com/200ok-ch/organice/pull/931\n\n* [2023-01-05 Thu]\n\n** Fixed\n\n- Deadline overlay UI improvements\n  - PR: https://github.com/200ok-ch/organice/pull/925\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n\n* [2023-01-04 Wed]\n\n** Added\n\n- Configuration option for a default Org file on startup.\n  - By default, when you start organice, it will display your root\n    file directory. If you prefer to display a specific Org file\n    instead, you can select it in the [[https://organice.200ok.ch/settings][file settings]].\n\n- Option to display DEADLINE values (near the clocking value) on each headline\n  - The default for this option is false - so there is no change to the default behavior - until you enable this option via Settings.\n  - PR: https://github.com/200ok-ch/organice/pull/891\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n\n** Fixed\n\n- Rotation of table editor icons to reflect their action.\n  - PR: https://github.com/200ok-ch/organice/pull/890\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n\n- Prevent the user from invalidating her Org file by entering a description that leads with =*=\n  - If the user starts any line with a =*=, wanting to start a new list, it is immediately converted to a =-=.\n  - PR: https://github.com/200ok-ch/organice/pull/920\n  - Thank you [[https://github.com/saikiransathpadi][saikiransathpadi]] for the PR\ud83d\ude4f\n   \n\n** Changed\n\n- Disable auto-capitalization for search\n  - Before:\n    - When using the search or task list text inputs the Android/iOS keyboards automatically apply the shift key, meaning that the first character is capitalized.\n    - 99% of the time this is not what we want because:\n      - Having mixed case triggers a case sensitive search. This is quite confusing when I did not intentionally use capitalization, but it was added anyway. For example, I type \"and\", and it actually inputs and searches for \"And\", which yields no results.\n      - Many of the keywords in the search grammar are lower case, e.g., =deadline:=, =desc:=.\n  - Now: Auto-capitalization is turned off\n  - PR: https://github.com/200ok-ch/organice/pull/914\n  - Thank you [[https://github.com/neildavidforrest][neildavidforrest]] for the PR\ud83d\ude4f\n* [2022-12-03 Sat]\n** Fixed\n\n- Improve parser to read lines with multiple inline markup statements\n  - PR: https://github.com/200ok-ch/organice/pull/910\n  - Thank you [[https://github.com/lechten][lechten]] for the PR\ud83d\ude4f\n\n* [2022-12-02 Fri]\n** Added\n- Filtering by description\n  - PR: https://github.com/200ok-ch/organice/pull/907\n  - Thank you [[https://github.com/neildavidforrest][neildavidforrest]] for the PR\ud83d\ude4f\n* [2022-11-02 Wed]\n** Fixed\n- Use correct HTML anchor tag inside public.html <noscript>\n  - PR: https://github.com/200ok-ch/organice/pull/902\n  - Thank you [[https://github.com/josephmturner][josephmturner]] for the PR\ud83d\ude4f\n* [2022-07-08 Fri]\n** Fixed\n- When opening an Org file, show it from the top\n  - PR: https://github.com/200ok-ch/organice/pull/878\n- Changelog has a =Back= button in the HeaderBar\n  - PR: https://github.com/200ok-ch/organice/pull/882\n* [2022-07-06 Wed]\n** Fixed\n- Change log renders above previously opened view component\n  - PR: https://github.com/200ok-ch/organice/pull/869\n- Make HeaderBar sticky\n  - PR: https://github.com/200ok-ch/organice/pull/870\n* [2022-07-04 Mon]\n** Added\n- Setting to change textbox height in the description editor\n  - PR: https://github.com/200ok-ch/organice/pull/875\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n* [2022-06-30 Thu]\n** Changed\n- Upgrade Dropbox authentication flow: switch from OAuth to OAuth 2\n  and PKCE\n  - Rationale: Dropbox switched OAuth from long lived tokens to short\n    lived tokens.\n  - PR: https://github.com/200ok-ch/organice/pull/851\n* [2022-06-29 Wed]\n** Fixed\n- Undo looks like it is persisting changes, but it persisted old\n  state. Hence, reloading the file was bringing back the version of\n  the file before undoing.\n  - PR: https://github.com/200ok-ch/organice/pull/861\n** Changed\n- Simplify UX in task modal\n  - \"Change todo keyword set\" is now an explicit button. Also, it's\n    only shown when there is more than one todo keyword set configured\n    for the current Org file.\n  - Todo keywords can be selected and unselected on the same button.\n    No trash can necessary to unselect a todo keyword..\n  - PR: https://github.com/200ok-ch/organice/pull/862\n** Added\n- Ability to delete header from task modal.\n  - PR: https://github.com/200ok-ch/organice/pull/862\n* [2022-06-22 Wed]\n** Added\n- Ability to handle empty files\n  - This takes care of a big UX problem for users who solely rely on organice. So far, we've shown a parser error if the file is empty *or* if the file did not contain a headline.\n  - Now, if the user opens a file that is empty, or has no headlines, she will see the call to action to create a new headline.\n  - PR: https://github.com/200ok-ch/organice/pull/853\n* [2022-06-16 Thu]\n** Added\n- Capture template variables =%r= and =%R= expanding to raw timestamps\n  - PR: https://github.com/200ok-ch/organice/pull/838\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n\n* [2022-06-14 Tue]\n** Added\n- Create new file from file browser\n  - PR: https://github.com/200ok-ch/organice/pull/818\n* [2022-06-13 Mon]\n** Added\n\n- Specify default webDAV URL in .env file\n  - PR: https://github.com/200ok-ch/organice/pull/829\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n- Docker image recognizes env vars\n  - PR: https://github.com/200ok-ch/organice/pull/835\n  - see [[https://organice.200ok.ch/documentation.html#docker][doc]] for more information\n\n* [2022-06-03 Fri]\n** Removed\n- Google Drive support. This backend had a few issues:\n  1. We waited [[https://github.com/200ok-ch/organice/issues/127][for years for Google to put the Google Drive API into\n     production mode]]. Without that, only very few people were actually\n     allowed by Google to use organice with Google Drive. A lot of\n     time and effort went into this from quite a few of people. Even\n     Google employees tried to expedite from within Google, but to no\n     avail. The maintainers of organice gave up on this issue since\n     [[https://github.com/200ok-ch/organice/issues/127#issuecomment-655339244][July 2020 and announced]] that the support for Google Drive will be\n     removed unless someone steps up and takes over this task. Nobody\n     did in the two years since, so we're removing it.\n  2. [[https://github.com/200ok-ch/organice/issues/109][Replace integration of Google Drive through <script> include in index.html with NPM module]]\n  3. [[https://github.com/200ok-ch/organice/issues/107][Sign in to Google Drive from new versions of Chrome dysfunctional]]\n\n* [2022-06-01 Wed]\n** Added\n   - Proper Landing Page\n     - PR: https://github.com/200ok-ch/organice/pull/809\n* [2022-02-23 Wed]\n** Fixed\n   - [[https://organice.200ok.ch/documentation.html#in_buffer_settings][In-buffer settings]] can be in lowercase or uppercase. Before, they\n     had to be in uppercase.\n     - PR: https://github.com/200ok-ch/organice/pull/776\n   - Manifest for PWAs\n     - Before, the 'install' button did not appear for Android devices\n       and both Chrome and Firefox showed warnings for the manifest.\n     - Issue: https://github.com/200ok-ch/organice/issues/779\n     - PR: https://github.com/200ok-ch/organice/pull/781\n     - Thank you [[https://github.com/tbruckmaier][tbruckmaier]] for the PR\ud83d\ude4f\n\n* [2021-12-09 Thu]\n** Fixed\n   - Title editor text loss.\n     - Since the introduction of the semantic Title editor on [2021-11-22 Mon], if you modified the text of a title and then click a todo, the todo keyword got saved which triggers a rerender before the text got saved. Therefore the text is reset to the state it was in when the title editor was opened.\n     - This is fixed, now.\n* [2021-12-05 Sun]\n** Added\n   - *EPIC* Bookmark functionality for search\n     - After entering a search string, you can bookmark it using the \u2b50 button.\n     - Bookmarked search strings populate the suggestions if no search string is entered into the input field.\n     - Bookmarks are saved by context, so there are separate bookmarks for search, task-list, and refile.\n     - There are at most ten bookmarks for a context. Newly saved bookmarks are inserted at the top of the list. If the list gets too long, the last search strings are dropped. Duplicate bookmarks are dropped too. The list of bookmarks is ordered by last used.\n     - Bookmarks are unaware of file context. Therefore, you always have the same bookmarks.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/758\n* [2021-11-22 Mon]\n** Changed\n   - Title and Description fields are not edited as raw text by default.\n     - Instead, a semantic editor comes up when editing them.\n     - To edit raw values, click the 'edit' icon, again.\n   - Search and Task List open in one modal with tabs.\n     - Modal opens to \"Search\" by default, but remembers what was opened last.\n   - If there are open clocks, a third modal \"Clock List\" is added\n     that looks like \"Search\" for =clock:now= without the search input\n     field.\n   - Notes can be multi-line and are properly indented.\n* [2021-11-09 Tue]\n** Added\n   - Setting to respect OS light/dark-mode preferences\n     - organice already queried the OS for light/dark-mode preference. But changing the setting in organice would override the OS preference.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/749\n** Fixed\n   - Fix repeater adjusting time of date when using =.+=\n     - When repeaterUnit is not \"h\", hour and minutes are never touched.\n     - When repeaterUnit is \"h\", hour and minutes are set to n hour(s) from now (as it was already implemented before this fix).\n   - Relevant PR: https://github.com/200ok-ch/organice/pull/746\n* [2021-11-03 Wed]\n** Fixed\n   - Fix GitLab OAuth token refresh\n     - PR: https://github.com/200ok-ch/organice/pull/740\n     - Thank you [[https://github.com/chasecaleb][chasecaleb]] for the PR\ud83d\ude4f\n* [2021-11-01 Mon]\n** Added\n   - *EPIC* Add GitLab as a sync back-end\n     - PR: https://github.com/200ok-ch/organice/pull/734\n     - Thank you [[https://github.com/chasecaleb][chasecaleb]] for the PR\ud83d\ude4f\n* [2021-10-29 Fri]\n** Fixed\n   - Loading settings when using WebDAV as synchronization back-end\n     - PR: https://github.com/200ok-ch/organice/pull/727\n     - Thank you [[https://github.com/mcordell][mcordell]] for the PR\ud83d\ude4f\n\n* [2021-05-16 Sun]\n** Added\n   - Parse and preserve habit timestamp ranges\n     - A timestamp may have minimum and maximum ranges specified by using the syntax =.+2d/3d=, which says that you want to do the task at least every three days, but at most every two days.\n     - Upstream documentation:\n       https://orgmode.org/manual/Tracking-your-habits.html\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/674\n     - Thank you [[https://github.com/tomonacci][tomonacci]] for the PR\ud83d\ude4f\n\n* [2021-05-13 Thu]\n\n** Changed\n   - Agenda starts on Monday by default (as it does in Emacs Org mode)\n\n** Added\n   - Ability to set the \"Start of week for weekly agenda\" in the Settings\n     - Akin to the Emacs org mode variable =org-agenda-start-on-weekday=\n   - Relevant PRs:\n     - https://github.com/200ok-ch/organice/pull/676\n       - Thank you [[https://github.com/tomonacci][tomonacci]] for the PR\ud83d\ude4f\n     - https://github.com/200ok-ch/organice/pull/677\n\n* [2020-12-29 Tue]\n** Added\n   - *EPIC*: Multiple file support\n     - Agenda, Search, Task List, Refile and Capture Templates have the ability to work on multiple files.\n     - You can adjust the behavior for these on a file per file basis by creating \"file settings\" in the settings menu.\n\n   - *EPIC*: Offline file support\n     - Every file opened in organice will automatically be cached on your device.\n     - When visiting the file, again, it will immediately be loaded from the local storage and then loaded from the remote back-end.\n     - That makes loading and switching between files instant _and_ gives you the ability to work on multiple files when being offline.\n\n   - Relevant PRs:\n     - https://github.com/200ok-ch/organice/pull/550\n     - https://github.com/200ok-ch/organice/pull/560\n     - https://github.com/200ok-ch/organice/pull/565\n     - https://github.com/200ok-ch/organice/pull/574\n     - https://github.com/200ok-ch/organice/pull/575\n     - https://github.com/200ok-ch/organice/pull/570\n     - https://github.com/200ok-ch/organice/pull/607\n\n* [2020-11-21 Sat]\n\n** Added\n   - When going to the Agenda view, the selected tab is persisted - meaning it will be pre-selected when you go to the Agenda next time.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/562\n\n** Fixed\n   - Having an active timestamp with a repeater was broken.\n     - When the TODO state changes for a header that has a repeater (either as SCHEDULED, DEADLINE or active timestamp), a log entry is written and the timestamp is updated.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/568\n   - Removing an active timestamp was broken.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/568\n\n* [2020-11-20 Fri]\n** Fixed\n   - organice understands =:PROPERTIES:= drawers and smartly parses the values in case one of the values is a timestamp.\n     - However, parsing all the values and saving the parsed result in any case will lead to wrong results. Most values of properties are just plain text and non-interactive things in Org mode.\n     - For example, a value like =something_with_underscores= would have been treated as 'underlined text' which doesn't make sense for a property drawer. When saving the value back, organice would have squashed the underlines.\n     - Now, the values are used and preserved as they are. Timestamps still work, of course.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/578\n* [2020-11-15 Sun]\n** Fixed\n   - When repeating a task, an active date timestamp was logged instead of an inactive datetime timestamp.\n\n* [2020-11-14 Sat]\n** Fixed\n   - The task list was not scrollable on Android.\n      - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/561][PR]] \ud83d\ude4f\n\n* [2020-11-08 Sun]\n** Changed\n   - Safeguard against selecting text by accident.\n      - Before this change, it was possible to select text when doing a 'swipe'.\n      - Now, selecting/copying text is only possible in 'edit mode', effectively safeguarding against accidentally selecting text.\n      - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/557][PR]] \ud83d\ude4f\n\n\n* [2020-11-06 Fri]\n** Added\n   - Additional themes. You now can choose between:\n     - Solarized\n     - One\n     - Gruvbox\n     - Smyck\n     - Code\n   - All of these are themes work in light and dark mode!\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/540][PR]] \ud83d\ude4f\n\n* [2020-11-01 Sun]\n\n** Changed\n   - We have enabled some default settings by default, because they are reasonable for a new user:\n     - =shouldStoreSettingsInSyncBackend=, because it enables using organice on multiple clients.\n     - =shouldLiveSync=, because it reduces the chance to have a conflict in the open Org file.\n     - =shouldSyncOnBecomingVisibile=, because it reduces the chance to have a conflict in the open Org file.\n   - =bulletStyle= is set to \"Fancy\", because it looks more visually pleasing than an asterisk (*) and hence makes organice look better on a first test run.\n   - If you personally do not want them enabled, you can disable them separately in the [[/settings][settings]] any time.\n\n** Fixed\n   - organice has various settings that the user can configure. Before manual configuration, there organice loads sane defaults. Loading and persisting some of these defaults was buggy before.\n     - Loading and persisting of defaults works now.\n     - Previously saved wrong values are removed from =localStorage= to reduce future bug potential.\n     - Changing this is - strictly speaking - not visible to the end-user, so it wouldn't ordinarily show up in this changelog. However, since it makes changes to the already saved settings (in cleaning up old faulty values), it theoretically could introduce a bug in the settings. Hence, the change is added to the changelog.\n     - Related PRs:\n       - https://github.com/200ok-ch/organice/pull/552\n       - https://github.com/200ok-ch/organice/pull/553\n       - https://github.com/200ok-ch/organice/pull/554\n* [2020-10-25 Sun]\n** Changed\n   - The 'focus header' feature is renamed.\n     - /Narrowing/ means focusing on this header, making the rest temporarily inaccessible.\n     - Canceling the narrowing, which makes all headers once again accessible, is called /widening/.\n* [2020-10-23 Fri]\n** Added\n   - Add 'dark mode' next to 'light mode' as a setting.\n     - Both themes are based on the popular [[https://ethanschoonover.com/solarized/][Solarized]] color palette.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/527][PR]] \ud83d\ude4f\n   - Add 'recursive clock times in search'.\n     - The =clock:= search term now includes headers that have time logged on their children.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/524][PR]] \ud83d\ude4f\n\n* [2020-10-20 Tue]\n** Added\n   - Add 'time range' queries to search for planning items (SCHEDULED and DEADLINE), plain active timestamps or clocked work time.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/505][PR]] \ud83d\ude4f\n* [2020-10-19 Mon]\n** Added\n   - When a header is focused, and the user uses the 'search' or 'task list' feature, then the searched header list is automatically narrowed to only subheaders of the originally focused header.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/517][PR]] \ud83d\ude4f\n* [2020-10-10 Sat]\n** Added\n   - Display time summaries for clock entries in each subtree\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/497][PR]] \ud83d\ude4f\n\n** Changed\n\n   - Improve header stickiness\n     - The header bar was not always sticky for longer documents and the therefore some functionality was hard to reach (the user had to scroll to the top to reach it).\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/499][PR]] \ud83d\ude4f\n\n* [2020-10-07 Wed]\n** Added\n\n   - Added Documentation on [[https://orgmode.org/manual/Repeated-tasks.html][repeaters]] and [[https://orgmode.org/manual/Deadlines-and-scheduling.html#Deadlines-and-scheduling][delays]] to =sample.org= and to mouseovers for the relevant buttons.\n\n* [2020-09-20 Sun]\n** Added\n\n   - Recognize US and Swiss phone numbers and make them clickable\n   - Next to 'canonical' phone numbers like +49123456789, also recognize:\n     - US phone numbers:\n       - 123-456-7890\n       - (123) 456-7890\n       - 123 456 7890\n       - 123.456.7890\n       - +91 (123) 456-7890\n     - Swiss phone numbers:\n       - 0783268674\n       - 078 326 86 74\n       - 041783268675\n       - 0041783268674\n       - +41783268676\n       - +41783268677\n\n* [2020-09-07 Mon]\n** Added\n   - Added the capability to chose the start screen when installing organice to the homescreen.\n     - More information on how to install organice like this, see https://organice.200ok.ch/documentation.html#installation\n* [2020-09-05 Sat]\n\n** Fixed\n  - Search and Todo List modals could be moved off screen on iOS since [2020-08-30 Sun]. The fix is to disable =autoFocus= on iOS. The rationale for that documented here: https://github.com/200ok-ch/organice/pull/462\n\n* [2020-08-30 Sun]\n\n** Added\n   - Add note to header (=M-x org-add-note=)\n     - This adds a button for taking notes to tasks (org-add-note). They will be prepended to the header contents after :PROPERTIES: and before the :LOGBOOK:\n   - Auto-focus filter input fields (search and task-list)\n\n* [2020-08-29 Sat]\n** Fixed\n   - If a user folds a header, all its subheaders should collapse as well, so that when the user reopens it, they stay closed.\n     - The previous behavior is buggy in a way that it keeps the subheaders open as they were, restoring their openness when the header is unfolded.\n     - The previous behavior is useful, though. So this change introduces a user setting to toggle the behaviour.\n   - Thank you [[https://github.com/necto][necto]] for your [[https://github.com/200ok-ch/organice/pull/440][PR]] \ud83d\ude4f\n\n* [2020-08-25 Tue]\n** Fixed\n   - Updating table cell values and removing table rows or colums was\n     not undoable\n     - Thank you [[https://github.com/necto][necto]] for your [[https://github.com/200ok-ch/organice/pull/432][PR]] \ud83d\ude4f\n\n* [2020-07-28 Tue]\n** Fixed\n   1. Sync stuck when working in the background\n     - When the user put organice into the background during a sync and comes back, organice was stuck in sync mode, but doesn't actually sync anymore. This means that any new changes to the Org file will not be persisted. This is due to mobile browsers cutting off most resources to browser apps in the background, so organice cannot guarantee that a sync happens properly in the background.\n     - It's not trivial to find out if the job is stuck\n       - Time is not a good indicator as bigger files on slower connections will always take longer.\n       - There's no JS API to reliably find out if the browser just got back from the background or is put into the foreground. The [[https://developer.mozilla.org/en-US/docs/Web/API/Page_Visibility_API][=visibilitychange= API]] just triggers for both these events.\n     - Hence, the implementation is generic in nature: Whenever the user hits the 'sync' button, an actual 'sync' is forced - even if organice thinks there's currently a sync in progress or that it should be debounced. That makes sense, because manual actions by the user should always be obeyed.\n     - Closes issue https://github.com/200ok-ch/organice/issues/252\n   - 2. On iOS >13.1, when organice is used in SPA mode (as a bookmark on the homescreen), and the user navigates away from the original bookmark, a huge URL Bar would show up with a \"Done\" button. This is a regression in how iOS handles full-screen SPAs. These are the relevant APIs:\n     - https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html\n     - https://developer.mozilla.org/en-US/docs/Web/Manifest/display\n   - 3. Feature detection for =crypto.subtle= module\n     - This is used for change detection in the changelog. The module is only available in secure contexts. Hence, when used locally and on a private IP range, depending on the browser, it might not be available.\n\n* [2020-07-08 Wed]\n** Added\n   - Allow template-variables in the header-path in a capture template\n     - Thank you [[https://github.com/jayesh-bhoot][jayesh-bhoot]] for your [[https://github.com/200ok-ch/organice/pull/387/][PR]] \ud83d\ude4f\n* [2020-06-14 Sun]\n** Added\n   - Allow capture templates to insert at beginning or end of file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/324][PR]] \ud83d\ude4f\n* [2020-06-05 Fri]\n** Fixed\n   - =file:= links are sanity checked before opened\n     - =file:= links opened in iOS from the PWA view will not open Mobile Safari\n     - Open issue: Some links will be opened as directories when the\n       link is not really going towards a directory.\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/311][PR]] \ud83d\ude4f\n\n* [2020-06-03 Wed]\n** Added\n   - =TODO= keyword sets can now be anywhere in the file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/310][PR]] \ud83d\ude4f\n* [2020-05-30 Sat]\n\n** Added\n   - Make local =file:...= links navigate to the relevant file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/307][PR]] \ud83d\ude4f\n\n* [2020-05-06 Wed]\n\n** Fixed\n   - Planning items now respect the new hard-indent setting.\n\n* [2020-05-05 Tue]\n\n** Fixed\n   - Append new tags correctly to title.\n     - If a header didn't have tags before, the first tags were\n       erroneously appended without a space.\n\n* [2020-04-06 Mon]\n\n** Added\n   - Support org-adapt-indentation\n     - By default, the metadata body (including deadlines and drawers) of an exported org heading is indented according to its level. If instead you prefer to keep your body text flush-left, i.e.{' '}\n     - Thank you [[https://github.com/cpbotha][cpbotha]] for your [[https://github.com/200ok-ch/organice/pull/272][PR]] \ud83d\ude4f\n\n* [2020-04-05 Sun]\n** Added\n   - Support for org-log-into-drawer TODO state logging\n     - Thank you [[https://github.com/cpbotha][cpbotha]] for your [[https://github.com/200ok-ch/organice/pull/271][PR]] \ud83d\ude4f\n** Fixed\n   - Settings screen has proper title and \"back\" button\n\n* [2020-03-27 Fri]\n** Fixed\n   - Help texts for widen/narrow were reversed\n     - Thank you [[https://github.com/obar][@obar]] for the [[https://github.com/200ok-ch/organice/pull/270][PR]] \ud83d\ude4f\n\n* [2020-02-29 Sat]\n\n** Fixed\n   - As a user, when I visit Search, Task List or Agenda whilst having\n     a dirty file, I'm not getting a pop up a dialogue notifying me\n     about unpushed changes\n\n* [2020-02-17 Mon]\n\n** Added\n   - *Headers with active timestamps in the header or description appear in agenda*\n\n** Fixed\n   - 'Insert timestamp' for headers and descriptions\n\n* [2020-02-09 Sun]\n\n** Added\n   - Comprehensive documentation: https://organice.200ok.ch/documentation.html\n     - You can find the link from the 'settings' screen or on top of\n       the readme.\n\n* [2020-01-27 Mon]\n\n** Fixed\n   - When editing a =:LOGBOOK:= drawer within a headers description,\n     the relevant logbook entries are updated (which might entail them\n     being deleted).\n\n* [2020-01-20 Mon]\n\n** Fixed\n   - When refiling a header, don't show subheaders in the refile drawer\n   - When doing a 'Search' or 'Refile', the action is reflected in the\n     name of the opening drawer.\n   - In the agenda view, fix relative time distance for future dates\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/240][PR]] \ud83d\ude4f\n\n* [2020-01-15 Wed]\n\n** Fixed\n   - Put Floating Action Button \"Move a header\" into the middle of the\n     screen, so that it has enough space to render all arrows on\n     mobile devices.\n\n* [2020-01-14 Tue]\n\n** Added\n   - Notify on changes for changelog\n     - This is done with a similar UX than other productivity apps\n       (like Slack) do it. The user will see a 'gift' icon whenever\n       there's a change to the changelog she has not seen, yet.\n\n* [2020-01-13 Mon]\n\n** Added\n   - \"Show Org filename in Header\" is configurable in settings and\n     off by default\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/229][PR]] \ud83d\ude4f\n\n** Fixed\n   - Show error message when using a capture template with a badly\n     configured header path\n\n* [2020-01-12 Sun]\n\n** Added\n   - Make HeaderBar sticky\n     - Making undo/redo, file browser and help always available\n       (before it was required to scroll all the way to the top)\n   - Deselect headline by clicking into the title (or empty space) in\n     the HeaderBar\n   - Show Org filename in Header\n\n** Fixed\n   - *Major synchronization improvements*\n     1. After undo/redo, synchronize Org file\n     2. Debounce Sync\n        1. When a user changes things quickly (which happens easily\n           when having 'live sync' enabled and using undo/redo for\n           example), multiple syncs ran in parallel. The back-ends\n           will either get confused or fail with errors (429 too many\n           write operations). In any case, likely the last written\n           state would not have been the state of the Org file in\n           organice.\n     3. Safeguard against concurrent sync requests to the back-end\n     4. In case of synchronization error, show the error to the user\n        and retry synchronization\n     5. Don't actually sync a whole Org file for an empty header.\n        When the user adds some data and triggers\n        UPDATE_HEADER_TITLE, then it makes sense to save it.\n\n* [2020-01-11 Sat]\n\n** Added\n   - All HeaderActionItems are undoable and redoable\n\n** Fixed\n   - Parsing planning items followed by a checkbox\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/222/files][PR]] \ud83d\ude4f\n* [2020-01-07 Tue]\n\n** Added\n   - *Refile*\n     - When reviewing the captured data, you may want to refile or to\n       copy some of the entries into a different list, for example\n       into a project.\n   - Add button in HeaderActionBar to open property editor\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/195][PR]] \ud83d\ude4f\n\n** Changed\n   - All HeaderActionDrawer actions have icons. The icons are\n     documented in sample.org and have a mouseover title.\n\n* [2020-01-04 Sat]\n\n** Added\n   - Ability to search headlines\n     - It has the same syntax as the search field in the Task List\n       feature\n\n** Fixed\n   - Sort order in Task List\n     - Tasks were only ordered by their planning item dates. This\n       implied that tasks that were long DONE would be shown first.\n     - Now, tasks in the Task list are sorted by state and then date.\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/207][PR]] \ud83d\ude4f\n\n\n* [2020-01-02 Thu]\n\n** Added\n   - Place cursor after the TODO keyword when creating a new header\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/193][PR]] \ud83d\ude4f\n   - Highlight verbatim markup\n\n** Changes\n   - Highlight cookies and cookie percentages according to Solarized\n     color scheme\n\n** Fixed\n   - Don't update search results when using an invalid search filter\n   - On mobile: Styling of Search / Task List drawer when searching all\n     headlines\n   - On mobile: Ability to scroll Search / Task List\n   - Teach #+TODO parser to understand (..) suffix\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/202][PR]] \ud83d\ude4f\n\n* [2020-01-01 Wed]\n\n** Added\n   - Support single- and double-quoted strings in the search filter\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/176][PR]] \ud83d\ude4f\n   - Trim whitespace for entered or updated headlines\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/177][PR]] \ud83d\ude4f\n\n** Fixed\n   - Capture templates in iOS 13.3 are positioned properly\n     - iOS 13 introduced a styling regression when setting focus\n       without user interaction. iOS 13.3 reverts to the way other\n       browsers do it.\n\n** Changed\n   - Revert \"Move HeaderActionDrawer before headline\"\n     - As per #188, the changes introduced in #100 didn't fare well\n       with the community. Hence, as a first step to improve UX,\n       we're reverting to the previous state.\n\n* [2019-12-31 Tue]\n\n** Added\n   - *Searching of headlines/todos with a composable query language*\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/154][PR]] \ud83d\ude4f\n   - Routing for Settings (/settings) and Sample (/sample)\n   - Routing for Agenda and TaskList\n\n** Changes\n   - The action for capture templates now uses a more idiomatic\n     'plus' icon instead of a 'list' icon\n\n* [2019-12-28 Sat]\n\n** Added\n   - Proper coloring of DONE todoKeywords from custom todo sequences\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/165][PR]]!\n   - Place TODO keyword of previous header in the new header\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/164][PR]]!\n\n** Changed\n   - Refactor current Org parser and regex\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/161][PR]]!\n\n* [2019-12-26 Thu]\n\n** Added\n\n   - \"Share\" button for headlines (sharing via email)\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/145][PR]]!\n   - Automatically render links for URLs with www prefix, but without\n     protocol\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/159][PR]]!\n\n* [2019-12-25 Wed]\n\n** Added\n\n   - Suggestion list for inputs in property editor\n     - To minimize typing and typos, add smart completion for property\n       names and values in the PropertyListEditorModal.\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/144][PR]]!\n\n* [2019-12-24 Tue]\n** Added\n\n   - *Automatically render links for URLs, e-mail addresses and phone\n     numbers*\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/147][PR]]!\n\n   - Suggestion list for inputs in tag editor\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/149][PR]]!\n\n* [2019-12-17 Tue]\n** Changed\n   - Improve webdav url input\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/139][PR]]!\n** Fixed\n   - Make \"privacy policy\" sticky to the bottom of the landing page\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/140][PR]]!\n\n* [2019-12-15 Sun]\n\n** Changed\n   - UX: Move Org header actions before selected headline\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/136][PR]]!\n\n** Fixed\n   - Android PWA implementation was broken (issue [[https://github.com/200ok-ch/organice/issues/134][#134]])\n     - It required two more icon sizes\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/135][PR]]!\n\n* [2019-12-10 Tue]\n\n** Added\n\n   - *Docker Support*\n   - The CI/CD workflow now also builds a Docker container which is\n     then published to\n     https://hub.docker.com/repository/docker/twohundredok/organice\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/133][PR]]!\n\n* [2019-12-08 Sun]\n\n** Added\n\n   - As a user, when I'm on a headline with a planning item (schedule\n     or deadline), I want to be able to remove it.\n\n* [2019-11-29 Fri]\n\n** Fixed\n\n   - Clicking the Timestamp in a TODO within the agenda toggles from\n     the date to a human readable timespan\n\n* [2019-11-27 Wed]\n\n** Added\n\n   - Instructions on configuring Nextcloud+haproxy to allow WebDAV\n   - Documentation on how to share from Nextcloud using WebDAV\n   - Thank you [[https://github.com/runejuhl][runejuhl]] for your [[https://github.com/200ok-ch/organice/pull/122][PR]]!\n\n* [2019-11-25 Mon]\n\n** Added\n   - Honor the 'nologrepeat' option\n     - It can be set via =#+STARTUP:= or as a property\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/119][PR]]!\n\n* [2019-11-22 Fri]\n\n** Fixed\n\n   - Handle non-clock entries in =:LOGBOOK:= drawers\n     - Fixes [[https://github.com/200ok-ch/organice/issues/111][issue #111]], [[https://github.com/200ok-ch/organice/issues/108][issue #108]] and [[https://github.com/200ok-ch/organice/issues/110][issue #110]]\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/112][PR]]!\n\n* [2019-11-21 Thu]\n\n** Fixed\n\n   - Safeguard against potential Dropbox SDK Bug\n     - More information in [[https://github.com/200ok-ch/organice/issues/108][issue #108]]\n\n* [2019-11-19 Tue]\n\n** Changed\n\n   - Don't put newlines after headers with no content, add newline at EOF\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/106][PR]]!\n\n* [2019-11-14 Thu]\n\n** Added\n\n   - *Clocking work time*\n     - Org mode allows you to clock the time you spend on specific\n       tasks in a project:\n       https://orgmode.org/manual/Clocking-Work-Time.html#Clocking-Work-Time\n     - organice is compatible with logbook clocking, now\n     - You can 'clock in' and 'clock out' to a header\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/103][PR]]!\n\n* [2019-10-31 Thu]\n\n** Fixed\n   - Keep all in-file settings and content lines from top of file\n     - Thank you [[https://github.com/andersjohansson][@andersjohansson]] for your [[https://github.com/200ok-ch/organice/pull/90][PR]]!\n\n* [2019-10-29 Tue]\n\n** Added\n   - Show login options as clickable links with cursor pointer\n   - Also improve wording with regards to login options\n     - Thank you [[https://github.com/rodrigomaia17][@rodrigomaia17]] for your [[https://github.com/200ok-ch/organice/pull/88][PR]]!\n\n\n* [2019-10-26 Sat]\n\n** Added\n   - *WebDAV as a sync backend!*\n     - Thank you [[https://github.com/TristanCacqueray][@TristanCacqueray]] for your [[https://github.com/200ok-ch/organice/pull/82][PR]]!\n\n   - As a user, when I swipe a header, I want the icon to contrast\n     the background, so that better see the action taken\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/78][PR]]!\n\n   - As a user, when I hover a clickable element, I want my cursor to\n   change, so that I can see that it is clickable.\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/79][PR]]!\n\n** Fixed\n   - Do not throw an error when clearing a planning item\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/81][PR]]!\n\n* [2019-10-02 Wed]\n\n** Fixed\n\n- On iOS 13, fix the regression which made capture input fields hide\n  under the keyboard\n  - More information and screenshots in the ticket: https://github.com/200ok-ch/organice/issues/46\n  - Turns out this issue is non trivial to fix and requires specific\n    rules for every size of iPhone. I tested against the Xs and 6s. If\n    you have a different form factor and the capture template input\n    screen looks off to you, please send me a screenshot of what it\n    looks like and I'll add the dimensions for your form factor right\n    away!\n\n* [2019-09-28 Sat]\n\n** Added\n\n- Implemented a =redo= Button next to the =undo= button\n\n* [2019-09-21 Sat]\n\n** Fixed\n\n- Parser bug which would interpret *bold* statements in the beginning\n  of a line as a header.\n- Parser bug which would delete newlines between headers and items\n\n** Changed\n\n- @MTrost [[https://github.com/200ok-ch/organice/pull/45][introduced]] a new testing library called [[https://testing-library.com/docs/intro][React Testing\n  Library]] which greatly simplified writing interaction tests.\n\n* [2019-09-19 Thu]\n\n** Changed\n\n- Constraining to a max width and centering for tablets and bigger\n\n* [2019-09-15 Sun]\n\n** Fixed\n\n- The 'Sync on application becoming visible' feature works on iOS and\n  Safari\n  - If enabled, the current org file is pulled from the sync backend\n    when the browser tab becomes visible. This prevents you from\n    having a stale file before starting to make changes to it.\n\n* [2019-09-08 Sun]\n** Added\n\n- Documented how to use organice from a bookmarklet using the capture\n  template feature\n\n* [2019-09-06 Fri]\n** Fixed\n\n- Removed Google Analytics tracking, because it has no place here\n\n* [2019-09-02 Mon]\n\n** Added\n\n- Configure Google Drive for the free community version of organice at\n  https://organice.200ok.ch\n- Documented SPA routing for self-hosting\n- Wrote and publicized a Privacy Policy\n\n* [2019-08-27 Tue]\n\n** Changed\n\n- Color scheme has been ported to the popular [[https://ethanschoonover.com/solarized/][Solarized]] (light mode)\n  - Whilst doing so, CSS variables have been introduced, so that\n    there's not a whole lot of repetition of magic rgb values going on\n  - The logo has been adapted, too\n- The landing page and settings screens have been de-cluttered\n\n* [2019-08-26 Mon]\n\n** Added\n\n- Continuous deployment: Merging to =master= triggers a build on CI\n  and when successful, it triggers a deploy to https://org.200ok.ch\n- Add a new temporary\u2122 logo: [[file:public/organice.png][organice.png]]\n\n* [2019-08-25 Sun]\n\n** Added\n\n- Since we want organice to be a community driven project, we have added:\n  - [[file:CODE_OF_CONDUCT.org][Code of conduct]]\n  - [[file:CONTRIBUTING.org][Contributing guidelines]]\n\n- Add [[https://circleci.com/][CircleCI]] to run the tests on every commit\n  - They are also integrated as a check for PRs with the benefit that\n    contributors get automated feedback by running the regression test\n    suite.\n\n- Add [[https://greenkeeper.io][Greenkeeper]] for automated dependency management\n\n- Add [[https://codeclimate.com][Codeclimate]] for automated maintainability analysis\n\n** Changed\n\n- Upgraded to Node 12.9\n\n* [2019-08-12 Mon]\n\n** Changed\n\n- The default keybindings (when used from a desktop browser) are now\n  more in line with the defaults in Emacs itself\n\n** Fixed\n\n- The keybindings work on non-macOS operating systems\n\n* [2019-08-10 Sat]\n\n** Added\n\n- As a user, when in a directory listing, I want the folders and files\n  to be sorted alphabetically. Furthermore, I only want to see files\n  that organice can open (that is org and org archive files).\n- Note: This is only implemented for the Dropbox back-end at this time.\n\n** Changed\n\n- Filters files from a directory listing down to org files.\n- Sorts folders atop of files.\n- Sorts both folders and files alphabetically.\n\n\n* [2019-08-05 Mon]\n\n** Added\n\n- When the browser tab becomes visible, pull the latest version of the\n  Org file\n  - This is rather helpful when the app is used in production. Since\n    the production build supports loading the complete application and\n    org-file from cache, it can be open for a very long time. When the\n    org-file hasn't been pulled in a \"very long time\"\u2122, then chances\n    are non-nil that the file has been changed by another client in\n    the meantime.\n  - Without this change, when the user opens the app after a while,\n    makes changes to the file and wants to sync to the back-end, there\n    might be the message \"Since you last pulled, a newer version of\n    the file has been pushed to the server.\". Now the user has two\n    conflicting versions of the same file and can only chose to keep\n    one (Which in itself is great UX and great error handling for\n    cases in which we do encounter a merge conflict, of course!).\n  - This situation is mitigated with this change. Now the user has the\n    option to enable \"Sync on application becoming visible\" which acts\n    similarly to \"Live Sync\". When the user opts to use this feature,\n    whenever the application gets pulled from the background or\n    started through the service worker, the first thing that happens\n    it that a new version of the org-file is pulled from the server.\n    It's therefore much harder for the user to create conflicts.\n\n* [2019-08-04 Sun]\n\n** Fixed\n\n- Parser doesn't break indentation of existing files in fewer places\n- Planning Items are formatted as in Emacs Org mode\n- Properties are formatted as in Emacs Org mode\n- Tags are formatted as in Emacs Org mode\n\n\n* [2019-08-03 Sat]\n\n** Added\n\n- Documented deployment options\n  - People have been asking for tighter access restrictions.\n  - Imo the best answer to that request is to make it as easy as\n    possible to host organice.\n  - There's myriads of good options, of course. I picked to document\n    two that will (potentially) be cost-free to the users and which\n    are very easy and quick to set up: Ftp and Heroku.\n\n** Fixed\n\n- Tests on =master= were red\n  - Partly due to obsolete tests\n  - Partly because tests weren't updated according to changes in the code\n".split("").map((e=>e.charCodeAt(0))),new Promise(((e,t)=>{crypto.subtle?crypto.subtle.digest({name:"SHA-256"},new Uint8Array(n)).then((t=>{e(b.a.values(new Uint8Array(t)).join(""))})):(console.warn("crypto.subtle module is not available, returning an empty bogus hash."),e(""))}))).then((t=>{e(t)}))})),ae=(e,t)=>{const n=ie(e,t);return{headerIndex:n,header:e.get(n)}},ie=(e,t)=>e.findIndex((e=>e.get("id")===t)),re=(e,t)=>e.get(ie(e,t)),se=(e,t)=>{const n=e.get(t),a=e.slice(t+1).findIndex((e=>e.get("nestingLevel")<=n.get("nestingLevel")));return-1===a?[t+1,e.size]:[t+1,t+1+a]},oe=(e,t)=>{const n=ie(e,t);return se(e,n)},le=(e,t)=>{let[n,a]=se(e,t);return e.slice(n,a)},ce=(e,t)=>{let[n,a]=oe(e,t);return e.slice(n,a)},de=(e,t)=>ce(e,t).size,he=(e,t)=>{const{header:n,headerIndex:a}=ae(e,t);for(let i=a-1;i>=0;--i){const t=e.get(i);if(t.get("nestingLevel")===n.get("nestingLevel")-1)return t;if(t.get("nestingLevel")<n.get("nestingLevel"))return null}return null},ue=(e,t)=>{const{header:n,headerIndex:a}=ae(e,t),i=e.slice(0,a).findLast((e=>e.get("nestingLevel")<n.get("nestingLevel")));return i?i.get("id"):null},pe=(e,t,n)=>{const a=e.getIn([t,"propertyListItems"]).find((e=>e.get("property")===n));if(a)return a.get("value");const i=ue(e,e.getIn([t,"id"]));if(i){const t=ie(e,i);return pe(e,t,n)}return null},me=(e,t)=>{const n=ue(e,t);if(!n)return!0;const a=re(e,n);return a.get("opened")&&me(e,a.get("id"))},ge=(e,t)=>{const n=((e,t)=>{const n=he(e,t);return n?n.get("id"):null})(e.get("headers"),t);if(null!==n){const t=ie(e.get("headers"),n);e=e.setIn(["headers",t,"opened"],!0)}return e},fe=e=>{let t=[];for(let n=0;n<e.size;++n){const a=e.get(n);if(!a.get("opened"))continue;const i=a.getIn(["titleLine","rawTitle"]),r=ce(e,a.get("id")),s=fe(r);s.length>0?s.forEach((e=>{t.push([i].concat(e))})):t.push([i]),n+=r.size}return t},be=e=>{const t=e.org.present.get("path"),n=e.org.present.getIn(["files",t],Object(y.Map)()),a=n.get("selectedHeaderId"),i=n.get("headers");if(!i)return null;const r=ie(i,a);return-1===r?null:n.getIn(["headers",r])},ye=(e,t)=>{if(0===t.size)return null;const n=e.find((n=>null===ue(e,n.get("id"))&&n.getIn(["titleLine","rawTitle"]).trim()===ee(t.first())[0].trim()));if(!n)return null;if(1===t.size)return n;const a=ce(e,n.get("id"));return ye(a,t.rest())},Ee=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0===t.size)return e;const a=t.first(),i=e.findIndex((e=>{const t=e.getIn(["titleLine","rawTitle"]),i=e.get("nestingLevel");return t===a&&i<=n}));if(-1===i)return e;e=e.update(i,(e=>e.set("opened",!0)));let r=ce(e,e.getIn([i,"id"]));return r=Ee(r,t.rest(),n+1),e=e.take(i+1).concat(r).concat(e.takeLast(e.size-(i+1+r.size)))},we=(e,t)=>e.get("contents").some((e=>e.get("contents").some((e=>e.get("id")===t)))),ke=(e,t)=>e.filter((e=>["table","list"].includes(e.get("type")))).some((e=>"table"===e.get("type")?we(e,t):e.get("items").some((e=>ke(e.get("contents"),t))))),ve=(e,t)=>e.find((e=>ke(e.get("description"),t))),Te=(e,t)=>e.map(((e,n)=>"timestamp"===e.get("type")&&e.get("id")===t?{path:[n],timestampPart:e}:"list"===e.get("type")?e.get("items").map(((e,a)=>{let i=Te(e.get("contents"),t);if(i){const{path:e,timestampPart:t}=i;return{path:[n,"items",a,"contents"].concat(e),timestampPart:t}}{let i=Te(e.get("titleLine"),t);if(i){const{path:e,timestampPart:t}=i;return{path:[n,"items",a,"titleLine"].concat(e),timestampPart:t}}return null}})).filter((e=>e)).first():"table"===e.get("type")?e.get("contents").map(((e,a)=>e.get("contents").map(((e,i)=>{const r=Te(e.get("contents"),t);if(r){const{path:e,timestampPart:t}=r;return{path:[n,"contents",a,"contents",i,"contents"].concat(e),timestampPart:t}}return null})).filter((e=>e)).first())).filter((e=>e)).first():null)).filter((e=>e)).first(),Se=(e,t)=>e.get("items").some((e=>e.get("id")===t)),_e=(e,t)=>e.map(((e,n)=>"list"===e.get("type")?e.get("items").map(((e,a)=>{if(e.get("id")===t)return{path:[n,"items",a],listItemPart:e};{const i=_e(e.get("contents"),t);if(i){const{path:e,listItemPart:t}=i;return{path:[n,"items",a,"contents"].concat(e),listItemPart:t}}return null}})).filter((e=>e)).first():null)).filter((e=>e)).first(),Ie=(e,t)=>e.map(((e,n)=>"table"===e.get("type")?we(e,t)?{path:[n],tablePart:e}:null:"list"===e.get("type")?e.get("items").map(((e,a)=>{const i=Ie(e.get("contents"),t);if(i){const{path:e,tablePart:t}=i;return{path:[n,"items",a,"contents"].concat(e),tablePart:t}}return null})).filter((e=>e)).first():null)).filter((e=>e)).first(),Ce=(e,t)=>e.map(((e,n)=>"list"===e.get("type")?Se(e,t)?{path:[n],listPart:e}:e.get("items").map(((e,a)=>{const i=Ce(e.get("contents"),t);if(i){const{path:e,listPart:t}=i;return{path:[n,"items",a,"contents"].concat(e),listPart:t}}return null})).filter((e=>!!e)).first():null)).filter((e=>!!e)).first(),De=(e,t)=>{const n=(e,t,n)=>({path:[e,...n].concat(t.path),timestampPart:t.timestampPart});return e.map(((e,a)=>{let i=["titleLine","title"],r=Te(e.getIn(i),t);return r?n(a,r,i):(i=["description"],r=Te(e.getIn(i),t),r?n(a,r,i):(i=["logNotes"],r=Te(e.getIn(i),t),r?n(a,r,i):(r=e.get("propertyListItems").map(((e,r)=>{if(!e.get("value"))return null;const s=Te(e.get("value"),t);return i=["propertyListItems",r,"value"],s?n(a,s,i):null})).filter((e=>e)).first(),r||null)))})).filter((e=>e)).first()},Ae=(e,t)=>e.map(((e,n)=>{const a=_e(e.get("description"),t);if(!a)return null;const{path:i,listItemPart:r}=a;return{path:[n,"description"].concat(i),listItemPart:r}})).filter((e=>e)).first(),Oe=(e,t,n)=>{const{path:a,tablePart:i}=((e,t)=>e.map(((e,n)=>{const a=Ie(e.get("description"),t);if(!a)return null;const{path:i,tablePart:r}=a;return{path:[n,"description"].concat(i),tablePart:r}})).filter((e=>e)).first())(e,t),r=i.get("contents").findIndex((e=>e.get("contents").some((e=>e.get("id")===t)))),s=i.getIn(["contents",r,"contents"]).findIndex((e=>e.get("id")===t));return e.updateIn(a.concat(["contents"]),n(r,s))},Ne=(e,t,n)=>{const{path:a,listPart:i}=((e,t)=>e.map(((e,n)=>{const a=Ce(e.get("description"),t);if(!a)return null;const{path:i,listPart:r}=a;return{path:[n,"description"].concat(i),listPart:r}})).filter((e=>!!e)).first())(e,t),r=i.get("items").findIndex((e=>e.get("id")===t));return e.updateIn(a.concat(["items"]),n(r))},Pe=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.size||"list"!==e.last().get("type")){const t=e.size;e=n?e.insert(t,n.set("id",w()).set("items",new y.List)):e.insert(t,Object(y.fromJS)({type:"list",id:w(),items:[],bulletCharacter:"-",numberTerminatorCharacter:null,isOrdered:!1}))}return e.map((e=>"list"===e.get("type")?e.update("items",(e=>e.push(t))):e))},Le=(e,t)=>{if(!e)return null;const n=Te(e,t);return n?n.timestampPart:null},Re=e=>Object(E.a)(e,{addSuffix:!0}),xe=(e,t)=>e.find((e=>e.get("keywords").contains(t)))||e.first(),Me=e=>e.flatMap((e=>e.getIn(["titleLine","tags"]))).toSet().sort(),Fe=e=>e.map((e=>e.get("propertyListItems").map((e=>{const t=e.get("property"),n=e.get("value");return[t,q(n)]})))).filter((e=>!e.isEmpty())).flatten(),He=e=>e.map((e=>{let[t]=e;return t})).toSet().sort(),je=(e,t)=>e.filter((e=>{let[n]=e;return n.toLowerCase()===t.toLowerCase()})).map((e=>{let[t,n]=e;return n})).toSet().sort(),Be=e=>e.get("rawDescription")||!e.get("planningItems").isEmpty()||!e.get("propertyListItems").isEmpty()||!e.get("logNotes").isEmpty()||!e.get("logBookEntries").isEmpty(),Ve=e=>t=>e.some((e=>e.get("completedKeywords").includes(t))),Ue=e=>!e.get("type").startsWith("TIMESTAMP_"),We=e=>Ue(e)?e.get("type"):"TIMESTAMP",ze=/\.org(_archive)?$/,Ge=(e,t,n)=>{const a=he(e,n);return a?(t.unshift(a.get("titleLine").get("rawTitle")),Ge(e,t,a.get("id"))):t},$e=(e,t)=>{const n=e.get(t);let a;return a=t.startsWith(te)?t.substring(18):t.endsWith(".org")?t.substring(t.lastIndexOf("/")+1,t.lastIndexOf(".")):t.substring(t.lastIndexOf("/")+1),e=>{let t=(i=n,r=e.get("id"),Ge(i,[],r));var i,r;t.unshift(a);const s=Math.max(3,Math.floor((80-3*t.length)/t.length));return t=t.map((e=>e.length>s?e.substr(0,s-2)+"..":e)),t.join(" > ")}},Ke=e=>({type:"SET_LOADING_MESSAGE",loadingMessage:e}),Ye=()=>({type:"HIDE_LOADING_MESSAGE"}),Je=(e,t)=>({type:"SET_IS_LOADING",isLoading:e,path:t}),qe=e=>({type:"SET_IS_ONLINE",online:e}),Xe=(e,t)=>n=>{n(Ke(e)),setTimeout((()=>n(Ye())),t)},Ze=e=>({type:"SET_LAST_VIEWED_FILE",lastViewedPath:e}),Qe=(e,t)=>n=>{n(Ze(t));n(Ri(te+e,{changelog:"# organice will not reflow if there's hard-wrapped content\n# -*- eval: (auto-fill-mode 0) -*-\n\n* General\n\nAll user visible changes to organice will be documented in this file.\n\nWhen there are updates to the changelog, you will be notified and see a 'gift' icon appear on the top right corner.\n\n* [2025-04-05 Sat]\n\n** Fixed\n\n- Create a static =/manifest.json=\n  - This improves the PWA experience for people self hosting organice\n  - PR: https://github.com/200ok-ch/organice/pull/1013\n\n* [2025-04-04 Fri]\n\n** Fixed\n\n- Prevent accidental horizontal swipes during vertical scrolling on iOS\n  - Improved touch handling to detect vertical scrolling intent and prevent unwanted horizontal swipe actions\n  - PR: https://github.com/200ok-ch/organice/pull/1012\n\n* [2024-11-11 Mon]\n\n** Changed\n\n- No UI/UX changes, but lots of tooling upgrades\n- Major version technical upgrades\n  - nodejs (from 12 to 20)\n  - Create React App (from 3 to 4)\n  - eslint (from 6 to 7)\n  - node-sass to sass\n- Minor version technical upgrades\n  - redux-undo\n  - React\n\nPRs:\n\n- https://github.com/200ok-ch/organice/pull/1000\n- https://github.com/200ok-ch/organice/pull/999\n- https://github.com/200ok-ch/organice/pull/998\n\n* [2024-11-09 Sat]\n** Fixed\n\n- Prevent app crash when deleting a list item immediately after exiting edit mode\n  - PR: https://github.com/200ok-ch/organice/pull/996\n  - Thank you [[https://github.com/kjmatsuda][kjmatsuda]] for the PR\ud83d\ude4f\n** Changed\n\n- doc: Clarify where to find docs (interactive tutorial vs. manual)\n  - PR: https://github.com/200ok-ch/organice/pull/991\n* [2024-09-19 Thu]\n\n** Added\n\n- Add a =flake.nix= file to provide a development shell for\n  [[https://nixos.org/][Nix]] users.\n  - PR: https://github.com/200ok-ch/organice/pull/987\n\n* [2023-11-15 Wed]\n\n** Added\n\n- Ability to print all content (including below the fold)\n  - PR: https://github.com/200ok-ch/organice/pull/969\n    \n* [2023-08-29 Tue]\n\n** Added\n\n- Capture template variable =%y= expanding to the raw year\n  - PR: https://github.com/200ok-ch/organice/pull/964\n\n** Fixed\n\n- Using a capture template that is available from all Org files, but should always capture to just one file (not necessarily the currently open one).\n  - PR: https://github.com/200ok-ch/organice/pull/965\n\n* [2023-04-11 Tue]\n\n** Changed\n\n- Ticking a checkbox should only tick the checkbox, not enable the list item manipulating functions from =handleListItemSelect=.\n  - Relevant discussion: https://github.com/200ok-ch/organice/discussions/950\n  - PR: https://github.com/200ok-ch/organice/pull/951\n\n* [2023-04-10 Mon]\n\n** Fixed\n- Color of unchecked checkbox in a list\n  - PR: https://github.com/200ok-ch/organice/pull/949\n\n* [2023-04-03 Mon]\n\n** Added\n\n- Implements list manipulation functions\n  - PR: https://github.com/200ok-ch/organice/pull/945\n  - Thank you [[https://github.com/kjmatsuda][kjmatsuda]] for the PR\ud83d\ude4f\n    \n* [2023-01-28 Sat]\n\n** Fixed\n\n- On a header, don't cancel swipe due to vertical movements\n  - PR: https://github.com/200ok-ch/organice/pull/938\n  - Thank you [[https://github.com/neildavidforrest][neildavidforrest]] for the PR\ud83d\ude4f\n\n* [2023-01-09 Mon]\n\n** Fixed\n\n- Checking or unchecking a checkbox discards text with markup\n  - PR: https://github.com/200ok-ch/organice/pull/928\n  - Thank you [[https://github.com/saikiransathpadi][saikiransathpadi]] for the PR\ud83d\ude4f\n\n- Don\u2019t replace all leading =*= in the description\n  - Only when followed by a space, it would become a headline. Otherwise it\u2019s markup for bold text.\n  - PR: https://github.com/200ok-ch/organice/pull/931\n\n* [2023-01-05 Thu]\n\n** Fixed\n\n- Deadline overlay UI improvements\n  - PR: https://github.com/200ok-ch/organice/pull/925\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n\n* [2023-01-04 Wed]\n\n** Added\n\n- Configuration option for a default Org file on startup.\n  - By default, when you start organice, it will display your root\n    file directory. If you prefer to display a specific Org file\n    instead, you can select it in the [[https://organice.200ok.ch/settings][file settings]].\n\n- Option to display DEADLINE values (near the clocking value) on each headline\n  - The default for this option is false - so there is no change to the default behavior - until you enable this option via Settings.\n  - PR: https://github.com/200ok-ch/organice/pull/891\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n\n** Fixed\n\n- Rotation of table editor icons to reflect their action.\n  - PR: https://github.com/200ok-ch/organice/pull/890\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n\n- Prevent the user from invalidating her Org file by entering a description that leads with =*=\n  - If the user starts any line with a =*=, wanting to start a new list, it is immediately converted to a =-=.\n  - PR: https://github.com/200ok-ch/organice/pull/920\n  - Thank you [[https://github.com/saikiransathpadi][saikiransathpadi]] for the PR\ud83d\ude4f\n   \n\n** Changed\n\n- Disable auto-capitalization for search\n  - Before:\n    - When using the search or task list text inputs the Android/iOS keyboards automatically apply the shift key, meaning that the first character is capitalized.\n    - 99% of the time this is not what we want because:\n      - Having mixed case triggers a case sensitive search. This is quite confusing when I did not intentionally use capitalization, but it was added anyway. For example, I type \"and\", and it actually inputs and searches for \"And\", which yields no results.\n      - Many of the keywords in the search grammar are lower case, e.g., =deadline:=, =desc:=.\n  - Now: Auto-capitalization is turned off\n  - PR: https://github.com/200ok-ch/organice/pull/914\n  - Thank you [[https://github.com/neildavidforrest][neildavidforrest]] for the PR\ud83d\ude4f\n* [2022-12-03 Sat]\n** Fixed\n\n- Improve parser to read lines with multiple inline markup statements\n  - PR: https://github.com/200ok-ch/organice/pull/910\n  - Thank you [[https://github.com/lechten][lechten]] for the PR\ud83d\ude4f\n\n* [2022-12-02 Fri]\n** Added\n- Filtering by description\n  - PR: https://github.com/200ok-ch/organice/pull/907\n  - Thank you [[https://github.com/neildavidforrest][neildavidforrest]] for the PR\ud83d\ude4f\n* [2022-11-02 Wed]\n** Fixed\n- Use correct HTML anchor tag inside public.html <noscript>\n  - PR: https://github.com/200ok-ch/organice/pull/902\n  - Thank you [[https://github.com/josephmturner][josephmturner]] for the PR\ud83d\ude4f\n* [2022-07-08 Fri]\n** Fixed\n- When opening an Org file, show it from the top\n  - PR: https://github.com/200ok-ch/organice/pull/878\n- Changelog has a =Back= button in the HeaderBar\n  - PR: https://github.com/200ok-ch/organice/pull/882\n* [2022-07-06 Wed]\n** Fixed\n- Change log renders above previously opened view component\n  - PR: https://github.com/200ok-ch/organice/pull/869\n- Make HeaderBar sticky\n  - PR: https://github.com/200ok-ch/organice/pull/870\n* [2022-07-04 Mon]\n** Added\n- Setting to change textbox height in the description editor\n  - PR: https://github.com/200ok-ch/organice/pull/875\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n* [2022-06-30 Thu]\n** Changed\n- Upgrade Dropbox authentication flow: switch from OAuth to OAuth 2\n  and PKCE\n  - Rationale: Dropbox switched OAuth from long lived tokens to short\n    lived tokens.\n  - PR: https://github.com/200ok-ch/organice/pull/851\n* [2022-06-29 Wed]\n** Fixed\n- Undo looks like it is persisting changes, but it persisted old\n  state. Hence, reloading the file was bringing back the version of\n  the file before undoing.\n  - PR: https://github.com/200ok-ch/organice/pull/861\n** Changed\n- Simplify UX in task modal\n  - \"Change todo keyword set\" is now an explicit button. Also, it's\n    only shown when there is more than one todo keyword set configured\n    for the current Org file.\n  - Todo keywords can be selected and unselected on the same button.\n    No trash can necessary to unselect a todo keyword..\n  - PR: https://github.com/200ok-ch/organice/pull/862\n** Added\n- Ability to delete header from task modal.\n  - PR: https://github.com/200ok-ch/organice/pull/862\n* [2022-06-22 Wed]\n** Added\n- Ability to handle empty files\n  - This takes care of a big UX problem for users who solely rely on organice. So far, we've shown a parser error if the file is empty *or* if the file did not contain a headline.\n  - Now, if the user opens a file that is empty, or has no headlines, she will see the call to action to create a new headline.\n  - PR: https://github.com/200ok-ch/organice/pull/853\n* [2022-06-16 Thu]\n** Added\n- Capture template variables =%r= and =%R= expanding to raw timestamps\n  - PR: https://github.com/200ok-ch/organice/pull/838\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n\n* [2022-06-14 Tue]\n** Added\n- Create new file from file browser\n  - PR: https://github.com/200ok-ch/organice/pull/818\n* [2022-06-13 Mon]\n** Added\n\n- Specify default webDAV URL in .env file\n  - PR: https://github.com/200ok-ch/organice/pull/829\n  - Thank you [[https://github.com/dmorlitz][dmorlitz]] for the PR\ud83d\ude4f\n- Docker image recognizes env vars\n  - PR: https://github.com/200ok-ch/organice/pull/835\n  - see [[https://organice.200ok.ch/documentation.html#docker][doc]] for more information\n\n* [2022-06-03 Fri]\n** Removed\n- Google Drive support. This backend had a few issues:\n  1. We waited [[https://github.com/200ok-ch/organice/issues/127][for years for Google to put the Google Drive API into\n     production mode]]. Without that, only very few people were actually\n     allowed by Google to use organice with Google Drive. A lot of\n     time and effort went into this from quite a few of people. Even\n     Google employees tried to expedite from within Google, but to no\n     avail. The maintainers of organice gave up on this issue since\n     [[https://github.com/200ok-ch/organice/issues/127#issuecomment-655339244][July 2020 and announced]] that the support for Google Drive will be\n     removed unless someone steps up and takes over this task. Nobody\n     did in the two years since, so we're removing it.\n  2. [[https://github.com/200ok-ch/organice/issues/109][Replace integration of Google Drive through <script> include in index.html with NPM module]]\n  3. [[https://github.com/200ok-ch/organice/issues/107][Sign in to Google Drive from new versions of Chrome dysfunctional]]\n\n* [2022-06-01 Wed]\n** Added\n   - Proper Landing Page\n     - PR: https://github.com/200ok-ch/organice/pull/809\n* [2022-02-23 Wed]\n** Fixed\n   - [[https://organice.200ok.ch/documentation.html#in_buffer_settings][In-buffer settings]] can be in lowercase or uppercase. Before, they\n     had to be in uppercase.\n     - PR: https://github.com/200ok-ch/organice/pull/776\n   - Manifest for PWAs\n     - Before, the 'install' button did not appear for Android devices\n       and both Chrome and Firefox showed warnings for the manifest.\n     - Issue: https://github.com/200ok-ch/organice/issues/779\n     - PR: https://github.com/200ok-ch/organice/pull/781\n     - Thank you [[https://github.com/tbruckmaier][tbruckmaier]] for the PR\ud83d\ude4f\n\n* [2021-12-09 Thu]\n** Fixed\n   - Title editor text loss.\n     - Since the introduction of the semantic Title editor on [2021-11-22 Mon], if you modified the text of a title and then click a todo, the todo keyword got saved which triggers a rerender before the text got saved. Therefore the text is reset to the state it was in when the title editor was opened.\n     - This is fixed, now.\n* [2021-12-05 Sun]\n** Added\n   - *EPIC* Bookmark functionality for search\n     - After entering a search string, you can bookmark it using the \u2b50 button.\n     - Bookmarked search strings populate the suggestions if no search string is entered into the input field.\n     - Bookmarks are saved by context, so there are separate bookmarks for search, task-list, and refile.\n     - There are at most ten bookmarks for a context. Newly saved bookmarks are inserted at the top of the list. If the list gets too long, the last search strings are dropped. Duplicate bookmarks are dropped too. The list of bookmarks is ordered by last used.\n     - Bookmarks are unaware of file context. Therefore, you always have the same bookmarks.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/758\n* [2021-11-22 Mon]\n** Changed\n   - Title and Description fields are not edited as raw text by default.\n     - Instead, a semantic editor comes up when editing them.\n     - To edit raw values, click the 'edit' icon, again.\n   - Search and Task List open in one modal with tabs.\n     - Modal opens to \"Search\" by default, but remembers what was opened last.\n   - If there are open clocks, a third modal \"Clock List\" is added\n     that looks like \"Search\" for =clock:now= without the search input\n     field.\n   - Notes can be multi-line and are properly indented.\n* [2021-11-09 Tue]\n** Added\n   - Setting to respect OS light/dark-mode preferences\n     - organice already queried the OS for light/dark-mode preference. But changing the setting in organice would override the OS preference.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/749\n** Fixed\n   - Fix repeater adjusting time of date when using =.+=\n     - When repeaterUnit is not \"h\", hour and minutes are never touched.\n     - When repeaterUnit is \"h\", hour and minutes are set to n hour(s) from now (as it was already implemented before this fix).\n   - Relevant PR: https://github.com/200ok-ch/organice/pull/746\n* [2021-11-03 Wed]\n** Fixed\n   - Fix GitLab OAuth token refresh\n     - PR: https://github.com/200ok-ch/organice/pull/740\n     - Thank you [[https://github.com/chasecaleb][chasecaleb]] for the PR\ud83d\ude4f\n* [2021-11-01 Mon]\n** Added\n   - *EPIC* Add GitLab as a sync back-end\n     - PR: https://github.com/200ok-ch/organice/pull/734\n     - Thank you [[https://github.com/chasecaleb][chasecaleb]] for the PR\ud83d\ude4f\n* [2021-10-29 Fri]\n** Fixed\n   - Loading settings when using WebDAV as synchronization back-end\n     - PR: https://github.com/200ok-ch/organice/pull/727\n     - Thank you [[https://github.com/mcordell][mcordell]] for the PR\ud83d\ude4f\n\n* [2021-05-16 Sun]\n** Added\n   - Parse and preserve habit timestamp ranges\n     - A timestamp may have minimum and maximum ranges specified by using the syntax =.+2d/3d=, which says that you want to do the task at least every three days, but at most every two days.\n     - Upstream documentation:\n       https://orgmode.org/manual/Tracking-your-habits.html\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/674\n     - Thank you [[https://github.com/tomonacci][tomonacci]] for the PR\ud83d\ude4f\n\n* [2021-05-13 Thu]\n\n** Changed\n   - Agenda starts on Monday by default (as it does in Emacs Org mode)\n\n** Added\n   - Ability to set the \"Start of week for weekly agenda\" in the Settings\n     - Akin to the Emacs org mode variable =org-agenda-start-on-weekday=\n   - Relevant PRs:\n     - https://github.com/200ok-ch/organice/pull/676\n       - Thank you [[https://github.com/tomonacci][tomonacci]] for the PR\ud83d\ude4f\n     - https://github.com/200ok-ch/organice/pull/677\n\n* [2020-12-29 Tue]\n** Added\n   - *EPIC*: Multiple file support\n     - Agenda, Search, Task List, Refile and Capture Templates have the ability to work on multiple files.\n     - You can adjust the behavior for these on a file per file basis by creating \"file settings\" in the settings menu.\n\n   - *EPIC*: Offline file support\n     - Every file opened in organice will automatically be cached on your device.\n     - When visiting the file, again, it will immediately be loaded from the local storage and then loaded from the remote back-end.\n     - That makes loading and switching between files instant _and_ gives you the ability to work on multiple files when being offline.\n\n   - Relevant PRs:\n     - https://github.com/200ok-ch/organice/pull/550\n     - https://github.com/200ok-ch/organice/pull/560\n     - https://github.com/200ok-ch/organice/pull/565\n     - https://github.com/200ok-ch/organice/pull/574\n     - https://github.com/200ok-ch/organice/pull/575\n     - https://github.com/200ok-ch/organice/pull/570\n     - https://github.com/200ok-ch/organice/pull/607\n\n* [2020-11-21 Sat]\n\n** Added\n   - When going to the Agenda view, the selected tab is persisted - meaning it will be pre-selected when you go to the Agenda next time.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/562\n\n** Fixed\n   - Having an active timestamp with a repeater was broken.\n     - When the TODO state changes for a header that has a repeater (either as SCHEDULED, DEADLINE or active timestamp), a log entry is written and the timestamp is updated.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/568\n   - Removing an active timestamp was broken.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/568\n\n* [2020-11-20 Fri]\n** Fixed\n   - organice understands =:PROPERTIES:= drawers and smartly parses the values in case one of the values is a timestamp.\n     - However, parsing all the values and saving the parsed result in any case will lead to wrong results. Most values of properties are just plain text and non-interactive things in Org mode.\n     - For example, a value like =something_with_underscores= would have been treated as 'underlined text' which doesn't make sense for a property drawer. When saving the value back, organice would have squashed the underlines.\n     - Now, the values are used and preserved as they are. Timestamps still work, of course.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/578\n* [2020-11-15 Sun]\n** Fixed\n   - When repeating a task, an active date timestamp was logged instead of an inactive datetime timestamp.\n\n* [2020-11-14 Sat]\n** Fixed\n   - The task list was not scrollable on Android.\n      - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/561][PR]] \ud83d\ude4f\n\n* [2020-11-08 Sun]\n** Changed\n   - Safeguard against selecting text by accident.\n      - Before this change, it was possible to select text when doing a 'swipe'.\n      - Now, selecting/copying text is only possible in 'edit mode', effectively safeguarding against accidentally selecting text.\n      - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/557][PR]] \ud83d\ude4f\n\n\n* [2020-11-06 Fri]\n** Added\n   - Additional themes. You now can choose between:\n     - Solarized\n     - One\n     - Gruvbox\n     - Smyck\n     - Code\n   - All of these are themes work in light and dark mode!\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/540][PR]] \ud83d\ude4f\n\n* [2020-11-01 Sun]\n\n** Changed\n   - We have enabled some default settings by default, because they are reasonable for a new user:\n     - =shouldStoreSettingsInSyncBackend=, because it enables using organice on multiple clients.\n     - =shouldLiveSync=, because it reduces the chance to have a conflict in the open Org file.\n     - =shouldSyncOnBecomingVisibile=, because it reduces the chance to have a conflict in the open Org file.\n   - =bulletStyle= is set to \"Fancy\", because it looks more visually pleasing than an asterisk (*) and hence makes organice look better on a first test run.\n   - If you personally do not want them enabled, you can disable them separately in the [[/settings][settings]] any time.\n\n** Fixed\n   - organice has various settings that the user can configure. Before manual configuration, there organice loads sane defaults. Loading and persisting some of these defaults was buggy before.\n     - Loading and persisting of defaults works now.\n     - Previously saved wrong values are removed from =localStorage= to reduce future bug potential.\n     - Changing this is - strictly speaking - not visible to the end-user, so it wouldn't ordinarily show up in this changelog. However, since it makes changes to the already saved settings (in cleaning up old faulty values), it theoretically could introduce a bug in the settings. Hence, the change is added to the changelog.\n     - Related PRs:\n       - https://github.com/200ok-ch/organice/pull/552\n       - https://github.com/200ok-ch/organice/pull/553\n       - https://github.com/200ok-ch/organice/pull/554\n* [2020-10-25 Sun]\n** Changed\n   - The 'focus header' feature is renamed.\n     - /Narrowing/ means focusing on this header, making the rest temporarily inaccessible.\n     - Canceling the narrowing, which makes all headers once again accessible, is called /widening/.\n* [2020-10-23 Fri]\n** Added\n   - Add 'dark mode' next to 'light mode' as a setting.\n     - Both themes are based on the popular [[https://ethanschoonover.com/solarized/][Solarized]] color palette.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/527][PR]] \ud83d\ude4f\n   - Add 'recursive clock times in search'.\n     - The =clock:= search term now includes headers that have time logged on their children.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/524][PR]] \ud83d\ude4f\n\n* [2020-10-20 Tue]\n** Added\n   - Add 'time range' queries to search for planning items (SCHEDULED and DEADLINE), plain active timestamps or clocked work time.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/505][PR]] \ud83d\ude4f\n* [2020-10-19 Mon]\n** Added\n   - When a header is focused, and the user uses the 'search' or 'task list' feature, then the searched header list is automatically narrowed to only subheaders of the originally focused header.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/517][PR]] \ud83d\ude4f\n* [2020-10-10 Sat]\n** Added\n   - Display time summaries for clock entries in each subtree\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/497][PR]] \ud83d\ude4f\n\n** Changed\n\n   - Improve header stickiness\n     - The header bar was not always sticky for longer documents and the therefore some functionality was hard to reach (the user had to scroll to the top to reach it).\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/499][PR]] \ud83d\ude4f\n\n* [2020-10-07 Wed]\n** Added\n\n   - Added Documentation on [[https://orgmode.org/manual/Repeated-tasks.html][repeaters]] and [[https://orgmode.org/manual/Deadlines-and-scheduling.html#Deadlines-and-scheduling][delays]] to =sample.org= and to mouseovers for the relevant buttons.\n\n* [2020-09-20 Sun]\n** Added\n\n   - Recognize US and Swiss phone numbers and make them clickable\n   - Next to 'canonical' phone numbers like +49123456789, also recognize:\n     - US phone numbers:\n       - 123-456-7890\n       - (123) 456-7890\n       - 123 456 7890\n       - 123.456.7890\n       - +91 (123) 456-7890\n     - Swiss phone numbers:\n       - 0783268674\n       - 078 326 86 74\n       - 041783268675\n       - 0041783268674\n       - +41783268676\n       - +41783268677\n\n* [2020-09-07 Mon]\n** Added\n   - Added the capability to chose the start screen when installing organice to the homescreen.\n     - More information on how to install organice like this, see https://organice.200ok.ch/documentation.html#installation\n* [2020-09-05 Sat]\n\n** Fixed\n  - Search and Todo List modals could be moved off screen on iOS since [2020-08-30 Sun]. The fix is to disable =autoFocus= on iOS. The rationale for that documented here: https://github.com/200ok-ch/organice/pull/462\n\n* [2020-08-30 Sun]\n\n** Added\n   - Add note to header (=M-x org-add-note=)\n     - This adds a button for taking notes to tasks (org-add-note). They will be prepended to the header contents after :PROPERTIES: and before the :LOGBOOK:\n   - Auto-focus filter input fields (search and task-list)\n\n* [2020-08-29 Sat]\n** Fixed\n   - If a user folds a header, all its subheaders should collapse as well, so that when the user reopens it, they stay closed.\n     - The previous behavior is buggy in a way that it keeps the subheaders open as they were, restoring their openness when the header is unfolded.\n     - The previous behavior is useful, though. So this change introduces a user setting to toggle the behaviour.\n   - Thank you [[https://github.com/necto][necto]] for your [[https://github.com/200ok-ch/organice/pull/440][PR]] \ud83d\ude4f\n\n* [2020-08-25 Tue]\n** Fixed\n   - Updating table cell values and removing table rows or colums was\n     not undoable\n     - Thank you [[https://github.com/necto][necto]] for your [[https://github.com/200ok-ch/organice/pull/432][PR]] \ud83d\ude4f\n\n* [2020-07-28 Tue]\n** Fixed\n   1. Sync stuck when working in the background\n     - When the user put organice into the background during a sync and comes back, organice was stuck in sync mode, but doesn't actually sync anymore. This means that any new changes to the Org file will not be persisted. This is due to mobile browsers cutting off most resources to browser apps in the background, so organice cannot guarantee that a sync happens properly in the background.\n     - It's not trivial to find out if the job is stuck\n       - Time is not a good indicator as bigger files on slower connections will always take longer.\n       - There's no JS API to reliably find out if the browser just got back from the background or is put into the foreground. The [[https://developer.mozilla.org/en-US/docs/Web/API/Page_Visibility_API][=visibilitychange= API]] just triggers for both these events.\n     - Hence, the implementation is generic in nature: Whenever the user hits the 'sync' button, an actual 'sync' is forced - even if organice thinks there's currently a sync in progress or that it should be debounced. That makes sense, because manual actions by the user should always be obeyed.\n     - Closes issue https://github.com/200ok-ch/organice/issues/252\n   - 2. On iOS >13.1, when organice is used in SPA mode (as a bookmark on the homescreen), and the user navigates away from the original bookmark, a huge URL Bar would show up with a \"Done\" button. This is a regression in how iOS handles full-screen SPAs. These are the relevant APIs:\n     - https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html\n     - https://developer.mozilla.org/en-US/docs/Web/Manifest/display\n   - 3. Feature detection for =crypto.subtle= module\n     - This is used for change detection in the changelog. The module is only available in secure contexts. Hence, when used locally and on a private IP range, depending on the browser, it might not be available.\n\n* [2020-07-08 Wed]\n** Added\n   - Allow template-variables in the header-path in a capture template\n     - Thank you [[https://github.com/jayesh-bhoot][jayesh-bhoot]] for your [[https://github.com/200ok-ch/organice/pull/387/][PR]] \ud83d\ude4f\n* [2020-06-14 Sun]\n** Added\n   - Allow capture templates to insert at beginning or end of file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/324][PR]] \ud83d\ude4f\n* [2020-06-05 Fri]\n** Fixed\n   - =file:= links are sanity checked before opened\n     - =file:= links opened in iOS from the PWA view will not open Mobile Safari\n     - Open issue: Some links will be opened as directories when the\n       link is not really going towards a directory.\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/311][PR]] \ud83d\ude4f\n\n* [2020-06-03 Wed]\n** Added\n   - =TODO= keyword sets can now be anywhere in the file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/310][PR]] \ud83d\ude4f\n* [2020-05-30 Sat]\n\n** Added\n   - Make local =file:...= links navigate to the relevant file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/307][PR]] \ud83d\ude4f\n\n* [2020-05-06 Wed]\n\n** Fixed\n   - Planning items now respect the new hard-indent setting.\n\n* [2020-05-05 Tue]\n\n** Fixed\n   - Append new tags correctly to title.\n     - If a header didn't have tags before, the first tags were\n       erroneously appended without a space.\n\n* [2020-04-06 Mon]\n\n** Added\n   - Support org-adapt-indentation\n     - By default, the metadata body (including deadlines and drawers) of an exported org heading is indented according to its level. If instead you prefer to keep your body text flush-left, i.e.{' '}\n     - Thank you [[https://github.com/cpbotha][cpbotha]] for your [[https://github.com/200ok-ch/organice/pull/272][PR]] \ud83d\ude4f\n\n* [2020-04-05 Sun]\n** Added\n   - Support for org-log-into-drawer TODO state logging\n     - Thank you [[https://github.com/cpbotha][cpbotha]] for your [[https://github.com/200ok-ch/organice/pull/271][PR]] \ud83d\ude4f\n** Fixed\n   - Settings screen has proper title and \"back\" button\n\n* [2020-03-27 Fri]\n** Fixed\n   - Help texts for widen/narrow were reversed\n     - Thank you [[https://github.com/obar][@obar]] for the [[https://github.com/200ok-ch/organice/pull/270][PR]] \ud83d\ude4f\n\n* [2020-02-29 Sat]\n\n** Fixed\n   - As a user, when I visit Search, Task List or Agenda whilst having\n     a dirty file, I'm not getting a pop up a dialogue notifying me\n     about unpushed changes\n\n* [2020-02-17 Mon]\n\n** Added\n   - *Headers with active timestamps in the header or description appear in agenda*\n\n** Fixed\n   - 'Insert timestamp' for headers and descriptions\n\n* [2020-02-09 Sun]\n\n** Added\n   - Comprehensive documentation: https://organice.200ok.ch/documentation.html\n     - You can find the link from the 'settings' screen or on top of\n       the readme.\n\n* [2020-01-27 Mon]\n\n** Fixed\n   - When editing a =:LOGBOOK:= drawer within a headers description,\n     the relevant logbook entries are updated (which might entail them\n     being deleted).\n\n* [2020-01-20 Mon]\n\n** Fixed\n   - When refiling a header, don't show subheaders in the refile drawer\n   - When doing a 'Search' or 'Refile', the action is reflected in the\n     name of the opening drawer.\n   - In the agenda view, fix relative time distance for future dates\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/240][PR]] \ud83d\ude4f\n\n* [2020-01-15 Wed]\n\n** Fixed\n   - Put Floating Action Button \"Move a header\" into the middle of the\n     screen, so that it has enough space to render all arrows on\n     mobile devices.\n\n* [2020-01-14 Tue]\n\n** Added\n   - Notify on changes for changelog\n     - This is done with a similar UX than other productivity apps\n       (like Slack) do it. The user will see a 'gift' icon whenever\n       there's a change to the changelog she has not seen, yet.\n\n* [2020-01-13 Mon]\n\n** Added\n   - \"Show Org filename in Header\" is configurable in settings and\n     off by default\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/229][PR]] \ud83d\ude4f\n\n** Fixed\n   - Show error message when using a capture template with a badly\n     configured header path\n\n* [2020-01-12 Sun]\n\n** Added\n   - Make HeaderBar sticky\n     - Making undo/redo, file browser and help always available\n       (before it was required to scroll all the way to the top)\n   - Deselect headline by clicking into the title (or empty space) in\n     the HeaderBar\n   - Show Org filename in Header\n\n** Fixed\n   - *Major synchronization improvements*\n     1. After undo/redo, synchronize Org file\n     2. Debounce Sync\n        1. When a user changes things quickly (which happens easily\n           when having 'live sync' enabled and using undo/redo for\n           example), multiple syncs ran in parallel. The back-ends\n           will either get confused or fail with errors (429 too many\n           write operations). In any case, likely the last written\n           state would not have been the state of the Org file in\n           organice.\n     3. Safeguard against concurrent sync requests to the back-end\n     4. In case of synchronization error, show the error to the user\n        and retry synchronization\n     5. Don't actually sync a whole Org file for an empty header.\n        When the user adds some data and triggers\n        UPDATE_HEADER_TITLE, then it makes sense to save it.\n\n* [2020-01-11 Sat]\n\n** Added\n   - All HeaderActionItems are undoable and redoable\n\n** Fixed\n   - Parsing planning items followed by a checkbox\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/222/files][PR]] \ud83d\ude4f\n* [2020-01-07 Tue]\n\n** Added\n   - *Refile*\n     - When reviewing the captured data, you may want to refile or to\n       copy some of the entries into a different list, for example\n       into a project.\n   - Add button in HeaderActionBar to open property editor\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/195][PR]] \ud83d\ude4f\n\n** Changed\n   - All HeaderActionDrawer actions have icons. The icons are\n     documented in sample.org and have a mouseover title.\n\n* [2020-01-04 Sat]\n\n** Added\n   - Ability to search headlines\n     - It has the same syntax as the search field in the Task List\n       feature\n\n** Fixed\n   - Sort order in Task List\n     - Tasks were only ordered by their planning item dates. This\n       implied that tasks that were long DONE would be shown first.\n     - Now, tasks in the Task list are sorted by state and then date.\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/207][PR]] \ud83d\ude4f\n\n\n* [2020-01-02 Thu]\n\n** Added\n   - Place cursor after the TODO keyword when creating a new header\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/193][PR]] \ud83d\ude4f\n   - Highlight verbatim markup\n\n** Changes\n   - Highlight cookies and cookie percentages according to Solarized\n     color scheme\n\n** Fixed\n   - Don't update search results when using an invalid search filter\n   - On mobile: Styling of Search / Task List drawer when searching all\n     headlines\n   - On mobile: Ability to scroll Search / Task List\n   - Teach #+TODO parser to understand (..) suffix\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/202][PR]] \ud83d\ude4f\n\n* [2020-01-01 Wed]\n\n** Added\n   - Support single- and double-quoted strings in the search filter\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/176][PR]] \ud83d\ude4f\n   - Trim whitespace for entered or updated headlines\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/177][PR]] \ud83d\ude4f\n\n** Fixed\n   - Capture templates in iOS 13.3 are positioned properly\n     - iOS 13 introduced a styling regression when setting focus\n       without user interaction. iOS 13.3 reverts to the way other\n       browsers do it.\n\n** Changed\n   - Revert \"Move HeaderActionDrawer before headline\"\n     - As per #188, the changes introduced in #100 didn't fare well\n       with the community. Hence, as a first step to improve UX,\n       we're reverting to the previous state.\n\n* [2019-12-31 Tue]\n\n** Added\n   - *Searching of headlines/todos with a composable query language*\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/154][PR]] \ud83d\ude4f\n   - Routing for Settings (/settings) and Sample (/sample)\n   - Routing for Agenda and TaskList\n\n** Changes\n   - The action for capture templates now uses a more idiomatic\n     'plus' icon instead of a 'list' icon\n\n* [2019-12-28 Sat]\n\n** Added\n   - Proper coloring of DONE todoKeywords from custom todo sequences\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/165][PR]]!\n   - Place TODO keyword of previous header in the new header\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/164][PR]]!\n\n** Changed\n   - Refactor current Org parser and regex\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/161][PR]]!\n\n* [2019-12-26 Thu]\n\n** Added\n\n   - \"Share\" button for headlines (sharing via email)\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/145][PR]]!\n   - Automatically render links for URLs with www prefix, but without\n     protocol\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/159][PR]]!\n\n* [2019-12-25 Wed]\n\n** Added\n\n   - Suggestion list for inputs in property editor\n     - To minimize typing and typos, add smart completion for property\n       names and values in the PropertyListEditorModal.\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/144][PR]]!\n\n* [2019-12-24 Tue]\n** Added\n\n   - *Automatically render links for URLs, e-mail addresses and phone\n     numbers*\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/147][PR]]!\n\n   - Suggestion list for inputs in tag editor\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/149][PR]]!\n\n* [2019-12-17 Tue]\n** Changed\n   - Improve webdav url input\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/139][PR]]!\n** Fixed\n   - Make \"privacy policy\" sticky to the bottom of the landing page\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/140][PR]]!\n\n* [2019-12-15 Sun]\n\n** Changed\n   - UX: Move Org header actions before selected headline\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/136][PR]]!\n\n** Fixed\n   - Android PWA implementation was broken (issue [[https://github.com/200ok-ch/organice/issues/134][#134]])\n     - It required two more icon sizes\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/135][PR]]!\n\n* [2019-12-10 Tue]\n\n** Added\n\n   - *Docker Support*\n   - The CI/CD workflow now also builds a Docker container which is\n     then published to\n     https://hub.docker.com/repository/docker/twohundredok/organice\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/133][PR]]!\n\n* [2019-12-08 Sun]\n\n** Added\n\n   - As a user, when I'm on a headline with a planning item (schedule\n     or deadline), I want to be able to remove it.\n\n* [2019-11-29 Fri]\n\n** Fixed\n\n   - Clicking the Timestamp in a TODO within the agenda toggles from\n     the date to a human readable timespan\n\n* [2019-11-27 Wed]\n\n** Added\n\n   - Instructions on configuring Nextcloud+haproxy to allow WebDAV\n   - Documentation on how to share from Nextcloud using WebDAV\n   - Thank you [[https://github.com/runejuhl][runejuhl]] for your [[https://github.com/200ok-ch/organice/pull/122][PR]]!\n\n* [2019-11-25 Mon]\n\n** Added\n   - Honor the 'nologrepeat' option\n     - It can be set via =#+STARTUP:= or as a property\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/119][PR]]!\n\n* [2019-11-22 Fri]\n\n** Fixed\n\n   - Handle non-clock entries in =:LOGBOOK:= drawers\n     - Fixes [[https://github.com/200ok-ch/organice/issues/111][issue #111]], [[https://github.com/200ok-ch/organice/issues/108][issue #108]] and [[https://github.com/200ok-ch/organice/issues/110][issue #110]]\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/112][PR]]!\n\n* [2019-11-21 Thu]\n\n** Fixed\n\n   - Safeguard against potential Dropbox SDK Bug\n     - More information in [[https://github.com/200ok-ch/organice/issues/108][issue #108]]\n\n* [2019-11-19 Tue]\n\n** Changed\n\n   - Don't put newlines after headers with no content, add newline at EOF\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/106][PR]]!\n\n* [2019-11-14 Thu]\n\n** Added\n\n   - *Clocking work time*\n     - Org mode allows you to clock the time you spend on specific\n       tasks in a project:\n       https://orgmode.org/manual/Clocking-Work-Time.html#Clocking-Work-Time\n     - organice is compatible with logbook clocking, now\n     - You can 'clock in' and 'clock out' to a header\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/103][PR]]!\n\n* [2019-10-31 Thu]\n\n** Fixed\n   - Keep all in-file settings and content lines from top of file\n     - Thank you [[https://github.com/andersjohansson][@andersjohansson]] for your [[https://github.com/200ok-ch/organice/pull/90][PR]]!\n\n* [2019-10-29 Tue]\n\n** Added\n   - Show login options as clickable links with cursor pointer\n   - Also improve wording with regards to login options\n     - Thank you [[https://github.com/rodrigomaia17][@rodrigomaia17]] for your [[https://github.com/200ok-ch/organice/pull/88][PR]]!\n\n\n* [2019-10-26 Sat]\n\n** Added\n   - *WebDAV as a sync backend!*\n     - Thank you [[https://github.com/TristanCacqueray][@TristanCacqueray]] for your [[https://github.com/200ok-ch/organice/pull/82][PR]]!\n\n   - As a user, when I swipe a header, I want the icon to contrast\n     the background, so that better see the action taken\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/78][PR]]!\n\n   - As a user, when I hover a clickable element, I want my cursor to\n   change, so that I can see that it is clickable.\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/79][PR]]!\n\n** Fixed\n   - Do not throw an error when clearing a planning item\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/81][PR]]!\n\n* [2019-10-02 Wed]\n\n** Fixed\n\n- On iOS 13, fix the regression which made capture input fields hide\n  under the keyboard\n  - More information and screenshots in the ticket: https://github.com/200ok-ch/organice/issues/46\n  - Turns out this issue is non trivial to fix and requires specific\n    rules for every size of iPhone. I tested against the Xs and 6s. If\n    you have a different form factor and the capture template input\n    screen looks off to you, please send me a screenshot of what it\n    looks like and I'll add the dimensions for your form factor right\n    away!\n\n* [2019-09-28 Sat]\n\n** Added\n\n- Implemented a =redo= Button next to the =undo= button\n\n* [2019-09-21 Sat]\n\n** Fixed\n\n- Parser bug which would interpret *bold* statements in the beginning\n  of a line as a header.\n- Parser bug which would delete newlines between headers and items\n\n** Changed\n\n- @MTrost [[https://github.com/200ok-ch/organice/pull/45][introduced]] a new testing library called [[https://testing-library.com/docs/intro][React Testing\n  Library]] which greatly simplified writing interaction tests.\n\n* [2019-09-19 Thu]\n\n** Changed\n\n- Constraining to a max width and centering for tablets and bigger\n\n* [2019-09-15 Sun]\n\n** Fixed\n\n- The 'Sync on application becoming visible' feature works on iOS and\n  Safari\n  - If enabled, the current org file is pulled from the sync backend\n    when the browser tab becomes visible. This prevents you from\n    having a stale file before starting to make changes to it.\n\n* [2019-09-08 Sun]\n** Added\n\n- Documented how to use organice from a bookmarklet using the capture\n  template feature\n\n* [2019-09-06 Fri]\n** Fixed\n\n- Removed Google Analytics tracking, because it has no place here\n\n* [2019-09-02 Mon]\n\n** Added\n\n- Configure Google Drive for the free community version of organice at\n  https://organice.200ok.ch\n- Documented SPA routing for self-hosting\n- Wrote and publicized a Privacy Policy\n\n* [2019-08-27 Tue]\n\n** Changed\n\n- Color scheme has been ported to the popular [[https://ethanschoonover.com/solarized/][Solarized]] (light mode)\n  - Whilst doing so, CSS variables have been introduced, so that\n    there's not a whole lot of repetition of magic rgb values going on\n  - The logo has been adapted, too\n- The landing page and settings screens have been de-cluttered\n\n* [2019-08-26 Mon]\n\n** Added\n\n- Continuous deployment: Merging to =master= triggers a build on CI\n  and when successful, it triggers a deploy to https://org.200ok.ch\n- Add a new temporary\u2122 logo: [[file:public/organice.png][organice.png]]\n\n* [2019-08-25 Sun]\n\n** Added\n\n- Since we want organice to be a community driven project, we have added:\n  - [[file:CODE_OF_CONDUCT.org][Code of conduct]]\n  - [[file:CONTRIBUTING.org][Contributing guidelines]]\n\n- Add [[https://circleci.com/][CircleCI]] to run the tests on every commit\n  - They are also integrated as a check for PRs with the benefit that\n    contributors get automated feedback by running the regression test\n    suite.\n\n- Add [[https://greenkeeper.io][Greenkeeper]] for automated dependency management\n\n- Add [[https://codeclimate.com][Codeclimate]] for automated maintainability analysis\n\n** Changed\n\n- Upgraded to Node 12.9\n\n* [2019-08-12 Mon]\n\n** Changed\n\n- The default keybindings (when used from a desktop browser) are now\n  more in line with the defaults in Emacs itself\n\n** Fixed\n\n- The keybindings work on non-macOS operating systems\n\n* [2019-08-10 Sat]\n\n** Added\n\n- As a user, when in a directory listing, I want the folders and files\n  to be sorted alphabetically. Furthermore, I only want to see files\n  that organice can open (that is org and org archive files).\n- Note: This is only implemented for the Dropbox back-end at this time.\n\n** Changed\n\n- Filters files from a directory listing down to org files.\n- Sorts folders atop of files.\n- Sorts both folders and files alphabetically.\n\n\n* [2019-08-05 Mon]\n\n** Added\n\n- When the browser tab becomes visible, pull the latest version of the\n  Org file\n  - This is rather helpful when the app is used in production. Since\n    the production build supports loading the complete application and\n    org-file from cache, it can be open for a very long time. When the\n    org-file hasn't been pulled in a \"very long time\"\u2122, then chances\n    are non-nil that the file has been changed by another client in\n    the meantime.\n  - Without this change, when the user opens the app after a while,\n    makes changes to the file and wants to sync to the back-end, there\n    might be the message \"Since you last pulled, a newer version of\n    the file has been pushed to the server.\". Now the user has two\n    conflicting versions of the same file and can only chose to keep\n    one (Which in itself is great UX and great error handling for\n    cases in which we do encounter a merge conflict, of course!).\n  - This situation is mitigated with this change. Now the user has the\n    option to enable \"Sync on application becoming visible\" which acts\n    similarly to \"Live Sync\". When the user opts to use this feature,\n    whenever the application gets pulled from the background or\n    started through the service worker, the first thing that happens\n    it that a new version of the org-file is pulled from the server.\n    It's therefore much harder for the user to create conflicts.\n\n* [2019-08-04 Sun]\n\n** Fixed\n\n- Parser doesn't break indentation of existing files in fewer places\n- Planning Items are formatted as in Emacs Org mode\n- Properties are formatted as in Emacs Org mode\n- Tags are formatted as in Emacs Org mode\n\n\n* [2019-08-03 Sat]\n\n** Added\n\n- Documented deployment options\n  - People have been asking for tighter access restrictions.\n  - Imo the best answer to that request is to make it as easy as\n    possible to host organice.\n  - There's myriads of good options, of course. I picked to document\n    two that will (potentially) be cost-free to the users and which\n    are very easy and quick to set up: Ftp and Heroku.\n\n** Fixed\n\n- Tests on =master= were red\n  - Partly due to obsolete tests\n  - Partly because tests weren't updated according to changes in the code\n",sample:"# organice will not reflow if there's hard-wrapped content\n# -*- eval: (auto-fill-mode 0) -*-\n#+TODO: TODO | DONE\n#+TODO: START INPROGRESS STALLED | FINISHED\n\n* This is an actual org file - feel free to play around with it! (Don't worry about messing it up - your changes won't be saved, so just refresh the page to reset it)\n* Tap on any header to open it\nThis header has some description text and a couple subheaders. Look through the next few top level headers to learn more about organice.\n** This is a subheader\n** This is a subheader too!\n* Actions\n** Editing headers\nWhen you select a header, the \"header action drawer\" appears. The first two icons in this drawer edit the header and description respectively. Try editing this header.\n\nTitle and Description fields are not edited as raw text by default. Instead, a semantic editor comes up when editing them. To edit raw values, click the 'edit' icon, again.\n\nIf you want the \"header action drawer\" to disappear or to deselect the current header, tap onto the title (or empty space) in the application's headerbar.\n\n** All icons in the header action bar\n\n1. Pen: Edit header title\n2. Pen in square: Edit header description\n3. Tags: [[https://orgmode.org/manual/Tags.html][Modify tags]]\n4. Properties: [[https://orgmode.org/manual/Properties-and-columns.html][Modify properties]]\n5. Expand: [[https://orgmode.org/manual/Structure-editing.html][Narrow to subtree]] (/Narrowing/ means focusing on this header, making the rest temporarily inaccessible.)\n6. Plus: Create new header below\n7. Mail: Share this header via email\n8. Calendar 1: [[https://orgmode.org/manual/Deadlines-and-scheduling.html][Set deadline datetime]]\n9. Calendar 2: [[https://orgmode.org/manual/Deadlines-and-scheduling.html][Set scheduled datetime]]\n10. Hourglass: [[https://orgmode.org/manual/Clocking-commands.html][Clock in and out (Start and stop the clock)]]\n11. File Export: [[https://orgmode.org/manual/Refile-and-copy.html][Refile this header to another header]]\n12. Add a note: Add a time-stamped note to the current header (=org-add-note=).\n\n** Todos [3/7] [42%]\nThis header has a few TODO items as subheaders.\n*** DONE Check out organice\n*** DONE Follow the organice tutorial\nThis interactive tutorial helps you get to know organice really quickly.\n*** TODO Learn how to use TODOs in organice\nTo advance the todo state of a header, swipe right on it until the background turns green.\n\nTry advancing the todo state of this header a few times!\n**** There's also a setting once you're signed in to enable tapping on the TODO label itself to advance the todo state. Its off by default because I thought the behavior would be confusing unless explained, but I recommend turning it on!\n*** START Investigate custom TODO states\norganice also supports [[http://orgmode.org/manual/Workflow-states.html#Workflow-states][custom todo states]] (if declared at the top of the file). Swipe right on this header a few times.\n\nNote that when the cycle restarts, it defaults to the first set of todo states. Manually edit the header to get back to a different todo state cycle (more on editing headers below!)\n*** FINISHED See that custom TODO states are colored correctly\nCustom =org-todo-keywords= keyword sequences can have finish states. They are colored appropriately. You can see that TODO and START headlines are colored red whereas DONE and FINISHED headlines are colored green.\n\n*** TODO If I have questions: Check out the documentation\norganice has solid documentation, including frequently asked questions: https://organice.200ok.ch/documentation.html\n*** TODO If I have further questions: Join the community chat\n#organice on IRC [[https://libera.chat/][Libera.Chat]], or [[https://matrix.to/#/!DfVpGxoYxpbfAhuimY:matrix.org?via=matrix.org&via=ungleich.ch][#organice:matrix.org]] on Matrix.\n\n** Tags\nThe next button in the header action drawer will bring up the tag editor.\n\nThis editor lets you add, modify, and reorder tags, as well as giving you easy access to all tags in the file.\n\nTry it out on these headers:\n*** Dogs\n**** Eloise                                        :cute:middleaged:tiny:dog:\n**** Clooney                                            :cute:young:tiny:dog:\n**** Murphy                                            :cute:young:small:dog:\n**** Starla                                             :cute:old:medium:dog:\n**** Rex                                                :cute:old:medium:dog:\n**** Maz                                          :cute:middleaged:large:dog:\n** Narrowing\nThe next button in the header action drawer \"narrows\" to a header, hiding all others and promoting it to the top level. Press the button again to \"widen\".\n\nNarrowing can make it easier to concentrate on a single heading or topic by eliminating clutter. It can also be used to limit the range of operation of a search command.\n\nThis is purely visual - your Org file isn't affected under the hood.\n\nExample: You can narrow on the \"Groceries\" list when you go to the grocery store. Give it a shot on this grocery list:\n*** Groceries\n- [ ] Mangoes\n- [ ] Dark chocolate\n- [ ] Carrots\n** Adding and removing headers\nTo add a new header, press the + button in the header action drawer\n\nTo remove a header, swipe left on the header until the background turns red.\n** Moving headers\nTo move a header, click on the four-way arrows button at the bottom of the screen with a header selected. 6 buttons will appear for moving headers.\n\nThe center 4 move the header up, down, left, and right. The 2 outermost buttons move the header and its entire nested subtree.\n\nGive them a try on these nested headers to get a feel for how they operate:\n*** A few of my favorite things:\n**** Food\n***** Chocolate\n****** Dark chocolate\n****** Milk chocolate\n****** Crispy chocolate\n***** Mangoes\n**** Text editors\n***** Emacs\n**** Mountain bikes\n***** Santa Cruz\n***** Trek\n***** Giant\n***** Specialized\n**** Dogs\n***** Eloise\n***** Maz\n***** Starla\n***** Rex\n***** Clooney\n** Syncing\nThe \"cloud\" button in the lower left hand corner syncs changes to your\nchosen sync service (Dropbox, GitLab, or WebDAV).\n\nIf there's a newer version on the server and no local changes, it'll pull.\n\nIf there's no newer version on the server and there are local changes, it'll push.\n\nOtherwise, it'll ask what you want to do.\n\nThis button isn't enabled in this demo :)\n\nIf you'd like to automatically push changes as you make them, you can enable \"Live sync\" in settings.\n** Undo / Redo\n   When you're signed in, you'll have =undo= and =redo= buttons in the\n   headerbar.\n* Tables\norganice has native support for viewing and editing tables.\n\nTry playing around with this one by first clicking on the table:\n\n| Dog name | Age | Weight (in lbs) | Parent   | Score (1-10) |\n|----------+-----+-----------------+----------+--------------|\n| Eloise   |   3 |             5.1 | Erin     |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Starla   |  15 |              40 | Sarah S  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Rex      |  15 |              45 | Sarah S  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Maz      |   1 |              55 | Brittany |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Clooney  | 0.1 |             4.8 | Sarah R  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Murphy   | 0.5 |              25 | Jordan   |           15 |\n\n** Table actions\nWhen a table is selected, the table editor is opened.\n\nBelow the table a table-specific action drawer appears.\n\nFor the icons to trigger any actions, you first need to select a table cell.\n\nThe leftmost icon allows you to edit a cell.\n\nIn the Middle, the top two icons let you add and remove rows. The bottom two icons let you add and remove columns.\n\nOn the right side, the four-way arrow buttons allow you to manipulate tables by moving rows and columns.\n\nPress up and down to move rows, and left and right to move columns.\n* Lists and checkboxes\norganice has native support for displaying plain lists and checkboxes.\n\nPlain:\n\n- Plain list item 1\n- Plain list item 2\n  - Sub item 1\n- Plain list item 3\n\nOrdered:\n\n1. Ordered Item 1\n2. Ordered Item 2\n   1. Sub item\n3. Ordered Item 2\n\nCheckboxes:\n\n- [-] 1 [1/2]\n  - [ ] 1.1 [0%]\n    - [ ] 1.1.1\n  - [X] 1. 2\n- [X] 2\n\n** Editing workflow\n\nFirst, create the first list item by editing the description of a header. When you close the \"edit description\" modal, you can manipulate the list item with native list manipulation functions. The UX is analogous to manipulating a header. Here's what you can do:\n\n- Add new list item\n- Remove list item\n- Move list item up\n- Move list item down\n- Move list item left\n- Move list item right\n- Move list subtree left\n- Move list subtree right\n- Edit list item title\n- Edit list item contents\n\n** All icons in the list action bar\n\n1. Pen: Edit list item title\n2. Pen in square: Edit list item contents\n3. Plus: Create new list item below\n4. Cross: Delete list item\n\n* Timestamps\norganice has native support for displaying and editing [[https://orgmode.org/manual/Timestamps.html#Timestamps][timestamps]].\n\nTry tapping on the timestamps below to get a feel for the editor:\n\n<2018-09-17 Sun>\n\n[2018-09-17 Sun]\n\n[2018-09-17 Sun +1d]\n\n[2018-09-17 Sun 10:00-11:30]\n\n<2018-09-17 Sun>--<2018-09-25 Tue>\n\n** Habit tracking\n\nOrg has the ability to track the consistency of a special category of TODO, called \"habits.\" From the [[https://orgmode.org/manual/Tracking-your-habits.html][upstream doc]]: A timestamp may have minimum and maximum ranges specified by using the syntax =.+2d/3d=, which says that you want to do the task at least every three days, but at most every two days.\n\nExample timestamp: <2009-10-17 Sat .+2d/4d>\n\norganice supports parsing and preserving the minimum/maximum range timestamps. Alas, only the minimum range is handled as a [[https://orgmode.org/manual/Repeated-tasks.html][repeated task]]. There's no UI for the maximum range, it can be edited as raw text. Also, there is no UI to show how well a habit has been exercised.\n\n* Automatic/Implicit links\n\norganice recognizes various types of hyperlinks automatically which Emacs Org mode would not necessarily do. That makes sense, because mobile devices, or browsers, enable a different feature set.\n\nFor example, when you read this in organice, then the text https://organice.200ok.ch will implicitly be rendered as a clickable link (as it would be in Emacs Org mode). The same also works for other web links like www.200ok.ch, email addresses like info@200ok.ch, and different kinds of phone numbers. For these, Emacs Org mode doesn't create an explicit link, but organice can and does.\n\nInternational/US phone numbers:\n\n  - 123-456-7890\n  - (123) 456-7890\n  - 123 456 7890\n  - 123.456.7890\n  - +91 (123) 456-7890\n\nSwiss phone numbers:\n\n - 0783268674\n - 078 326 86 74\n - 041783268675\n - 0041783268674\n - +41783268676\n - +41783268677\n\n* Property lists\norganice has native support for viewing and editing [[https://orgmode.org/guide/Properties.html][property lists]]. To bring up an editor, expand the ~PROPERTIES~ drawer below and tap on any of the properties.\n** Example\n:PROPERTIES:\n:callsign: Maverick\n:eyewear: Aviators\n:launch-date: [1986-05-16 Fri]\n:END:\n* Planning\norganice has native support for adding and editing DEADLINE and SCHEDULED items. It also supports [[https://orgmode.org/manual/Repeated-tasks.html][repeaters]] and [[https://orgmode.org/manual/Deadlines-and-scheduling.html#Deadlines-and-scheduling][delays]]. Check out these examples:\n\n=DEADLINE= means that the task - most likely a TODO item, though not necessarily\u2014is supposed to be finished on that date.\n\n=SCHEDULED= means that you are planning to start working on that task on the given date.\n\nScheduling an item should not be understood in the same way that we understand scheduling a meeting. Setting a date for a meeting is just a simple appointment, you can mark this entry with a simple plain timestamp, to get this item shown on the date where it applies.\n\n** An item with a deadline\n   DEADLINE: <2018-10-03 Wed>\n\nDeadlines and scheduled items produce entries in the agenda when they are over-due, so it is important to be able to mark such an entry as done once you have done so. When you mark a \u2018DEADLINE\u2019 or a \u2018SCHEDULED\u2019 with the TODO keyword \u2018DONE\u2019, it no longer produces entries in the agenda.\n** An item that is scheduled\n   SCHEDULED: <2018-10-18 Thu>\n** Doctors appointment <2020-10-07 Wed>\n\nFor simple appointments, it is enough to mark the entry with a simple plain timestamp. This will still show up in the agenda.\n\n** An item with both\n   DEADLINE: <2018-10-05 Fri> SCHEDULED: <2018-10-04 Thu>\n** TODO An item with a repeater - try swiping right to advance to the DONE state\n   DEADLINE: <2019-01-10 Thu +1w>\n   :PROPERTIES:\n   :LAST_REPEAT: [2019-01-03 Thu 15:35]\n   :END:\n\n   - State \"DONE\"       from \"TODO\"       [2019-01-03 Thu 15:35]\n\nThe =+1w= is a repeater; the intended interpretation is that the task has a deadline on '2019-01-10' and repeats itself every (one) week starting from that time. You can use yearly, monthly, weekly, daily and hourly repeat cookies by using the 'y', 'w', 'm', 'd' and 'h' letters.\n\nWith the =+1w= cookie, the date shift is always exactly one week. So if you completed the TODO for three months, marking this entry DONE still keeps it as an overdue deadline. Depending on the task, this may not be the best way to handle it. For example, if you forgot to call your father for 3 weeks, it does not make sense to call him 3 times in a single day to make up for it. Finally, there are tasks, like changing batteries, which should always repeat a certain time after the last time you did it. For these tasks, Org mode has special repeaters =++= and =.+=. For example:\n\n*** TODO Call kitchen trash\n    DEADLINE: <2019-02-11 Mon ++1w>\n    Marking this DONE shifts the date by at least one week, but also by as many weeks as it takes to get this date into the future. However, it stays on a Sunday, even if you called and marked it done on Saturday.\n\n*** TODO Check the batteries in the smoke detectors\n    DEADLINE: <2019-11-01 Fri .+1m>\n    Marking this DONE shifts the date to one month after today.\n** TODO An item with deadline and different lead time\n   DEADLINE: <2020-10-07 Wed>\n\nOn the deadline date, the task is listed in the agenda. In addition, the agenda for today carries a warning about the approaching or missed deadline, starting a defined time period before the due date (see settings \"Default DEADLINE warning period\"), and continuing until the entry is marked as done.\n\nYou can specify a different lead time for warnings for a specific deadlines using the following syntax. Here is an example with a warning period of 5 days 'DEADLINE: <2004-02-29 Sun -5d>'.\n\nIn case the task contains a repeater, the delay is considered to affect all occurrences; if you want the delay to only affect the first scheduled occurrence of the task, use '--5d' instead.\n\n\nIn the settings, there is an option to display deadline values on each headline.\n* Capture\norganice supports something like [[https://orgmode.org/manual/Capture.html][Org capture]] in the form of customizable, quickly accessible buttons for creating new headers.\n\nClick the button in the bottom right corner of the screen to see some examples. The first button, the lemon, will create a new entry in the \"Groceries\" list below this. The second button adds an entry to a more deeply nested header.\n\nOnce signed in, you can set up capture templates that specify header paths (and various other configurations). If the list is empty, the content will be inserted at the end of the file, or the beginning if the prepend option is selected. These capture templates will sync between your devices if you enable settings sync.\n** Groceries\n** Deeply\n*** Nested\n**** Headers\n***** Work\n****** Too!\n\n* Search / Task List / Clock List\n\nBelow, there is a button to open up a generic search and a task list. The modal opens \"Search\" by default, but remembers what was opened last. If there are open clocks, a third tab \"Clock List\" is added\n\nTap a header in the view to jump to it.\n\nUsing the filter input, you can search for headlines. Specifically, you can search for headline text, TODO keywords, tags, and [[https://orgmode.org/guide/Properties.html][orgmode properties]]. It also supports alternatives, and you can exclude headlines by negating a filter.\n\nWhen a header is narrowed, and the user uses the 'search' or 'task list' feature, then the searched header list is automatically narrowed to only subheaders of the originally narrowed header.\n\n** Bookmarks\n\nAfter entering a search string, you can bookmark it using the \u2b50 button.\n\nBookmarked search strings populate the suggestions if no search string is entered into the input field.\n\nBookmarks are saved by context, so there are separate bookmarks for search, task-list, and refile.\n\nThere are at most ten bookmarks for a context. Newly saved bookmarks are inserted at the top of the list. If the list gets too long, the last search strings are dropped. Duplicate bookmarks are dropped too. The list of bookmarks is ordered by last used.\n\nBookmarks are unaware of file context. Therefore, you always have the same bookmarks.\n\n** Differences Search and Task List\n\n- In the task list, you can tap on the date to switch to a more readable relative date format.\n- The task list shows only tasks - i.e. headlines with a TODO keyword are displayed.\n  - The tasks will be sorted by state and then date.\n\n** Examples for the search syntax\n\nYou can simply search for\n\n=TODO check out organice|orgmode=\n\nto filter for tasks containing these words. The pipe symbol (|) is a logical /OR/. The filter is a smart-case search:\n\n- Lower-case words mean that the filter ignores the case.\n- If a word contains upper-case letters, the filter is case-sensitive.\n\nThe following example searches for headlines containing *START* or *FINISHED* keywords and the string \"states are\". You can also use single-quotes.\n\n=START|FINISHED \"states are\"=\n\nThe next example excludes *DONE* headlines but requires the tag *fun*.\n\n=-DONE  :fun=\n\nYou can exclude text strings, tags, and properties as well by prepending the minus sign (-).\n\nYou can search for headlines with defined properties:\n\n=TODO :blocked_by:  :assignee:nobody|none=\n\nThis filters headlines having a property *blocked_by* (with any value) and a property *assignee* with a value containing =nobody= or =none=.\n\nYou can also negate filters by prefixing them with =-=. For example, if you want to search for all headers that are not DONE:\n\n=-DONE=\n\nYou can also search time ranges on headers with planning items (SCHEDULED and DEADLINE), plain active timestamps or clocked work time.\n\nThe time related filters are:\n\n- =scheduled= (shorthand =sched=)\n- =deadline= (shorthand =dead=)\n- =clock=\n- =date=\n\n=date= is a shorthand to search for planning items (SCHEDULED and DEADLINE) and plain active timestamps at the same time.\n\nThese time related filters work on time ranges indicated by =START..END= where =START= and =END= support the following units:\n\n- =h=: Hours\n- =d=: Days\n- =w=: Weeks\n- =m=: Months\n- =y=: Years\n\n=START= and =END= can both be omitted to search for an infinite timespan into the past or future. Both can be used with digits to quantify the amount (i.e. =2w= for two weeks). For both, the digit can be omitted to refer to the calendar unit instead of a time duration (i.e. =w= is the current week using the [[https://en.wikipedia.org/wiki/Week#The_ISO_week_date_system][Western Traditional]] system [from Sunday to Saturday]).\n\nThere are two special units that need no quantification:\n\n- =today=: Current date\n- =now=: Current time\n\nNext to units, =START= and =END= can also be expressed in dates like. Dates can be expressed by:\n\n- =YYYY= (i.e. 2020)\n- =YYYY-MM= (i.e. 2020-11)\n- =YYYY/MM= (i.e. 2020/11)\n- =YYYY.MM= (i.e. 2020.11)\n- =YYYYMM= (i.e. 202011)\n- =YYYY-MM-DD= (i.e. 2020-11-17)\n- =YYYY/MM/DD= (i.e. 2020/11/17)\n- =YYYY.MM.DD= (i.e. 2020.11.17)\n- =YYYYMMDD= (i.e. 20201117)\n\nSome examples on how to use time ranges:\n\n- =clock:..= searches for all items with time clocked. This includes headers that have time logged on their children.\n  - =clock:now= searches for currently clocked in headers.\n- =sched:w= searches for all scheduled items in the current week (same for other units).\n- =dead:..w= searches for all deadlines between now and the end of the week.\n- =date:today= searches for all planning items (scheduled and deadline items) as well as items with active timestamps.\n- =date:1w= (equivalent to =date:..1w=) searches from now to one week in the future.\n- =sched:2m..w= if both ends of the range are relative, they refer back to the current moment. So this searches for all scheduled items between two months before now to the end of the current week.\n\nNote that negating time ranges is not implemented.\n\nTo search for the description of your headlines, use =desc= or =description=:\n\n- =desc:\"search term\"=\n\nIf you want to search for multiple terms, you can combine them like so:\n\n- =desc:term_1 desc:term_2=\n\n\n** Auto-completion for filters\n\nYou probably noticed that organice provides suggestions for your filter. After space, =-=, =:=, and =|= you can tap on the completion \u2013 no need to type the tag, property, etc.\n\n** TODO Example with properties\t\t\t\t\t\t\t:fun:\n:PROPERTIES:\n:assignee: nobody\n:blocked_by: the others\n:END:\n\n* Agenda\norganice has a basic agenda view that you can access by tapping the calendar button at the bottom of the page.\n\nTap a header in this view to jump to it, and tap on the date to switch to a more readable relative date format.\n\nDue and overdue items with deadlines and a schedule show up on today's entry. Entries with just an active timestamp are shown only on exactly the day of the timestamp. Hence, a 'meeting' or an 'appointment' should get an active timestamp whereas a TODO often will be scheduled or even has a deadline.\n\nMore information on that in the [[https://orgmode.org/manual/Deadlines-and-Scheduling.html][org manual]].\n\nExamples:\n\n** TODO Check out the organice agenda view\nDEADLINE: <2018-09-10 Mon>\n** TODO Install organice to the homescreen on my mobile phone\nSCHEDULED: <2018-09-17 Mon>\n** This entry shows only exactly on <2020-02-17 Mon> in the agenda\n** This entry also only shows on exactly one day\n   <2020-02-17 Mon>\n* Syncing\norganice pulls down your org files from Dropbox, GitLab, or WebDAV. Click the \"Sign in\" button in the upper right hand corner to sign in with either of them and authenticate organice.\n\n** Backups\nThe first time you push changes from organice back up to your chosen sync service, organice will make a backup of the original file first. It'll be named {your-file-name}.organice-bak. Dropbox keeps a full version history of your files for you, but this is an additional precaution in case something goes wrong pushing the file back up.\n\nGenerally, when working with distributed Org files, we're recommending to put them under version control and to check for bugs and racing conditions between clients.\n\n* Multiple files\norganice supports using multiple files.\n\nDefault behaviour:\n\n- When you first open a file it is loaded from the backend. At this point the file is persisted to local storage. It will be loaded from there on future application starts. To ensure consistency whenever a file is opened it will be synced with the backend.\n- Agenda, Refile, Search and Task List by default show results from the currently viewed file.\n\nYou can adjust these defaults on a file per file basis by creating file settings in the [[/settings][settings menu]].\n\n* organice operates completely client side\nYou don't log in to organice directly because organice doesn't have a back end - it operates completely client side using Dropbox, GitLab, or WebDAV as back-ends for storage.\n* Capture URL params and Siri support\norganice supports a flexible mechanism for capturing using URL parameters. This mechanism integrates very nicely with the new [[https://support.apple.com/guide/shortcuts/welcome/ios][Siri Shortcuts]] feature in iOS 12, allowing you to use Siri to execute capture templates.\n\nYou can use [[https://www.icloud.com/shortcuts/14f91f8cf8f547a183a0734396240984][this sample Shortcut]] to get started with this right away in iOS 12. Open the link on your iOS device and click \"Get Shortcut\". Then open up the Shortcuts app and edit the template by following the directions in the comments. Then record a Siri trigger and you're good to go!\n\nAlternatively, you can take advantage of the URL parameters yourself to build your own custom capture mechanism. You can find more details about this in [[https://github.com/200ok-ch/organice/#capture-params-and-siri-support][the README file]].\n\n* Further questions?\n\nIf you've finished this interactive tutorial, but have further questions, we have you covered! There is additional [[https://organice.200ok.ch/documentation.html][documentation]] which contains more comprehensive and formal documentation, including installation instructions, deployment guides, contribution guidelines, and technical details about the project's architecture and development process. This file is aimed at both users seeking in-depth information and developers interested in contributing to the project.\n"}[e]))},et=()=>(e,t)=>{e(Mi());const n=t().base.get("lastViewedPath");n&&e(zi(n))},tt=e=>({type:"SET_FONT_SIZE",newFontSize:e}),nt=e=>({type:"SET_BULLET_STYLE",newBulletStyle:e}),at=e=>({type:"SET_SHOULD_TAP_TODO_TO_ADVANCE",newShouldTapTodoToAdvance:e}),it=e=>({type:"SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT",newAgendaDefaultDeadlineDelayUnit:e}),rt=e=>({type:"SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE",newAgendaDefaultDeadlineDelayValue:e}),st=e=>({type:"SET_EDITOR_DESCRIPTION_HEIGHT_VALUE",newEditorDescriptionHeightValue:e}),ot=e=>({type:"SET_AGENDA_START_ON_WEEKDAY",newAgendaStartOnWeekday:e}),lt=e=>({type:"SET_SHOULD_LIVE_SYNC",shouldLiveSync:e}),ct=e=>({type:"SET_SHOW_DEADLINE_DISPLAY",showDeadlineDisplay:e}),dt=e=>({type:"SET_SHOULD_SYNC_ON_BECOMING_VISIBLE",shouldSyncOnBecomingVisibile:e}),ht=e=>({type:"SET_SHOULD_SHOW_TITLE_IN_ORG_FILE",shouldShowTitleInOrgFile:e}),ut=e=>({type:"SET_SHOULD_LOG_INTO_DRAWER",shouldLogIntoDrawer:e}),pt=e=>({type:"SET_CLOSE_SUBHEADERS_RECURSIVELY",closeSubheadersRecursively:e}),mt=e=>({type:"SET_SHOULD_NOT_INDENT_ON_EXPORT",shouldNotIndentOnExport:e}),gt=e=>(t,n)=>{if(t({type:"SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND",newShouldStoreSettingsInSyncBackend:e}),!e){const e=n().syncBackend.get("client");switch(e.type){case"Dropbox":case"GitLab":case"WebDAV":e.deleteFile("/.organice-config.json").catch(((e,t)=>e?null:alert(`There was an error trying to delete the .organice-config.json file: ${t}`)))}window.previousSettingsFileContents=null}},ft=e=>({type:"SET_COLOR_SCHEME",colorScheme:e}),bt=e=>({type:"SET_THEME",theme:e}),yt=e=>({type:"SET_HAS_UNSEEN_CHANGELOG",newHasUnseenChangelog:e}),Et=e=>({type:"SET_LAST_SEEN_CHANGELOG_HEADER",newLastSeenChangelogHash:e}),wt=(e,t)=>({type:"SET_CUSTOM_KEYBINDING",keybindingName:e,keybinding:t}),kt=e=>({type:"RESTORE_BASE_SETTINGS",newSettings:e}),vt=e=>({type:"PUSH_MODAL_PAGE",modalPage:e}),Tt=()=>({type:"POP_MODAL_PAGE"}),St=()=>({type:"CLEAR_MODAL_STACK"}),_t=(e,t)=>({type:"ACTIVATE_POPUP",popupType:e,data:t}),It=()=>({type:"CLOSE_POPUP"}),Ct=e=>t=>t({type:"SET_AGENDA_TIMEFRAME",agendaTimeframe:e}),Dt=e=>t=>t({type:"SET_FINDER_TAB",finderTab:e}),At=e=>t=>t({type:"PREFER_EDIT_RAW_VALUES",preferEditRawValues:e});var Ot=Object(y.fromJS)([{description:"Groceries",headerPaths:["Capture","Groceries"],iconName:"lemon",id:w(),isAvailableInAllOrgFiles:!1,letter:"",orgFilesWhereAvailable:[],shouldPrepend:!1,template:"* TODO %?",isSample:!0},{description:"Deeply nested header",headerPaths:["Capture","Deeply","Nested","Headers","Work","Too!"],iconName:"fighter-jet",id:w(),isAvailableInAllOrgFiles:!1,letter:"",orgFilesWhereAvailable:[],shouldPrepend:!0,template:"* You can insert timestamps too! %T %?",isSample:!0}]),Nt=n(401),Pt=n(399),Lt=n(400);const Rt=()=>({type:"ADD_NEW_EMPTY_CAPTURE_TEMPLATE"}),xt=(e,t,n)=>({type:"UPDATE_TEMPLATE_FIELD_PATH_VALUE",templateId:e,fieldPath:t,newValue:n}),Mt=e=>({type:"ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY",templateId:e}),Ft=(e,t)=>({type:"REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY",templateId:e,orgFileAvailabilityIndex:t}),Ht=e=>({type:"ADD_NEW_TEMPLATE_HEADER_PATH",templateId:e}),jt=(e,t)=>({type:"REMOVE_TEMPLATE_HEADER_PATH",templateId:e,headerPathIndex:t}),Bt=e=>({type:"DELETE_TEMPLATE",templateId:e}),Vt=e=>({type:"RESTORE_CAPTURE_SETTINGS",newSettings:e}),Ut=(e,t)=>({type:"REORDER_CAPTURE_TEMPLATE",fromIndex:e,toIndex:t}),Wt=(()=>{try{localStorage.setItem("test","test");const e="test"===localStorage.getItem("test");return localStorage.removeItem("test"),e&&localStorage}catch(e){return!1}})(),zt=b.a.debounce(((e,t)=>{switch(e.type){case"Dropbox":case"WebDAV":e.createFile("/.organice-config.json",t).catch((e=>alert(`There was an error trying to push settings to your sync backend: ${e}`)));break;case"GitLab":(async(e,t)=>{const n="/.organice-config.json";let a=!1;try{const i=await e.getFileContents(n);if(a=!0,i===t)return}catch{}a?await e.updateFile(n,t):await e.createFile(n,t)})(e,t).catch((e=>alert(`There was an error trying to push settings to your sync backend: ${e}`)))}}),1e3,{maxWait:3e3}),Gt=[{category:"base",name:"fontSize",type:"nullable"},{category:"base",name:"bulletStyle",type:"nullable",default:"Fancy"},{category:"base",name:"shouldTapTodoToAdvance",type:"boolean"},{category:"base",name:"agendaDefaultDeadlineDelayUnit",type:"nullable"},{category:"base",name:"agendaDefaultDeadlineDelayValue",type:"nullable"},{category:"base",name:"editorDescriptionHeightValue",type:"nullable",default:"8"},{category:"base",name:"agendaStartOnWeekday",type:"nullable",default:1},{category:"base",name:"shouldStoreSettingsInSyncBackend",type:"boolean",default:!0},{category:"base",name:"lastSeenChangelogHash",type:"nullable"},{category:"base",name:"customKeybindings",type:"json"},{category:"base",name:"shouldLiveSync",type:"boolean",default:!0},{category:"base",name:"showDeadlineDisplay",type:"boolean",default:!1},{category:"base",name:"shouldSyncOnBecomingVisibile",type:"boolean",default:!0},{category:"base",name:"shouldShowTitleInOrgFile",type:"boolean"},{category:"base",name:"shouldLogIntoDrawer",type:"boolean"},{category:"base",name:"closeSubheadersRecursively",type:"boolean"},{category:"base",name:"shouldNotIndentOnExport",type:"boolean"},{category:"org",name:"showClockDisplay",type:"boolean"},{category:"base",name:"colorScheme",type:"string",default:"OS"},{category:"base",name:"theme",type:"string",default:"Solarized"},{category:"capture",name:"captureTemplates",type:"json",default:Object(y.List)()},{category:"org",name:"fileSettings",type:"json",default:Object(y.List)()},{category:"base",name:"agendaTimeframe",type:"string",default:"Week"},{category:"base",name:"preferEditRawValues",type:"boolean"},{category:"org",name:"bookmarks",type:"json",default:Object(y.Map)({search:Object(y.List)(),"task-list":Object(y.List)(),refile:Object(y.List)()})}],$t=()=>{const e=localStorage.getItem("headerOpenness");return e?JSON.parse(e):null},Kt=(e,t)=>t.filter((e=>!e.depreacted)).filter((e=>"org"===e.category)).map((t=>"json"===t.type?[t.name,JSON.stringify(e.org.present.get(t.name)||t.default||{})]:[t.name,e.org.present.get(t.name)])).concat(Gt.filter((e=>"org"!==e.category)).map((t=>"json"===t.type?[t.name,JSON.stringify(e[t.category].get(t.name)||t.default||{})]:[t.name,e[t.category].get(t.name)||t.default]))),Yt=e=>JSON.stringify(b.a.fromPairs(e),null,2),Jt=()=>{let e=(()=>{let e={syncBackend:Object(y.Map)(),org:{past:[],present:Object(y.Map)({files:Object(y.Map)(),fileSettings:[],opennessState:Object(y.Map)(),search:Object(y.Map)({searchFilter:"",searchFilterExpr:[]}),bookmarks:Object(y.Map)({search:Object(y.List)(),"task-list":Object(y.List)(),refile:Object(y.List)()})}),future:[]},base:Object(y.Map)({isLoading:Object(y.Set)(),finderTab:"Search"}),capture:Object(y.Map)()};return Gt.forEach((t=>{const n=t.default;"org"===t.category?e[t.category].present=e[t.category].present.set(t.name,n):e[t.category]=e[t.category].set(t.name,n)})),e})();return Wt?(e=>{Gt.forEach((t=>{let n=localStorage.getItem(t.name);"nullable"===t.type?"null"===n&&(n=null):"boolean"===t.type?n="true"===n:"json"===t.type&&(n=n?Object(y.fromJS)(JSON.parse(n)):t.default||Object(y.Map)()),n=n||t.default,"org"===t.category?e[t.category].present=e[t.category].present.set(t.name,n):e[t.category]=e[t.category].set(t.name,n)})),e.capture.get("captureTemplates")&&(e.capture=e.capture.update("captureTemplates",(e=>e.map((e=>e.set("id",w())))))),e.org.present.get("fileSettings")&&(e.org.present=e.org.present.update("fileSettings",(e=>e.map((e=>e.set("id",w()))))));const t=$t();return t&&(e.org.present=e.org.present.set("opennessState",Object(y.fromJS)(t))),window.previousSettingsFileContents=Yt(Kt(e,Gt)),Li(e)})(e):e},qt=(e,t)=>{Wt&&localStorage.setItem(e,t)},Xt=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Wt){const n=localStorage.getItem(e);return t&&"null"===n?null:n}return null};var Zt=n(164),Qt=n.n(Zt),en=n(390),tn=n(391),nn=n(102),an=n(392),rn=n(393),sn=n(394),on=n(395),ln=n(396),cn=n(397),dn=n(398);const hn=(e,t)=>{const n=new Date(e);switch(t){case"h":return Object(on.a)(n);case"d":return Object(nn.a)(n);case"w":return Object(ln.a)(n);case"m":return Object(tn.a)(n);case"y":return Object(en.a)(n);default:throw Error("unknown `unit` for timerange search")}},un=(e,t)=>{const n=new Date(e);switch(t){case"h":return Object(cn.a)(n);case"d":return Object(sn.a)(n);case"w":return Object(dn.a)(n);case"m":return Object(rn.a)(n);case"y":return Object(an.a)(n);default:throw Error("unknown `unit` for timerange search")}},pn=e=>null===e?new Date:"timestamp"===e.type?(e=>{const t=new Date;return t.setFullYear(e.year),null===e.month?Object(en.a)(t):null===e.day?(t.setMonth(e.month-1),Object(tn.a)(t)):(t.setMonth(e.month-1),t.setDate(e.day),Object(nn.a)(t))})(e):"special"===e.type?(e=>{const t=new Date;return"now"===e.value?t:"today"===e.value?Object(nn.a)(t):void 0})(e):"offset"===e.type?G(new Date,e.value,e.unit):"unit"===e.type?hn(new Date,e.unit):void 0,mn=e=>null===e?new Date:"timestamp"===e.type?(e=>{const t=new Date;return t.setFullYear(e.year),null===e.month?Object(an.a)(t):null===e.day?(t.setMonth(e.month-1),Object(rn.a)(t)):(t.setMonth(e.month-1),t.setDate(e.day),Object(sn.a)(t))})(e):"special"===e.type?(e=>{const t=new Date;return"now"===e.value?t:"today"===e.value?Object(sn.a)(t):void 0})(e):"offset"===e.type?z(new Date,e.value,e.unit):"unit"===e.type?un(new Date,e.unit):void 0,gn=e=>"offset"===e.type||"unit"===e.type,fn=e=>{const t=e.field.timerange;let n,a;if("point"===t.type){const e=t.point;return"offset"===e.type?(n=new Date,a=z(new Date(n))):(n=pn(e),a=mn(e)),e=>n<=W(e)&&W(e)<=a}if("range"===t.type){const e=t.from?t.from:{type:"special",value:"now"},n=t.to?t.to:{type:"special",value:"now"};let a,i;if(gn(e)===gn(n))a=pn(e),i=mn(n);else if("offset"===e.type)i=mn(n),a=G(new Date(i),e.value,e.unit);else if("offset"===n.type)a=pn(e),i=z(new Date(a),n.value,n.unit);else if("unit"===e.type)i=mn(n),a=hn(i,e.unit);else{if("unit"!==n.type)throw Error("unable to construct timerangefilter");a=pn(e),i=un(a,n.unit)}return e=>a<=W(e)&&W(e)<=i}if("all"===t.type)return e=>!0;throw Error("unable to construct timefilter")},bn=e=>t=>t.some((t=>e.includes(t))),yn=e=>t=>0!==e.size&&e.some((e=>t(e))),En=(e,t,n)=>(a,i,r)=>{const s=((e,t,n)=>(a,i,r)=>{const s=[].concat(t,He(Object(y.fromJS)(n)).toJS().map((e=>e+":"))),o=a?kn(a,i,r):null,l=i.charAt(r-1),c=r>1?i.charAt(r-2):"";if(null===o);else{if(o===wn)return e;if("case-sensitive"===o.type){if(l.match(/[A-Z]/)){const t=l,n=e.filter((e=>e.startsWith(t))).map((e=>e.substring(t.length)));if([" ","","|","-"].includes(c))return n}}else{if("ignore-case"===o.type)return"-"===l&&[" ",""].includes(c)?e:[];if("tag"===o.type){if(":"===l)return s}else if("property"===o.type&&":"===l){if(" "===c||""===c)return s;{const e=i.substring(0,r-1).lastIndexOf(":"),t=i.substring(e+1,r-1),a=e=>e.match(/ /)?e.match(/"/)?e.match(/'/)?[e.match(/^[^ ]*/)[0]]:[`'${e}'`]:[`"${e}"`]:[e];if(e>=0&&t.match(/^[^ ]+$/))return je(Object(y.fromJS)(n),t).flatMap(a).toJS()}}}}if(":"===l){if([" ","","-"].includes(c))return s}else if("|"===l){const n=i.substring(0,r).lastIndexOf(":"),a=i.substring(n+1,r-1);return n>-1&&!a.match(/ /)?t:e}return[]})(e,t,n)(a,i,r);return s.map((e=>i.substring(0,r)+e+i.substring(r)))},wn=" ",kn=(e,t,n)=>{if(0===e.length)return wn;const a=(e,t)=>({value:e,elem:t}),{value:i}=e.reduce(((e,t)=>{let{value:i,elem:r}=e;return null===r?a(i,null):n>=t.offset&&n<=t.endOffset?a(t,null):n>r.endOffset&&n<t.offset?a(wn,null):a(null,t)}),{value:null,elem:{offset:-1,endOffset:-1}});return n>e[e.length-1].endOffset?wn:i},vn=e=>0!==e.get("logBookEntries",[]).filter((e=>e.get("start")&&!e.get("end"))).size,Tn=(e,t)=>t.get("logBookEntries",[]).map((e=>[e.get("start"),e.get("end")])).filter((e=>{let[t,n]=e;return t&&n})).filter((t=>t.some((t=>e.every((e=>e(t))))))).map((e=>{let[t,n]=e;return W(n)-W(t)})).reduce(((e,t)=>e+t),0),Sn=e=>{if(!e)return e;const t=e.map((e=>e.set("totalTimeLogged",(e=>e.get("logBookEntries",[]).map((e=>e.get("start")&&e.get("end")?W(e.get("end"))-W(e.get("start")):0)).reduce(((e,t)=>e+t),0))(e))));return t.map(((e,n)=>{const a=le(t,n).reduce(((e,t)=>e+t.get("totalTimeLogged")),e.get("totalTimeLogged"));return e.set("totalTimeLoggedRecursive",a)}))},_n=/(?: (\+|\+\+|\.\+|-|--)(\d+)([hdwmy])(?:\/(\d+)([hdwmy]))?)?/,In=new RegExp([/([<[])/,/(\d{4})-(\d{2})-(\d{2})/,/(?: ([^0-9\s]{1,9}))?/,/(?: ([012]?\d:[0-5]\d))?(?:-([012]?\d:[0-5]\d))?/,_n,_n,/[>\]]/].map((e=>e.source)).join("")),Cn=new RegExp([/(\[\[([^\]]*)\]\]|\[\[([^\]]*)\]\[([^\]]*)\]\])|(\[((\d*%)|(\d*\/\d*))\])|((^|\s|[({'"])([*/~=_+])([^\s,'](.*?))\11([\s\-.,:;!?'")}]?))/.source,`(${In.source}(?:--${In.source})?)`,/(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\\+.~#?&//=]*))/.source,/([a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)/.source,/((\+|00)\d{8,30})/.source,/((\+\d{1,2}\s)?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4})/.source,/(0[1-9]{2}\s[0-9]{3}\s[0-9]{2}\s[0-9]{2})/.source,/(0[0-9]{9,11})/.source,/(www(\.[-_a-zA-Z0-9]+){2,}(\/[-_a-zA-Z0-9]+)*)/.source].join("|"),"g"),Dn=(e,t)=>{const[n,a,i,r,s,o,l,c,d,h,u,p,m,g,f,b,y]=t.map((t=>e[t]));if(!a)return null;const[E,w]=o?o.split(":"):[],[k,v]=l?l.split(":"):[];let T,S,_,I,C,D,A,O;return["+","++",".+"].includes(c)?(T=c,S=d,_=h,I=u,C=p):["-","--"].includes(c)&&(D=c,A=d,O=h),["+","++",".+"].includes(m)?(T=m,S=g,_=f,I=b,C=y):["-","--"].includes(m)&&(D=m,A=g,O=f),{isActive:"<"===n,year:a,month:i,day:r,dayName:s,startHour:E,startMinute:w,endHour:k,endMinute:v,repeaterType:T,repeaterValue:S,repeaterUnit:_,delayType:D,delayValue:A,delayUnit:O,repeaterDeadlineValue:I,repeaterDeadlineUnit:C}},An=function(e){let{shouldAppendNewline:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];let a=Cn.exec(e);for(;a;){if(a[2])n.push({type:"link",rawText:a[0],uri:a[2],index:a.index});else if(a[3]&&a[4])n.push({type:"link",rawText:a[0],uri:a[3],title:a[4],index:a.index});else if(a[7]){const e=a[7].match(/(\d*)%/);n.push({type:"percentage-cookie",rawText:a[0],percentage:e[1],index:a.index})}else if(a[8]){const e=a[8].match(/(\d*)\/(\d*)/);n.push({type:"fraction-cookie",rawText:a[0],fraction:[e[1],e[2]],index:a.index})}else if(a[11]){const e={"~":"inline-code","*":"bold","/":"italic","+":"strikethrough",_:"underline","=":"verbatim"}[a[11]],t=a[10].length;n.push({type:"inline-markup",rawText:a[0].substring(t,a[12].length+2+t),index:a.index+t,content:a[12],markupType:e})}else if(a[15]){const e=Dn(a,b.a.range(16,33)),t=Dn(a,b.a.range(33,50));n.push({type:"timestamp",rawText:a[0],index:a.index,firstTimestamp:e,secondTimestamp:t})}else a[50]?n.push({type:"url",rawText:a[0],index:a.index}):a[53]?n.push({type:"e-mail",rawText:a[0],index:a.index}):a[54]||a[56]||a[58]||a[59]?n.push({type:"phone-number",rawText:a[0],index:a.index}):a[60]&&n.push({type:"www-url",rawText:a[0],index:a.index});a=Cn.exec(e)}const i=[];let r=0;if(n.forEach((t=>{let n=t.index;if(n!==r){const t=e.substring(r,n);i.push({type:"text",contents:t})}const a=On(e,t);i.push(a),r=t.index+t.rawText.length})),r!==e.length||t){const n=e.substring(r,e.length)+(t?"\n":"");i.push({type:"text",contents:n})}return i},On=(e,t)=>{switch(t.type){case"link":const e={id:w(),type:"link",contents:{uri:t.uri}};return t.title&&(e.contents.title=t.title),e;case"percentage-cookie":return{id:w(),type:"percentage-cookie",percentage:t.percentage};case"fraction-cookie":return{id:w(),type:"fraction-cookie",fraction:t.fraction};case"inline-markup":return{id:w(),type:"inline-markup",content:t.content,markupType:t.markupType};case"timestamp":return{id:w(),type:"timestamp",firstTimestamp:t.firstTimestamp,secondTimestamp:t.secondTimestamp};case"url":case"www-url":case"e-mail":case"phone-number":return{id:w(),type:t.type,content:t.rawText};default:throw Error("The regex parser parsed something but it is not converted to proper data structure.")}},Nn=e=>{const t={id:w(),type:"table",contents:[[]],columnProperties:[]};e.map((e=>e.trim())).forEach((e=>{if(e.startsWith("|-"))t.contents.push([]);else{const n=b.a.last(t.contents),a=e.substr(1,e.length-2).split("|");0===n.length?a.forEach((e=>n.push(e))):a.forEach(((e,t)=>{n[t]+=`\n${e}`}))}})),t.contents=t.contents.map((e=>({id:w(),contents:e.map((e=>({id:w(),contents:An(e,{excludeCookies:!0}),rawContents:e})))}))),0===b.a.last(t.contents).contents.length&&(t.contents=t.contents.slice(0,t.contents.length-1));const n=Math.max(...t.contents.map((e=>e.contents.length)));return t.contents.forEach((e=>{e.contents.length<n&&b.a.times(n-e.contents.length,(()=>{e.contents.push({id:w(),contents:[],rawContents:""})}))})),t},Pn=function(e){let{excludeContentElements:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.split("\n"),a=/^\s*([-+*]|(\d+(\.|\)))) (.*)/;let i=null;const r=b.a.flatten(n.map(((e,r)=>{const s=e.match(/^( *)/)[0].length;return null!==i&&(s>i||!e.trim())?[{type:"raw-list-content",line:e}]:(i=null,e.match(a)&&!t?(i=s,[{type:"raw-list-header",line:e}]):e.trim().startsWith("|")&&!t?[{type:"raw-table",line:e}]:An(e,{shouldAppendNewline:r!==n.length-1,excludeCookies:!0}))}))),s=[];for(let o=0;o<r.length;++o){const e=r[o];if("raw-table"===e.type){const e=b.a.takeWhile(r.slice(o),(e=>"raw-table"===e.type)).map((e=>e.line));s.push(Nn(e)),o+=e.length-1}else if("raw-list-header"===e.type){const t=e.line.match(/^( *)/)[0].length,n=b.a.takeWhile(r.slice(o+1),(e=>"raw-list-content"===e.type)).map((e=>e.line)).map((e=>e.startsWith(" ".repeat(t+2))?e.substr(t+2):e.substr(t+1)));""===n[n.length-1]&&(n[n.length-1]=" ");const i=Pn(n.join("\n")).toJS();o+=n.length;const l=!!e.line.match(/^\s*\d+[.)]/);let c=e.line.match(a)[4],d=null;c.match(/^\s*\[@\d+\]/)&&(d=c.match(/^\s*\[@(\d+)\]/)[1],c=c.replace(/^\s*\[@\d+\]\s*/,""));let h=null;const u=!!c.match(/^\s*\[[ X-]\]/);if(u){h={" ":"unchecked",X:"checked","-":"partial"}[c.match(/^\s*\[([ X-])\]/)[1]],c=c.replace(/^\s*\[[ X-]\]\s*/,"")}const p={id:w(),titleLine:An(c),contents:i,forceNumber:d,isCheckbox:u,checkboxState:h},m=s.length-1;m>=0&&"list"===s[m].type?s[m].items.push(p):s.push({type:"list",id:w(),items:[p],bulletCharacter:e.line.trim()[0],numberTerminatorCharacter:l?e.line.match(/\s*\d+([.)])/)[1]:null,isOrdered:l})}else s.push(e)}return Object(y.fromJS)(s)},Ln=e=>{let{type:t,timestamp:n,id:a}=e;return Object(y.fromJS)({type:t,timestamp:n,id:a||w()})},Rn=e=>{const t=(e=>{const t=RegExp(`((DEADLINE|SCHEDULED|CLOSED):\\s*${Bn(In)})?`),n=jn(/^\s*/,t,/[ \t]*/,t,/[ \t]*/,t,/[ \t]*\n?/),a=e.match(n),i=Object(y.fromJS)([2,21,40].map((e=>{const t=a[e];if(!t)return null;const n=Dn(a,b.a.range(e+1,e+1+17));return Ln({type:t,timestamp:n})})).filter((e=>!!e)));return 0===i.size?{planningItems:Object(y.fromJS)([]),strippedDescription:e}:{planningItems:i,strippedDescription:e.replace(n,"")}})(e),n=t.planningItems,a=(e=>{const t=e.split("\n"),n=t.findIndex((e=>":PROPERTIES:"===e.trim())),a=t.findIndex((e=>":END:"===e.trim()));return-1!==n&&-1!==a&&e.trim().startsWith(":PROPERTIES:")?{propertyListItems:Object(y.fromJS)(t.slice(n+1,a).map((e=>{const t=e.match(/:([^\s]*):(?: (.*))?/);if(!t)return null;let n=t[2]?An(t[2]):null;return n&&"timestamp"!==n[0].type&&(n=[{contents:t[2],type:"text"}]),{property:t[1],value:n,id:w()}})).filter((e=>!!e))),strippedDescription:t.slice(a+1).join("\n")}:{propertyListItems:Object(y.List)(),strippedDescription:e}})(t.strippedDescription),i=(e=>{const t=e.split("\n"),n=t.findIndex((e=>":LOGBOOK:"===e.trim()));return-1!==n?Jn(t.slice(0,n),t.slice(n)):Jn([],[e])})(a.strippedDescription),r=(e=>{const t=e.split("\n"),n=t.findIndex((e=>":LOGBOOK:"===e.trim())),a=t.findIndex((e=>":END:"===e.trim()));if(-1===n||-1===a||!e.trim().startsWith(":LOGBOOK:"))return{logBookEntries:Object(y.List)(),strippedDescription:e};const i=jn(/^CLOCK: /,In,/$/),r=jn(/^CLOCK: /,In,"/--/",In,/\s*=>\s*\S+$/);return{logBookEntries:Object(y.fromJS)(t.slice(n+1,a).map((e=>{const t=e.trim().match(r);if(t)return{start:Dn(t,b.a.range(1,18)),end:Dn(t,b.a.range(18,39)),id:w()};const n=e.trim().match(i);return n?{start:Dn(n,b.a.range(1,18)),end:null,id:w()}:{raw:e.trimLeft(),id:w()}}))),strippedDescription:t.slice(a+1).join("\n")}})(i.strippedDescription);return{planningItems:n,propertyListItems:a.propertyListItems,logNotes:i.logNotes,logBookEntries:r.logBookEntries,strippedDescription:r.strippedDescription}},xn=(e,t)=>{const{planningItems:n,propertyListItems:a,logNotes:i,logBookEntries:r,strippedDescription:s}=Rn(t),o=Pn(s),l=e.getIn(["titleLine","title"]),c=zn(n,Wn("TIMESTAMP_TITLE",l),Wn("TIMESTAMP_DESCRIPTION",o),Wn("TIMESTAMP_LOG_NOTES",i));return e.set("rawDescription",s).set("description",o).set("planningItems",c).set("propertyListItems",a).set("logNotes",i).set("logBookEntries",r)},Mn=Object(y.fromJS)([{keywords:["TODO","DONE"],completedKeywords:["DONE"],default:!0}]),Fn=(e,t)=>{const n=t.flatMap((e=>e.get("keywords"))).filter((t=>e.startsWith(t+" "))).first();let a=e;n&&(a=a.substr(n.length+1));let i=[];if(a.trimRight().endsWith(":")){const e=a.trimRight().split(" "),t=e[e.length-1];/^:[^\s]+:$/.test(t)&&(a=a.substr(0,a.length-t.length),i=t.split(":").filter((e=>""!==e)))}const r=An(a);return Object(y.fromJS)({title:r,rawTitle:a,todoKeyword:n,tags:i})},Hn=(e,t,n)=>{0===n.size&&(n=Mn);const a=Fn(e,n);return Object(y.fromJS)({titleLine:a,rawDescription:"",description:[],opened:!1,id:w(),nestingLevel:t,planningItems:[],propertyListItems:[],logNotes:[],logBookEntries:[]})},jn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>RegExp(Bn(e)+Bn(t))))},Bn=e=>{const t=e.toString();return t.substring(1,t.length-1)},Vn=e=>{let t=Object(y.List)(),n=Object(y.List)();return e.forEach((e=>{const a=(e=>{if(!(e=>{const t=e.toLowerCase();return t.startsWith("#+todo: ")||t.startsWith("#+typ_todo: ")||t.startsWith("#+seq_todo: ")})(e))return null;const t=e.substr(e.indexOf(":")+2).split(/\s/),n=t.filter((e=>"|"!==e)).map((e=>e.replace(/\(.[!@]?(\/[!@])?\)$/,""))),a=t.indexOf("|"),i=a>=0?n.slice(a):[];return Object(y.fromJS)({keywords:n,completedKeywords:i,configLine:e,default:!1})})(e);a?t=t.push(a):e.startsWith("#+")&&(n=n.push(e))})),0===t.size&&(t=Mn),{todoKeywordSets:t,fileConfigLines:n}},Un=e=>{let t=Object(y.List)();const n=Yn(e);let a=Object(y.List)();const{todoKeywordSets:i,fileConfigLines:r}=Vn(n);n.forEach((e=>{if(e.match(/^\*+ /)){const n=Kn(e),a=e.substr(n+1);t=t.push(Hn(a,n,i))}else 0===t.size?a=a.push(e):t=t.updateIn([t.size-1,"rawDescription"],(t=>(t=t||"")+(e+"\n")))})),t=t.map((e=>{const t=e.get("rawDescription");return xn(e,t)})),t=Sn(t);const s=Object(y.fromJS)(t).filter(vn).size;return Object(y.fromJS)({headers:t,activeClocks:s,todoKeywordSets:i,fileConfigLines:r,linesBeforeHeadings:a})},Wn=(e,t)=>t.filter((e=>"timestamp"===e.get("type")&&e.getIn(["firstTimestamp","isActive"]))).map((t=>Ln({type:e,timestamp:t.get("firstTimestamp"),id:t.get("id")}))),zn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[0].concat(...t.slice(1))},Gn=(e,t,n)=>e.filter((e=>e.get("type")!==t)).merge(Wn(t,n)),$n=e=>{let t=e.get("planningItems");return t=Gn(t,"TIMESTAMP_TITLE",e.getIn(["titleLine","title"])),t=Gn(t,"TIMESTAMP_DESCRIPTION",e.get("description")),t=Gn(t,"TIMESTAMP_LOG_NOTES",e.get("logNotes")),t},Kn=e=>{const t=e.indexOf(" ");return-1===t?e.trimRight().length:t},Yn=e=>{const t=e.split("\n");return t.length>0&&""!==t[t.length-1]?t:t.slice(0,t.length-1)},Jn=(e,t)=>{const n=e.join("\n");return{rawLogNotes:n,logNotes:Pn(n),strippedDescription:t.join("\n")}};var qn=n(26);const Xn=(e,t)=>{const{path:n,contents:a}=t,i=Un(a);return e.setIn(["files",n,"headers"],i.get("headers")).setIn(["files",n,"todoKeywordSets"],i.get("todoKeywordSets")).setIn(["files",n,"fileConfigLines"],i.get("fileConfigLines")).setIn(["files",n,"linesBeforeHeadings"],i.get("linesBeforeHeadings")).setIn(["files",n,"activeClocks"],i.get("activeClocks"))},Zn=(e,t)=>{const n=e.get("headers"),a=ie(n,t.headerId);return e.setIn(["headers",a,"opened"],!0)},Qn=(e,t)=>{const n=e.get("headers"),{header:a,headerIndex:i}=ae(n,t.headerId),r=a.get("opened");if(r&&e.get("narrowedHeaderId")===t.headerId)return e;if(r&&t.closeSubheadersRecursively){const a=((e,t)=>{let[n,a]=oe(e,t);return b.a.range(n,a)})(n,t.headerId);a.forEach((t=>{e=e.setIn(["headers",t,"opened"],!1)}))}return e.setIn(["headers",i,"opened"],!r)},ea=(e,t)=>e.set("selectedHeaderId",t.headerId),ta=(e,t)=>{let n=e.get("headers");const{headerId:a}=t;let i=ue(n,a);for(;i;){const e=ie(n,i);n=n.setIn([e,"opened"],!0),i=ue(n,i)}return e.set("headers",n)},na=(e,t)=>{const n=t.filter((e=>e)).length,a=t.length;return e.map((e=>{switch(e.get("type")){case"fraction-cookie":return e.set("fraction",Object(y.List)([n,a]));case"percentage-cookie":return e.set("percentage",Math.floor(n/a*100));default:return e}}))},aa=(e,t)=>{const n=e.get("headers"),a=ie(n,t),i=ce(n,t),r=[];for(let o=0;o<i.size;++o){const e=i.get(o);r.push(e);o+=ce(n,e.get("id")).size}let s=r.map((e=>e.getIn(["titleLine","todoKeyword"]))).filter((e=>!!e)).map((t=>xe(e.get("todoKeywordSets"),t).get("completedKeywords").contains(t)));return 0===s.length&&(s=n.get(a).get("description").filter((e=>"list"===e.get("type"))).flatMap((e=>e.get("items"))).filter((e=>e.get("isCheckbox"))).map((e=>"checked"===e.get("checkboxState"))).toJS()),e.updateIn(["headers",a,"titleLine","title"],(e=>na(e,s))).updateIn(["headers",a,"titleLine"],(e=>e.set("rawTitle",q(e.get("title")))))},ia=(e,t)=>{const n=ue(e.get("headers"),t);return n?aa(e,n):e},ra=(e,t)=>{const{headerId:n,logIntoDrawer:a,timestamp:i}=t,r=n||e.get("selectedHeaderId");if(!r)return e;const s=e.get("headers"),{header:o,headerIndex:l}=ae(s,r),c=o.getIn(["titleLine","todoKeyword"]),d=xe(e.get("todoKeywordSets"),c),h=d.get("keywords").indexOf(c)+1,u=d.get("keywords").get(h)||"";return e=Ii({currentTodoSet:d,newTodoState:u,indexedPlanningItemsWithRepeaters:o.get("planningItems").map(((e,t)=>[e,t])).filter((e=>{let[t]=e;return!!t.getIn(["timestamp","repeaterType"])})),state:e,headerIndex:l,currentTodoState:c,logIntoDrawer:a,timestamp:i}),e=ia(e,r)},sa=(e,t)=>{const{headerId:n,logIntoDrawer:a,newTodoState:i,timestamp:r}=t,s=n||e.get("selectedHeaderId");if(!s)return e;const o=e.get("headers"),{header:l,headerIndex:c}=ae(o,s),d=l.getIn(["titleLine","todoKeyword"]),h=xe(e.get("todoKeywordSets"),d);if(h===xe(e.get("todoKeywordSets"),i)){e=Ii({currentTodoSet:h,newTodoState:i,indexedPlanningItemsWithRepeaters:l.get("planningItems").map(((e,t)=>[e,t])).filter((e=>{let[t]=e;return!!t.getIn(["timestamp","repeaterType"])})),state:e,headerIndex:c,currentTodoState:d,logIntoDrawer:a,timestamp:r})}else e=e.setIn(["headers",c,"titleLine","todoKeyword"],i);return e=ia(e,s)},oa=(e,t)=>e.set("editMode",t.editModeType),la=e=>e.set("editMode",null),ca=(e,t)=>{const n=e.get("headers"),a=ie(n,t.headerId),i=e.get("todoKeywordSets"),r=Fn(t.newRawTitle.trim(),i);return e=(e=e.setIn(["headers",a,"titleLine"],r)).updateIn(["headers",a,"planningItems"],(e=>Gn(e,"TIMESTAMP_TITLE",r.get("title")))),ia(e,t.headerId)},da=(e,t)=>{const n=e.get("headers"),a=ie(n,t.headerId);return e.updateIn(["headers",a],(e=>xn(e,t.newRawDescription)))},ha=(e,t)=>{const n=e.get("headers"),{header:a,headerIndex:i}=ae(n,t.headerId),r=ce(n,t.headerId),s=a.getIn(["titleLine","todoKeyword"]),o=Hn(s?s+" ":"",a.get("nestingLevel"),e.get("todoKeywordSets"));return t.headerId===e.get("narrowedHeaderId")&&(e=e.set("narrowedHeaderId",null)),e.update("headers",(e=>e.insert(i+r.size+1,o)))},ua=e=>{let t=Hn("First header",1,e.get("todoKeywordSets")),n="Extend the file from here";return e.get("linesBeforeHeadings").size>0&&(n=e.get("linesBeforeHeadings").toJS().join("\n"),e=e.set("linesBeforeHeadings",Object(y.List)())),t=xn(t,n),e.update("headers",(e=>e.insert(0,t)))},pa=(e,t)=>{const n=e.get("headers"),{header:a,headerIndex:i}=ae(n,t.headerId),r=ce(n,t.headerId),s=n.get(i+r.size+1);return s&&s.get("nestingLevel")===a.get("nestingLevel")?e.set("selectedHeaderId",s.get("id")):e},ma=e=>{const t=e.get("headers");if(void 0===e.get("selectedHeaderId"))return e.set("selectedHeaderId",t.getIn([0,"id"]));const n=((e,t)=>e.slice(t+1).find((t=>me(e,t.get("id")))))(t,ie(t,e.get("selectedHeaderId")));return n?e.set("selectedHeaderId",n.get("id")):e},ga=e=>{const t=e.get("headers"),n=((e,t)=>e.slice(0,t).reverse().find((t=>me(e,t.get("id")))))(t,ie(t,e.get("selectedHeaderId")));return n?e.set("selectedHeaderId",n.get("id")):e},fa=(e,t)=>{let n=e.get("headers");const a=ie(n,t.headerId),i=1+ce(n,t.headerId).size,r=ue(n,t.headerId);return b.a.times(i).forEach((()=>{n=n.delete(a)})),t.headerId===e.get("narrowedHeaderId")&&(e=e.set("narrowedHeaderId",null)),e=e.set("headers",n),r&&(e=aa(e,r)),e},ba=(e,t)=>{let n=e.get("headers");const a=ie(n,t.headerId),i=((e,t)=>{const n=e.getIn([t,"nestingLevel"]);for(let a=t-1;a>=0;--a){const t=e.get(a);if(t.get("nestingLevel")<n)return null;if(t.get("nestingLevel")===n)return a}return null})(n,a);if(null===i)return e;const r=ce(n,t.headerId);return b.a.times(1+r.size).forEach((()=>{n=n.insert(i,n.get(a+r.size)),n=n.delete(a+r.size+1)})),e.set("headers",n)},ya=(e,t)=>{let n=e.get("headers");const{header:a,headerIndex:i}=ae(n,t.headerId),r=ce(n,t.headerId),s=i+r.size+1,o=n.get(s);if(!o||o.get("nestingLevel")<a.get("nestingLevel"))return e;const l=ce(n,o.get("id"));return b.a.times(1+l.size).forEach((()=>{n=n.insert(i,n.get(s+l.size)),n=n.delete(s+l.size+1)})),e.set("headers",n)},Ea=(e,t)=>{const n=e.get("headers"),a=ie(n,t.headerId),i=ue(n,t.headerId);return e=Ci(e=Di({state:e,headerIndex:a},"-"),i,t)},wa=(e,t)=>{const n=e.get("headers"),a=ie(n,t.headerId),i=ue(n,t.headerId);return e=Di({state:e,headerIndex:a},"+"),e=Ci(e=ge(e,t.headerId),i,t)},ka=(e,t)=>{const n=e.get("headers"),{header:a,headerIndex:i}=ae(n,t.headerId),r=ue(n,t.headerId);if(1===a.get("nestingLevel"))return e;return e=Ci(e=Di({state:e,headerIndex:i,subheaders:ce(n,t.headerId)},"-"),r,t)},va=(e,t)=>{const n=e.get("headers"),a=ie(n,t.headerId),i=ue(n,t.headerId);return e=Ci(e=Di({state:e,headerIndex:a,subheaders:ce(n,t.headerId)},"+"),i,t),ge(e,t.headerId)},Ta=e=>{let{fromList:t,fromIndex:n,toIndex:a,item:i}=e;const r=t.get(a);t=t.delete(n);const s=t.indexOf(r);return t=t.insert(s+1,i),[t,t]},Sa=e=>{let{fromList:t,fromIndex:n,toList:a,toIndex:i,item:r}=e;const s=a.get(i);t=t.delete(n);const o=a.indexOf(s);return a=a.insert(o+1,r),[t,a]},_a=(e,t)=>{const{noteText:n}=t,a=e.get("selectedHeaderId"),i=e.get("headers"),r=ie(i,a);return e.updateIn(["headers",r],(e=>{const t=e.update("logNotes",(e=>Pn(n+(e.isEmpty()?"\n":"")).concat(e)));return t.set("planningItems",$n(t))}))},Ia=(e,t)=>{const{inputText:n,currentDate:a}=t,i=(r=n,s=70,r.replace(new RegExp(`(?![^\\n]{1,${s}}$)([^\\n]{1,${s}})\\s`,"g"),"$1\n")).replace(/\n(.)/g,"\n  $1");var r,s;const o=U(a,{isActive:!1,withStartTime:!0});return _a(e,{noteText:`- Note taken on ${o} \\\\\n  ${i}`})},Ca=(e,t)=>e.set("narrowedHeaderId",t.headerId),Da=e=>e.set("narrowedHeaderId",null),Aa=(e,t)=>e.set("isDirty",t.isDirty),Oa=(e,t)=>e.set("selectedTableId",t.tableId),Na=(e,t)=>e.set("selectedTableCellId",t.cellId),Pa=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=e.get("headers");n||(n=ve(a,t));const i=ie(a,n.get("id"));return e.updateIn(["headers",i],(e=>e.set("rawDescription",q(e.get("description")))))},La=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",(e=>Oe(e,t,(e=>t=>t.insert(e+1,(e=>e.get(0).set("id",w()).update("contents",(e=>e.map((e=>e.set("id",w()).set("contents",Object(y.List)()).set("rawContents",""))))))(t)))))),Pa(e,t)):e},Ra=e=>{const t=e.get("selectedTableCellId");if(!t)return e;const n=ve(e.get("headers"),t);return e=(e=e.update("headers",(e=>Oe(e,t,(e=>t=>t.delete(e)))))).set("selectedTableCellId",null),Pa(e,t,n)},xa=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",(e=>Oe(e,t,((e,t)=>e=>e.map((e=>e.update("contents",(e=>e.insert(t+1,Object(y.fromJS)({id:w(),contents:[],rawContents:""})))))))))),Pa(e,t)):e},Ma=e=>{const t=e.get("selectedTableCellId");if(!t)return e;const n=ve(e.get("headers"),t);return e=(e=e.update("headers",(e=>Oe(e,t,((e,t)=>e=>e.map((e=>e.update("contents",(e=>e.delete(t)))))))))).set("selectedTableCellId",null),Pa(e,t,n)},Fa=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",(e=>Oe(e,t,(e=>t=>e+1===t.size?t:t.insert(e,t.get(e+1)).delete(e+2))))),Pa(e,t)):e},Ha=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",(e=>Oe(e,t,(e=>t=>0===e?t:t.insert(e-1,t.get(e)).delete(e+1))))),Pa(e,t)):e},ja=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",(e=>Oe(e,t,((e,t)=>e=>0===t?e:e.map((e=>e.update("contents",(e=>0===e.size?e:e.insert(t-1,e.get(t)).delete(t+1))))))))),Pa(e,t)):e},Ba=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",(e=>Oe(e,t,((e,t)=>e=>t+1>=e.getIn([0,"contents"]).size?e:e.map((e=>e.update("contents",(e=>0===e.size?e:e.insert(t,e.get(t+1)).delete(t+2))))))))),Pa(e,t)):e},Va=(e,t)=>(e=e.update("headers",(e=>Oe(e,t.cellId,((e,n)=>a=>a.updateIn([e,"contents",n],(e=>e.set("rawContents",t.newValue).set("contents",Object(y.fromJS)(An(t.newValue,{excludeCookies:!0}))))))))),Pa(e,t.cellId)),Ua=(e,t)=>{const n=e.get("headers"),{template:a,content:i,shouldPrepend:r}=t,{newIndex:s,nestingLevel:o,parentHeader:l}=Wa(a,n,r);if(void 0===s)return e;const c=((e,t)=>{const n=e.split("\n")[0].replace(/^\**\s*|\s*$/g,""),a=e.split("\n").slice(1).join("\n"),i=Hn(n,1,t);return xn(i,a)})(i,e.get("todoKeywordSets")).set("nestingLevel",o);return e=e.update("headers",(e=>e.insert(s,c))),void 0!==l&&(e=aa(e,l.get("id"))),e},Wa=(e,t,n)=>{const a=e.get("headerPaths");if(0===a.size)return n?{newIndex:0,nestingLevel:1}:{newIndex:t.size+1,nestingLevel:1};const i=ye(t,a);if(null==i)return{};const r=ie(t,i.get("id")),s=de(t,i.get("id"));return{newIndex:r+1+(n?0:s),nestingLevel:i.get("nestingLevel")+1,parentHeader:i}},za=(e,t)=>{const n=t.slice(0,t.length-4),a=e.getIn(n);if(!a.get("isCheckbox"))return e;const i=a.get("contents").filter((e=>"list"===e.get("type"))).flatMap((e=>e.get("items").filter((e=>e.get("isCheckbox"))).map((e=>e.get("checkboxState")))));e=i.every((e=>"checked"===e))?e.setIn(n.concat(["checkboxState"]),"checked"):i.every((e=>"unchecked"===e))?e.setIn(n.concat(["checkboxState"]),"unchecked"):e.setIn(n.concat(["checkboxState"]),"partial");const r=i.map((e=>"checked"===e)).toJS();return e=e.updateIn(n.concat("titleLine"),(e=>na(e,r))),za(e,n)},Ga=(e,t)=>{const n=Ae(e.get("headers"),t.listItemId),{path:a,listItemPart:i}=n;if(i.get("contents").filter((e=>"list"===e.get("type"))).some((e=>e.get("items").some((e=>e.get("isCheckbox"))))))return e;const r={checked:"unchecked",unchecked:"checked",partial:"unchecked"}[i.get("checkboxState")];e=e.setIn(["headers"].concat(a).concat(["checkboxState"]),r),e=za(e,["headers"].concat(a));const s=a[0];return e=(e=aa(e,e.getIn(["headers",s,"id"]))).updateIn(["headers",s],(e=>e.set("rawDescription",q(e.get("description")))))},$a=(e,t)=>e.set("selectedListItemId",t.listItemId),Ka=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=-1;const i=e.get("headers");if(n)a=ie(i,n.get("id"));else{a=Ae(i,t).path[0]}return a>=0?e.updateIn(["headers",a],(e=>e.set("rawDescription",q(e.get("description"))))):e},Ya=(e,t)=>{const n=t.listItemId;return n?(e=e.update("headers",(e=>Ne(e,n,(e=>n=>n.updateIn([e],(e=>e.set("titleLine",Object(y.fromJS)(An(t.newValue))))))))),Ka(e,n)):e},Ja=(e,t)=>{const n=t.listItemId;return n?(e=e.update("headers",(e=>Ne(e,n,(e=>n=>n.updateIn([e],(e=>e.set("contents",Object(y.fromJS)(Pn(t.newValue))))))))),Ka(e,n)):e},qa=e=>{const t=e.get("selectedListItemId");if(!t)return e;const n=Ae(e.get("headers"),t);let a=Object(y.fromJS)({id:w(),titleLine:[],contents:[],forceNumber:null,isCheckbox:!1});return n.listItemPart.get("isCheckbox")&&(a=a.set("isCheckbox",!0).set("checkboxState","unchecked")),e=e.update("headers",(e=>Ne(e,t,(e=>t=>t.insert(e+1,a))))),Ka(e,t)},Xa=e=>{const t=e.get("selectedListItemId");if(!t)return e;const n=Ae(e.get("headers"),t);let{path:a}=n;return a[a.length-1]=a[a.length-1]+1,e=e.set("selectedListItemId",e.getIn(["headers"].concat(a).concat("id")))},Za=e=>{const t=e.get("selectedListItemId");if(!t)return e;const n=((e,t)=>{const n=Ae(e,t).path[0];return e.get(n)})(e.get("headers"),t);return e=(e=e.update("headers",(e=>Ne(e,t,(e=>t=>t.delete(e)))))).set("selectedListItemId",null),Ka(e,t,n)},Qa=e=>{const t=e.get("selectedListItemId");return t?(e=e.update("headers",(e=>Ne(e,t,(e=>t=>0===e?t:t.insert(e-1,t.get(e)).delete(e+1))))),Ka(e,t)):e},ei=e=>{const t=e.get("selectedListItemId");return t?(e=e.update("headers",(e=>Ne(e,t,(e=>t=>e+1===t.size?t:t.insert(e,t.get(e+1)).delete(e+2))))),Ka(e,t)):e},ti=e=>{const t=e.get("selectedListItemId");if(!t)return e;return Ae(e.get("headers"),t).listItemPart.get("contents").filter((e=>"list"===e.get("type"))).some((e=>e.get("items").size>0))?e:ai(e)},ni=e=>{const t=e.get("selectedListItemId");if(!t)return e;const n=Ae(e.get("headers"),t);let{path:a,listItemPart:i}=n;const r=e.getIn(["headers"].concat(a.slice(0,a.length-2))),s=a[a.length-1]-1;if(s<0)return e;e=e.update("headers",(e=>Ne(e,t,(e=>t=>t.delete(e)))));const o=["headers"].concat(a.slice(0,a.length-1)).concat(s).concat("contents"),l=i.get("contents").filter((e=>"list"===e.get("type")));return i=i.update("contents",(e=>e.filter((e=>"list"!==e.get("type"))))),e=e.updateIn(o,(e=>Pe(e,i,r))),l.map((t=>t.get("items").forEach((n=>{e=e.updateIn(o,(e=>Pe(e,n,t)))})))),Ka(e,t)},ai=e=>{const t=e.get("selectedListItemId");if(!t)return e;const n=Ae(e.get("headers"),t);let{path:a,listItemPart:i}=n;const r=a[a.length-1];if(a.filter((e=>"items"===e)).length<2)return e;const s=((e,t)=>{const n=Ae(e,t);let{path:a}=n;return e.getIn(a.slice(0,a.length-4))})(e.getIn(["headers"]),t);return s.get("contents").filter((e=>"list"===e.get("type"))).map((e=>e.get("items").forEach(((t,n)=>{n>r&&(i=i.update("contents",(n=>Pe(n,t,e))))})))),e=(e=e.update("headers",(e=>Ne(e,t,(()=>e=>e.filter(((e,t)=>t<r))))))).update("headers",(e=>Ne(e,s.get("id"),(e=>t=>t.insert(e+1,i))))),Ka(e,t)},ii=e=>{const t=e.get("selectedListItemId");if(!t)return e;const n=Ae(e.get("headers"),t),{path:a,listItemPart:i}=n,r=e.getIn(["headers"].concat(a.slice(0,a.length-2))),s=a[a.length-1]-1;return s<0?e:(e=(e=e.update("headers",(e=>Ne(e,t,(e=>t=>0===e?t:t.delete(e)))))).updateIn(["headers"].concat(a.slice(0,a.length-1)).concat(s).concat("contents"),(e=>Pe(e,i,r))),Ka(e,t))},ri=(e,t)=>e.set("lastSyncAt",t.lastSyncAt),si=(e,t)=>{const n=e.get("headers"),a=ie(n,t.headerId);return-1===a?e:e.setIn(["headers",a,"titleLine","tags"],t.tags)},oi=(e,t)=>{const n=e.get("selectedHeaderId");if(!n)return e;const a=ie(e.get("headers"),n);return e.updateIn(["headers",a,"titleLine","tags"],(e=>e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))))},li=(e,t)=>{const n=t.headerId;if(!n)return e;const a=ie(e.get("headers"),n);return e.updateIn(["headers",a,"propertyListItems"],(e=>e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))))},ci=(e,t)=>{const n=De(e.get("headers"),t.timestampId);if(!n)return e;const{path:a}=n,i=a[0];return e.setIn(["headers"].concat(a),t.newTimestamp).updateIn(["headers",i],(e=>{const t=e.get("description"),n=e.getIn(["titleLine","title"]);return e.setIn(["titleLine","rawTitle"],q(n)).set("rawDescription",q(t)).set("planningItems",$n(e))}))},di=(e,t)=>{const{headerId:n,planningItemIndex:a,newTimestamp:i}=t,r=ie(e.get("headers"),n);return e.setIn(["headers",r,"planningItems",a,"timestamp"],i)},hi=(e,t)=>{const n=ie(e.get("headers"),t.headerId),a=Object(y.fromJS)({id:w(),type:t.planningType,timestamp:B(t.timestamp)});return e.updateIn(["headers",n,"planningItems"],(e=>e?e.push(a):Object(y.List)([a])))},ui=(e,t)=>{const n=ie(e.get("headers"),t.headerId),{planningItemIndex:a}=t;return e.removeIn(["headers",n,"planningItems",a])},pi=(e,t)=>{const{path:n}=De(e.get("headers"),t.timestampId);return e=(e=(e=(e=e.removeIn(["headers",...n])).updateIn(["headers",n[0],"planningItems"],(e=>e.filter((e=>e.get("id")!==t.timestampId))))).setIn(["headers",n[0],"titleLine","rawTitle"],q(e.getIn(["headers",n[0],"titleLine","title"])))).setIn(["headers",n[0],"rawDescription"],q(e.getIn(["headers",n[0],"description"])))},mi=(e,t)=>{const n=ie(e.get("headers"),t.headerId);return e.setIn(["headers",n,"propertyListItems"],t.newPropertyListItems)},gi=(e,t)=>{const{headerId:n,entryId:a,time:i}=t,r=ie(e.get("headers"),n),s=e.getIn(["headers",r,"logBookEntries"]).findIndex((e=>e.get("id")===a));return(e=e.update("activeClocks",(e=>e-1))).setIn(["headers",r,"logBookEntries",s,"end"],Object(y.fromJS)(i))},fi=(e,t)=>{const{headerId:n,time:a}=t,i=ie(e.get("headers"),n),r=Object(y.fromJS)({id:w(),start:a,end:null});return(e=e.update("activeClocks",(e=>e+1))).updateIn(["headers",i,"logBookEntries"],(e=>e?e.unshift(r):Object(y.List)([r])))},bi=(e,t)=>{const{headerId:n,entryIndex:a,entryType:i,newTime:r}=t,s=ie(e.get("headers"),n);return e.setIn(["headers",s,"logBookEntries",a,i],Object(y.fromJS)(r))},yi=(e,t,n,a,i)=>e.mapEntries((e=>{let[r,s]=e;return[r,s.update("headers",(e=>{const s=t.find((e=>r===e.get("path")));return n===r?e:s?s.get(a)?e:Object(y.List)():r.startsWith(te)?Object(y.List)():i?e:Object(y.List)()}))]})),Ei=e=>{let t,{searchFilterExpr:n=[],headersToSearch:a,path:i}=e,r=200;const s=(e=>{const t=(e,t)=>n=>n.type===e&&n.exclude===t,n=e=>e.words,a=e=>e.words.map((e=>e.toLowerCase())),i=e.filter(t("tag",!1)).map(n),r=e.filter(t("case-sensitive",!1)).map(n),s=e.filter(t("ignore-case",!1)).map(a),o=e.filter(t("property",!1)).map((e=>[e.property,e.words])),l=e.filter(t("field",!1)),c=l.filter((e=>"date"===e.field.type)).map(fn),d=l.filter((e=>"scheduled"===e.field.type)).map(fn),h=l.filter((e=>"deadline"===e.field.type)).map(fn),u=e.filter(t("tag",!0)).map(n),p=e.filter(t("case-sensitive",!0)).map(n),m=e.filter(t("ignore-case",!0)).map(a),g=e.filter(t("property",!0)).map((e=>[e.property,e.words])),f=l.filter((e=>"description"===e.field.type&&"ignore-case"===e.field.text.type)).map((e=>e.field.text.words.map((e=>e.toLowerCase())))),b=l.filter((e=>"description"===e.field.type&&"case-sensitive"===e.field.text.type)).map((e=>e.field.text.words));return e=>{const t=e.get("titleLine"),n=t.get("tags"),a=t.get("todoKeyword"),l=t.get("rawTitle"),y=a?`${a} ${l}`:l,E=e.get("propertyListItems").map((e=>[e.get("property"),q(e.get("value"))])),w=e.get("planningItems").filter((e=>!0===e.get("timestamp").get("isActive"))),k=w.map((e=>e.get("timestamp"))),v=w.filter((e=>"SCHEDULED"===e.get("type"))).map((e=>e.get("timestamp"))),T=w.filter((e=>"DEADLINE"===e.get("type"))).map((e=>e.get("timestamp")));var S="";(f.length>0||b.length>0)&&(S=e.get("rawDescription").replace(/\*([\w]*)\*/,((e,t,n,a)=>t)));const _=e=>{let[t,n]=e;return!E.filter((e=>{let[a,i]=e;const r=a.toLowerCase()===t.toLowerCase(),s=n.some((e=>i.includes(e)));return r&&s})).isEmpty()};return i.every(bn(n))&&r.every(bn(y))&&s.every(bn(y.toLowerCase()))&&o.every(_)&&c.every(yn(k))&&d.every(yn(v))&&h.every(yn(T))&&f.every(bn(S.toLowerCase()))&&b.every(bn(S))&&!u.some(bn(n))&&!p.some(bn(y))&&!m.some(bn(y.toLowerCase()))&&!g.some(_)}})(n),o=a.get(i).filter(s).take(r);r-=o.count(),t=Object(y.Map)().set(i,o);return a.keySeq().filter((e=>e!==i)).forEach((e=>{if(r>0){const n=a.get(e).filter(s).take(r);r-=n.count(),t=t.set(e,n)}})),t},wi=(e,t)=>{const{searchFilter:n,cursorPosition:a,context:i}=t;let r=e.get("files");e=e.asMutable();let s,o=!0;try{s=Qt.a.parse(n),e.setIn(["search","searchFilterExpr"],s)}catch(u){o=!1}const l=e.get("path"),c=e.get("fileSettings");if("agenda"===i?r=yi(r,c,l,"includeInAgenda",!1):"search"===i?r=yi(r,c,l,"includeInSearch",!1):"task-list"===i?r=yi(r,c,l,"includeInTasklist",!1):"refile"===i&&(r=yi(r,c,l,"includeInRefile",!1)),e.setIn(["search","searchFilterValid"],o),o){const t=r.map((e=>e.get("headers"))),n=s.filter((e=>"field"===e.type)).filter((e=>"clock"===e.field.type)),a=n.filter((e=>{return!("point"===(t=e).field.timerange.type&&"special"===t.field.timerange.point.type&&"now"===t.field.timerange.point.value);var t})),o=n.length!==a.length,c=a.map(fn),d=0!==a.length;e.setIn(["search","showClockedTimes"],d);const h=e.getIn(["files",l,"narrowedHeaderId"]);let u;u=h&&"refile"!==i?Object(y.Map)().set(l,ce(t.get(l),h)):t,o&&(u=u.map((e=>e.filter(vn)))),d&&(u=u.map((e=>e.map((e=>e.set("totalFilteredTimeLogged",Tn(c,e)))))),u=u.map((e=>((e,t)=>{if(!t)return t;const n=t.map((t=>t.set("totalFilteredTimeLogged",Tn(e,t))));return n.map(((e,t)=>{const a=le(n,t).reduce(((e,t)=>e+t.get("totalFilteredTimeLogged")),e.get("totalFilteredTimeLogged"));return e.set("totalFilteredTimeLoggedRecursive",a)}))})(c,e).filter((e=>0!==e.get("totalFilteredTimeLoggedRecursive"))))));let p=Ei({searchFilterExpr:s,headersToSearch:u,path:l});if(d){const t=p.map((e=>e.reduce(((e,t)=>e+t.get("totalFilteredTimeLogged")),0))).toList().reduce(((e,t)=>e+t),0);e.setIn(["search","clockedTime"],t)}if("refile"===i){const n=e.getIn(["files",l,"selectedHeaderId"]);let a=ce(t.get(l),n).map((e=>e.get("id"))).toJS();a.push(n),p=p.update(l,(e=>e.filter((e=>!a.includes(e.get("id"))))))}e.setIn(["search","filteredHeaders"],p)}e.setIn(["search","searchFilter"],n);let d=[];if(!b.a.isEmpty(n)){const e=r.get(l),t=e.get("headers"),i=(e=>e.get("todoKeywordSets").flatMap((e=>e.get("keywords"))).toSet().toJS())(e),o=Me(t).toJS(),c=Fe(t).toJS();d=En(i,o,c)(s,n,a)}e.setIn(["search","searchFilterSuggestions"],d);let h=e.getIn(["bookmarks",i]);return h.contains(n)&&(h=h.filter((e=>e!==n)).unshift(n).take(10)),e.setIn(["bookmarks",i],h),e.asImmutable()},ki=(e,t)=>e.findIndex((e=>e.get("id")===t)),vi=(e,t)=>t.newSettings?((e,t)=>{const n=Object(y.fromJS)(JSON.parse(t.fileSettings)).map((e=>e.set("id",w())));return e.set("fileSettings",n)})(e,t.newSettings):e,Ti=(e,t,n)=>function(a){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];return e.updateIn(["files",n],(e=>a(e||Object(y.Map)(),t,...r)))},Si=(e,t)=>{const n=e.get("path"),a=Ti(e,t,n);switch(t.type){case"PARSE_FILE":return Xn(e,t);case"CLEAR_SEARCH":return(e=>e.setIn(["search","filteredHeaders"],null))(e);case"TOGGLE_HEADER_OPENED":return a(Qn);case"OPEN_HEADER":return a(Zn);case"SELECT_HEADER":return a(ea);case"OPEN_PARENTS_OF_HEADER":return a(ta);case"ADVANCE_TODO_STATE":return a(ra);case"SET_TODO_STATE":return a(sa);case"ENTER_EDIT_MODE":return a(oa);case"EXIT_EDIT_MODE":return a(la);case"UPDATE_HEADER_TITLE":return a(ca);case"UPDATE_HEADER_DESCRIPTION":return a(da);case"ADD_HEADER":return a(ha);case"CREATE_FIRST_HEADER":return a(ua);case"SELECT_NEXT_SIBLING_HEADER":return a(pa);case"SELECT_NEXT_VISIBLE_HEADER":return a(ma);case"SELECT_PREVIOUS_VISIBLE_HEADER":return a(ga);case"REMOVE_HEADER":return a(fa);case"MOVE_HEADER_UP":return a(ba);case"MOVE_HEADER_DOWN":return a(ya);case"MOVE_HEADER_LEFT":return a(Ea);case"MOVE_HEADER_RIGHT":return a(wa);case"MOVE_SUBTREE_LEFT":return a(ka);case"MOVE_SUBTREE_RIGHT":return a(va);case"REFILE_SUBTREE":return((e,t)=>{const{sourcePath:n,sourceHeaderId:a,targetPath:i,targetHeaderId:r}=t,s=n===i?Ta:Sa;let o=e.getIn(["files",n,"headers"]),l=e.getIn(["files",i,"headers"]),{header:c,headerIndex:d}=ae(o,a),h=ie(l,r),u=ce(o,a);const p=o.getIn([d,"nestingLevel"]),m=l.getIn([h,"nestingLevel"]);return c=c.set("nestingLevel",m+1),[o,l]=s({fromList:o,fromIndex:d,toList:l,toIndex:h,item:c}),u.forEach(((e,t)=>{e=e.set("nestingLevel",e.get("nestingLevel")-p+m+1);const n=ie(o,e.get("id"));h=ie(l,r);const a=h+t+1;[o,l]=s({fromList:o,fromIndex:n,toList:l,toIndex:a,item:e})})),(e=(e=(e=e.setIn(["files",n,"headers"],o)).setIn(["files",i,"headers"],l)).updateIn(["files",n],(e=>Ci(e,a,t)))).updateIn(["files",i],(e=>Ci(e,r,t)))})(e,t);case"HEADER_ADD_NOTE":return a(Ia);case"APPLY_OPENNESS_STATE":return((e,t)=>{const{path:n}=t,a=e.get("opennessState");if(!a)return e;const i=a.get(n);if(!i||0===i.size)return e;let r=e.getIn(["files",n,"headers"]);return i.forEach((e=>{r=Ee(r,e)})),e.setIn(["files",n,"headers"],r)})(e,t);case"SET_OPENNESS_STATE":return((e,t)=>{const{path:n,opennessState:a}=t;return e.setIn(["opennessState",n],Object(y.fromJS)(a))})(e,t);case"SET_DIRTY":return t.path?Ti(e,t,t.path)(Aa):a(Aa);case"NARROW_HEADER":return a(Ca);case"WIDEN_HEADER":return a(Da);case"SET_SELECTED_TABLE_ID":return a(Oa);case"SET_SELECTED_TABLE_CELL_ID":return a(Na);case"ADD_NEW_TABLE_ROW":return a(La);case"REMOVE_TABLE_ROW":return a(Ra);case"ADD_NEW_TABLE_COLUMN":return a(xa);case"REMOVE_TABLE_COLUMN":return a(Ma);case"MOVE_TABLE_ROW_DOWN":return a(Fa);case"MOVE_TABLE_ROW_UP":return a(Ha);case"MOVE_TABLE_COLUMN_LEFT":return a(ja);case"MOVE_TABLE_COLUMN_RIGHT":return a(Ba);case"UPDATE_TABLE_CELL_VALUE":return a(Va);case"INSERT_CAPTURE":return t.template.get("file")?Ti(e,t,t.template.get("file"))(Ua):a(Ua);case"CLEAR_PENDING_CAPTURE":return(e=>e.set("pendingCapture",null))(e);case"ADVANCE_CHECKBOX_STATE":return a(Ga);case"SET_SELECTED_LIST_ITEM_ID":return a($a);case"UPDATE_LIST_TITLE_VALUE":return a(Ya);case"UPDATE_LIST_CONTENTS_VALUE":return a(Ja);case"ADD_NEW_LIST_ITEM":return a(qa);case"SELECT_NEXT_SIBLING_LIST_ITEM":return a(Xa);case"REMOVE_LIST_ITEM":return a(Za);case"MOVE_LIST_ITEM_UP":return a(Qa);case"MOVE_LIST_ITEM_DOWN":return a(ei);case"MOVE_LIST_ITEM_LEFT":return a(ti);case"MOVE_LIST_ITEM_RIGHT":return a(ni);case"MOVE_LIST_SUBTREE_LEFT":return a(ai);case"MOVE_LIST_SUBTREE_RIGHT":return a(ii);case"SET_LAST_SYNC_AT":return t.path?Ti(e,t,t.path)(ri):a(ri);case"SET_HEADER_TAGS":return a(si);case"REORDER_TAGS":return a(oi);case"REORDER_PROPERTY_LIST":return a(li);case"UPDATE_TIMESTAMP_WITH_ID":return a(ci);case"UPDATE_PLANNING_ITEM_TIMESTAMP":return a(di);case"ADD_NEW_PLANNING_ITEM":return a(hi);case"REMOVE_PLANNING_ITEM":return a(ui);case"REMOVE_TIMESTAMP":return a(pi);case"UPDATE_PROPERTY_LIST_ITEMS":return a(mi);case"SET_ORG_FILE_ERROR_MESSAGE":return((e,t)=>e.set("orgFileErrorMessage",t.message))(e,t);case"SET_LOG_ENTRY_STOP":return a(gi);case"CREATE_LOG_ENTRY_START":return a(fi);case"UPDATE_LOG_ENTRY_TIME":return a(bi);case"SET_SEARCH_FILTER_INFORMATION":return wi(e,t);case"SET_PATH":return((e,t)=>e.set("path",t.path))(e,t);case"TOGGLE_CLOCK_DISPLAY":return((e,t)=>(t.showClockDisplay&&(e=e.update("headers",Sn)),e.set("showClockDisplay",t.showClockDisplay)))(e,t);case"UPDATE_FILE_SETTING_FIELD_PATH_VALUE":return((e,t)=>{const n=ki(e.get("fileSettings"),t.settingId);return e.setIn(["fileSettings",n].concat(t.fieldPath),t.newValue)})(e,t);case"REORDER_FILE_SETTING":return((e,t)=>e.update("fileSettings",(e=>e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex)))))(e,t);case"DELETE_FILE_SETTING":return((e,t)=>{const n=ki(e.get("fileSettings"),t.settingId);return e.update("fileSettings",(e=>e.delete(n)))})(e,t);case"ADD_NEW_EMPTY_FILE_SETTING":return(e=>e.update("fileSettings",(e=>e.push(Object(y.fromJS)({id:w(),path:"",loadOnStartup:!1,includeInAgenda:!1,includeInSearch:!1,includeInRefile:!1,includeInTasklist:!1})))))(e);case"RESTORE_FILE_SETTINGS":return vi(e,t);case"SAVE_BOOKMARK":return((e,t)=>{let{context:n,bookmark:a}=t;return e.updateIn(["bookmarks",n],(e=>e.filter((e=>e!==a)).unshift(a).take(10)))})(e,t);case"DELETE_BOOKMARK":return((e,t)=>{let{context:n,bookmark:a}=t;return e.updateIn(["bookmarks",n],(e=>e.filter((e=>e!==a)).take(10)))})(e,t);case"ADD_NEW_FILE":return((e,t)=>{let{path:n,content:a}=t;const i=Un(a);return e.setIn(["files",n,"headers"],i.get("headers")).setIn(["files",n,"todoKeywordSets"],i.get("todoKeywordSets")).setIn(["files",n,"fileConfigLines"],i.get("fileConfigLines")).setIn(["files",n,"linesBeforeHeadings"],i.get("linesBeforeHeadings")).setIn(["files",n,"activeClocks"],i.get("activeClocks")).setIn(["files",n,"isDirty"],!1)})(e,t);default:return e}};const _i=(e,t)=>{if(t.dirtying){if("REFILE_SUBTREE"===t.type)return[t.sourcePath,t.targetPath];if("INSERT_CAPTURE"===t.type){const n=t.template.get("file");return n?[n]:[e.get("path")]}return[e.get("path")]}return[]};function Ii(e){let{currentTodoSet:t,newTodoState:n,indexedPlanningItemsWithRepeaters:a,state:i,headerIndex:r,currentTodoState:s,logIntoDrawer:o,timestamp:l}=e;return t.get("completedKeywords").includes(n)&&a.size>0?function(e){let{indexedPlanningItemsWithRepeaters:t,state:n,headerIndex:a,currentTodoSet:i,newTodoState:r,currentTodoState:s,logIntoDrawer:o,timestamp:l}=e;if(t.forEach((e=>{let[t,i]=e;const r=((e,t)=>{if(!e.get("repeaterType"))return e;let n=null;switch(e.get("repeaterType")){case"+":n=z(W(e),e.get("repeaterValue"),e.get("repeaterUnit"));break;case"++":for(n=z(W(e),e.get("repeaterValue"),e.get("repeaterUnit"));Object(L.a)(n,t);)n=z(n,e.get("repeaterValue"),e.get("repeaterUnit"));break;case".+":if(n=z(t,e.get("repeaterValue"),e.get("repeaterUnit")),"h"!==e.get("repeaterUnit")){let t=W(e);n=Object(R.a)(n,Object(x.a)(t)),n=Object(M.a)(n,Object(F.a)(t))}break;default:return console.error(`Unrecognized timestamp repeater type: ${e.get("repeaterType")}`),e}return void 0!==(e=e.set("day",Object(k.a)(n,"dd")).set("dayName",Object(k.a)(n,"eee")).set("month",Object(k.a)(n,"MM")).set("year",Object(k.a)(n,"yyyy"))).get("startHour")&&null!==e.get("startHour")&&(e=e.set("startHour",Object(k.a)(n,"HH")).set("startMinute",Object(k.a)(n,"mm"))),e})(t.get("timestamp"),l);switch(n=n.setIn(["headers",a,"planningItems",i,"timestamp"],r),t.get("type")){case"TIMESTAMP_TITLE":const e=n.getIn(["headers",a,"titleLine","title"]).findIndex((e=>t.get("id")===e.get("id")));n=n.setIn(["headers",a,"titleLine","title",e,"firstTimestamp"],r),n=n.setIn(["headers",a,"titleLine","rawTitle"],q(n.getIn(["headers",a,"titleLine","title"])));break;case"TIMESTAMP_DESCRIPTION":const i=n.getIn(["headers",a,"description"]).findIndex((e=>t.get("id")===e.get("id")));n=n.setIn(["headers",a,"description",i,"firstTimestamp"],r),n=n.setIn(["headers",a,"rawDescription"],q(n.getIn(["headers",a,"description"])))}})),n=n.setIn(["headers",a,"titleLine","todoKeyword"],i.get("keywords").first()),!function(e){let{state:t,headerIndex:n}=e;const a=t.get("fileConfigLines").some((e=>e.match(/^#\+STARTUP:.*nologrepeat.*/))),i=pe(t.get("headers"),n,"LOGGING");return!!(a||i&&i.some((e=>"text"===e.get("type")&&e.get("contents").match(/\s*nologrepeat\s*/))))}({state:n,headerIndex:a})){const e=B(l,{isActive:!1,withStartTime:!0}),t=[{type:"timestamp",id:w(),firstTimestamp:e,secondTimestamp:null}];n=n.updateIn(["headers",a,"propertyListItems"],(e=>e.some((e=>"LAST_REPEAT"===e.get("property")))?e.map((e=>"LAST_REPEAT"===e.get("property")?e.set("value",Object(y.fromJS)(t)):e)):e.push(Object(y.fromJS)({property:"LAST_REPEAT",value:t,id:w()})))),n=function(e,t,n,a,i,r){const s=U(r,{isActive:!1,withStartTime:!0}),o=`- State "${n}"       from "${a}"       ${s}`;if(i){const n=Object(y.fromJS)({id:w(),raw:o});return e.updateIn(["headers",t,"logBookEntries"],(e=>e.unshift(n)))}return _a(e,{noteText:o})}(n,a,r,s,o,l)}return n}({indexedPlanningItemsWithRepeaters:a,state:i,headerIndex:r,currentTodoSet:t,newTodoState:n,currentTodoState:s,logIntoDrawer:o,timestamp:l}):i.setIn(["headers",r,"titleLine","todoKeyword"],n)}function Ci(e,t,n){return e=aa(e,t),e=ia(e,n.headerId)}function Di(e){let{state:t,headerIndex:n,subheaders:a=[]}=e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return t=t.updateIn(["headers",n,"nestingLevel"],r()),a.forEach(((e,a)=>{t=t.updateIn(["headers",n+a+1,"nestingLevel"],r())})),t;function r(){return e=>"-"===i?Math.max(e-1,1):e+1}}const Ai=(e,t)=>{if(Wt){const n=JSON.parse(localStorage.getItem("isDirty"))||{};n[t]=e,localStorage.setItem("isDirty",JSON.stringify(n))}},Oi=(e,t)=>{if(Wt&&!t.startsWith(te)){const n=JSON.parse(localStorage.getItem("persistedFiles"))||{},a=Z({headers:e.org.present.getIn(["files",t,"headers"]),linesBeforeHeadings:e.org.present.getIn(["files",t,"linesBeforeHeadings"]),dontIndent:e.base.get("shouldNotIndentOnExport")});localStorage.setItem("files__"+t,a),n[t]=e.org.present.getIn(["files",t,"lastSyncAt"]),localStorage.setItem("persistedFiles",JSON.stringify(n))}},Ni={},Pi=(e,t)=>{let n=Ni[t];n||(Ni[t]=Object(f.debounce)(Oi,3e3,{leading:!0,trailing:!0}),n=Ni[t]),n(e,t)},Li=e=>{if(Wt){const t=JSON.parse(localStorage.getItem("persistedFiles"))||{},n=JSON.parse(localStorage.getItem("isDirty"))||{};Object.entries(t).forEach((t=>{let[a,i]=t;const r=localStorage.getItem("files__"+a);r&&(e.org.present=e.org.present.update((e=>Xn(e,{path:a,contents:r}))),e.org.present=e.org.present.setIn(["files",a,"lastSyncAt"],Object(Lt.a)(i)),e.org.present=e.org.present.setIn(["files",a,"isDirty"],n[a]))}))}return e},Ri=(e,t)=>n=>{if(Wt&&!e.startsWith(te)){((e,t)=>{if(Wt&&!e.startsWith(te)){let n=JSON.parse(localStorage.getItem("persistedFiles"));n=n||{},localStorage.setItem("files__"+e,t),n[e]=Object(Pt.a)(new Date,5),localStorage.setItem("persistedFiles",JSON.stringify(n))}})(e,t);const a=$t();a&&n(gr(e,a[e]))}n({type:"PARSE_FILE",path:e,contents:t}),n(fr(e))},xi=(e,t)=>({type:"SET_LAST_SYNC_AT",path:t,lastSyncAt:e}),Mi=()=>e=>{e(mr()),e(It()),e({type:"CLEAR_SEARCH"}),e(zi(null)),e(m.ActionCreators.clearHistory())},Fi={},Hi=(e,t,n)=>{let a=[];if(n.path)a=[n.path];else{const e=t().org.present.get("files");a=e.keySeq().filter((t=>e.getIn([t,"isDirty"])))}a.forEach((t=>{let a=Fi[t];a||(Fi[t]=Object(f.debounce)(((e,t)=>e(Bi(t))),3e3,{leading:!0,trailing:!0}),a=Fi[t]),a(e,n)}))},ji=e=>(t,n)=>{if(n().base.get("online"))if("manual"===e.forceAction){console.log("forcing sync");n().org.present.get("files").keySeq().forEach((n=>t(Bi({...e,path:n}))))}else Hi(t,n,e)},Bi=function(){let{forceAction:e=null,successMessage:t="Changes pushed",shouldSuppressMessages:n=!1,path:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(i,r)=>{const s=r().syncBackend.get("client"),o=r().org.present.get("path");a=a||o,a&&!a.startsWith(te)&&(r().base.get("isLoading").includes(a)&&"manual"!==e?i(ji({forceAction:"push"})):(n||i(Ke("Syncing ...")),i(Je(!0,a)),i(ns(null)),s.getFileContentsAndMetadata(a).then((o=>{let{contents:l,lastModifiedAt:c}=o;const d=r().org.present.getIn(["files",a,"isDirty"]),h=Object(Lt.a)(c),u=r().org.present.getIn(["files",a,"lastSyncAt"]);if(Object(Nt.a)(u,h)||"push"===e)if(d){const e=Z({headers:r().org.present.getIn(["files",a,"headers"]),linesBeforeHeadings:r().org.present.getIn(["files",a,"linesBeforeHeadings"]),dontIndent:r().base.get("shouldNotIndentOnExport")});s.updateFile(a,e).then((()=>{n?setTimeout((()=>i(Ye())),2e3):i(Xe(t,2e3)),i(Je(!1,a)),i(yr(!1,a)),i(xi(Object(Pt.a)(new Date,5),a))})).catch((e=>{const t=`There was an error pushing the file ${a}: ${e.toString()}`;console.error(t),i(Xe(t,5e3)),i(Ye()),i(Je(!1,a)),i(ji({path:a}))}))}else n?setTimeout((()=>i(Ye())),2e3):i(Xe("Nothing to sync",2e3)),i(Je(!1,a));else d&&"pull"!==e?(i(Ye()),i(Je(!1,a)),i(_t("sync-confirmation",{lastServerModifiedAt:h,lastSyncAt:u,path:a}))):(i(Ri(a,l)),i(yr(!1,a)),i(xi(Object(Pt.a)(new Date,5),a)),n?setTimeout((()=>i(Ye())),2e3):i(Xe(`Latest version pulled: ${a}`,2e3)),i(Je(!1,a)))})).catch((()=>{i(Ye()),i(Je(!1,a)),i(ns(`File ${a} not found`))}))))}},Vi=e=>({type:"OPEN_HEADER",headerId:e}),Ui=(e,t)=>({type:"TOGGLE_HEADER_OPENED",headerId:e,closeSubheadersRecursively:t}),Wi=e=>t=>{t({type:"SELECT_HEADER",headerId:e}),e&&(t(wr(null)),t(Rr(null)))},zi=e=>t=>{t({type:"SET_PATH",path:e}),t({type:m.ActionTypes.CLEAR_HISTORY})},Gi=(e,t)=>n=>{n(zi(e)),n({type:"OPEN_PARENTS_OF_HEADER",headerId:t}),setTimeout((()=>n(Wi(t))),0)},$i=(e,t)=>({type:"ADVANCE_TODO_STATE",headerId:e,logIntoDrawer:t,dirtying:!0,timestamp:new Date}),Ki=(e,t,n)=>({type:"SET_TODO_STATE",newTodoState:t,headerId:e,logIntoDrawer:n,dirtying:!0,timestamp:new Date}),Yi=e=>({type:"ENTER_EDIT_MODE",editModeType:e}),Ji=()=>({type:"EXIT_EDIT_MODE"}),qi=(e,t)=>({type:"UPDATE_HEADER_TITLE",headerId:e,newRawTitle:t,dirtying:!0}),Xi=(e,t)=>({type:"UPDATE_HEADER_DESCRIPTION",headerId:e,newRawDescription:t,dirtying:!0}),Zi=e=>({type:"ADD_HEADER",headerId:e,dirtying:!1}),Qi=()=>({type:"CREATE_FIRST_HEADER",dirtying:!0}),er=e=>({type:"SELECT_NEXT_SIBLING_HEADER",headerId:e}),tr=e=>t=>{t(Zi(e)),t(er(e)),t(_t("title-editor"))},nr=e=>({type:"SELECT_NEXT_VISIBLE_HEADER",headerId:e}),ar=e=>({type:"SELECT_PREVIOUS_VISIBLE_HEADER",headerId:e}),ir=e=>({type:"REMOVE_HEADER",headerId:e,dirtying:!0}),rr=e=>({type:"MOVE_HEADER_UP",headerId:e,dirtying:!0}),sr=e=>({type:"MOVE_HEADER_DOWN",headerId:e,dirtying:!0}),or=e=>({type:"MOVE_HEADER_LEFT",headerId:e,dirtying:!0}),lr=e=>({type:"MOVE_HEADER_RIGHT",headerId:e,dirtying:!0}),cr=e=>({type:"MOVE_SUBTREE_LEFT",headerId:e,dirtying:!0}),dr=e=>({type:"MOVE_SUBTREE_RIGHT",headerId:e,dirtying:!0}),hr=(e,t,n,a)=>({type:"REFILE_SUBTREE",sourcePath:e,sourceHeaderId:t,targetPath:n,targetHeaderId:a,dirtying:!0}),ur=(e,t)=>({type:"HEADER_ADD_NOTE",inputText:e,currentDate:t,dirtying:!0}),pr=e=>({type:"NARROW_HEADER",headerId:e}),mr=()=>({type:"WIDEN_HEADER"}),gr=(e,t)=>({type:"SET_OPENNESS_STATE",path:e,opennessState:t}),fr=e=>({type:"APPLY_OPENNESS_STATE",path:e}),br=(e,t)=>({type:"SET_DIRTY",isDirty:e,path:t}),yr=(e,t)=>n=>{Ai(e,t),n(br(e,t))},Er=e=>t=>{t({type:"SET_SELECTED_TABLE_ID",tableId:e})},wr=e=>t=>{t({type:"SET_SELECTED_TABLE_CELL_ID",cellId:e}),e&&t(Rr(null))},kr=()=>({type:"ADD_NEW_TABLE_ROW",dirtying:!0}),vr=()=>({type:"REMOVE_TABLE_ROW",dirtying:!0}),Tr=()=>({type:"ADD_NEW_TABLE_COLUMN",dirtying:!0}),Sr=()=>({type:"REMOVE_TABLE_COLUMN",dirtying:!0}),_r=()=>({type:"MOVE_TABLE_ROW_DOWN",dirtying:!0}),Ir=()=>({type:"MOVE_TABLE_ROW_UP",dirtying:!0}),Cr=()=>({type:"MOVE_TABLE_COLUMN_LEFT",dirtying:!0}),Dr=()=>({type:"MOVE_TABLE_COLUMN_RIGHT",dirtying:!0}),Ar=(e,t)=>({type:"UPDATE_TABLE_CELL_VALUE",cellId:e,newValue:t,dirtying:!0}),Or=(e,t,n)=>(a,i)=>{a(It());a({type:"INSERT_CAPTURE",template:i().capture.get("captureTemplates").concat(Ot).find((t=>t.get("id")===e)),content:t,shouldPrepend:n,dirtying:!0})},Nr=()=>({type:"CLEAR_PENDING_CAPTURE"}),Pr=()=>(e,t)=>{const n=t().org.present.get("path"),a=t().org.present.get("pendingCapture"),i=a.get("captureTemplateName"),r=a.get("captureContent"),s=a.get("customCaptureVariables");e(Nr()),window.history.pushState({},"",window.location.pathname);const o=t().capture.get("captureTemplates").filter((e=>e.get("isAvailableInAllOrgFiles")||e.get("orgFilesWhereAvailable").includes(t().org.present.get("path")))).find((e=>e.get("description").trim()===i.trim()));if(!o)return void e(Xe(`Capture failed: "${i}" template not found or not available in this file`,8e3));if(!ye(t().org.present.getIn(["files",n,"headers"]),o.get("headerPaths")))return void e(Xe(`Capture failed: "${o.get("description")}" header path invalid in this file`,8e3));const[l,c]=ee(o.get("template"),s),d=c?`${l.substring(0,c)}${r}${l.substring(c)}`:`${l}${r}`;e(Or(o.get("id"),d,o.get("shouldPrepend"))),e(ji({successMessage:"Item captured"}))},Lr=e=>({type:"ADVANCE_CHECKBOX_STATE",listItemId:e,dirtying:!0}),Rr=e=>t=>{t({type:"SET_SELECTED_LIST_ITEM_ID",listItemId:e}),e&&(t(Wi(null)),t(wr(null)))},xr=(e,t)=>({type:"UPDATE_LIST_TITLE_VALUE",listItemId:e,newValue:t,dirtying:!0}),Mr=(e,t)=>({type:"UPDATE_LIST_CONTENTS_VALUE",listItemId:e,newValue:t,dirtying:!0}),Fr=()=>({type:"ADD_NEW_LIST_ITEM",dirtying:!0}),Hr=()=>({type:"SELECT_NEXT_SIBLING_LIST_ITEM"}),jr=()=>e=>{e(Fr()),e(Hr()),e(Yi("list-title"))},Br=()=>({type:"REMOVE_LIST_ITEM",dirtying:!0}),Vr=()=>({type:"MOVE_LIST_ITEM_UP",dirtying:!0}),Ur=()=>({type:"MOVE_LIST_ITEM_DOWN",dirtying:!0}),Wr=()=>({type:"MOVE_LIST_ITEM_LEFT",dirtying:!0}),zr=()=>({type:"MOVE_LIST_ITEM_RIGHT",dirtying:!0}),Gr=()=>({type:"MOVE_LIST_SUBTREE_LEFT",dirtying:!0}),$r=()=>({type:"MOVE_LIST_SUBTREE_RIGHT",dirtying:!0}),Kr=(e,t)=>({type:"SET_HEADER_TAGS",headerId:e,tags:t,dirtying:!0}),Yr=(e,t)=>({type:"REORDER_TAGS",fromIndex:e,toIndex:t,dirtying:!0}),Jr=(e,t)=>(n,a)=>n({type:"REORDER_PROPERTY_LIST",fromIndex:e,toIndex:t,headerId:a().base.getIn(["activePopup","data","headerId"]),dirtying:!0}),qr=(e,t)=>({type:"UPDATE_TIMESTAMP_WITH_ID",timestampId:e,newTimestamp:t,dirtying:!0}),Xr=(e,t,n)=>({type:"UPDATE_PLANNING_ITEM_TIMESTAMP",headerId:e,planningItemIndex:t,newTimestamp:n,dirtying:!0}),Zr=(e,t)=>({type:"ADD_NEW_PLANNING_ITEM",headerId:e,planningType:t,dirtying:!0,timestamp:new Date}),Qr=(e,t)=>({type:"REMOVE_PLANNING_ITEM",headerId:e,planningItemIndex:t,dirtying:!0}),es=(e,t)=>({type:"REMOVE_TIMESTAMP",headerId:e,timestampId:t,dirtying:!0}),ts=(e,t)=>({type:"UPDATE_PROPERTY_LIST_ITEMS",headerId:e,newPropertyListItems:t,dirtying:!0}),ns=e=>({type:"SET_ORG_FILE_ERROR_MESSAGE",message:e}),as=(e,t,n)=>({type:"SET_LOG_ENTRY_STOP",headerId:e,entryId:t,time:n,dirtying:!0}),is=(e,t)=>({type:"CREATE_LOG_ENTRY_START",headerId:e,time:t,dirtying:!0}),rs=(e,t,n,a)=>({type:"UPDATE_LOG_ENTRY_TIME",headerId:e,entryIndex:t,entryType:n,newTime:a,dirtying:!0}),ss=(e,t,n)=>({type:"SET_SEARCH_FILTER_INFORMATION",searchFilter:e,cursorPosition:t,context:n}),os=e=>({type:"TOGGLE_CLOCK_DISPLAY",showClockDisplay:e}),ls=(e,t,n)=>({type:"UPDATE_FILE_SETTING_FIELD_PATH_VALUE",settingId:e,fieldPath:t,newValue:n}),cs=(e,t)=>({type:"REORDER_FILE_SETTING",fromIndex:e,toIndex:t}),ds=e=>({type:"DELETE_FILE_SETTING",settingId:e}),hs=()=>e=>e({type:"ADD_NEW_EMPTY_FILE_SETTING"}),us=e=>({type:"RESTORE_FILE_SETTINGS",newSettings:e}),ps=(e,t)=>({type:"SAVE_BOOKMARK",context:e,bookmark:t}),ms=(e,t)=>({type:"DELETE_BOOKMARK",context:e,bookmark:t}),gs=(e,t)=>({type:"ADD_NEW_FILE",path:e,content:t});var fs=e=>t=>n=>(setTimeout((()=>{let t=_i(e.getState().org.present,n);t.forEach((t=>Pi(e.getState(),t))),t.forEach((e=>Ai(!0,e))),e.getState().base.get("shouldLiveSync")&&t.forEach((t=>e.dispatch(ji({shouldSuppressMessages:!0,path:t}))))}),0),t(n)),bs=e=>t=>n=>{const a=window.matchMedia("(prefers-color-scheme: dark)");return"addEventListener"in a&&a.addEventListener("change",(t=>{const n=t.matches?"Dark":"Light";e.dispatch(ft(n))})),t(n)};const ys=(e,t)=>t.newSettings?((e,t,n)=>(Gt.filter((e=>e.category===n)).forEach((n=>{e="json"===n.type?e.set(n.name,Object(y.fromJS)(JSON.parse(t[n.name]))):e.set(n.name,t[n.name])})),e))(e,t.newSettings,"base"):e;const Es=(e,t)=>e.findIndex((e=>e.get("id")===t)),ws=(e,t)=>t.newSettings?((e,t)=>{const n=Object(y.fromJS)(JSON.parse(t.captureTemplates)).map((e=>e.set("id",w())));return e.set("captureTemplates",n)})(e,t.newSettings):e;m.ActionCreators.undo=function(){return e=>{e({type:m.ActionTypes.UNDO}),e(yr(!0)),e(ji({forceAction:"push"}))}},m.ActionCreators.redo=function(){return e=>{e({type:m.ActionTypes.REDO}),e(yr(!0)),e(ji({forceAction:"push"}))}};var ks=Object(u.c)({base:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(y.Map)(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOADING_MESSAGE":return((e,t)=>e.set("loadingMessage",t.loadingMessage))(e,t);case"HIDE_LOADING_MESSAGE":return(e=>e.set("loadingMessage",null))(e);case"SET_FONT_SIZE":return((e,t)=>e.set("fontSize",t.newFontSize))(e,t);case"SET_BULLET_STYLE":return((e,t)=>e.set("bulletStyle",t.newBulletStyle))(e,t);case"SET_SHOULD_TAP_TODO_TO_ADVANCE":return((e,t)=>e.set("shouldTapTodoToAdvance",t.newShouldTapTodoToAdvance))(e,t);case"SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT":return((e,t)=>e.set("agendaDefaultDeadlineDelayUnit",t.newAgendaDefaultDeadlineDelayUnit))(e,t);case"SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE":return((e,t)=>e.set("agendaDefaultDeadlineDelayValue",t.newAgendaDefaultDeadlineDelayValue))(e,t);case"SET_EDITOR_DESCRIPTION_HEIGHT_VALUE":return((e,t)=>e.set("editorDescriptionHeightValue",t.newEditorDescriptionHeightValue))(e,t);case"SET_AGENDA_START_ON_WEEKDAY":return((e,t)=>e.set("agendaStartOnWeekday",t.newAgendaStartOnWeekday))(e,t);case"SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND":return((e,t)=>e.set("shouldStoreSettingsInSyncBackend",t.newShouldStoreSettingsInSyncBackend))(e,t);case"SET_COLOR_SCHEME":return((e,t)=>e.set("colorScheme",t.colorScheme))(e,t);case"SET_THEME":return((e,t)=>e.set("theme",t.theme))(e,t);case"SET_SHOULD_LIVE_SYNC":return((e,t)=>e.set("shouldLiveSync",t.shouldLiveSync))(e,t);case"SET_SHOW_DEADLINE_DISPLAY":return((e,t)=>e.set("showDeadlineDisplay",t.showDeadlineDisplay))(e,t);case"SET_SHOULD_SYNC_ON_BECOMING_VISIBLE":return((e,t)=>e.set("shouldSyncOnBecomingVisibile",t.shouldSyncOnBecomingVisibile))(e,t);case"SET_SHOULD_SHOW_TITLE_IN_ORG_FILE":return((e,t)=>e.set("shouldShowTitleInOrgFile",t.shouldShowTitleInOrgFile))(e,t);case"SET_SHOULD_LOG_INTO_DRAWER":return((e,t)=>e.set("shouldLogIntoDrawer",t.shouldLogIntoDrawer))(e,t);case"SET_CLOSE_SUBHEADERS_RECURSIVELY":return((e,t)=>e.set("closeSubheadersRecursively",t.closeSubheadersRecursively))(e,t);case"SET_SHOULD_NOT_INDENT_ON_EXPORT":return((e,t)=>e.set("shouldNotIndentOnExport",t.shouldNotIndentOnExport))(e,t);case"SET_HAS_UNSEEN_CHANGELOG":return((e,t)=>e.set("hasUnseenChangelog",t.newHasUnseenChangelog))(e,t);case"SET_LAST_SEEN_CHANGELOG_HEADER":return((e,t)=>e.set("lastSeenChangelogHash",t.newLastSeenChangelogHash))(e,t);case"SET_LAST_VIEWED_FILE":return((e,t)=>e.set("lastViewedPath",t.lastViewedPath))(e,t);case"SET_CUSTOM_KEYBINDING":return((e,t)=>(e.get("customKeybindings")||(e=e.set("customKeybindings",Object(y.Map)())),e.setIn(["customKeybindings",t.keybindingName],t.keybinding)))(e,t);case"RESTORE_BASE_SETTINGS":return ys(e,t);case"PUSH_MODAL_PAGE":return((e,t)=>e.update("modalPageStack",(e=>e?e.push(t.modalPage):Object(y.List)([t.modalPage]))))(e,t);case"POP_MODAL_PAGE":return(e=>e.update("modalPageStack",(e=>e?e.pop():e)))(e);case"CLEAR_MODAL_STACK":return(e=>e.set("modalPageStack",Object(y.List)()))(e);case"ACTIVATE_POPUP":return((e,t)=>{const{data:n,popupType:a}=t;return["search","task-list","agenda"].includes(a)&&window.history.replaceState({},"",`${window.location.pathname}#${a}`),e.set("activePopup",Object(y.fromJS)({type:a,data:n}))})(e,t);case"CLOSE_POPUP":return(e=>(window.history.replaceState("",document.title,window.location.pathname+window.location.search),e.set("activePopup",null)))(e);case"SET_IS_LOADING":return((e,t)=>t.isLoading?e.update("isLoading",(e=>e.add(t.path))):e.update("isLoading",(e=>e.delete(t.path))))(e,t);case"SET_IS_ONLINE":return((e,t)=>e.set("online",t.online))(e,t);case"SET_AGENDA_TIMEFRAME":return((e,t)=>e.set("agendaTimeframe",t.agendaTimeframe))(e,t);case"SET_FINDER_TAB":return((e,t)=>e.set("finderTab",t.finderTab))(e,t);case"PREFER_EDIT_RAW_VALUES":return((e,t)=>e.set("preferEditRawValues",t.preferEditRawValues))(e,t);default:return e}},syncBackend:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(y.Map)(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGN_OUT":return(e=>e.set("isAuthenticated",!1).set("client",null))(e);case"SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING":return((e,t)=>e.set("currentFileBrowserDirectoryListing",Object(y.Map)({listing:t.directoryListing,hasMore:t.hasMore,additionalSyncBackendState:t.additionalSyncBackendState})).set("currentPath",t.path))(e,t);case"SET_IS_LOADING_MORE_DIRECTORY_LISTING":return((e,t)=>e.update("currentFileBrowserDirectoryListing",(e=>e||Object(y.Map)())).setIn(["currentFileBrowserDirectoryListing","isLoadingMore"],t.isLoadingMore))(e,t);default:return e}},org:g()((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(y.Map)(),t=arguments.length>1?arguments[1]:void 0;const n=_i(e,t);return n.forEach((t=>{e=e.setIn(["files",t,"isDirty"],!0)})),e=Si(e,t),t.dirtying&&e.get("showClockDisplay")&&n.forEach((t=>{e=e.updateIn(["files",t,"headers"],Sn)})),e}),{filter:Object(m.includeAction)(["ADD_HEADER","REMOVE_HEADER","MOVE_HEADER_UP","MOVE_HEADER_DOWN","MOVE_HEADER_LEFT","MOVE_HEADER_RIGHT","MOVE_SUBTREE_LEFT","MOVE_SUBTREE_RIGHT","ADVANCE_TODO_STATE","SET_TODO_STATE","UPDATE_HEADER_TITLE","UPDATE_HEADER_DESCRIPTION","ADD_NEW_TABLE_ROW","ADD_NEW_TABLE_COLUMN","REMOVE_TABLE_ROW","REMOVE_TABLE_COLUMN","UPDATE_TABLE_CELL_VALUE","MOVE_TABLE_ROW_DOWN","MOVE_TABLE_ROW_UP","MOVE_TABLE_COLUMN_LEFT","MOVE_TABLE_COLUMN_RIGHT","INSERT_CAPTURE","REFILE_SUBTREE","HEADER_ADD_NOTE","SET_HEADER_TAGS","UPDATE_PROPERTY_LIST_ITEMS","ADD_NEW_PLANNING_ITEM","REMOVE_PLANNING_ITEM","CREATE_LOG_ENTRY_START","SET_LOG_ENTRY_STOP","ADD_NEW_LIST_ITEM","REMOVE_LIST_ITEM","MOVE_LIST_ITEM_UP","MOVE_LIST_ITEM_DOWN","MOVE_LIST_ITEM_LEFT","MOVE_LIST_ITEM_RIGHT","MOVE_LIST_SUBTREE_LEFT","MOVE_LIST_SUBTREE_RIGHT"])}),capture:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(y.Map)(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_NEW_EMPTY_CAPTURE_TEMPLATE":return(e=>(e.get("captureTemplates")||(e=e.set("captureTemplates",Object(y.List)())),e.update("captureTemplates",(e=>e.push(Object(y.fromJS)({id:w(),description:"",letter:"",iconName:"",isAvailableInAllOrgFiles:!0,file:"",orgFilesWhereAvailable:[""],headerPaths:[""],shouldPrepend:!1,template:""}))))))(e);case"UPDATE_TEMPLATE_FIELD_PATH_VALUE":return((e,t)=>{const n=Es(e.get("captureTemplates"),t.templateId);return e.setIn(["captureTemplates",n].concat(t.fieldPath),t.newValue)})(e,t);case"ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY":return((e,t)=>{const n=Es(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"orgFilesWhereAvailable"],(e=>e.push("")))})(e,t);case"REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY":return((e,t)=>{const n=Es(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"orgFilesWhereAvailable"],(e=>e.delete(t.orgFileAvailabilityIndex)))})(e,t);case"ADD_NEW_TEMPLATE_HEADER_PATH":return((e,t)=>{const n=Es(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"headerPaths"],(e=>e.push("")))})(e,t);case"REMOVE_TEMPLATE_HEADER_PATH":return((e,t)=>{const n=Es(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"headerPaths"],(e=>e.delete(t.headerPathIndex)))})(e,t);case"DELETE_TEMPLATE":return((e,t)=>{const n=Es(e.get("captureTemplates"),t.templateId);return e.update("captureTemplates",(e=>e.delete(n)))})(e,t);case"RESTORE_CAPTURE_SETTINGS":return ws(e,t);case"REORDER_CAPTURE_TEMPLATE":return((e,t)=>e.update("captureTemplates",(e=>e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex)))))(e,t);default:return e}}});const vs=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||u.d;var Ts=e=>{var t=Object.create(null);return"string"!==typeof e?t:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach((function(e){var n=e.replace(/\+/g," ").split("="),a=n.shift(),i=n.length>0?n.join("="):void 0;a=decodeURIComponent(a),i=void 0===i?null:decodeURIComponent(i),void 0===t[a]?t[a]=i:Array.isArray(t[a])?t[a].push(i):t[a]=[t[a],i]})),t):t},Ss=()=>{(()=>{if(!Wt)return;const e=localStorage.getItem("accessToken");e&&(localStorage.setItem("dropboxAccessToken",e),localStorage.removeItem("accessToken"))})(),(()=>{if(!Wt)return;const e=localStorage.getItem("shouldStoreSettingsInDropbox");e&&(localStorage.setItem("shouldStoreSettingsInSyncBackend",e),localStorage.removeItem("shouldStoreSettingsInDropbox"))})(),Wt&&Object.entries(localStorage).forEach(((e,t)=>{let[n,a]=e;["null","undefined"].includes(a)&&(console.warn(`localStorage contains a bogus entry: '${n}': '${a}'`),console.warn("Deleting the bogus entry."),localStorage.removeItem(n))}))},_s=n(14),Is=n(20),Cs=n(165);const Ds=()=>{let e,t;return new Cs.OAuth2AuthCodePKCE({authorizationUrl:"https://gitlab.com/oauth/authorize",tokenUrl:"https://gitlab.com/oauth/token",clientId:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DROPBOX_CLIENT_ID:"5uoz09pasfoxrcj"}).REACT_APP_GITLAB_CLIENT_ID,redirectUrl:window.location.origin,scopes:["api"],extraAuthorizationParams:{clientSecret:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DROPBOX_CLIENT_ID:"5uoz09pasfoxrcj"}).REACT_APP_GITLAB_SECRET},onAccessTokenExpiry:async t=>{e||(e=t());const n=await e;return e=void 0,n},onInvalidGrant:async e=>{t||(t=e()),await t,t=void 0}})},As=e=>{const t=e=>"tree"===e.type;return Object(y.fromJS)(e.filter((e=>t(e)||e.name.match(ze))).map((e=>({id:e.id,name:e.name,path:`/${e.path}`,isDirectory:t(e)}))).sort(((e,t)=>e.isDirectory&&!t.isDirectory?-1:!e.isDirectory&&t.isDirectory||e.name>t.name?1:-1)))},Os="https://gitlab.com/api/v4";var Ns=e=>{const t=e.decorateFetchHTTPClient(fetch),n=()=>`${Os}/projects/${Xt("gitLabProject")}`;let a;const i=async()=>{if(!a){const e=await t(n());if(!e.ok)throw new Error(`Unexpected response from project API. Status code: ${e.status}`);const i=await e.json();a=i.default_branch}return a},r=async e=>{const n=await t(e);if(!n.ok)throw new Error(`Unexpected response from directory API. Status code: ${n.status}`);const a=(i=n.headers.get("link"))?i.split(",").reduce(((e,t)=>{const n=t.match(/<(.*)>; rel="(\w*)"/),a=n[1];return e[n[2]]=a,e}),{}):{};var i;const r=await n.json();return{listing:As(r),hasMore:!!a.next,additionalSyncBackendState:Object(y.Map)({cursor:a.next})}},s=async e=>{const a=new URLSearchParams({ref:await i()}),r=encodeURIComponent(e.replace(/^\//,"")),s=await t(`${n()}/repository/files/${r}/raw?${a}`);if(!s.ok)throw new Error(`Unexpected response from file API. Status code: ${s.status}`);return{contents:await s.text(),commit:s.headers.get("x-gitlab-last-commit-id")}},o=async e=>{const a=await t(`${n()}/repository/commits/${e}?stats=false`);if(!a.ok)throw new Error(`Unexpected response from commit API. Status code: ${a.status}`);const i=await a.json(),r=new Date(i.committed_date),s=new Date(i.authored_date);return r>s?r.toISOString():s.toISOString()},l=async e=>{const a=`[organice] ${e.action.charAt(0).toUpperCase()+e.action.slice(1)} ${e.file_path}\n\nAutomatic commit from organice app.`;await t(`${n()}/repository/commits`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch:await i(),commit_message:a,actions:[e],stats:!1})})};return{type:"GitLab",isSignedIn:async()=>{if(!e.isAuthorized())return!1;try{return await e.getAccessToken(),!0}catch(t){return console.error("Error trying to get OAuth access token."),console.error(t),!1}},isProjectAccessible:async()=>{const[e,a]=await Promise.all([t(`${Os}/user`),t(`${n()}/members`)]);if(!e.ok||!a.ok)return!1;const[i,r]=await Promise.all([e.json(),a.json()]),s=r.find((e=>e.id===i.id));return s&&s.access_level>=30},getDirectoryListing:async e=>{const t=new URLSearchParams({pagination:"keyset",ref:await i(),path:e.replace(/^\//,""),per_page:100});return await r(`${n()}/repository/tree?${t}`)},getMoreDirectoryListing:async e=>await r(e.get("cursor")),updateFile:async(e,t)=>{await l({action:"update",file_path:e.replace(/^\//,""),content:t})},createFile:async(e,t)=>{await l({action:"create",file_path:e.replace(/^\//,""),content:t})},getFileContentsAndMetadata:async e=>{const t=await s(e);return{contents:t.contents,lastModifiedAt:await o(t.commit)}},getFileContents:async e=>(await s(e)).contents,deleteFile:async e=>{await l({action:"delete",file_path:e.replace(/^\//,"")})}}},Ps=n(166),Ls=n.n(Ps);const Rs=()=>(e,t)=>{switch(t().syncBackend.get("client",{}).type){case"WebDAV":["Endpoint","Username","Password"].forEach((e=>{qt("webdav"+e,null)}));break;case"Dropbox":qt("dropboxAccessToken",null),qt("dropboxRefreshToken",null),qt("codeVerifier",null);break;case"GitLab":qt("gitLabProject",null),Ds().reset()}qt("authenticatedSyncService",null),e({type:"SIGN_OUT"}),e(St()),e(Ye()),Wt&&localStorage.clear()},xs=(e,t,n,a)=>({type:"SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING",directoryListing:e,hasMore:t,additionalSyncBackendState:n,path:a}),Ms=e=>({type:"SET_IS_LOADING_MORE_DIRECTORY_LISTING",isLoadingMore:e}),Fs=e=>(t,n)=>{t(Ke("Getting listing..."));n().syncBackend.get("client").getDirectoryListing(e).then((n=>{let{listing:a,hasMore:i,additionalSyncBackendState:r}=n;t(xs(a,i,r,e)),t(Ye())})).catch((e=>{t(Ye());const n=b.a.get(e,"error.error_summary")||"";[400,401].includes(e.status)||n.includes("expired_access_token")?t(Rs()):(alert("There was an error retrieving files!"),console.error(e))}))},Hs=()=>(e,t)=>{e(Ms(!0));const n=t().syncBackend.get("client"),a=t().syncBackend.get("currentFileBrowserDirectoryListing");n.getMoreDirectoryListing(a.get("additionalSyncBackendState")).then((t=>{let{listing:n,hasMore:i,additionalSyncBackendState:r}=t;const s=a.get("listing").concat(n);e(xs(s,i,r)),e(Ms(!1))}))},js=(e,t)=>(n,a)=>{const i=a().syncBackend.get("client");switch(i.type){case"Dropbox":case"WebDAV":i.createFile(`${e}.organice-bak`,t)}},Bs=e=>(t,n)=>{t(Ke("Downloading file ...")),n().syncBackend.get("client").getFileContents(e).then((n=>{t(Ye()),t(js(e,n)),t(Ri(e,n)),t(xi(Object(Pt.a)(new Date,5),e)),t(yr(!1,e)),t(m.ActionCreators.clearHistory())})).catch((()=>{t(Ye()),t(Je(!1,e)),t(ns(`File ${e} not found`))}))};const Vs=(e,t)=>(n,a)=>{n(Ke(`Creating file: ${e}`)),a().syncBackend.get("client").createFile(e,t).then((()=>{n(xi(Object(Pt.a)(new Date,5),e)),n(Ye()),n(Fs(function(e){return Ls()(e).dir}(e)))})).catch((()=>{n(Ye()),n(Je(!1,e)),n(ns(`File ${e} not found`))}))};var Us=n(74);function Ws(){return Ts(window.location.search).code}var zs=()=>{let e;const t=e=>{const t=(e=>e.filter((e=>"folder"===e[".tag"]||e.name.match(ze))).sort(((e,t)=>"folder"===e[".tag"]&&"file"===t[".tag"]?-1:e.name>t.name?1:-1)))(e);return Object(y.fromJS)(t.map((e=>({id:e.id,name:e.name,isDirectory:"folder"===e[".tag"],path:e.path_display}))))},n=(t,n)=>new Promise(((a,i)=>e.then((e=>{e.filesUpload({path:t,contents:n,mode:{".tag":"overwrite"},autorename:!0}).then(a).catch(i)})))),a=n,i=n,r=t=>new Promise(((n,a)=>e.then((e=>{e.filesDownload({path:t}).then((e=>{const t=new FileReader;t.addEventListener("loadend",(()=>n({contents:t.result,lastModifiedAt:e.result.server_modified}))),t.readAsText(e.result.fileBlob)})).catch((e=>{const t=function(){try{return"not_found"===JSON.parse(e.error).error.path[".tag"]}catch(t){return!1}}();("string"===typeof e&&e.match(/missing required field 'path'/)||t)&&a()}))})))),s=window.location.origin+"/";return e=new Promise(((e,t)=>{const n=new Us.Dropbox({clientId:"5uoz09pasfoxrcj",fetch:fetch.bind(window)}),a=n.auth;Ws()?(a.setCodeVerifier(Xt("codeVerifier")),a.getAccessTokenFromCode(s,Ws()).then((t=>{a.setRefreshToken(t.result.refresh_token),qt("dropboxRefreshToken",t.result.refresh_token),e(n)})).catch((e=>{console.error(e)}))):(a.setCodeVerifier(Xt("codeVerifier")),a.setRefreshToken(Xt("dropboxRefreshToken")),e(n))})),{type:"Dropbox",isSignedIn:()=>new Promise((e=>e(!0))),getDirectoryListing:n=>new Promise(((a,i)=>{e.then((e=>{e.filesListFolder({path:n}).then((e=>{a({listing:t(e.result.entries),hasMore:e.result.has_more,additionalSyncBackendState:Object(y.Map)({cursor:e.result.cursor})})}))})).catch(i)})),getMoreDirectoryListing:n=>{const a=n.get("cursor");return new Promise(((n,i)=>e.then((e=>{e.filesListFolderContinue({cursor:a}).then((e=>n({listing:t(e.result.entries),hasMore:e.result.has_more,additionalSyncBackendState:Object(y.Map)({cursor:e.result.cursor})})))}))))},updateFile:a,createFile:i,getFileContentsAndMetadata:r,getFileContents:e=>Object(f.isEmpty)(e)?Promise.reject("No path given"):new Promise(((t,n)=>r(e).then((e=>{let{contents:n}=e;return t(n)})).catch(n))),deleteFile:t=>new Promise(((n,a)=>e.then((e=>{e.filesDelete({path:t}).then(n).catch((e=>a("path_lookup"===e.error.error[".tag"],e)))}))))}},Gs=n(167);n(312);var $s=n(16),Ks=(n(313),n(314),n.p+"static/media/organice.5121bc75.svg"),Ys=n(402),Js=n(403),qs=n(404),Xs=n(405),Zs=n(406),Qs=()=>(Object(o.useEffect)((()=>{const e=["font_awesome_all.min.js","bootstrap.bundle.min.js"];for(const t of e){const e=document.createElement("script");e.async=!1,e.src=`https://200ok.ch/landing_page/js/${t}`,document.head.appendChild(e)}}),[]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{id:"layoutDefault"},l.a.createElement("div",{id:"layoutDefault_content"},l.a.createElement("main",null,l.a.createElement("nav",{className:"navbar navbar-marketing navbar-expand-lg bg-transparent navbar-dark fixed-top navbar-scrolled"},l.a.createElement("div",{className:"container px-5"},l.a.createElement("img",{className:"landing-logo",src:Ks,alt:"Logo",style:{height:"4rem",filter:"drop-shadow(0px 0px 18px #fdf6e3)"}}),l.a.createElement("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},l.a.createElement(Ys.a,null)),l.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},l.a.createElement("ul",{className:"navbar-nav ms-auto me-lg-5"},l.a.createElement("li",{className:"nav-item"},l.a.createElement("a",{target:"_blank",className:"nav-link navbar-brand",href:"https://github.com/sponsors/200ok-ch",rel:"noreferrer noopener"},"Pricing")),l.a.createElement("li",{className:"nav-item"},l.a.createElement("a",{target:"_blank",className:"nav-link navbar-brand",href:"https://github.com/200ok-ch/organice",rel:"noreferrer noopener"},"Code")),l.a.createElement("li",{className:"nav-item"},l.a.createElement("a",{target:"_blank",className:"nav-link navbar-brand",href:"https://organice.200ok.ch/documentation.html",rel:"noreferrer noopener"},"Documentation"))),l.a.createElement("a",{className:"btn fw-500 ms-lg-4 btn-teal",href:"/sign_in"},"Sign in",l.a.createElement(Js.a,{className:"ms-2"}))))),l.a.createElement("header",{className:"page-header-ui page-header-ui-dark bg-gradient-primary-to-secondary"},l.a.createElement("div",{className:"page-header-ui-content pt-10"},l.a.createElement("div",{className:"container px-5"},l.a.createElement("div",{className:"row gx-5 align-items-center"},l.a.createElement("div",{className:"col-lg-6","data-aos":"fade-up"},l.a.createElement("h1",{className:"page-header-ui-title"},"organice is the best way to get stuff done"),l.a.createElement("p",null,"Whether you're planning multiple work projects, sharing a shopping list with your partner or you're planing a holiday, organice is here to help you complete all your personal and professional tasks."),l.a.createElement("p",null,"organice is Free and Open Source software that works on top of Org mode files."),l.a.createElement("a",{className:"btn btn-teal fw-500 me-2",href:"/sample"},"Live demo",l.a.createElement(Js.a,{className:"ms-2"})),l.a.createElement("a",{className:"btn btn-white fw-500 me-2",href:"/sign_in"},"Sign in",l.a.createElement(Js.a,{className:"ms-2"}))),l.a.createElement("div",{className:"col-lg-6 mt-5 mt-lg-0 d-lg-block text-center","data-aos":"fade-up","data-aos-delay":"1000"},l.a.createElement("img",{className:"img-fluid main-image",alt:"",src:"https://200ok.ch/landing_page/img/organice/screenshot-overview.png",style:{filter:"drop-shadow(0.5em 0.5em 0.5em #444)"}})))),l.a.createElement("div",{className:"svg-border-rounded text-white"},l.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 144.54 17.34",preserveAspectRatio:"none",fill:"currentColor"},l.a.createElement("path",{d:"M144.54,17.34H0V0H144.54ZM0,0S32.36,17.34,72.27,17.34,144.54,0,144.54,0"}))))),l.a.createElement("div",{className:"row"},l.a.createElement("section",{className:"bg-white py-10"},l.a.createElement("div",{className:"container px-5"},l.a.createElement("div",{className:"row gx-5 text-center"},l.a.createElement("div",{className:"col-lg-4 mb-5 mb-lg-0"},l.a.createElement("div",{className:"icon-stack icon-stack-xl bg-gradient-primary-to-secondary text-white mb-4"},l.a.createElement(qs.a,null)),l.a.createElement("h3",null,"Plan for anything"),l.a.createElement("p",{className:"mb-0"},"Organize and share your to-do, work, grocery, movies and household lists. No matter what you\u2019re planning, how big or small the task may be, organice makes it super easy to get stuff done.")),l.a.createElement("div",{className:"col-lg-4 mb-5 mb-lg-0"},l.a.createElement("div",{className:"icon-stack icon-stack-xl bg-gradient-primary-to-secondary text-white mb-4"},l.a.createElement(Xs.a,null)),l.a.createElement("h3",null,"See your agenda anytime"),l.a.createElement("p",{className:"mb-0"},"Set schedules and deadlines on to-dos. No matter whether your tasks are work related or just for fun, you will never miss a deadline again with organice in charge.")),l.a.createElement("div",{className:"col-lg-4 mb-5 mb-lg-0"},l.a.createElement("div",{className:"icon-stack icon-stack-xl bg-gradient-primary-to-secondary text-white mb-4"},l.a.createElement(Zs.a,null)),l.a.createElement("h3",null,"Privacy and freedom first"),l.a.createElement("p",{className:"mb-0"},"organice is Free and Open Source software protecting your freedom to run, copy, distribute, study, change and improve the software. Your most important data should never be in a closed silo.",l.a.createElement("br",null),l.a.createElement("br",null),"We also never see your data - only you and your personal storage provider does. organice saves your files in the free format Org mode, so you can always access it with any tool at any time!"))),l.a.createElement("div",{id:"icons",className:"row pt-10 d-flex flex-wrap align-items-center"},l.a.createElement("h1",{className:"text-center mb-5"},"Access from anywhere"),l.a.createElement("strong",{className:"text-center mb-5"},"Available on iPhone, Android, and the Web, organice works seamlessly across all major devices."),l.a.createElement("div",{className:"col-md-4"},l.a.createElement("i",{className:"fas fa-mobile-alt"})),l.a.createElement("div",{className:"col-md-4"},l.a.createElement("i",{className:"fab fa-android"})),l.a.createElement("div",{className:"col-md-4"},l.a.createElement("i",{className:"fab fa-firefox-browser"})))),l.a.createElement("div",{className:"svg-border-rounded text-light"},l.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 144.54 17.34",preserveAspectRatio:"none",fill:"currentColor"},l.a.createElement("path",{d:"M144.54,17.34H0V0H144.54ZM0,0S32.36,17.34,72.27,17.34,144.54,0,144.54,0"})))),l.a.createElement("section",{className:"bg-light py-10"},l.a.createElement("div",{className:"container px-5"},l.a.createElement("div",{className:"row gx-5 align-items-center justify-content-center"},l.a.createElement("div",{className:"col-md-9 col-lg-6 order-1 order-lg-0","data-aos":"fade-right"},l.a.createElement("div",{className:"content-skewed content-skewed-right"},l.a.createElement("img",{className:"content-skewed-item img-fluid shadow-lg rounded-3",src:"https://200ok.ch/landing_page/img/organice/screenshot-wide.png",alt:"Sample organice document"}))),l.a.createElement("div",{className:"col-lg-6 order-0 order-lg-1 mb-5 mb-lg-0","data-aos":"fade-left"},l.a.createElement("div",{className:"mb-5"},l.a.createElement("h2",null,"Remember all the things"),l.a.createElement("p",{className:"lead"},"Succeed with every project")),l.a.createElement("div",{className:"row gx-5"},l.a.createElement("div",{className:"col-md-6 mb-4"},l.a.createElement("h6",null,"Work anywhere"),l.a.createElement("p",{className:"mb-2 small mb-0"},"organice works on all major platforms, so you can access your information wherever you are.")),l.a.createElement("div",{className:"col-md-6 mb-4"},l.a.createElement("h6",null,"Find your content quickly"),l.a.createElement("p",{className:"mb-2 small mb-0"},"Thanks to a flexible query language and a bookmarking system, you can find your important content quickly and reliably."))))))),l.a.createElement("section",{className:"bg-white pt-10"},l.a.createElement("div",{className:"container px-5"},l.a.createElement("div",{className:"row gx-5 mb-10"},l.a.createElement("h1",{className:"text-center mb-5"},"What our users say"),l.a.createElement("div",{className:"col-lg-6 mb-5 mb-lg-0 divider-right aos-init aos-animate","data-aos":"fade"},l.a.createElement("div",{className:"testimonial p-lg-5"},l.a.createElement("p",{className:"testimonial-quote text-primary"},'"This is a SPECTACULAR project and I am glad that I found it. organice takes the extreme power of org mode and makes it simple to use. When combined with the option to self-host your own data rganice has created an extremely flexible and secure option to help fulfill everyone\'s organizational needs."'),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-3"},l.a.createElement("img",{className:"card-img",src:"https://github.com/dmorlitz.png",alt:"@dmorlitz"})),l.a.createElement("div",{className:"col-9"},l.a.createElement("div",{className:"testimonial-name"},l.a.createElement("a",{target:"_blank",href:"https://github.com/dmorlitz",style:{color:"#363d47"},rel:"noopener noreferrer"},"@dmorlitz")),l.a.createElement("div",{className:"testimonial-position"},"Contributor"))))),l.a.createElement("div",{className:"col-lg-6 aos-init aos-animate","data-aos":"fade","data-aos-delay":"100"},l.a.createElement("div",{className:"testimonial p-lg-5"},l.a.createElement("p",{className:"testimonial-quote text-primary"},'"Been using organice for years. To me, it\u2019s by far the most usable solution for interacting with org files on a mobile device."'),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-3"},l.a.createElement("img",{className:"card-img",src:"https://github.com/jcpst.png",alt:"@jcpst"})),l.a.createElement("div",{className:"col-9"},l.a.createElement("div",{className:"testimonial-name"},l.a.createElement("a",{target:"_blank",href:"https://github.com/jcpst",style:{color:"#363d47"},rel:"noopener noreferrer"},"@jcpst")),l.a.createElement("div",{className:"testimonial-position"},"User")))))))),l.a.createElement("hr",{className:"m-0"}),l.a.createElement("section",{className:"bg-dark py-10"},l.a.createElement("div",{className:"container px-5"},l.a.createElement("div",{className:"row gx-5 my-10"},l.a.createElement("div",{className:"col-lg-6 mb-5"},l.a.createElement("div",{className:"d-flex h-100"},l.a.createElement("div",{className:"icon-stack flex-shrink-0 bg-teal text-white"},l.a.createElement("i",{className:"fas fa-question"})),l.a.createElement("div",{className:"ms-4"},l.a.createElement("h5",{className:"text-white"},"Intro video"),l.a.createElement("p",{className:"text-white-50"},"If you are interested into the 'why did we get started with organice', we have got you covered. For"," ",l.a.createElement("a",{target:"_blank",href:"https://emacsconf.org/2019/",rel:"noreferrer noopener"}," ","EmacsConf 2019"),", we have created a 10 minute introductory video into the rationale and usability of organice.")))),l.a.createElement("div",{className:"col-lg-6 mb-5"},l.a.createElement("div",{className:"d-flex h-100"},l.a.createElement("div",{className:"tutorial container text-center my-5 ratio ratio-16x9"},l.a.createElement("iframe",{src:"https://www.youtube.com/embed/aQKc0hcFXCk",title:"YouTube video player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}))))),l.a.createElement("div",{className:"row gx-5 justify-content-center text-center"},l.a.createElement("div",{className:"col-lg-8"},l.a.createElement("div",{className:"badge bg-transparent-light rounded-pill badge-marketing mb-4"}),l.a.createElement("h2",{className:"text-white"},"Get started"),l.a.createElement("div",{className:"lead text-white-50 mb-5"},l.a.createElement("p",null,"organice is"," ",l.a.createElement("a",{target:"_blank",href:"https://www.gnu.org/philosophy/free-sw.en.html",rel:"noreferrer noopener"},"free software")," ","and will stay this way. Leave the closed silos behind and let your knowledge roam free. Start with the live demo - you don't even need to sign up. Check it out first and sign up later.")),l.a.createElement("a",{className:"btn btn-teal fw-500",href:"/sample"},"Live demo")))),l.a.createElement("div",{className:"svg-border-rounded text-white"},l.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 144.54 17.34",preserveAspectRatio:"none",fill:"currentColor"},l.a.createElement("path",{d:"M144.54,17.34H0V0H144.54ZM0,0S32.36,17.34,72.27,17.34,144.54,0,144.54,0"})))),l.a.createElement("section",{className:"bg-light py-10"},l.a.createElement("div",{className:"container px-5 mt-5"},l.a.createElement("div",{className:"row gx-5 align-items-center"},l.a.createElement("div",{className:"col-lg-6"},l.a.createElement("h4",null,"Do you have further questions?"),l.a.createElement("p",{className:"lead mb-5 mb-lg-0 text-gray-500"},"Join the inclusive and friendly community chat, and let's have a talk.")),l.a.createElement("div",{className:"col-lg-6 text-lg-end"},l.a.createElement("a",{className:"btn btn-primary fw-500 me-3 my-2",href:"https://matrix.to/#/#organice:matrix.org"},"Matrix"),l.a.createElement("a",{className:"btn btn-white fw-500 my-2 shadow",href:"https://web.libera.chat/"},"IRC (#organice)"))))),l.a.createElement("hr",{className:"m-0"})))),l.a.createElement("div",{id:"layoutDefault_footer"},l.a.createElement("footer",{className:"footer pt-10 pb-5 mt-auto bg-light footer-light"},l.a.createElement("div",{className:"container px-5"},l.a.createElement("div",{className:"row gx-5"},l.a.createElement("div",{className:"col-lg-3"},l.a.createElement("div",{className:"footer-brand"},"200ok GmbH"),l.a.createElement("div",{className:"mb-3"},"Glarus, Switzerland"),l.a.createElement("div",null,l.a.createElement("a",{href:"tel:+41764050567"},l.a.createElement("i",{className:"fas fa-phone-square"}),"\xa0+41 76 405 05 67")),l.a.createElement("div",null,l.a.createElement("a",{href:"mailto:info@200ok.ch"},l.a.createElement("i",{className:"fas fa-envelope-square"}),"\xa0info@200ok.ch"))),l.a.createElement("div",{className:"col-lg-9"},l.a.createElement("div",{className:"row gx-5"},l.a.createElement("div",{className:"col-lg-6"},l.a.createElement("div",{className:"footer-brand"},"\xa0"),l.a.createElement("div",{className:"mb-3"},"Follow us on Social Media"),l.a.createElement("div",{className:"icon-list-social mb-5"},l.a.createElement("a",{className:"icon-list-social-link",target:"_blank",href:"https://200ok.ch/atom.xml",rel:"noreferrer noopener"},l.a.createElement("i",{className:"fas fa-rss-square"})),l.a.createElement("a",{className:"icon-list-social-link",target:"_blank",href:"https://github.com/200ok-ch/",rel:"noreferrer noopener"},l.a.createElement("i",{className:"fab fa-github"})),l.a.createElement("a",{className:"icon-list-social-link",target:"_blank",href:"https://www.linkedin.com/in/alafon/",rel:"noreferrer noopener"},l.a.createElement("i",{className:"fab fa-linkedin"})),l.a.createElement("a",{className:"icon-list-social-link",target:"_blank",href:"https://twitter.com/munen_200ok",rel:"noreferrer noopener"},l.a.createElement("i",{className:"fab fa-twitter"}))))))),l.a.createElement("hr",{className:"my-5"}),l.a.createElement("div",{className:"row gx-5 align-items-center"},l.a.createElement("div",{className:"col-md-6 small"},"Copyright \xa9 200ok GmbH 2022"),l.a.createElement("div",{className:"col-md-6 text-md-end small"},l.a.createElement(_s.b,{to:"/privacy-policy"},"Privacy Policy"),"\xb7")))))))),eo=(n(316),n(8)),to=n.n(eo),no=(n(317),e=>{let{href:t,children:n}=e;return l.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},n||t)});var ao=()=>l.a.createElement("div",{className:"privacy-policy-container"},l.a.createElement("h1",null,"organice privacy policy"),l.a.createElement("p",null,"Last updated: May 9th, 2020"),l.a.createElement("p",null,l.a.createElement(no,{href:"https://200ok.ch/"},"200ok llc")," operates the"," ",l.a.createElement(no,{href:"https://organice.200ok.ch"})," website and mobile apps."),l.a.createElement("p",null,"This page is used to inform website visitors regarding our policies with the collection, use, and disclosure of Personal Information if anyone decided to use our Service."),l.a.createElement("p",null,"If you choose to use our Service, then you agree to the collection and use of information in relation with this policy. The Personal Information that we collect are used for providing and improving the Service. We will not use or share your information with anyone except as described in this Privacy Policy."),l.a.createElement("p",null,l.a.createElement("strong",null,"Information Collection and Use")),l.a.createElement("p",null,"For a better experience while using our Service, we may require you to provide us with certain personally identifiable information, including but not limited to your name, phone number, and postal address. The information that we collect will be used to contact or identify you."),l.a.createElement("p",null,l.a.createElement("strong",null,"Log Data")),l.a.createElement("p",null,"We want to inform you that whenever you visit our Service, we collect information that your browser sends to us that is called Log Data. This Log Data may include information such as your computer\u2019s Internet Protocol (\u201cIP\u201d) address, browser version, pages of our Service that you visit, the time and date of your visit, the time spent on those pages, and other statistics."),l.a.createElement("p",null,l.a.createElement("strong",null,"User data")),l.a.createElement("p",null,"No user data, including user data from third-party services such as Dropbox will be stored or monitored by our Service. All access to user data is done through the proper APIs of the respective services, and all data is only processed by the browser. No data will be shared with any other service."),l.a.createElement("p",null,l.a.createElement("strong",null,"Cookies")),l.a.createElement("p",null,"Cookies are files with small amount of data that is commonly used an anonymous unique identifier. These are sent to your browser from the website that you visit and are stored on your computer\u2019s hard drive."),l.a.createElement("p",null,"Our website uses these \u201ccookies\u201d to collection information and to improve our Service. You have the option to either accept or refuse these cookies, and know when a cookie is being sent to your computer. If you choose to refuse our cookies, you may not be able to use some portions of our Service."),l.a.createElement("p",null,l.a.createElement("strong",null,"Service Providers")),l.a.createElement("p",null,"We may employ third-party companies and individuals due to the following reasons:"),l.a.createElement("ul",null,l.a.createElement("li",null,"To facilitate our Service;"),l.a.createElement("li",null,"To provide the Service on our behalf;"),l.a.createElement("li",null,"To perform Service-related services; or"),l.a.createElement("li",null,"To assist us in analyzing how our Service is used.")),l.a.createElement("p",null,"We want to inform our Service users that these third parties have access to your Personal Information. The reason is to perform the tasks assigned to them on our behalf. However, they are obligated not to disclose or use the information for any other purpose."),l.a.createElement("p",null,l.a.createElement("strong",null,"Security")),l.a.createElement("p",null,"We value your trust in providing us your Personal Information, thus we are striving to use commercially acceptable means of protecting it. But remember that no method of transmission over the internet, or method of electronic storage is 100% secure and reliable, and we cannot guarantee its absolute security."),l.a.createElement("p",null,l.a.createElement("strong",null,"Links to Other Sites")),l.a.createElement("p",null,"Our Service may contain links to other sites. If you click on a third-party link, you will be directed to that site. Note that these external sites are not operated by us. Therefore, we strongly advise you to review the Privacy Policy of these websites. We have no control over, and assume no responsibility for the content, privacy policies, or practices of any third-party sites or services."),l.a.createElement("p",null,l.a.createElement("strong",null,"Children\u2019s Privacy")),l.a.createElement("p",null,"Our Services do not address anyone under the age of 13. We do not knowingly collect personal identifiable information from children under 13. In the case we discover that a child under 13 has provided us with personal information, we immediately delete this from our servers. If you are a parent or guardian and you are aware that your child has provided us with personal information, please contact us so that we will be able to do necessary actions."),l.a.createElement("p",null,l.a.createElement("strong",null,"Changes to This Privacy Policy")),l.a.createElement("p",null,"We may update our Privacy Policy from time to time. Thus, we advise you to review this page periodically for any changes. We will notify you of any changes by posting the new Privacy Policy on this page. These changes are effective immediately, after they are posted on this page."),l.a.createElement("p",null,l.a.createElement("strong",null,"Contact us")),l.a.createElement("p",null,"If you have any questions about this Privacy Policy, please"," ",l.a.createElement("a",{href:"mailto:info@200ok.ch"},"contact us"),"."));n(318);class io extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleChangelogClick","handleModalPageDoneClick","handleHeaderBarTitleClick","handleBackClick","handleUndoClick","handleRedoClick","handleHelpClick","handleSettingsClick"])}getPathRoot(){const{location:{pathname:e}}=this.props;return e.split("/")[1]}getFilename(){const{location:{pathname:e}}=this.props;return e.includes(".org")?e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")):""}renderFileBrowserBackButton(){let e="Back";const t=window.location.href.split("/").map((e=>decodeURIComponent(e)));return b.a.includes(t,"files")&&(e=b.a.last(t)),l.a.createElement("div",{onClick:()=>{window.history.back()},className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},e))}renderOrgFileBackButton(){const{location:{pathname:e}}=this.props;let t=e.substr(5);t.endsWith("/")&&(t=t.substring(0,t.length-1));const n=t.split("/"),a=n.slice(0,n.length-1).join("/");return l.a.createElement(_s.b,{to:`/files${a}`,onClick:this.handleBackClick,className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"File browser"))}renderLogo(){return l.a.createElement("div",{className:"header-bar__logo-container"},l.a.createElement("img",{className:"header-bar__logo",src:Ks,alt:"Logo",width:"30",height:"30"}),l.a.createElement("h2",{className:"header-bar__app-name"},"organice"))}renderHomeFileBackButton(){return l.a.createElement(_s.b,{to:"/",className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Home"))}renderSignInBackButton(){return l.a.createElement(_s.b,{to:"/",className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Home"))}handleBackClick(){this.props.base.popModalPage()}renderSettingsSubPageBackButton(){return l.a.createElement("div",{className:"header-bar__back-button",onClick:this.handleBackClick},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Settings"))}renderBackButton(){const{activeModalPage:e}=this.props;switch(e){case"changelog":case"keyboard_shortcuts_editor":case"capture_templates_editor":case"file_settings_editor":return this.renderSettingsSubPageBackButton();case"sample":return this.renderOrgFileBackButton()}switch(this.getPathRoot()){case"":return this.renderLogo();case"files":case"settings":case"changelog":return this.renderFileBrowserBackButton();case"file":return this.renderOrgFileBackButton();case"sample":return this.renderHomeFileBackButton();case"sign_in":return this.renderSignInBackButton();default:return l.a.createElement("div",null)}}renderTitle(){const e=e=>l.a.createElement("div",{className:"header-bar__title",onClick:this.handleHeaderBarTitleClick},e);switch(this.props.activeModalPage){case"changelog":return e("Changelog");case"settings":return e("Settings");case"keyboard_shortcuts_editor":return e("Shortcuts");case"capture_templates_editor":return e("Capture");case"file_settings_editor":return e("Files");case"sample":return e("Sample")}switch(this.getPathRoot()){case"sample":return e("Sample");case"sign_in":return e("Sign in");case"settings":return e("Settings")}return e(this.props.shouldShowTitleInOrgFile?this.getFilename():"")}handleChangelogClick(){this.props.base.restoreStaticFile("changelog"),this.props.base.pushModalPage("changelog")}handleModalPageDoneClick(){this.props.base.clearModalStack()}handleHeaderBarTitleClick(){this.props.org.selectHeader(null)}handleUndoClick(){this.props.isUndoEnabled&&this.props.undo.undo()}handleRedoClick(){this.props.isRedoEnabled&&this.props.undo.redo()}handleHelpClick(){this.props.base.restoreStaticFile("sample"),this.props.base.pushModalPage("sample")}handleSettingsClick(){this.props.base.setLastViewedFile(this.props.path)}renderActions(){const{isAuthenticated:e,hasUnseenChangelog:t,activeModalPage:n,path:a,isUndoEnabled:i,isRedoEnabled:r}=this.props;if(n)return l.a.createElement("div",{className:"header-bar__actions",onClick:this.handleModalPageDoneClick},"Done");if("settings"!==this.getPathRoot()){const s=to()("fas fa-undo header-bar__actions__item",{"header-bar__actions__item--disabled":!i}),c=to()("fas fa-redo header-bar__actions__item",{"header-bar__actions__item--disabled":!r}),d=to()("fas fa-cogs header-bar__actions__item");return l.a.createElement("div",{className:"header-bar__actions"},!e&&"sign_in"!==this.getPathRoot()&&l.a.createElement(_s.b,{to:"/sign_in"},l.a.createElement("div",{className:"header-bar__actions__item",title:"Sign in"},"Sign in")),!e&&l.a.createElement(no,{href:"https://github.com/200ok-ch/organice"},l.a.createElement("i",{className:"fab fa-github header-bar__actions__item"})),e&&!n&&!!a&&l.a.createElement(o.Fragment,null,l.a.createElement("i",{className:s,onClick:this.handleUndoClick,title:"Undo"}),l.a.createElement("i",{className:c,onClick:this.handleRedoClick,title:"Redo"}),l.a.createElement("i",{className:"fas fa-question-circle header-bar__actions__item",onClick:this.handleHelpClick,title:"Help"})),e&&l.a.createElement("div",null,t&&l.a.createElement(_s.b,{to:"/changelog"},l.a.createElement("i",{className:"changelog-icon--has-unseen-changelog header-bar__actions__item fas fa-gift",title:"Changelog"})),l.a.createElement(_s.b,{to:"/settings",onClick:this.handleSettingsClick},l.a.createElement("i",{className:d,title:"Settings"}))))}}render(){const e=to()("header-bar",{"header-bar--with-logo":""===this.getPathRoot()});return(()=>{const e=Object(qn.a)();return!window.testRunner&&"/"===e.location.pathname&&!localStorage.authenticatedSyncService})()?null:l.a.createElement("div",{className:e},this.renderBackButton(),this.renderTitle(),this.renderActions())}}var ro=Object($s.i)(Object(h.b)((e=>({isAuthenticated:e.syncBackend.get("isAuthenticated"),hasUnseenChangelog:e.base.get("hasUnseenChangelog"),activeModalPage:e.base.get("modalPageStack",Object(y.List)()).last(),shouldShowTitleInOrgFile:e.base.get("shouldShowTitleInOrgFile"),path:e.org.present.get("path"),isUndoEnabled:e.org.past.length>0,isRedoEnabled:e.org.future.length>0,syncBackendType:e.syncBackend.get("client")&&e.syncBackend.get("client").type})),(e=>({base:Object(u.b)(a,e),org:Object(u.b)(r,e),undo:Object(u.b)(m.ActionCreators,e)})))(io));n(157),n(319);class so extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleClick"])}handleClick(){const{onClick:e,isDisabled:t}=this.props;t||e()}render(){const{iconName:e,subIconName:t,isDisabled:n,shouldRotateSubIcon:a,letter:i,additionalClassName:r,style:s,tooltip:o,shouldSpinSubIcon:c,onRef:d}=this.props,h=to()("btn","btn--circle","action-drawer__btn",r||"",{fas:!i,"fa-lg":!i,[`fa-${e}`]:!i,"action-drawer__btn--with-sub-icon":!!t,"btn--disabled":n,"action-drawer__btn--letter":!!i}),u=to()("fas","fa-xs",`fa-${t}`,"action-drawer__btn__sub-icon",{"action-drawer__btn__sub-icon--rotated":a,"fa-spin":c});return l.a.createElement("button",{className:h,onClick:this.handleClick,style:s,title:o,ref:d},!!i&&i,!!t&&l.a.createElement("i",{className:u}))}}var oo=Object(h.b)((e=>{const t=e.syncBackend.get("currentPath");let n=e.syncBackend.getIn(["currentFileBrowserDirectoryListing","listing"]);return n=n?n.map((e=>e.get("id"))).toJS():[],{path:t,files:n}}),(e=>({org:Object(u.b)(r,e),syncBackend:Object(u.b)(s,e)})))((e=>{let{org:t,files:n,syncBackend:a,path:i}=e;return l.a.createElement("div",{className:"action-drawer-container nice-scroll"},l.a.createElement(o.Fragment,null,l.a.createElement("div",{className:"action-drawer__capture-buttons-container",style:{marginLeft:"auto",marginRight:0}},l.a.createElement(so,{iconName:"plus",isDisabled:!1,onClick:()=>{const e="* First header\nExtend the file from here.";let r=prompt("New filename:");if(!r)return;r=(e=>e.endsWith(".org")?e:`${e}.org`)(r);let s=`${i}/${r}`;b.a.includes(n,s)?alert("File already exists. Aborting."):(a.createFile(s,e),t.addNewFile(s,e))},style:{opacity:1,position:"relative",zIndex:1},tooltip:"Add new Org file"}))))}));n(320);var lo=Object(h.b)((e=>{const t=e.syncBackend.get("currentFileBrowserDirectoryListing");return{syncBackendType:e.syncBackend.get("client").type,listing:t?t.get("listing"):null,hasMore:!!t&&t.get("hasMore"),isLoadingMore:!!t&&t.get("isLoadingMore"),additionalSyncBackendState:!!t&&t.get("additionalSyncBackendState")}}),(e=>({syncBackend:Object(u.b)(s,e)})))((e=>{let{path:t,listing:n,hasMore:a,isLoadingMore:i,syncBackendType:r,syncBackend:s}=e;Object(o.useEffect)((()=>s.getDirectoryListing(t)),[s,t]);const c=""===t;return l.a.createElement("div",{className:"file-browser-container"},"Dropbox"===r&&l.a.createElement("h3",{className:"file-browser__header"},"Directory: ",c?"/":t),l.a.createElement(oo,null),l.a.createElement("ul",{className:"file-browser__file-list"},!c&&l.a.createElement(_s.b,{to:`/files${(()=>{switch(r){case"Dropbox":case"GitLab":case"WebDAV":const e=t.split("/");return e.slice(0,e.length-1).join("/");default:return null}})()}`},l.a.createElement("li",{className:"file-browser__file-list__element"},l.a.createElement("i",{className:"fas fa-folder file-browser__file-list__icon--directory"})," ..")),(n||[]).map((e=>{const t=e.get("isDirectory"),n=e.get("name").endsWith(".organice-bak"),a=e.get("name").endsWith(".org"),i=".organice-config.json"===e.get("name"),r=to()("file-browser__file-list__icon fas",{"fa-folder":t,"file-browser__file-list__icon--directory":t,"fa-file":!t&&!n&&!i,"file-browser__file-list__icon--not-org":!a,"fa-copy":n,"fa-cogs":i});return e.get("isDirectory")?l.a.createElement(_s.b,{to:`/files${e.get("path")}`,key:e.get("id")},l.a.createElement("li",{className:"file-browser__file-list__element"},l.a.createElement("i",{className:r})," ",e.get("name"),"/")):l.a.createElement(_s.b,{to:`/file${e.get("path")}`,key:e.get("id")},l.a.createElement("li",{className:"file-browser__file-list__element"},l.a.createElement("i",{className:r})," ",e.get("name")))})),a&&(i?l.a.createElement("li",{className:"file-browser__file-list__loading-more-container"},l.a.createElement("i",{className:"fas fa-spinner fa-lg fa-spin"})):l.a.createElement("li",{className:"file-browser__file-list__element file-browser__file-list__element--load-more-row",onClick:()=>s.loadMoreDirectoryListing()},"Load more..."))))})),co=n(13),ho=(n(328),e=>{let{message:t}=e;const[n,a]=Object(o.useState)(!0),[i,r]=Object(o.useState)(t);Object(o.useEffect)((()=>{t&&(r(t),a(!0))}),[t]);const s=()=>a(!1);if(!n)return null;const c={opacity:Object(co.spring)(t?.9:0,{stiffness:300})};return l.a.createElement(co.Motion,{style:c,onRest:()=>{t||(a(!1),r(null))}},(e=>l.a.createElement("div",{className:"loading-indicator",style:e,onClick:s},i)))}),uo=n(75),po=(n(330),n(331),n(38));n(333),n(334),n(335),n(336);class mo extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleTableSelect"]),this.state={rawCellValues:this.generateCellValueMap(e.table),shouldIgnoreBlur:!1}}componentDidUpdate(e){const{subPartDataAndHandlers:{onTableCellValueUpdate:t,selectedTableCellId:n,inTableEditMode:a}}=this.props,{rawCellValues:i}=this.state;e.subPartDataAndHandlers.inTableEditMode&&!a&&i.has(n)&&t(n,i.get(n)),this.props.table!==e.table&&this.setState({rawCellValues:this.generateCellValueMap(this.props.table)})}generateCellValueMap(e){return Object(y.Map)(e.get("contents").map((e=>e.get("contents").map((e=>[e.get("id"),e.get("rawContents")])))).flatten())}handleTableSelect(e){this.props.subPartDataAndHandlers.onTableSelect(e)}render(){const{table:e}=this.props;return l.a.createElement(o.Fragment,null,l.a.createElement("table",{className:"table-part",onClick:()=>this.handleTableSelect(e.get("id"))},l.a.createElement("tbody",null,e.get("contents").map((e=>l.a.createElement("tr",{key:e.get("id")},e.get("contents").map((e=>{const t=to()("table-part__cell");return l.a.createElement("td",{className:t,key:e.get("id")},e.get("contents").size>0?l.a.createElement(So,{parts:e.get("contents"),subPartDataAndHandlers:this.props.subPartDataAndHandlers}):"   ")}))))))))}}n(337);const go=(e,t,n)=>({r:parseInt((t.r-e.r)*n+e.r,10),g:parseInt((t.g-e.g)*n+e.g,10),b:parseInt((t.b-e.b)*n+e.b,10),a:(t.a-e.a)*n+e.a}),fo=(e,t,n,a)=>({r:e,g:t,b:n,a:a}),bo=e=>`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`,yo=e=>{const t=getComputedStyle(document.documentElement).getPropertyValue(e);if("#"===t.charAt(0)){const e=t.substring(1,7);return fo(parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16),1)}{const e=[...t.matchAll(/[0-9.]+/g)].map((e=>+e[0]));return 3===e.length?fo(...e,0):4===e.length?fo(...e):fo(0,0,0,0)}},Eo={Solarized:{Light:{"--base3":"#fdf6e3","--base2":"#eee8d5","--base1":"#93a1a1","--base0":"#839496","--base00":"#657b83","--base01":"#586e75","--base02":"#073642","--base03":"#002b36","--base0-soft":"rgba(131, 148, 150, 0.75)","--base1-soft":"rgba(147, 161, 161, 0.4)","--blue":"#268bd2","--green":"#859900","--cyan":"#2aa198","--yellow":"#b58900","--orange":"#cb4b16","--red":"#dc322f","--magenta":"#d33682","--violet":"#6c71c4","--green-soft":"rgba(133, 153, 0, 0.28)"},Dark:{"--base3":"#002b36","--base2":"#073642","--base1":"#586e75","--base0":"#657b83","--base03":"#fdf6e3","--base02":"#eee8d5","--base01":"#93a1a1","--base00":"#839496","--base0-soft":"rgba(0, 21, 27, 0.75)","--base1-soft":"rgba(0, 21, 27, 0.4)","--blue":"#268bd2","--green":"#859900","--cyan":"#2aa198","--yellow":"#b58900","--orange":"#cb4b16","--red":"#dc322f","--magenta":"#6c71c4","--violet":"#d33682","--green-soft:":"rgba(133, 153, 0, 0.28)"}},Gruvbox:{Light:{"--base3":"#fbf1c7","--base2":"#d5c4a1","--base1":"#bdae93","--base0":"#a89984","--base00":"#7c6f64","--base01":"#665c54","--base02":"#504945","--base03":"#282828","--base0-soft":"rgba(168, 153, 132, 0.75)","--base1-soft":"rgba(189, 174, 147, 0.4)","--blue":"#076678","--green":"#79740e","--cyan":"#427b58","--yellow":"#b57614","--orange":"#af3a03","--red":"#9d0006","--magenta":"#8f3f71","--violet":"#b16286","--green-soft":"rgba(133, 153, 0, 0.28)"},Dark:{"--base3":"#282828","--base2":"#504945","--base1":"#665c54","--base0":"#7c6f64","--base00":"#a89984","--base01":"#bdae93","--base02":"#d5c4a1","--base03":"#fbf1c7","--base0-soft":"rgba(20, 20, 20, 0.75)","--base1-soft":"rgba(20, 20, 20, 0.4)","--blue":"#458588","--green":"#98971a","--cyan":"#689d6a","--yellow":"#d79921","--orange":"#d65d0e","--red":"#cc241d","--magenta":"#b16286","--violet":"#d3869b","--green-soft":"rgba(133, 153, 0, 0.28)"}},One:{Light:{"--base03":"#383A42","--base02":"#585A5F","--base01":"#79797C","--base00":"#999999","--base0":"#A0A1A7","--base1":"#C0C0C4","--base2":"#DFE0E2","--base3":"#FFFFFF","--base0-soft":"rgba(160, 161, 167, 0.75)","--base1-soft":"rgba(192, 192, 196, 0.4)","--blue":"#1492ff","--green":"#2db448","--cyan":"#D831B0","--yellow":"#d5880b","--orange":"#f42a2a","--red":"#f42a2a","--magenta":"hsl(208, 100%, 56%)","--violet":"#D831B0","--green-soft":"rgba(133, 153, 0, 0.28)"},Dark:{"--base03":"#abb2bf","--base02":"#9198A5","--base01":"#767D8A","--base00":"#5c6370","--base0":"#4c5263","--base1":"#404553","--base2":"#343944","--base3":"#282c34","--base0-soft":"rgba(20, 22, 26, 0.75)","--base1-soft":"rgba(20, 22, 26, 0.4)","--blue":"rgb(100, 148, 237)","--green":"rgb(115, 201, 144)","--cyan":"rgb(204, 133, 51)","--yellow":"rgb(226, 192, 141)","--orange":"rgb(255, 99, 71)","--red":"#D831B0","--magenta":"rgb(0, 136, 255)","--violet":"#d33682","--green-soft":"rgba(133, 153, 0, 0.28)"}},Smyck:{Light:{"--base3":"#F7F7F7","--base2":"#DFDFDF","--base1":"#C8C8C8","--base0":"#B0B0B0","--base00":"#5D5D5D","--base01":"#3E3E3E","--base02":"#1F1F1F","--base03":"#000000","--base0-soft":"rgba(176, 176, 176, 0.75)","--base1-soft":"rgba(200, 200, 200, 0.4)","--blue":"#72B3CC","--green":"#8EB33B","--cyan":"#218693","--yellow":"#D0B03C","--orange":"#C75646","--red":"#E09690","--magenta":"#77DFD8","--violet":"#FBB1F9","--green-soft":"rgba(133, 153, 0, 0.28)"},Dark:{"--base3":"#000000","--base2":"#1F1F1F","--base1":"#3E3E3E","--base0":"#5D5D5D","--base00":"#B0B0B0","--base01":"#C8C8C8","--base02":"#DFDFDF","--base03":"#F7F7F7","--base0-soft":"rgba(31, 31, 31, 0.75)","--base1-soft":"rgba(31, 31, 31, 0.4)","--blue":"#72B3CC","--green":"#8EB33B","--cyan":"#218693","--yellow":"#D0B03C","--orange":"#C75646","--red":"#E09690","--magenta":"#77DFD8","--violet":"#FBB1F9","--green-soft":"rgba(133, 153, 0, 0.28)"}},Code:{Light:{"--base3":"#FFFFFF","--base2":"#DBDBDB","--base1":"#B6B6B6","--base0":"#929292","--base00":"#6D6D6D","--base01":"#494949","--base02":"#242424","--base03":"#000000","--base0-soft":"rgba(146, 146, 146, 0.75)","--base1-soft":"rgba(172, 172, 172, 0.4)","--blue":"#0000ff","--green":"#098658","--cyan":"#267f99","--yellow":"#795e26","--orange":"#ee0000","--red":"#a31515","--magenta":"#0070c1","--violet":"#811f3f","--green-soft":"rgba(133, 153, 0, 0.28)"},Dark:{"--base3":"#1E1E1E","--base2":"#2C2C32","--base1":"#303036","--base0":"#34343a","--base00":"#C8C8C8","--base01":"#cccccc","--base02":"#D0D0D0","--base03":"#D4D4D4","--base0-soft":"rgba(15, 15, 15, 0.75)","--base1-soft":"rgba(15, 15, 15, 0.4)","--blue":"rgb(79,193,255)","--green":"rgb(106, 153, 85)","--cyan":"#ce9178","--yellow":"#d7ba7d","--orange":"#d16969","--red":"#d16969","--magenta":"#569cd6","--violet":"#C586C0","--green-soft":"rgba(133, 153, 0, 0.28)"}}};n(338);var wo=e=>{let{state:t,onClick:n}=e;const a=fo(255,255,255,1),i=fo(238,232,213,1),r={colorFactor:Object(co.spring)({checked:1,partial:1,unchecked:0}[t],{stiffness:300})};return l.a.createElement(co.Motion,{style:r},(e=>{const r=bo(go(a,i,e.colorFactor));return l.a.createElement("div",{className:"checkbox",onClick:n,style:{backgroundColor:r}},l.a.createElement("div",{className:"checkbox__inner-container"},"checked"===t&&l.a.createElement("i",{className:"fas fa-check"}),"partial"===t&&l.a.createElement("i",{className:"fas fa-minus"}),"unchecked"===t&&l.a.createElement("i",{className:"fas fa-square"})))}))},ko=(n(339),e=>{let{subPartDataAndHandlers:{onEnterListTitleEditMode:t,onEnterListContentsEditMode:n,onAddNewListItem:a,onRemoveListItem:i}}=e;return l.a.createElement("div",{className:"list-action-drawer-container"},l.a.createElement("div",{className:"list-action-drawer__row"},l.a.createElement("div",{className:"list-action-drawer__edit-icon-container",onClick:t},l.a.createElement("i",{className:"fas fa-pencil-alt fa-lg",title:"Edit list item title"})),l.a.createElement("span",{className:"list-action-drawer__separator"}),l.a.createElement("div",{className:"list-action-drawer__edit-icon-container",onClick:n,title:"Edit list item contents"},l.a.createElement("i",{className:"fas fa-edit fa-lg"})),l.a.createElement("span",{className:"list-action-drawer__separator"}),l.a.createElement("div",{className:"list-action-drawer__edit-icon-container",onClick:a},l.a.createElement("i",{className:"fas fa-plus fa-lg","data-testid":"list-item-action-plus",title:"Create list item below"})),l.a.createElement("span",{className:"list-action-drawer__separator"}),l.a.createElement("div",{className:"list-action-drawer__edit-icon-container",onClick:i},l.a.createElement("i",{className:"fas fa-times fa-lg",title:"Delete list item"}))))});class vo extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleListItemSelect","handleCheckboxClick","handleTextareaBlur","handleListTitleChange","handleListContentsChange","handleInsertTimestampListTitle","handleInsertTimestampListContents","handleTextareaRef"]),this.state={listTitleValues:this.generateListTitleValueMap(e.part),listContentsValues:this.generateListContentsValueMap(e.part),shouldIgnoreBlur:!1}}componentDidUpdate(e){const{subPartDataAndHandlers:{onListTitleValueUpdate:t,onListContentsValueUpdate:n,inListTitleEditMode:a,inListContentsEditMode:i,selectedListItemId:r}}=this.props,{listTitleValues:s,listContentsValues:o}=this.state;e.subPartDataAndHandlers.inListTitleEditMode&&!a&&s.has(r)&&t(r,s.get(r));const l=e.subPartDataAndHandlers.selectedListItemId;l!==r&&a&&e.subPartDataAndHandlers.inListTitleEditMode&&s.has(l)&&Se(this.props.part,l)&&t(l,s.get(l)),e.subPartDataAndHandlers.inListContentsEditMode&&!i&&o.has(r)&&n(r,o.get(r)),l!==r&&i&&e.subPartDataAndHandlers.inListContentsEditMode&&o.has(l)&&Se(this.props.part,l)&&n(l,o.get(l)),this.props.part!==e.part&&(this.setState({listTitleValues:this.generateListTitleValueMap(this.props.part)}),this.setState({listContentsValues:this.generateListContentsValueMap(this.props.part)}))}generateListTitleValueMap(e){return Object(y.Map)(e.get("items").map((e=>[e.get("id"),q(e.get("titleLine"))])))}generateListContentsValueMap(e){return Object(y.Map)(e.get("items").map((e=>[e.get("id"),q(e.get("contents"))])))}handleListItemSelect(e){return()=>this.props.subPartDataAndHandlers.onListItemSelect(e)}handleCheckboxClick(e,t){return e.stopPropagation(),this.props.subPartDataAndHandlers.onCheckboxClick(t)}handleTextareaBlur(){setTimeout((()=>{this.state.shouldIgnoreBlur?this.setState({shouldIgnoreBlur:!1}):this.props.subPartDataAndHandlers.onExitListTitleEditMode()}),0)}handleListTitleChange(e){const{listTitleValues:t}=this.state,{subPartDataAndHandlers:{selectedListItemId:n}}=this.props;this.setState({listTitleValues:t.set(n,e.target.value)})}handleListContentsChange(e){const{listContentsValues:t}=this.state,{subPartDataAndHandlers:{selectedListItemId:n}}=this.props;this.setState({listContentsValues:t.set(n,e.target.value)})}handleInsertTimestampListTitle(){this.setState({shouldIgnoreBlur:!0});const{listTitleValues:e}=this.state,{subPartDataAndHandlers:{selectedListItemId:t}}=this.props,n=e.get(t),a=this.textarea.selectionStart;this.setState({listTitleValues:e.set(t,n.substring(0,a)+V()+n.substring(this.textarea.selectionEnd||a))}),this.textarea.focus()}handleInsertTimestampListContents(){this.setState({shouldIgnoreBlur:!0});const{listContentsValues:e}=this.state,{subPartDataAndHandlers:{selectedListItemId:t}}=this.props,n=e.get(t),a=this.textarea.selectionStart;this.setState({listContentsValues:e.set(t,n.substring(0,a)+V()+n.substring(this.textarea.selectionEnd||a))}),this.textarea.focus()}handleTextareaRef(e){this.textarea=e}renderContent(){const{part:e,subPartDataAndHandlers:{selectedListItemId:t,inListTitleEditMode:n,inListContentsEditMode:a,shouldDisableActions:i}}=this.props,{listTitleValues:r,listContentsValues:s}=this.state;return e.get("items").map((e=>{const o=e.get("id")===t,c=to()({"list-part__not_checkbox-container":!e.get("isCheckbox"),"list-part__checkbox-container":e.get("isCheckbox"),"list-part__item--selected":o});return l.a.createElement("li",{key:e.get("id"),value:e.get("forceNumber")},l.a.createElement("div",{className:c,onClick:this.handleListItemSelect(e.get("id"))},e.get("isCheckbox")&&l.a.createElement(wo,{onClick:t=>this.handleCheckboxClick(t,e.get("id")),state:e.get("checkboxState")}),o&&n?l.a.createElement("div",{className:"list-title-line__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea","data-testid":"list-item-edit",rows:"3",ref:this.handleTextareaRef,value:r.get(e.get("id")),onBlur:this.handleTextareaBlur,onChange:this.handleListTitleChange}),l.a.createElement("div",{className:"list-title-line__insert-timestamp-button",onClick:this.handleInsertTimestampListTitle},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):r.get(e.get("id"))?l.a.createElement(So,{parts:e.get("titleLine"),subPartDataAndHandlers:this.props.subPartDataAndHandlers}):l.a.createElement("span",null,"\xa0")),l.a.createElement(po.UnmountClosed,{isOpened:o&&!i},l.a.createElement(ko,{subPartDataAndHandlers:this.props.subPartDataAndHandlers})),o&&a?l.a.createElement("div",{className:"list-contents__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"8",ref:this.handleTextareaRef,value:s.get(e.get("id")),onBlur:this.handleTextareaBlur,onChange:this.handleListContentsChange}),l.a.createElement("div",{className:"list-contents__insert-timestamp-button",onClick:this.handleInsertTimestampListContents},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):l.a.createElement(So,{parts:e.get("contents"),subPartDataAndHandlers:this.props.subPartDataAndHandlers}))}))}render(){return l.a.createElement(o.Fragment,null,this.props.part.get("isOrdered")?l.a.createElement("ol",{className:"attributed-string__list-part attributed-string__list-part--ordered"},this.renderContent()):l.a.createElement("ul",{className:"attributed-string__list-part"},this.renderContent()))}}n(340);var To=e=>{let{part:t,subPartDataAndHandlers:{onTimestampClick:n,shouldDisableActions:a}}=e;const i=t.get("firstTimestamp"),r=t.get("secondTimestamp");return l.a.createElement("span",{className:"attributed-string__timestamp-part",onClick:()=>a?void 0:n(t.get("id"))},!!i&&j(i),!!r&&l.a.createElement(o.Fragment,null,"--",j(r)))};var So=Object(h.b)(null,(e=>({org:Object(u.b)(r,e)})))((e=>{let t,{org:n,parts:a,subPartDataAndHandlers:i}=e,r=Object($s.h)();const s=e=>{let t=r.pathname.match(/(.*)\//)[1],n=e;for(;n.startsWith("../");){if(!t.match(/^\/file\/.+/))return e;n=n.substr(3),t=t.match(/(.*)\//)[1]}return t+"/"+n};return l.a.createElement("span",null,a.map((e=>{switch(e.get("type")){case"text":return e.get("contents");case"link":return(e=>{const t=e.get("id"),a=e.getIn(["contents","uri"]),i=e.getIn(["contents","title"])||a;let r=a;if(a.startsWith("file:"))return r=a.substr(5),r.startsWith("/")||r.startsWith("~")||(r=s(r),r.includes("/../")||a.match(ze))?(r=r.replace(/^\/file\//,"/"),l.a.createElement("span",{key:t,style:{textDecoration:"underline"},"data-target":r,onClick:()=>n.setPath(r)},i)):(r=r.replace(/^\/file\//,"/files/"),l.a.createElement(_s.b,{key:t,to:r},i));return l.a.createElement(no,{key:t,href:r},i)})(e);case"percentage-cookie":return t=to()("attributed-string__cookie-part",{"attributed-string__cookie-part--complete":100===parseInt(e.get("percentage"),10)}),l.a.createElement("span",{key:e.get("id"),className:t},"[",e.get("percentage"),"%]");case"fraction-cookie":return t=to()("attributed-string__cookie-part",{"attributed-string__cookie-part--complete":""!==e.getIn(["fraction",0])&&e.getIn(["fraction",0])===e.getIn(["fraction",1])}),l.a.createElement("span",{key:e.get("id"),className:t},"[",e.getIn(["fraction",0]),"/",e.getIn(["fraction",1]),"]");case"table":return l.a.createElement(mo,{key:e.get("id"),table:e,subPartDataAndHandlers:i});case"list":return l.a.createElement(vo,{key:e.get("id"),part:e,subPartDataAndHandlers:i});case"inline-markup":return t=to()("attributed-string__inline-markup",`attributed-string__inline-markup--${e.get("markupType")}`),l.a.createElement("span",{key:e.get("id"),className:t},e.get("content"));case"timestamp":return l.a.createElement(To,{key:e.get("id"),part:e,subPartDataAndHandlers:i});case"url":return l.a.createElement(no,{href:e.get("content"),key:e.get("id")},e.get("content"));case"www-url":return l.a.createElement(no,{href:`https://${e.get("content")}`,key:e.get("id")},e.get("content"));case"e-mail":return l.a.createElement("a",{href:`mailto:${e.get("content")}`,key:e.get("id")},e.get("content"));case"phone-number":return l.a.createElement("a",{href:`tel:${e.get("content")}`,key:e.get("id")},e.get("content"));default:return console.error(`Unrecognized attributed string part type! ${e.get("type")}`),""}})))}));class _o extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleTitleClick","handleTodoClick","handleTimestampClick"]),this.state={titleValue:this.calculateRawTitle(e.header),containerWidth:null,shouldIgnoreBlur:!1}}storeContainerWidth(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}componentDidMount(){this.storeContainerWidth()}componentDidUpdate(e){const{header:t}=this.props;e.header!==t&&this.setState({titleValue:this.calculateRawTitle(t)},(()=>this.storeContainerWidth()))}calculateRawTitle(e){return X(e.toJS(),!1)}handleTitleClick(){const{header:e,hasContent:t,isSelected:n,onClick:a,closeSubheadersRecursively:i}=this.props;a?a():(!t||e.get("opened")&&!n||this.props.org.toggleHeaderOpened(e.get("id"),i),this.props.org.selectHeader(e.get("id")))}handleTodoClick(e){const{header:t,shouldTapTodoToAdvance:n,setShouldLogIntoDrawer:a,onClick:i}=this.props;i?(i(),e.stopPropagation()):(this.props.org.selectHeader(t.get("id")),n&&this.props.org.advanceTodoState(null,a))}handleTitleFieldClick(e){e.stopPropagation()}handleTimestampClick(e){this.props.base.activatePopup("timestamp-editor",{headerId:this.props.header.get("id"),timestampId:e})}render(){const{header:e,color:t,hasContent:n,shouldDisableActions:a,shouldDisableExplicitWidth:i,todoKeywordSets:r,addition:s}=this.props,{containerWidth:o}=this.state,c=Ve(r),d=e.getIn(["titleLine","todoKeyword"]),h={color:t,wordBreak:"break-word"},u={color:t,minWidth:"5em",textAlign:"right",marginRight:"2em",whiteSpace:"nowrap"};return l.a.createElement("div",{className:"title-line",onClick:this.handleTitleClick,style:{width:i?"":o}},d?l.a.createElement("span",{className:to()("todo-keyword",c(d)?"todo-keyword--done-state":null),onClick:this.handleTodoClick},d):"",l.a.createElement("div",{style:{width:"100%"}},l.a.createElement("div",{className:"title-line-text"},l.a.createElement("span",{style:h},l.a.createElement(So,{parts:e.getIn(["titleLine","title"]),subPartDataAndHandlers:{onTimestampClick:this.handleTimestampClick,shouldDisableActions:a}}),!e.get("opened")&&n?"...":""),s?l.a.createElement("span",{style:u},s):null),e.getIn(["titleLine","tags"]).size>0&&l.a.createElement("div",null,e.getIn(["titleLine","tags"]).toSet().toList().filter((e=>!!e)).map((e=>l.a.createElement("div",{className:"header-tag",key:e},e))))))}}var Io=Object(h.b)(((e,t)=>{const n=e.org.present.get("path"),a=e.org.present.getIn(["files",n]);return{setShouldLogIntoDrawer:e.base.get("shouldLogIntoDrawer"),shouldTapTodoToAdvance:e.base.get("shouldTapTodoToAdvance"),closeSubheadersRecursively:e.base.get("closeSubheadersRecursively"),isSelected:a.get("selectedHeaderId")===t.header.get("id"),todoKeywordSets:a.get("todoKeywordSets")}}),(e=>({org:Object(u.b)(r,e),base:Object(u.b)(a,e)})))(_o);n(341),n(342);class Co extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleTimestampClick"])}handleTimestampClick(e,t){return()=>this.props.onClick(e,t)}render(){const{planningItems:e}=this.props,t=e.filter((e=>Ue(e)));return t.isEmpty()?null:l.a.createElement("div",null,t.map(((e,t)=>l.a.createElement("div",{key:e.get("id"),className:"planning-items__item-container"},l.a.createElement("div",{className:"planning-item__type"},e.get("type"),": "),l.a.createElement("div",{className:"planning-item__timestamp",onClick:this.handleTimestampClick(e.get("type"),t)},j(e.get("timestamp")))))))}}n(343);var Do=e=>{let{propertyListItems:t,shouldDisableActions:n,onTimestampClick:a,onEdit:i}=e;const[r,s]=Object(o.useState)(!0);return 0===t.size?null:l.a.createElement("div",{className:"property-list-container"},l.a.createElement("div",{className:"property-list__property",onClick:()=>s(!r)},":PROPERTIES:",r?"...":""),!r&&l.a.createElement(o.Fragment,null,t.map((e=>l.a.createElement("div",{className:"property-list__item-container",key:e.get("id")},l.a.createElement("div",{className:"property-list__property",onClick:n?null:i},":",e.get("property"),":"),l.a.createElement("div",{className:"property-list__value"},l.a.createElement(So,{parts:e.get("value")||[],subPartDataAndHandlers:{onTimestampClick:a,shouldDisableActions:n}}))))),l.a.createElement("div",{className:"property-list__property",onClick:i},":END:")))},Ao=(n(344),e=>{let{logBookEntries:t,onTimestampClick:n,shouldDisableActions:a}=e;const[i,r]=Object(o.useState)(!0),s=(e,t)=>()=>a?void 0:n(e,t);return 0===t.size?null:l.a.createElement("div",{className:"logbook-entries-container"},l.a.createElement("div",{className:"logbook-entries__logbook",onClick:()=>r(!i)},":LOGBOOK:",i?"...":""),!i&&l.a.createElement(o.Fragment,null,t.map(((e,t)=>void 0!==e.get("raw")?l.a.createElement("div",{className:"logbook-entries__item-container",key:e.get("id")},e.get("raw")||" "):l.a.createElement("div",{className:"logbook-entries__item-container",key:e.get("id")},l.a.createElement("span",{className:"logbook-entries__item-clock"},"CLOCK:"),l.a.createElement("span",{className:"logbook-entries__item-start",onClick:s(t,"start")},j(e.get("start"))),null===e.get("end")?"":l.a.createElement(o.Fragment,null,"--",l.a.createElement("span",{className:"logbook-entries__item-end",onClick:s(t,"end")},j(e.get("end"))),l.a.createElement("span",{className:"logbook-entries__item-duration"},"=> ",$(e.get("start"),e.get("end"))))))),l.a.createElement("div",{className:"logbook-entries__logbook"},":END:")))});class Oo extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleTableSelect","handleCheckboxClick","handleListItemSelect","handleEnterListTitleEditMode","handleExitListTitleEditMode","handleListTitleValueUpdate","handleEnterListContentsEditMode","handleExitListContentsEditMode","handleListContentsValueUpdate","handleAddNewListItem","handleRemoveListItem","handleTimestampClick","handleLogEntryTimestampClick","handleInsertTimestamp","handlePlanningItemTimestampClick","handlePropertyListEdit"]),this.state={descriptionValue:this.calculateRawDescription(e.header),containerWidth:null,shouldIgnoreBlur:!1}}storeContainerWidth(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}componentDidMount(){this.storeContainerWidth()}componentDidUpdate(e){const{header:t}=this.props;e.header!==t&&this.setState({descriptionValue:this.calculateRawDescription(t)},(()=>this.storeContainerWidth()))}calculateRawDescription(e){const t=this.props.dontIndent;return Q(e,!1,t)}handleTableSelect(e){this.props.org.selectHeader(this.props.header.get("id")),this.props.org.setSelectedTableId(e),this.props.base.activatePopup("table-editor")}handleCheckboxClick(e){this.props.org.advanceCheckboxState(e)}handleListItemSelect(e){this.props.org.setSelectedListItemId(e)}handleEnterListTitleEditMode(){this.props.org.enterEditMode("list-title")}handleExitListTitleEditMode(){this.props.org.exitEditMode()}handleListTitleValueUpdate(e,t){this.props.org.updateListTitleValue(e,t)}handleEnterListContentsEditMode(){this.props.org.enterEditMode("list-contents")}handleExitListContentsEditMode(){this.props.org.exitEditMode()}handleListContentsValueUpdate(e,t){this.props.org.updateListContentsValue(e,t)}handleAddNewListItem(){this.props.org.addNewListItemAndEdit()}handleRemoveListItem(){this.props.org.removeListItem()}handleTimestampClick(e){this.props.base.activatePopup("timestamp-editor",{timestampId:e,headerId:this.props.header.get("id")})}handleLogEntryTimestampClick(e){return(t,n)=>this.props.base.activatePopup("timestamp-editor",{headerId:e,logEntryIndex:t,entryType:n})}handleInsertTimestamp(){this.setState({shouldIgnoreBlur:!0});const{descriptionValue:e}=this.state,t=this.textarea.selectionStart;this.setState({descriptionValue:e.substring(0,t)+V()+e.substring(this.textarea.selectionEnd||t)}),this.textarea.focus()}handlePlanningItemTimestampClick(e){return(t,n)=>{const a={DEADLINE:"deadline-editor",SCHEDULED:"scheduled-editor"}[t]||"timestamp-editor";this.props.base.activatePopup(a,{headerId:e,planningItemIndex:n})}}handlePropertyListEdit(){const{header:e}=this.props;this.props.base.activatePopup("property-list-editor",{headerId:e.get("id")})}render(){const{header:e,shouldDisableActions:t,selectedListItemId:n,inListTitleEditMode:a,inListContentsEditMode:i}=this.props,{containerWidth:r}=this.state;return e.get("opened")?l.a.createElement("div",{className:"header-content-container nice-scroll",style:{width:r}},l.a.createElement(o.Fragment,null,l.a.createElement(Co,{planningItems:e.get("planningItems"),onClick:this.handlePlanningItemTimestampClick(e.get("id"))}),l.a.createElement(Do,{propertyListItems:e.get("propertyListItems"),onTimestampClick:this.handleTimestampClick,shouldDisableActions:t,onEdit:this.handlePropertyListEdit}),l.a.createElement(So,{parts:e.get("logNotes"),subPartDataAndHandlers:{onTimestampClick:this.handleTimestampClick,shouldDisableActions:t}}),l.a.createElement(Ao,{logBookEntries:e.get("logBookEntries"),onTimestampClick:this.handleLogEntryTimestampClick(e.get("id")),shouldDisableActions:t}),l.a.createElement(So,{parts:e.get("description"),subPartDataAndHandlers:{onTableSelect:t?void 0:this.handleTableSelect,onCheckboxClick:this.handleCheckboxClick,onListItemSelect:this.handleListItemSelect,onEnterListTitleEditMode:this.handleEnterListTitleEditMode,onExitListTitleEditMode:this.handleExitListTitleEditMode,onListTitleValueUpdate:this.handleListTitleValueUpdate,onEnterListContentsEditMode:this.handleEnterListContentsEditMode,onExitListContentsEditMode:this.handleExitListContentsEditMode,onListContentsValueUpdate:this.handleListContentsValueUpdate,onAddNewListItem:this.handleAddNewListItem,onRemoveListItem:this.handleRemoveListItem,selectedListItemId:n,inListTitleEditMode:a,inListContentsEditMode:i,onTimestampClick:this.handleTimestampClick,shouldDisableActions:t}}))):l.a.createElement("div",null)}}var No=Object(h.b)(((e,t)=>{const n=e.org.present.get("path"),a=e.org.present.getIn(["files",n]);return{isSelected:a.get("selectedHeaderId")===t.header.get("id"),dontIndent:e.base.get("shouldNotIndentOnExport"),selectedListItemId:a.get("selectedListItemId"),inListTitleEditMode:"list-title"===a.get("editMode"),inListContentsEditMode:"list-contents"===a.get("editMode")}}),(e=>({org:Object(u.b)(r,e),base:Object(u.b)(a,e)})))(Oo);n(345);class Po extends o.PureComponent{iconWithFFClickCatcher(e){let{className:t,onClick:n,title:a,testId:i=""}=e;return l.a.createElement("div",{title:a,onClick:n,className:"header-action-drawer__ff-click-catcher-container"},l.a.createElement("div",{className:"header-action-drawer__ff-click-catcher"}),l.a.createElement("i",{className:t,"data-testid":i}))}render(){const{onTitleClick:e,onDescriptionClick:t,onTagsClick:n,onPropertiesClick:a,isNarrowed:i,onNarrow:r,onWiden:s,onAddNewHeader:o,onDeadlineClick:c,onClockInOutClick:d,onScheduledClick:h,hasActiveClock:u,onShareHeader:p,onRefileHeader:m,onAddNote:g}=this.props;return l.a.createElement("div",{className:"header-action-drawer-container"},l.a.createElement("div",{className:"header-action-drawer__row"},this.iconWithFFClickCatcher({className:"fas fa-pencil-alt fa-lg",onClick:e,title:"Edit header title"}),this.iconWithFFClickCatcher({className:"fas fa-edit fa-lg",onClick:t,title:"Edit header description",testId:"edit-header-title"}),this.iconWithFFClickCatcher({className:"fas fa-tags fa-lg",onClick:n,title:"Modify tags"}),this.iconWithFFClickCatcher({className:"fas fa-list fa-lg",onClick:a,title:"Modify properties"}),i?this.iconWithFFClickCatcher({className:"fas fa-expand fa-lg",onClick:s,title:"Widen (Cancelling the narrowing.)"}):this.iconWithFFClickCatcher({className:"fas fa-compress fa-lg",onClick:r,testId:"header-action-narrow",title:"Narrow to subtree (focusing in on some portion of the buffer, making the rest temporarily inaccessible.)"}),this.iconWithFFClickCatcher({className:"fas fa-plus fa-lg",onClick:o,testId:"header-action-plus",title:"Create new header below"})),l.a.createElement("div",{className:"header-action-drawer__row"},this.iconWithFFClickCatcher({className:"fas fa-envelope fa-lg",onClick:p,testId:"share",title:"Share this header via email"}),this.iconWithFFClickCatcher({className:"fas fa-calendar-check fa-lg",onClick:c,title:"Set deadline datetime"}),this.iconWithFFClickCatcher({className:"far fa-calendar-check fa-lg",onClick:h,title:"Set scheduled datetime"}),u?this.iconWithFFClickCatcher({className:"fas fa-hourglass-end fa-lg",onClick:d,testId:"org-clock-out",title:"Clock out (Stop the clock)"}):this.iconWithFFClickCatcher({className:"fas fa-hourglass-start fa-lg",onClick:d,testId:"org-clock-in",title:"Clock in (Start the clock)"}),this.iconWithFFClickCatcher({className:"fas fa-file-export fa-lg",onClick:m,testId:"org-refile",title:"Refile this header to another header"}),this.iconWithFFClickCatcher({className:"far fa-sticky-note fa-lg",onClick:g,title:"Add a note"})))}}class Lo extends o.PureComponent{constructor(e){super(e),this.SWIPE_ACTION_ACTIVATION_DISTANCE=80,this.FREE_DRAG_ACTIVATION_DISTANCE=10,b.a.bindAll(this,["handleRef","handleMouseDown","handleTouchStart","handleTouchCancel","handleHeaderClick","handleShowTitleModal","handleShowDescriptionModal","handleShowTagsModal","handleShowPropertyListEditorModal","handleNarrow","handleWiden","handleAddNewHeader","handleRest","handleDeadlineClick","handleClockInOutClick","handleScheduledClick","handleShareHeaderClick","handleRefileHeaderRequest","handleAddNoteClick"]),this.state={isDraggingFreely:!1,dragStartX:null,currentDragX:null,containerWidth:null,isPlayingRemoveAnimation:!1,heightBeforeRemove:null,disabledBackgroundColor:yo("--base3"),touchStartY:null,currentTouchY:null},this.globalMouseMoveHandler=this.handleMouseMove.bind(this),this.globalMouseUpHandler=this.handleMouseUp.bind(this),this.globalTouchMoveHandler=this.handleTouchMove.bind(this),this.globalTouchEndHandler=this.handleTouchEnd.bind(this)}addGlobalDragHandlers(){window.addEventListener("mousemove",this.globalMouseMoveHandler),window.addEventListener("mouseup",this.globalMouseUpHandler),window.addEventListener("touchmove",this.globalTouchMoveHandler),window.addEventListener("touchend",this.globalTouchEndHandler)}removeGlobalDragHandlers(){window.removeEventListener("mousemove",this.globalMouseMoveHandler),window.removeEventListener("mouseup",this.globalMouseUpHandler),window.removeEventListener("touchmove",this.globalTouchMoveHandler),window.removeEventListener("touchend",this.globalTouchEndHandler)}componentDidMount(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}componentWillUnmount(){this.removeGlobalDragHandlers()}handleRef(e){this.containerDiv=e,this.props.onRef(e)}handleDragStart(e,t){this.props.shouldDisableActions||e.target.closest(".table-part")||(this.setState({dragStartX:t}),this.addGlobalDragHandlers())}handleDragMove(e){null!==this.state.dragStartX&&(this.state.isDraggingFreely||Math.abs(e-this.state.dragStartX)>=this.FREE_DRAG_ACTIVATION_DISTANCE&&this.setState({isDraggingFreely:!0}),this.setState({currentDragX:e}))}handleDragEnd(){const{dragStartX:e,currentDragX:t}=this.state;if(e&&t){const n=t-e;n>=this.SWIPE_ACTION_ACTIVATION_DISTANCE&&this.props.org.advanceTodoState(this.props.header.get("id"),this.props.shouldLogIntoDrawer),-1*n>=this.SWIPE_ACTION_ACTIVATION_DISTANCE&&this.setState({isPlayingRemoveAnimation:!0,heightBeforeRemove:this.containerDiv.offsetHeight})}this.setState({dragStartX:null,currentDragX:null,isDraggingFreely:!1}),this.removeGlobalDragHandlers()}handleDragCancel(){this.setState({dragStartX:null,currentDragX:null,isDraggingFreely:!1})}handleMouseDown(e){this.handleDragStart(e,e.clientX)}handleMouseMove(e){this.handleDragMove(e.clientX,e.clientY)}handleMouseUp(){this.handleDragEnd()}handleTouchStart(e){const t=e.changedTouches[0];this.setState({touchStartY:t.clientY}),this.handleDragStart(e,t.clientX)}handleTouchMove(e){const t=e.changedTouches[0],n=t.clientY,a=t.clientX;if(this.setState({currentTouchY:n}),null!==this.state.touchStartY&&null!==this.state.dragStartX){const e=Math.abs(n-this.state.touchStartY);if(e>Math.abs(a-this.state.dragStartX)&&e>10)return void this.handleDragCancel()}this.handleDragMove(a,n)}handleTouchEnd(){this.setState({touchStartY:null,currentTouchY:null}),this.handleDragEnd()}handleTouchCancel(){this.setState({touchStartY:null,currentTouchY:null}),this.handleDragCancel()}handleHeaderClick(e){const t=e.target.classList;if(t.contains("header")||t.contains("header__bullet")){const{header:e,hasContent:t,isSelected:n,closeSubheadersRecursively:a}=this.props;!t||e.get("opened")&&!n||this.props.org.toggleHeaderOpened(e.get("id"),a),this.props.org.selectHeader(e.get("id"))}}handleShowTitleModal(){this.props.base.activatePopup("title-editor")}handleShowDescriptionModal(){this.props.base.activatePopup("description-editor")}handleShowTagsModal(){this.props.base.activatePopup("tags-editor")}handleShowPropertyListEditorModal(){this.props.base.activatePopup("property-list-editor")}handleNarrow(){this.props.org.narrowHeader(this.props.header.get("id"))}handleWiden(){this.props.org.widenHeader()}handleAddNewHeader(){this.props.org.addHeaderAndEdit(this.props.header.get("id"))}handleRest(){this.state.isPlayingRemoveAnimation&&this.props.org.removeHeader(this.props.header.get("id"))}handleDeadlineAndScheduledClick(e){const{header:t}=this.props,n={DEADLINE:"deadline-editor",SCHEDULED:"scheduled-editor"}[e],a=t.get("planningItems",[]).findIndex((t=>t.get("type")===e));this.props.base.activatePopup(n,{headerId:t.get("id"),planningItemIndex:a}),this.props.org.openHeader(t.get("id"))}handleDeadlineClick(){this.handleDeadlineAndScheduledClick("DEADLINE")}handleClockInOutClick(){const{header:e}=this.props,t=e.get("logBookEntries",[]),n=t.findIndex((e=>null===e.get("end"))),a=function(){let{isActive:e=!0,withStartTime:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return B(new Date,{isActive:e,withStartTime:t})}({isActive:!1,withStartTime:!0});-1!==n?this.props.org.setLogEntryStop(e.get("id"),t.getIn([n,"id"]),a):this.props.org.createLogEntryStart(e.get("id"),a)}handleScheduledClick(){this.handleDeadlineAndScheduledClick("SCHEDULED")}handleShareHeaderClick(){const{header:e}=this.props,t=e.get("titleLine"),n=t.get("todoKeyword"),a=t.get("tags"),i=t.get("rawTitle").trim(),r=n?`${n} ${i}`:i,s=`\n${a.isEmpty()?"":`Tags: ${a.join(" ")}\n`}\n${e.get("rawDescription")}`,o=`mailto:?subject=${encodeURIComponent(r)}&body=${encodeURIComponent(s)}`;window.open(o)}handleAddNoteClick(){this.props.base.activatePopup("note-editor")}handlePopupClose(){this.props.base.closePopup()}handleRefileHeaderRequest(){this.props.base.activatePopup("refile")}render(){const{header:e,color:t,hasContent:n,isSelected:a,bulletStyle:i,narrowedHeader:r,isNarrowed:s,shouldDisableActions:o,showClockDisplay:c,showDeadlineDisplay:d}=this.props,h=r?e.get("nestingLevel")-r.get("nestingLevel")+1:e.get("nestingLevel"),u=e.get("planningItems").filter((e=>"DEADLINE"===e.get("type"))).map((e=>e.get("timestamp"))).get(0),p=void 0!==u?u.get("month")+"-"+u.get("day")+"-"+u.get("year"):"",{dragStartX:m,currentDragX:g,isDraggingFreely:f,isPlayingRemoveAnimation:b,containerWidth:y}=this.state,E={paddingLeft:20*h,marginLeft:m&&g&&f?g-m:b?Object(co.spring)(-1*y,{stiffness:300}):Object(co.spring)(0,{stiffness:300}),heightFactor:b?Object(co.spring)(0,{stiffness:300}):1},w=to()("header",{"header--selected":a,"header--removing":b}),k=e.get("logBookEntries").filter((e=>void 0===e.get("raw"))),v=0!==k.size&&0!==k.filter((e=>!e.get("end"))).size;return l.a.createElement(co.Motion,{style:E,onRest:this.handleRest},(r=>{const h=r.marginLeft,u=h>=this.SWIPE_ACTION_ACTIVATION_DISTANCE,m=-1*h>=this.SWIPE_ACTION_ACTIVATION_DISTANCE,g=fo(0,128,0,1),f=fo(255,0,0,1),y=fo(0,0,0,1),E=fo(255,255,255,1),k={width:r.marginLeft,backgroundColorFactor:Object(co.spring)(u?1:0,{stiffness:300})},T={width:-1*r.marginLeft,backgroundColorFactor:Object(co.spring)(m?1:0,{stiffness:300})},{heightFactor:S,..._}=r;return b&&(_.height=this.state.heightBeforeRemove*S),l.a.createElement("div",{className:w,style:_,ref:this.handleRef,onClick:this.handleHeaderClick,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onTouchCancel:this.handleTouchCancel},l.a.createElement(co.Motion,{style:k},(e=>{const t={width:e.width,backgroundColor:bo(go(this.state.disabledBackgroundColor,g,e.backgroundColorFactor))},n={display:h>30?"":"none",color:bo(go(y,E,e.backgroundColorFactor))};return l.a.createElement("div",{className:"left-swipe-action-container",style:t},l.a.createElement("i",{className:"fas fa-check swipe-action-container__icon swipe-action-container__icon--left",style:n}))})),l.a.createElement(co.Motion,{style:T},(e=>{const t={width:e.width,backgroundColor:bo(go(this.state.disabledBackgroundColor,f,e.backgroundColorFactor))},n={display:-1*h>30?"":"none",color:bo(go(y,E,e.backgroundColorFactor))};return l.a.createElement("div",{className:"right-swipe-action-container",style:t},l.a.createElement("i",{className:"fas fa-times swipe-action-container__icon swipe-action-container__icon--right",style:n}))})),l.a.createElement("div",{style:{marginLeft:-16,color:t},className:"header__bullet"},"Fancy"===i?"\u25cf":"*"),l.a.createElement(Io,{header:e,color:t,hasContent:n,isSelected:a,shouldDisableExplicitWidth:0===h,shouldDisableActions:o,addition:(c&&0!==e.get("totalTimeLoggedRecursive")?Y(e.get("totalTimeLoggedRecursive")):"")+(c&&d?" ":"")+(d&&void 0!==p?p:"")}),l.a.createElement(po.UnmountClosed,{isOpened:a&&!o,springConfig:{stiffness:300},style:{marginRight:T.width}},l.a.createElement(Po,{onTitleClick:this.handleShowTitleModal,onDescriptionClick:this.handleShowDescriptionModal,isNarrowed:s,onTagsClick:this.handleShowTagsModal,onPropertiesClick:this.handleShowPropertyListEditorModal,onNarrow:this.handleNarrow,onWiden:this.handleWiden,onAddNewHeader:this.handleAddNewHeader,onDeadlineClick:this.handleDeadlineClick,onClockInOutClick:this.handleClockInOutClick,onScheduledClick:this.handleScheduledClick,hasActiveClock:v,onShareHeader:this.handleShareHeaderClick,onRefileHeader:this.handleRefileHeaderRequest,onAddNote:this.handleAddNoteClick})),l.a.createElement(No,{header:e,shouldDisableActions:o}))}))}}var Ro=Object(h.b)(((e,t)=>{const n=e.org.present.get("path"),a=e.org.present.getIn(["files",n],Object(y.Map)()),i=a.get("narrowedHeaderId")?re(a.get("headers"),a.get("narrowedHeaderId")):null;return{bulletStyle:e.base.get("bulletStyle"),shouldLogIntoDrawer:e.base.get("shouldLogIntoDrawer"),closeSubheadersRecursively:e.base.get("closeSubheadersRecursively"),narrowedHeader:i,isNarrowed:!!i&&i.get("id")===t.header.get("id"),showClockDisplay:e.org.present.get("showClockDisplay"),showDeadlineDisplay:e.base.get("showDeadlineDisplay")}}),(e=>({org:Object(u.b)(r,e),base:Object(u.b)(a,e)})))(Lo);class xo extends o.PureComponent{constructor(e){super(e),this.headerRefs={},b.a.bindAll(this,["handleHeaderRef"])}componentDidUpdate(e){if(e.selectedHeaderId!==this.props.selectedHeaderId){const e=this.headerRefs[this.props.selectedHeaderId];if(e){const t=e.getBoundingClientRect(),n=document.documentElement.clientHeight;(t.top>.9*n||t.bottom<0)&&e.scrollIntoView()}}}handleHeaderRef(e){return t=>this.headerRefs[e]=t}render(){const{headers:e,selectedHeaderId:t,narrowedHeaderId:n,shouldDisableActions:a}=this.props,i=e.map((e=>({header:e,displayed:!1,hasContent:Be(e)}))).toArray();if(i.forEach(((e,t)=>{const n=e.header.get("nestingLevel");i.slice(0,t).every((e=>e.header.get("nestingLevel")>=n))&&(e.displayed=!0);const a=i.slice(t+1);for(let i=0;i<a.length;++i){const t=a[i];if(t.header.get("nestingLevel")<=n)break;e.hasContent=!0,t.displayed=e.header.get("opened")&&e.displayed}})),n){const t=i.findIndex((e=>e.header.get("id")===n));i.slice(0,t).forEach((e=>e.displayed=!1));const a=de(e,n);i.slice(t+a+1).forEach((e=>e.displayed=!1))}const r=["var(--blue)","var(--green)","var(--cyan)","var(--yellow)","var(--blue)","var(--green)","var(--cyan)","var(--yellow)"],s=i.filter((e=>e.displayed)),o=to()("header-list-container",{"header-list-container--narrowed":!!n});return l.a.createElement("div",{className:o},s.map((e=>{const n=e.header,i=r[(n.get("nestingLevel")-1)%r.length];return l.a.createElement(Ro,{key:n.get("id"),header:n,color:i,hasContent:e.hasContent,isSelected:n.get("id")===t,onRef:this.handleHeaderRef(n.get("id")),shouldDisableActions:a})})),l.a.createElement("div",{style:{height:"90px"}}))}}var Mo=Object(h.b)((e=>{const t=e.org.present.get("path"),n=e.org.present.getIn(["files",t],Object(y.Map)());return{headers:n.get("headers",Object(y.List)()),selectedHeaderId:n.get("selectedHeaderId"),narrowedHeaderId:n.get("narrowedHeaderId")}}))(xo);var Fo=Object(h.b)((e=>{const t=e.org.present.get("path"),n=e.org.present.get("files"),a=e.org.present.getIn(["files",t],Object(y.Map)()),i=e.org.present.get("fileSettings"),r=yi(n,i,t,"includeInSearch",!1),s=Object.values(r.map((e=>e.get("headers").size?e.get("activeClocks"):0)).toJS()).reduce(((e,t)=>"number"===typeof t?e+t:e),0);return{selectedHeaderId:a.get("selectedHeaderId"),isDirty:a.get("isDirty"),isNarrowedHeaderActive:!!a.get("narrowedHeaderId"),selectedTableCellId:a.get("selectedTableCellId"),selectedListItemId:a.get("selectedListItemId"),captureTemplates:e.capture.get("captureTemplates",Object(y.List)()),path:t,isLoading:!e.base.get("isLoading").isEmpty(),online:e.base.get("online"),activeClocks:s}}),(e=>({org:Object(u.b)(r,e),capture:Object(u.b)(i,e),base:Object(u.b)(a,e)})))((e=>{let{org:t,selectedHeaderId:n,base:a,staticFile:i,captureTemplates:r,path:s,selectedTableCellId:c,selectedListItemId:d,isLoading:h,online:u,shouldDisableSyncButtons:p,activeClocks:m}=e;const[g,f]=Object(o.useState)(!1),[b,y]=Object(o.useState)(!1),E=Object(o.useRef)(null),w=Object(o.useMemo)((()=>E.current?E.current.getBoundingClientRect():null),[E]),k=()=>n?t.moveHeaderUp(n):c?t.moveTableRowUp():t.moveListItemUp(),v=()=>n?t.moveHeaderDown(n):c?t.moveTableRowDown():t.moveListItemDown(),T=()=>n?t.moveHeaderLeft(n):c?t.moveTableColumnLeft():t.moveListItemLeft(),S=()=>n?t.moveHeaderRight(n):c?t.moveTableColumnRight():t.moveListItemRight(),_=()=>n?t.moveSubtreeLeft(n):t.moveListSubtreeLeft(),I=()=>n?t.moveSubtreeRight(n):t.moveListSubtreeRight(),C=()=>"sample"===i?Ot:r.filter((e=>e.get("isAvailableInAllOrgFiles")||e.get("orgFilesWhereAvailable").map((e=>e.trim().startsWith("/")?e.trim():"/"+e.trim())).includes((s||"").trim()))),D=()=>f(!g),A=()=>{b||0!==C().size?y(!b):alert("You don't have any capture templates set up for this file! Add some in Settings > Capture Templates")};return l.a.createElement("div",{className:"action-drawer-container nice-scroll"},l.a.createElement(o.Fragment,null,l.a.createElement(so,{iconName:"cloud",subIconName:"sync-alt",shouldSpinSubIcon:h,isDisabled:p||!u,onClick:()=>t.sync({forceAction:"manual"}),style:{opacity:g||b?0:1},tooltip:"Sync changes"}),l.a.createElement(so,{iconName:"calendar-alt",isDisabled:!1,onClick:()=>a.activatePopup("agenda"),style:{opacity:g||b?0:1},tooltip:"Show agenda"}),(()=>{const e={opacity:b?0:1};g||(e.boxShadow="none");let t=0;w&&(t=window.screen.width/2-(w.x+w.width/2));const n={centerXOffset:Object(co.spring)(g?t:0,{stiffness:300}),topRowYOffset:Object(co.spring)(g?150:0,{stiffness:300}),bottomRowYOffset:Object(co.spring)(g?80:0,{stiffness:300}),firstColumnXOffset:Object(co.spring)(g?70:0,{stiffness:300}),secondColumnXOffset:Object(co.spring)(g?140:0,{stiffness:300})};let a=null,i="Move header up",r="Move header down",s="Move header left",h="Move header right";return c?(a="table",i="Move row up",r="Move row down",s="Move column left",h="Move column right"):d&&(a="list",i="Move list up",r="Move list down",s="Move list left",h="Move list right"),l.a.createElement(co.Motion,{style:n},(t=>l.a.createElement("div",{className:"action-drawer__arrow-buttons-container",style:{left:t.centerXOffset}},l.a.createElement(so,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-up",subIconName:a,isDisabled:!1,onClick:k,style:{...e,bottom:t.topRowYOffset},tooltip:i}),l.a.createElement(so,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-down",subIconName:a,isDisabled:!1,onClick:v,style:{...e,bottom:t.bottomRowYOffset},tooltip:r}),l.a.createElement(so,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-left",subIconName:a,isDisabled:!1,onClick:T,style:{...e,bottom:t.bottomRowYOffset,right:t.firstColumnXOffset},tooltip:s}),l.a.createElement(so,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-right",subIconName:a,isDisabled:!1,onClick:S,style:{...e,bottom:t.bottomRowYOffset,left:t.firstColumnXOffset},tooltip:h}),!c&&l.a.createElement(o.Fragment,null,l.a.createElement(so,{additionalClassName:"action-drawer__arrow-button",iconName:"chevron-left",subIconName:a,isDisabled:!1,onClick:_,style:{...e,bottom:t.bottomRowYOffset,right:t.secondColumnXOffset},tooltip:"Move entire subtree left"}),l.a.createElement(so,{additionalClassName:"action-drawer__arrow-button",iconName:"chevron-right",subIconName:a,isDisabled:!1,onClick:I,style:{...e,bottom:t.bottomRowYOffset,left:t.secondColumnXOffset},tooltip:"Move entire subtree right"})),l.a.createElement(so,{iconName:g?"times":"arrows-alt",subIconName:a,additionalClassName:"action-drawer__main-arrow-button",isDisabled:!1,onClick:D,style:{opacity:b?0:1},tooltip:g?"Hide movement buttons":"Show movement buttons",onRef:E}))))})(),l.a.createElement(so,{iconName:"search",isDisabled:!1,onClick:()=>{a.activatePopup("search")},additionalClassName:0!==m?"active-clock-indicator":void 0,style:{opacity:g||b?0:1,position:"relative",zIndex:1},tooltip:"Show Search / Task List"}),(()=>{const e=C(),t={position:"absolute",zIndex:0,left:0,opacity:g?0:1};b||(t.boxShadow="none");const n={opacity:g?0:1,position:"relative",zIndex:1},i={bottom:Object(co.spring)(b?70:0,{stiffness:300})};return l.a.createElement(co.Motion,{style:i},(i=>l.a.createElement("div",{className:"action-drawer__capture-buttons-container"},l.a.createElement(so,{iconName:b?"times":"plus",isDisabled:!1,onClick:A,style:n,tooltip:b?"Hide capture templates":"Show capture templates"}),e.map(((e,n)=>{return l.a.createElement(so,{key:e.get("id"),letter:e.get("letter"),iconName:e.get("iconName"),isDisabled:!1,onClick:(r=e.get("id"),()=>{y(!1),a.activatePopup("capture",{templateId:r})}),style:{...t,bottom:i.bottom*(n+1)},tooltip:`Activate "${e.get("description")}" capture template`});var r})))))})()))})),Ho=n(168);const jo=n.n(Ho).a.getParser(window.navigator.userAgent),Bo=jo.satisfies({mobile:{safari:">=13"}})&&jo.satisfies({mobile:{safari:"<13.0.4"}}),Vo="desktop"!==jo.getPlatformType(),Uo=()=>"iOS"===jo.getOS().name,Wo=!!window.matchMedia&&window.matchMedia("(max-device-width: 812px) and (-webkit-device-pixel-ratio : 3)").matches,zo=!!window.matchMedia&&window.matchMedia("(min-device-width: 375px) and (-webkit-device-pixel-ratio : 2)").matches,Go="standalone"in window.navigator&&window.navigator.standalone;function $o(){return[90,-90].includes(window.orientation)}n(346),n(347);var Ko=e=>{let{isEnabled:t,onToggle:n}=e;const a=fo(255,255,255,1),i=fo(238,232,213,1),r={colorFactor:Object(co.spring)(t?1:0,{stiffness:300})},s={marginLeft:Object(co.spring)(t?42:0,{stiffness:300})};return l.a.createElement(co.Motion,{style:r},(e=>{const t=bo(go(a,i,e.colorFactor));return l.a.createElement("div",{className:"switch",style:{backgroundColor:t},onClick:n},l.a.createElement(co.Motion,{style:s},(e=>l.a.createElement("div",{className:"switch__grabber",style:e}))))}))},Yo=e=>{let{template:t,onCapture:n,headers:a}=e;const[i,r]=Object(o.useMemo)((()=>ee(t.get("template"))),[t]),s=Object(o.useMemo)((()=>0===t.get("headerPaths").size?"FILE":ye(a,t.get("headerPaths"))),[a,t]),[c,d]=Object(o.useState)(i),[h,u]=Object(o.useState)(t.get("shouldPrepend")),p=Object(o.useRef)(null);Object(o.useEffect)((()=>{p.current&&(p.current.focus(),p.current.setSelectionRange(r,r))}),[p,r]);return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"capture-modal-header"},l.a.createElement(so,{letter:t.get("letter"),iconName:t.get("iconName"),isDisabled:!1,onClick:()=>{},style:{marginRight:20}}),l.a.createElement("span",null,t.get("description"))),l.a.createElement("div",{className:"capture-modal-header-path"},t.get("headerPaths").map((e=>ee(e)[0])).join(" > ")),s?l.a.createElement(o.Fragment,null,l.a.createElement("textarea",{className:"textarea capture-modal-textarea",rows:"4",value:c,onChange:e=>d(e.target.value),autoFocus:!0,ref:p}),l.a.createElement("div",{className:"capture-modal-button-container"},l.a.createElement("div",{className:"capture-modal-prepend-container"},l.a.createElement("span",{className:"capture-modal-prepend-label"},"Prepend:"),l.a.createElement(Ko,{isEnabled:h,onToggle:()=>u(!h)})),l.a.createElement("button",{className:"btn capture-modal-button",onClick:()=>n(t.get("id"),c,h)},"Capture")),Bo&&l.a.createElement("div",{style:{minHeight:Bo?Go?$o()?"9em":Wo?"23em":zo?"19em":"auto":$o()?"9em":Wo||zo?"18em":"auto":"auto"}})):l.a.createElement("div",{className:"capture-modal-error-message"},"The specified header path doesn't exist in this org file!"),l.a.createElement("br",null))},Jo=(n(348),e=>{let{lastServerModifiedAt:t,lastSyncAt:n,path:a,onPull:i,onPush:r,onCancel:s}=e;return l.a.createElement(l.a.Fragment,null,l.a.createElement("h2",{className:"sync-confirmation-modal__header"},"Sync conflict"),"Since you last pulled ",a,", a newer version of the file has been pushed to the server. The newer version is from:",l.a.createElement("br",null),"\xa0",l.a.createElement("br",null),l.a.createElement("div",{className:"sync-confirmation-modal__last-sync-time"},Object(k.a)(t,"MMMM do, yyyy [at] h:mm:ss a"),l.a.createElement("br",null),"(",Re(t),")"),l.a.createElement("br",null),"\xa0",l.a.createElement("br",null),"While your version is from:",l.a.createElement("br",null),"\xa0",l.a.createElement("br",null),l.a.createElement("div",{className:"sync-confirmation-modal__last-sync-time"},Object(k.a)(n,"MMMM do, yyyy [at] h:mm:ss a"),l.a.createElement("br",null),"(",Re(n),")"),l.a.createElement("div",{className:"sync-confirmation-modal__buttons-container"},l.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:i},"Pull latest version from server"),l.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:r},"Overwrite server version"),l.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:s},"Cancel sync")),l.a.createElement("br",null))});n(349);class qo extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleRemoveTag","handleAddNewTag","handleTagChange"]),this.state={allTags:e.allTags}}componentDidUpdate(e){const t=e.header.getIn(["titleLine","tags"]),n=this.props.header.getIn(["titleLine","tags"]);t.size===n.size-1&&""===n.last()&&this.lastTextfield&&this.lastTextfield.focus()}handleTagChange(e){return t=>{const n=this.props.header.getIn(["titleLine","tags"]);this.props.onChange(n.set(e,t.target.value.replace(/(\s+|:)/g,"")))}}handleRemoveTag(e){return()=>{const t=this.props.header.getIn(["titleLine","tags"]);this.props.onChange(t.delete(e))}}handleAddNewTag(){const e=this.props.header.getIn(["titleLine","tags"]);this.props.onChange(e.push(""))}handleExistingTagClick(e){return()=>{const t=this.props.header.getIn(["titleLine","tags"]);t.includes(e)?this.props.onChange(t.filter((t=>t!==e))):this.props.onChange(t.push(e))}}render(){const{header:e}=this.props,{allTags:t}=this.state,n=e.getIn(["titleLine","tags"]);return l.a.createElement(l.a.Fragment,null,l.a.createElement("h2",{className:"drawer-modal__title"},"Edit tags"),l.a.createElement("datalist",{id:"drawer-modal__datalist-tag-names"},t.map(((e,t)=>l.a.createElement("option",{key:t,value:e})))),0===n.size?l.a.createElement("div",{className:"no-tags-message"},"This header doesn't have any tags.",l.a.createElement("br",null),l.a.createElement("br",null),"Click the ",l.a.createElement("i",{className:"fas fa-plus"})," button to add a new one, or choose from the list of all of your tags below."):l.a.createElement(Is.c,{droppableId:"tags-editor-droppable",type:"TAG"},((e,t)=>l.a.createElement("div",Object.assign({className:"tags-container",ref:e.innerRef},e.droppableProps),l.a.createElement(o.Fragment,null,n.map(((e,t)=>l.a.createElement(Is.b,{draggableId:`tag--${t}`,index:t,key:t},((n,a)=>l.a.createElement("div",Object.assign({className:to()("tag-container",{"tag-container--dragging":a.isDragging}),ref:n.innerRef},n.draggableProps),l.a.createElement("input",{type:"text",className:"textfield tag-container__textfield",value:e,onChange:this.handleTagChange(t),ref:e=>this.lastTextfield=e,list:"drawer-modal__datalist-tag-names"}),l.a.createElement("div",{className:"tag-container__actions-container"},l.a.createElement("i",{className:"fas fa-times fa-lg",onClick:this.handleRemoveTag(t)}),l.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg tag-container__drag-handle drag-handle"},n.dragHandleProps)))))))),e.placeholder)))),l.a.createElement("div",{className:"tags-editor__add-new-container"},l.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:this.handleAddNewTag})),l.a.createElement("hr",{className:"tags-editor__separator"}),l.a.createElement("h2",{className:"tags-editor__title"},"All tags"),l.a.createElement("div",{className:"all-tags-container"},t.filter((e=>!!e)).map((e=>{const t=to()("all-tags__tag",{"all-tags__tag--in-use":n.includes(e)});return l.a.createElement("div",{className:t,key:e,onClick:this.handleExistingTagClick(e)},e)}))))}}n(350),n(351),n(352);var Xo=e=>{let{buttons:t,titles:n,values:a,selectedButton:i,useEqualWidthTabs:r,onSelect:s}=e;const o=e=>()=>s(e),c=to()("tab-buttons",{"tab-buttons--equal-width-tabs":r}),d={gridTemplateColumns:r?`repeat(${t.length}, 1fr)`:null};return l.a.createElement("div",{className:c,style:d},t.map(((e,t)=>{const r=a?a[t]:e,s=to()("tab-buttons__btn",{"tab-buttons__btn--selected":r===i});let c="";return n&&(c=n[t]),l.a.createElement("div",{key:e+t,title:c,className:s,onClick:o(r)},e)})))};class Zo extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleActiveToggle","handleDateChange","handleAddRepeater","handleRemoveRepeater","handleRepeaterTypeChange","handleRepeaterValueChange","handleRepeaterUnitChange","handleAddDelay","handleRemoveDelay","handleDelayTypeChange","handleDelayValueChange","handleDelayUnitChange","createPlanningItem"])}handleActiveToggle(){this.props.onChange(this.props.timestamp.update("isActive",(e=>!e)))}handleDateChange(e,t,n){if(b.a.isEmpty(e.target.value))b.a.isNumber(t)?this.props.org.removePlanningItem(this.props.headerId,t):b.a.isNumber(n)&&this.props.org.removeTimestamp(this.props.headerId,n),"scheduled-editor"!==this.props.activePopupType&&"deadline-editor"!==this.props.activePopupType&&this.props.onClose();else{const{onChange:t,timestamp:n}=this.props,[a,i,r,s]=Object(k.a)(Object(Lt.a)(e.target.value),"yyyy MM dd eee").split(" ");t(n.set("year",a).set("month",i).set("day",r).set("dayName",s))}}handleAddTime(e){return()=>{const{onChange:t,timestamp:n}=this.props,[a,i]="start"===e?["startHour","startMinute"]:["endHour","endMinute"],[r,s]=Object(k.a)(new Date,"HH:mm").split(":");t(n.set(a,r).set(i,s))}}handleRemoveTime(e){return()=>{const{onChange:t,timestamp:n}=this.props,[a,i]="start"===e?["startHour","startMinute"]:["endHour","endMinute"];t(n.set(a,null).set(i,null))}}handleTimeChange(e){return t=>{const{onChange:n,timestamp:a}=this.props,[i,r]="start"===e?["startHour","startMinute"]:["endHour","endMinute"];let[s,o]=t.target.value.split(":");s=s.startsWith("0")?s.substring(1):s,n(a.set(i,s).set(r,o))}}handleAddRepeater(){const{onChange:e,timestamp:t}=this.props;e(t.set("repeaterType","+").set("repeaterValue",1).set("repeaterUnit","h"))}handleRemoveRepeater(){const{onChange:e,timestamp:t}=this.props;e(t.set("repeaterType",null).set("repeaterValue",null).set("repeaterUnit",null))}handleRepeaterTypeChange(e){const{onChange:t,timestamp:n}=this.props;t(n.set("repeaterType",e))}handleRepeaterValueChange(e){const{onChange:t,timestamp:n}=this.props;t(n.set("repeaterValue",e.target.value))}handleRepeaterUnitChange(e){const{onChange:t,timestamp:n}=this.props;t(n.set("repeaterUnit",e))}handleAddDelay(){const{onChange:e,timestamp:t}=this.props;e(t.set("delayType","-").set("delayValue",1).set("delayUnit","h"))}handleRemoveDelay(){const{onChange:e,timestamp:t}=this.props;e(t.set("delayType",null).set("delayValue",null).set("delayUnit",null))}handleDelayTypeChange(e){const{onChange:t,timestamp:n}=this.props;t(n.set("delayType",e))}handleDelayValueChange(e){const{onChange:t,timestamp:n}=this.props;t(n.set("delayValue",e.target.value))}handleDelayUnitChange(e){const{onChange:t,timestamp:n}=this.props;t(n.set("delayUnit",e))}renderTimeField(e,t,n,a){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return l.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},l.a.createElement("div",{className:"timestamp-editor__field-title"},e),l.a.createElement("div",{className:"timestamp-editor__field"},n?l.a.createElement(o.Fragment,null,l.a.createElement("input",{type:"time",className:"timestamp-editor__time-input",value:`${n.padStart(2,"0")}:${a.padStart(2,"0")}`,onChange:this.handleTimeChange(t)}),i&&l.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveTime(t)})):l.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddTime(t)})))}renderRepeater(){const{repeaterType:e,repeaterValue:t,repeaterUnit:n}=this.props.timestamp.toJS();return l.a.createElement("div",{className:"timestamp-editor__field-container"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Repeater"),l.a.createElement("div",{className:"timestamp-editor__field timestamp-editor__field--delay-repeater"},e?l.a.createElement(o.Fragment,null,l.a.createElement("div",{className:"timestamp-editor__delay-repeater-type"},l.a.createElement(Xo,{buttons:["+","++",".+"],titles:["Shift exactly the amount of time in the repeater (i.e. one month for +1m).","Shift the date by as many intervals of the amount of time in the repeater (i.e. one or many months for for ++1m) as it takes to get this date into the future.","Shift the date exactly the amount of time of the repeater relative to the time of the state change."],selectedButton:e||"+",onSelect:this.handleRepeaterTypeChange})),l.a.createElement("input",{type:"number",min:"1",className:"textfield delay-repeater-value-input",value:t||1,onChange:this.handleRepeaterValueChange}),l.a.createElement("div",null,l.a.createElement(Xo,{buttons:["h","d","w","m","y"],titles:["hours","days","weeks","months","years"],selectedButton:n||"h",onSelect:this.handleRepeaterUnitChange})),l.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveRepeater})):l.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddRepeater})))}renderDelay(){const{delayType:e,delayValue:t,delayUnit:n}=this.props.timestamp.toJS();return l.a.createElement("div",{className:"timestamp-editor__field-container"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Delay"),l.a.createElement("div",{className:"timestamp-editor__field"},e?l.a.createElement(o.Fragment,null,l.a.createElement("div",{className:"timestamp-editor__delay-repeater-type"},l.a.createElement(Xo,{buttons:["-","--"],titles:["Set a different lead time before the entry is put into the agenda.","In case the task contains a repeater, the delay is considered to affect all occurrences; if you want the delay to only affect the first scheduled occurrence of the task, use '--' instead."],selectedButton:e||"-",onSelect:this.handleDelayTypeChange})),l.a.createElement("input",{type:"number",min:"1",className:"textfield delay-repeater-value-input",value:t||1,onChange:this.handleDelayValueChange}),l.a.createElement("div",null,l.a.createElement(Xo,{buttons:["h","d","w","m","y"],titles:["hours","days","weeks","months","years"],selectedButton:n||"h",onSelect:this.handleDelayUnitChange})),l.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveDelay})):l.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddDelay})))}createPlanningItem(){const{selectedHeaderId:e,header:t,activePopupType:n}=this.props,a={"deadline-editor":"DEADLINE","scheduled-editor":"SCHEDULED"}[n];this.props.org.addNewPlanningItem(e,a),this.props.base.activatePopup(n,{headerId:e,planningItemIndex:t.get("planningItems").size})}render(){const{timestamp:e,timestampId:t,planningItemIndex:n}=this.props;if(!e)return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"timestamp-editor__field-title"},"Add Timestamp"),l.a.createElement("div",{className:"timestamp-editor__field"},l.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.createPlanningItem})));const{isActive:a,year:i,month:r,day:s,startHour:o,startMinute:c,endHour:d,endMinute:h}=e.toJS();return l.a.createElement("div",null,l.a.createElement("div",{className:"timestamp-editor__render"},j(e)),l.a.createElement("div",{className:"timestamp-editor__date-time-fields-container"},l.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Active"),l.a.createElement("div",{className:"timestamp-editor__field"},l.a.createElement(Ko,{isEnabled:a,onToggle:this.handleActiveToggle}))),l.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Date"),l.a.createElement("div",{className:"timestamp-editor__field"},l.a.createElement("input",{"data-testid":"timestamp-selector",type:"date",className:"timestamp-editor__date-input",onChange:e=>this.handleDateChange(e,n,t),onFocus:e=>e.nativeEvent.target.defaultValue="",value:`${i}-${r}-${s}`}))),this.renderTimeField("Start time","start",o,c,!d),!!o&&this.renderTimeField("End time","end",d,h)),this.renderRepeater(),this.renderDelay())}}var Qo=Object(h.b)((e=>{const t=e.org.present.get("path"),n=e.org.present.getIn(["files",t],Object(y.Map)()),a=e.base.get("activePopup");return{selectedHeaderId:n.get("selectedHeaderId"),header:be(e),activePopupType:a?a.get("type"):null,activePopupData:a?a.get("data"):null}}),(e=>({org:Object(u.b)(r,e),base:Object(u.b)(a,e)})))(Zo);class el extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleAddEndTimestamp","handleRemoveEndTimestamp"])}handleChange(e){return t=>this.props.onChange(this.props.timestamp.set(e,t))}handleAddEndTimestamp(){const{timestamp:e}=this.props,[t,n,a,i]=Object(k.a)(new Date,"yyyy MM dd eee").split(" ");this.props.onChange(e.set("secondTimestamp",Object(y.Map)({year:t,month:n,day:a,dayName:i,isActive:e.getIn(["firstTimestamp","isActive"])})))}handleRemoveEndTimestamp(){this.props.onChange(this.props.timestamp.set("secondTimestamp",null))}render(){const{headerId:e,timestamp:t,timestampId:n,popupType:a,onClose:i,singleTimestampOnly:r,planningItemIndex:s}=this.props;return l.a.createElement(l.a.Fragment,null,l.a.createElement("h2",{className:"timestamp-editor__title"},{"timestamp-editor":"Edit timestamp","scheduled-editor":"Edit scheduled timestamp","deadline-editor":"Edit deadline"}[a]),l.a.createElement(Qo,{headerId:e,timestamp:t&&t.get("firstTimestamp"),timestampId:n,planningItemIndex:s,onClose:i,onChange:this.handleChange("firstTimestamp")}),!r&&(t.get("secondTimestamp")?l.a.createElement(o.Fragment,null,l.a.createElement("div",{className:"timestamp-editor__separator"},l.a.createElement("div",{className:"timestamp-editor__separator__margin-line"}),"to",l.a.createElement("div",{className:"timestamp-editor__separator__margin-line"})),l.a.createElement(Qo,{headerId:e,timestamp:t.get("secondTimestamp"),timestampId:n,onChange:this.handleChange("secondTimestamp")}),l.a.createElement("div",{className:"timestamp-editor__button-container"},l.a.createElement("button",{className:"btn timestamp-editor__add-new-button",onClick:this.handleRemoveEndTimestamp},"Remove end timestamp"))):l.a.createElement("div",{className:"timestamp-editor__button-container"},l.a.createElement("button",{className:"btn timestamp-editor__add-new-button",onClick:this.handleAddEndTimestamp},"Add end timestamp"))),l.a.createElement("br",null))}}n(353);class tl extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleAddNewItem"])}componentDidUpdate(e){const t=e.propertyListItems,n=this.props.propertyListItems;t.size===n.size-1&&""===n.last().get("property")&&this.lastTextfield&&this.lastTextfield.focus()}handlePropertyChange(e){return t=>{const n=this.props.propertyListItems.findIndex((t=>t.get("id")===e));this.props.onChange(this.props.propertyListItems.setIn([n,"property"],t.target.value))}}handleValueChange(e){return t=>{const{propertyListItems:n,onChange:a}=this.props,i=n.findIndex((t=>t.get("id")===e));a(n.setIn([i,"value"],Object(y.fromJS)(An(t.target.value))))}}handleRemoveItem(e){return()=>this.props.onChange(this.props.propertyListItems.filter((t=>t.get("id")!==e)))}handleAddNewItem(){this.props.onChange(this.props.propertyListItems.push(Object(y.fromJS)({property:"",value:"",id:w()})))}render(){const{propertyListItems:e,allOrgProperties:t}=this.props,n=He(t),a=e.map((e=>{const n=e.get("property");return[e,je(t,n)]}));return l.a.createElement(l.a.Fragment,null,l.a.createElement("h2",{className:"drawer-modal__title"},"Edit property list"),l.a.createElement("datalist",{id:"drawer-modal__datalist-property-names"},n.map(((e,t)=>l.a.createElement("option",{key:t,value:e})))),0===e.size?l.a.createElement("div",{className:"no-items-message"},"There are no items in this property list.",l.a.createElement("br",null),l.a.createElement("br",null),"Click the ",l.a.createElement("i",{className:"fas fa-plus"})," button to add a new one."):l.a.createElement(Is.c,{droppableId:"property-list-editor-droppable",type:"PROPERTY-LIST"},(e=>l.a.createElement("div",Object.assign({className:"property-list-editor__items-container",ref:e.innerRef},e.droppableProps),l.a.createElement(o.Fragment,null,a.map(((e,t)=>{let[n,a]=e;return l.a.createElement(Is.b,{draggableId:`property-list-item--${t}`,index:t,key:n.get("id")},((e,i)=>l.a.createElement("div",Object.assign({className:to()("property-list-editor__item-container",{"property-list-editor__item-container--dragging":i.isDragging}),ref:e.innerRef},e.draggableProps),l.a.createElement("div",{className:"item__textfields-container"},l.a.createElement("input",{type:"text",className:"textfield item-container__textfield",value:n.get("property"),onChange:this.handlePropertyChange(n.get("id")),ref:e=>this.lastTextfield=e,list:"drawer-modal__datalist-property-names"}),l.a.createElement("input",{type:"text",className:"textfield item-container__textfield",value:q(n.get("value")),onChange:this.handleValueChange(n.get("id")),list:`drawer-modal__datalist-property-${t}-values`}),l.a.createElement("datalist",{id:`drawer-modal__datalist-property-${t}-values`},a.map(((e,t)=>l.a.createElement("option",{key:t,value:e}))))),l.a.createElement("div",{className:"item-container__actions-container"},l.a.createElement("i",{className:"fas fa-times fa-lg",onClick:this.handleRemoveItem(n.get("id"))}),l.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg item-container__drag-handle drag-handle"},e.dragHandleProps))))))})),e.placeholder)))),l.a.createElement("div",{className:"property-list-editor__add-new-container"},l.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:this.handleAddNewItem})))}}n(354);class nl extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleTextareaRef","handleTextareaFocus","handleTitleChange","handleTitleFieldClick","handleInsertTimestamp","chooseTodoKeywordSet","handleTodoChange","handleNextTodoKeywordSet"]);const t=this.chooseTodoKeywordSet(e.todoKeywordSets,e.header.getIn(["titleLine","todoKeyword"]));this.state={todoKeywordSet:t,todoKeywordSetIndex:e.todoKeywordSets.indexOf(t),titleValue:e.editRawValues?this.calculateRawTitle(e.header):e.header.getIn(["titleLine","rawTitle"])}}handleTextareaRef(e){this.textarea=e}componentDidMount(){this.props.setPopupCloseActionValuesAccessor((()=>[this.state.titleValue]))}componentDidUpdate(e){const{header:t,editRawValues:n}=this.props;e.header===t&&e.editRawValues===n||(this.setState({titleValue:n?this.calculateRawTitle(t):t.getIn(["titleLine","rawTitle"])}),this.textarea.focus())}handleTextareaFocus(e){const{header:t}=this.props;if(""===t.getIn(["titleLine","rawTitle"])){const t=e.target.value;e.target.selectionStart=t.length,e.target.selectionEnd=t.length}}handleTitleChange(e){const t=e.target.value,n=t[t.length-1];this.state.titleValue!==t.substring(0,t.length-1)||"\n"!==n?this.setState({titleValue:t}):this.props.onClose(t)}handleTitleFieldClick(e){e.stopPropagation()}calculateRawTitle(e){return X(e.toJS(),!1)}handleInsertTimestamp(e){const{titleValue:t}=this.state,n=this.textarea.selectionStart;this.setState({titleValue:t.substring(0,n)+V()+t.substring(this.textarea.selectionEnd||n)}),this.textarea.focus(),e.stopPropagation()}chooseTodoKeywordSet(e,t){return xe(e,t)}handleTodoChange(e){const t=this.props.header.getIn(["titleLine","todoKeyword"])===e?"":e;this.props.saveTitle(this.state.titleValue),this.props.onTodoClicked(t)}handleNextTodoKeywordSet(){const{todoKeywordSets:e}=this.props,t=this.state.todoKeywordSetIndex+1!==e.size?this.state.todoKeywordSetIndex+1:0,n=t!==e.size?e.get(t):e.get(0);this.setState({todoKeywordSet:n,todoKeywordSetIndex:t})}render(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("h2",{className:"drawer-modal__title"},this.props.editRawValues?"Edit full title":"Edit title"),this.props.editRawValues?null:l.a.createElement("div",{className:"todo-container"},l.a.createElement(Xo,{buttons:this.state.todoKeywordSet.get("keywords").filter((e=>0===this.state.todoKeywordSet.get("completedKeywords").filter((t=>e===t)).size)),selectedButton:this.props.header.getIn(["titleLine","todoKeyword"]),onSelect:this.handleTodoChange}),l.a.createElement(Xo,{buttons:this.state.todoKeywordSet.get("completedKeywords").filter((e=>""!==e)),selectedButton:this.props.header.getIn(["titleLine","todoKeyword"]),onSelect:this.handleTodoChange}),this.props.todoKeywordSets.size>1?l.a.createElement("button",{className:"btn-passive",onClick:this.handleNextTodoKeywordSet,title:"Next keyword set"},"Next set"):null),l.a.createElement("div",{className:"title-line__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea drag-handle","data-testid":"titleLineInput",rows:"3",ref:this.handleTextareaRef,value:this.state.titleValue,onFocus:this.handleTextareaFocus,onChange:this.handleTitleChange,onClick:this.handleTitleFieldClick}),l.a.createElement("div",{className:"title-line__insert-timestamp-button",onClick:this.handleInsertTimestamp},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")))}}n(355);class al extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleTextareaRef","handleDescriptionChange","handleInsertTimestamp"]),this.state={descriptionValue:e.editRawValues?this.calculateRawDescription(e.header):e.header.get("rawDescription"),editorDescriptionHeightValue:e.editorDescriptionHeightValue?e.editorDescriptionHeightValue:"8"}}componentDidMount(){this.props.setPopupCloseActionValuesAccessor((()=>[this.state.descriptionValue]))}componentDidUpdate(e){const{header:t,editRawValues:n}=this.props;e.header===t&&e.editRawValues===n||(this.setState({descriptionValue:this.props.editRawValues?this.calculateRawDescription(t):t.get("rawDescription")}),this.textarea.focus())}calculateRawDescription(e){const t=this.props.dontIndent;return Q(e,!1,t)}handleTextareaRef(e){this.textarea=e}descriptionModifier(e){const{target:{value:t}}=e,n=t.split("\n");return n.forEach(((e,t)=>{e.startsWith("* ")&&(n[t]="- "+e.slice(2))})),n.join("\n")}handleDescriptionChange(e){this.setState({descriptionValue:this.descriptionModifier(e)})}handleInsertTimestamp(){const{descriptionValue:e}=this.state,t=this.textarea.selectionStart;this.setState({descriptionValue:e.substring(0,t)+V()+e.substring(this.textarea.selectionEnd||t)}),this.textarea.focus()}render(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("h2",{className:"drawer-modal__title"},this.props.editRawValues?"Edit full description":"Edit description"),l.a.createElement("div",{className:"header-content__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea drag-handle",rows:Vo?"8":this.state.editorDescriptionHeightValue,ref:this.handleTextareaRef,value:this.state.descriptionValue,onChange:this.handleDescriptionChange}),l.a.createElement("div",{className:"header-content__insert-timestamp-button",onClick:this.handleInsertTimestamp},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")))}}var il=Object(h.b)((e=>({editorDescriptionHeightValue:e.base.get("editorDescriptionHeightValue")})))(al),rl=(n(356),n(357),e=>{let{subPartDataAndHandlers:{selectedTableCellId:t,onEnterTableEditMode:n,onAddNewTableRow:a,onRemoveTableRow:i,onAddNewTableColumn:r,onRemoveTableColumn:s,onUpClick:o,onLeftClick:c,onRightClick:d,onDownClick:h}}=e;return l.a.createElement("div",{className:"table-action-drawer"},l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"table-action-drawer-container"},l.a.createElement("div",{className:" table-action-drawer__edit-icon-container",onClick:()=>t?n():void 0},l.a.createElement("i",{className:"fas fa-pencil-alt fa-lg"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:()=>t?a():void 0},l.a.createElement("i",{className:"fas fa-plus fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:()=>t?i():void 0},l.a.createElement("i",{className:"fas fa-times fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:()=>t?r():void 0},l.a.createElement("i",{className:"fas fa-plus fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:()=>t?s():void 0},l.a.createElement("i",{className:"fas fa-times fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon"}))),l.a.createElement("div",{className:"table-action-movement-container"},l.a.createElement("div",{className:"table-action-movement__up",onClick:()=>t?o():void 0},l.a.createElement("i",{className:"fas fa-arrow-up fa-lg table-action-drawer__main-icon"})),l.a.createElement("div",{className:"table-action-movement__left",onClick:()=>t?c():void 0},l.a.createElement("i",{className:"fas fa-arrow-left fa-lg table-action-drawer__main-icon"})),l.a.createElement("div",{className:"table-action-movement__right",onClick:()=>t?d():void 0},l.a.createElement("i",{className:"fas fa-arrow-right fa-lg table-action-drawer__main-icon"})),l.a.createElement("div",{className:"table-action-movement__down",onClick:()=>t?h():void 0},l.a.createElement("i",{className:"fas fa-arrow-down fa-lg table-action-drawer__main-icon"})))))});class sl extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleCellSelect","handleTextareaBlur","handleCellChange","handleInsertTimestamp","handleTextareaRef","handleTableCellSelect","handleTableCellValueUpdate","handlePopupClose","handleExitTableEditMode","handleEnterTableEditMode","handleAddNewTableRow","handleRemoveTableRow","handleAddNewTableColumn","handleRemoveTableColumn","handleCheckboxClick","handleTimestampClick","handleUpClick","handleDownClick","handleLeftClick","handleRightClick"]),this.state={rawCellValues:this.generateCellValueMap(e.table),shouldIgnoreBlur:!1}}componentDidUpdate(e){const{selectedTableCellId:t,inTableEditMode:n}=this.props,{rawCellValues:a}=this.state;e.inTableEditMode&&!n&&a.has(t)&&this.handleTableCellValueUpdate(t,a.get(t)),this.props.table!==e.table&&this.setState({rawCellValues:this.generateCellValueMap(this.props.table)})}generateCellValueMap(e){return Object(y.Map)(e.get("contents").map((e=>e.get("contents").map((e=>[e.get("id"),e.get("rawContents")])))).flatten())}handleCellSelect(e){return()=>this.handleTableCellSelect(e)}handleTextareaBlur(){setTimeout((()=>{this.state.shouldIgnoreBlur?this.setState({shouldIgnoreBlur:!1}):this.handleExitTableEditMode()}),0)}handleCellChange(e){const{rawCellValues:t}=this.state,{selectedTableCellId:n}=this.props;this.setState({rawCellValues:t.set(n,e.target.value)})}handleInsertTimestamp(){this.setState({shouldIgnoreBlur:!0});const{rawCellValues:e}=this.state,{selectedTableCellId:t}=this.props,n=e.get(t),a=this.textarea.selectionStart;this.setState({rawCellValues:e.set(t,n.substring(0,a)+V()+n.substring(this.textarea.selectionEnd||a))}),this.textarea.focus()}handleTextareaRef(e){this.textarea=e}handleTableCellSelect(e){this.props.org.setSelectedTableCellId(e)}handleTableCellValueUpdate(e,t){this.props.org.updateTableCellValue(e,t)}handlePopupClose(){this.props.base.closePopup()}handleExitTableEditMode(){this.props.org.exitEditMode()}handleEnterTableEditMode(){this.props.org.enterEditMode("table")}handleAddNewTableRow(){this.props.org.addNewTableRow()}handleRemoveTableRow(){this.props.org.removeTableRow()}handleAddNewTableColumn(){this.props.org.addNewTableColumn()}handleRemoveTableColumn(){this.props.org.removeTableColumn()}handleCheckboxClick(e){this.props.org.advanceCheckboxState(e)}handleTimestampClick(e){this.props.base.activatePopup("timestamp-editor",{timestampId:e})}handleUpClick(){this.props.org.moveTableRowUp()}handleDownClick(){this.props.org.moveTableRowDown()}handleLeftClick(){this.props.org.moveTableColumnLeft()}handleRightClick(){this.props.org.moveTableColumnRight()}render(){const{table:e,selectedTableCellId:t,inTableEditMode:n,shouldDisableActions:a}=this.props,{rawCellValues:i}=this.state,r={onTableCellSelect:this.handleTableCellSelect,selectedTableCellId:t,inTableEditMode:n,onExitTableEditMode:this.handleExitTableEditMode,onTableCellValueUpdate:this.handleTableCellValueUpdate,onEnterTableEditMode:this.handleEnterTableEditMode,onAddNewTableRow:this.handleAddNewTableRow,onRemoveTableRow:this.handleRemoveTableRow,onAddNewTableColumn:this.handleAddNewTableColumn,onRemoveTableColumn:this.handleRemoveTableColumn,onCheckboxClick:this.handleCheckboxClick,onTimestampClick:this.handleTimestampClick,onUpClick:this.handleUpClick,onDownClick:this.handleDownClick,onLeftClick:this.handleLeftClick,onRightClick:this.handleRightClick,shouldDisableActions:a};return 0!==e.get("contents").size&&0!==e.getIn(["contents",0,"contents"]).size||this.handlePopupClose(),l.a.createElement(l.a.Fragment,null,l.a.createElement("h2",{className:"drawer-modal__title"},"Edit table"),l.a.createElement("div",{style:{overflowX:"auto",overflowY:"auto"}},l.a.createElement("table",{className:"table-part"},l.a.createElement("tbody",null,e.get("contents").map((e=>l.a.createElement("tr",{key:e.get("id")},e.get("contents").map((e=>{const a=e.get("id")===t,s=to()("table-part__cell",{"table-part__cell--selected":a});return l.a.createElement("td",{className:s,key:e.get("id"),onClick:this.handleCellSelect(e.get("id"))},a&&n?l.a.createElement("div",{className:"table-cell__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"3",value:i.get(e.get("id")),onBlur:this.handleTextareaBlur,onChange:this.handleCellChange,ref:this.handleTextareaRef}),l.a.createElement("div",{className:"table-cell__insert-timestamp-button",onClick:this.handleInsertTimestamp},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):e.get("contents").size>0?l.a.createElement(So,{parts:e.get("contents"),subPartDataAndHandlers:r}):"   ")})))))))),l.a.createElement(rl,{subPartDataAndHandlers:r}))}}var ol=Object(h.b)((e=>{const t=e.org.present.get("path"),n=e.org.present.getIn(["files",t],Object(y.Map)()),a=n.get("headers"),i=n.get("selectedHeaderId"),r=a&&i&&re(a,i),s=n.get("selectedTableId");return{table:r?r.get("description").find((e=>e.get("id")===s)):null,selectedTableCellId:n.get("selectedTableCellId"),inTableEditMode:"table"===n.get("editMode")}}),(e=>({base:Object(u.b)(a,e),org:Object(u.b)(r,e)})))(sl);n(358);class ll extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleTextareaRef","addNote","handleDescriptionChange"]),this.state={allTags:e.allTags,note:""}}handleTextareaRef(e){this.textarea=e}addNote(){let{note:e}=this.state;null!==e&&(e=e.trim()),e&&(this.props.org.addNote(e,new Date),this.setState({note:""}))}handleNoteFieldClick(e){e.stopPropagation()}handleDescriptionChange(e){this.setState({note:e.target.value})}render(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("h2",{className:"drawer-modal__title"},"Add note"),l.a.createElement("div",null,"Enter a note to add to the header:"),l.a.createElement("textarea",{autoFocus:!0,className:"textarea drag-handle","data-testid":"titleLineInput",rows:"3",ref:this.handleTextareaRef,value:this.state.note,onClick:this.handleNoteFieldClick,onChange:this.handleDescriptionChange}),l.a.createElement("button",{className:"btn note-editor__done-btn",onClick:()=>this.addNote()},"Add"))}}var cl=Object(h.b)(null,(e=>({base:Object(u.b)(a,e),org:Object(u.b)(r,e)})))(ll),dl=(n(359),n(360),n(414)),hl=n(407),ul=n(408),pl=n(409);class ml extends o.PureComponent{handleHeaderClick(e,t){return()=>this.props.onHeaderClick(e,t)}render(){const{date:e,files:t,dateDisplayType:n,onToggleDateDisplayType:a,agendaDefaultDeadlineDelayValue:i,agendaDefaultDeadlineDelayUnit:r}=this.props,s=Object(nn.a)(e),c=Object(sn.a)(e),d=this.getPlanningItemsAndHeaders({files:t,date:e,agendaDefaultDeadlineDelayValue:i,agendaDefaultDeadlineDelayUnit:r,dateStart:s,dateEnd:c});return l.a.createElement("div",{className:"agenda-day__container"},l.a.createElement("div",{className:"agenda-day__title"},Object(dl.a)(e)&&l.a.createElement("div",{className:"agenda-day__today-indicator"}),l.a.createElement("div",{className:"agenda-day__title__day-name"},Object(k.a)(e,"eeee")),l.a.createElement("div",{className:"agenda-day__title__date"},Object(k.a)(e,"MMMM do, yyyy"))),l.a.createElement("div",{className:"agenda-day__headers-container"},l.a.createElement("div",null,d.map((e=>{let[t,i]=e;const r=W(t.get("timestamp")),s=!!i.getIn(["titleLine","todoKeyword"]),c=to()("agenda-day__header-planning-date",{"agenda-day__header-planning-date--overdue":s&&Object(hl.a)(r)});return l.a.createElement("div",{key:t.get("id"),className:"agenda-day__header-container"},l.a.createElement("div",{className:"agenda-day__header__planning-item-container"},l.a.createElement("div",{className:"agenda-day__header-planning-type"},We(t)),l.a.createElement("div",{className:c,onClick:a},"absolute"===n?Object(k.a)(r,"MM/dd"):Re(r),t.getIn(["timestamp","startHour"])&&l.a.createElement(o.Fragment,null,l.a.createElement("br",null),Object(k.a)(r,"h:mma")))),l.a.createElement("div",{className:"agenda-day__header__header-container"},l.a.createElement(Io,{header:i,color:"var(--base03)",hasContent:!1,isSelected:!1,shouldDisableActions:!0,shouldDisableExplicitWidth:!0,onClick:this.handleHeaderClick(i.get("path"),i.get("id"))})))})))))}getPlanningItemsAndHeaders(e){let{files:t,date:n,agendaDefaultDeadlineDelayValue:a,agendaDefaultDeadlineDelayUnit:i,dateStart:r,dateEnd:s}=e;const o=Object(y.List)().concat(...t.mapEntries((e=>{let[t,n]=e;return[t,n.get("headers").map((e=>e.set("path",t)))]})).valueSeq()),l=t.map((e=>e.get("todoKeywordSets")));return o.flatMap((e=>e.get("planningItems").filter((t=>{const o=t.get("timestamp");if(!o.get("isActive"))return!1;const c=W(o),d=e.getIn(["titleLine","todoKeyword"]);if(d&&((e,t)=>xe(e,t).get("completedKeywords").includes(t))(l.get(e.get("path")),d))return!1;switch(t.get("type")){case"DEADLINE":if(Object(dl.a)(n)){if(Object(L.a)(c,new Date))return!0;const[e,t]=o.get("delayType")?[o.get("delayValue"),o.get("delayUnit")]:[a,i],r=G(c,e,t);return Object(Nt.a)(n,r)||Object(ul.a)(n,r)}return Object(pl.a)(c,{start:r,end:s});case"SCHEDULED":let t=c;if(o.get("delayType")){const n=e.get("propertyListItems").some((e=>"LAST_REPEAT"===e.get("property")));"--"!==o.get("delayType")||n||(t=z(c,o.get("delayValue"),o.get("delayUnit")))}return!(!Object(dl.a)(n)||!Object(Nt.a)(n,t))||Object(pl.a)(t,{start:r,end:s});default:return Object(pl.a)(c,{start:r,end:s})}})).map((t=>[t,e])))).sortBy((e=>{let[t]=e;const{startHour:n,startMinute:a,endHour:i,endMinute:r,month:s,day:o}=t.get("timestamp").toJS();return[n?0:1,n,a,i,r,s,o]}))}}var gl=n(410),fl=n(411);var bl=Object(h.b)((e=>{const t=e.org.present.get("path"),n=e.org.present.getIn(["files",t]),a=e.org.present.get("files"),i=e.org.present.get("fileSettings"),r=e.base.get("agendaStartOnWeekday");return{files:yi(a,i,t,"includeInAgenda",!1),todoKeywordSets:n.get("todoKeywordSets"),agendaTimeframe:e.base.get("agendaTimeframe"),agendaDefaultDeadlineDelayValue:e.base.get("agendaDefaultDeadlineDelayValue")||5,agendaDefaultDeadlineDelayUnit:e.base.get("agendaDefaultDeadlineDelayUnit")||"d",agendaStartOnWeekday:null==r?1:+r}}),(e=>({org:Object(u.b)(r,e),base:Object(u.b)(a,e)})))((function(e){const{files:t,todoKeywordSets:n,agendaTimeframe:a,agendaDefaultDeadlineDelayValue:i,agendaDefaultDeadlineDelayUnit:r,agendaStartOnWeekday:s}=e,[c,d]=Object(o.useState)(new Date),[h,u]=Object(o.useState)("absolute"),p=s<0?Object(gl.a)(c):s;function m(t,n){e.onClose(),e.org.selectHeaderAndOpenParents(t,n)}function g(){u("absolute"===h?"relative":"absolute")}let f=[];switch(a){case"Day":f=[c];break;case"Week":const e=Object(ln.a)(c,{weekStartsOn:p});f=b.a.range(7).map((t=>Object(S.a)(e,t)));break;case"Month":const t=Object(tn.a)(c);f=b.a.range(Object(fl.a)(c)).map((e=>Object(S.a)(t,e)))}return l.a.createElement(l.a.Fragment,null,l.a.createElement("h2",{className:"agenda__title"},"Agenda"),l.a.createElement("div",{className:"agenda__tab-container"},l.a.createElement(Xo,{buttons:["Day","Week","Month"],selectedButton:a,onSelect:function(t){e.base.setAgendaTimeframe(t)},useEqualWidthTabs:!0})),l.a.createElement("div",{className:"agenda__timeframe-header-container"},l.a.createElement("i",{className:"fas fa-chevron-left fa-lg",onClick:function(){switch(a){case"Day":d(Object(A.a)(c,1));break;case"Week":d(Object(O.a)(c,1));break;case"Month":d(Object(N.a)(c,1));break;default:return""}}}),l.a.createElement("div",{className:"agenda__timeframe-header"},function(){switch(a){case"Day":return Object(k.a)(c,"MMMM do");case"Week":const e=Object(ln.a)(c,{weekStartsOn:p}),t=Object(_.a)(e,1);return`${Object(k.a)(e,"MMM do")} - ${Object(k.a)(t,"MMM do")} (W${Object(k.a)(e,"w")})`;case"Month":return Object(k.a)(c,"MMMM");default:return""}}()),l.a.createElement("i",{className:"fas fa-chevron-right fa-lg",onClick:function(){switch(a){case"Day":d(Object(S.a)(c,1));break;case"Week":d(Object(_.a)(c,1));break;case"Month":d(Object(I.a)(c,1));break;default:return""}}})),l.a.createElement("div",{className:"agenda__days-container",style:Vo?void 0:{overflow:"auto"}},f.map((e=>l.a.createElement(ml,{key:Object(k.a)(e,"yyyy MM dd"),date:e,files:t,onHeaderClick:m,todoKeywordSets:n,dateDisplayType:h,onToggleDateDisplayType:g,agendaDefaultDeadlineDelayValue:i,agendaDefaultDeadlineDelayUnit:r})))),l.a.createElement("br",null))}));n(361),n(362);var yl=Object(h.b)((e=>({allHeaders:e.org.present.get("files").map((e=>e.get("headers"))),headers:e.org.present.getIn(["search","filteredHeaders"])||Object(y.Map)(),showClockedTimes:e.org.present.getIn(["search","showClockedTimes"])})),(e=>({org:Object(u.b)(r,e)})))((function(e){const{context:t}=e;function n(t,n){return()=>e.onHeaderClick(t,n)}Object(o.useEffect)((()=>{"Clock List"===t?e.org.setSearchFilterInformation("clock:now",0,"search"):e.org.setSearchFilterInformation("",0,t)}),[t,e.org]);const{headers:a,allHeaders:i,showClockedTimes:r}=e;return l.a.createElement("div",{className:"agenda-day__container"},l.a.createElement("div",{className:"agenda-day__headers-container"},Array.from(a.entries(),(e=>{let[t,a]=e;const s=$e(i,t);return a.map((e=>l.a.createElement("div",{key:e.get("id"),className:"agenda-day__header-container"},l.a.createElement("div",{className:"search__breadcrumbs"},s(e)),l.a.createElement("div",{className:"agenda-day__header__header-container"},l.a.createElement(Io,{header:e,color:"var(--base03)",hasContent:!1,isSelected:!1,shouldDisableActions:!0,shouldDisableExplicitWidth:!0,onClick:n(t,e.get("id")),addition:r&&0!==e.get("totalFilteredTimeLoggedRecursive")?Y(e.get("totalFilteredTimeLoggedRecursive")):null})))))}))))}));var El=Object(h.b)((e=>({path:e.org.present.get("path"),searchFilter:e.org.present.getIn(["search","searchFilter"]),searchFilterValid:e.org.present.getIn(["search","searchFilterValid"]),searchFilterSuggestions:e.org.present.getIn(["search","searchFilterSuggestions"])||[],allBookmarks:e.org.present.get("bookmarks"),showClockedTimes:e.org.present.getIn(["search","showClockedTimes"]),clockedTime:e.org.present.getIn(["search","clockedTime"])})),(e=>({org:Object(u.b)(r,e)})))((function(e){const[t,n]=Object(o.useState)("absolute"),{searchFilter:a,searchFilterValid:i,searchFilterSuggestions:r,allBookmarks:s,context:c,showClockedTimes:d,clockedTime:h,activeClocks:u}=e,p=s.get(c),m=p.contains(a),g=i&&0!==a.length;return l.a.createElement(l.a.Fragment,null,"search"===c?l.a.createElement("div",{className:"task-list__modal-title_search"},d?l.a.createElement("span",{title:"Sum of time logged on all search results directly (not including time logged on their children)"},Y(h)):null):l.a.createElement("div",{className:"task-list__modal-title"},l.a.createElement("h2",{className:"agenda__title"},Object(f.capitalize)(c))),u?null:l.a.createElement("div",{className:"search-input-container"},l.a.createElement("div",{className:"search-input-line"},l.a.createElement("datalist",{id:"task-list__datalist-filter"},(0===a.length?p:r).map(((e,t)=>l.a.createElement("option",{key:t,value:e})))),l.a.createElement("div",{className:"search__input-container"},l.a.createElement("input",{type:"text",value:a,autoFocus:!Uo(),autoCapitalize:"none",autoComplete:"off",className:to()("textfield","task-list__filter-input",{"task-list__filter-input--invalid":!!a&&!i}),placeholder:"e.g. -DONE doc|man :simple|easy :assignee:nobody|none",list:"task-list__datalist-filter",onChange:function(t){e.org.setSearchFilterInformation(t.target.value,t.target.selectionStart,c)}})),l.a.createElement("i",{className:to()("fas fa-lg bookmark__icon ",{"fa-star":!m,"fa-trash":m,bookmark__icon__enabled:g}),onClick:function(){m?e.org.deleteBookmark(c,a):g&&e.org.saveBookmark(c,a)}}))),l.a.createElement("div",{className:"task-list__headers-container",style:Vo?void 0:{overflow:"auto"}},l.a.createElement(yl,{onHeaderClick:function(t,n){e.onClose(t,n)},dateDisplayType:t,onToggleDateDisplayType:function(){n("absolute"===t?"relative":"absolute")},context:u?"Clock List":c})))})),wl=(n(363),e=>{let{children:t,shouldIncludeCloseButton:n,onClose:a,maxSize:i=!1}=e;const[r,s]=Object(o.useState)(!1),[c,d]=Object(o.useState)(null);Object(o.useLayoutEffect)((()=>{s(!0)}),[]);const h=Object(o.useRef)(),u=Object(o.useRef)(),p=Object(o.useRef)();Object(o.useLayoutEffect)((()=>{p.current=u.current.offsetHeight}));const m=e=>e.stopPropagation(),g=()=>s(!1),f=e=>h.current=e.targetTouches[0].clientY,b=e=>{if(e.target.classList.contains("drag-handle"))return;const t=h.current>e.targetTouches[0].clientY;t&&u.current.scrollHeight-u.current.scrollTop<=u.current.clientHeight?e.preventDefault():t||0!==u.current.scrollTop||(e.preventDefault(),d(e.targetTouches[0].clientY-h.current))};Object(o.useEffect)((()=>{const e=()=>(s(c<=.3*p.current),void d(null));if(u.current){u.current.addEventListener("touchstart",f),u.current.addEventListener("touchmove",b),u.current.addEventListener("touchend",e),u.current.addEventListener("touchcancel",e);const t=u.current;return()=>{t.removeEventListener("touchstart",f),t.removeEventListener("touchmove",b),t.removeEventListener("touchend",e),t.removeEventListener("touchcancel",e)}}return null}),[u,c]);const y=to()("drawer-outer-container",{"drawer-outer-container--visible":r}),E={offsetY:c||Object(co.spring)(r?0:p.current||window.innerHeight,{stiffness:300})};return l.a.createElement(co.Motion,{style:E,onRest:()=>!r&&a?a():void 0},(e=>{const r={transform:`translateY(${e.offsetY}px)`};return i&&(r.height="92%",r.overflow="none"),l.a.createElement("div",{className:y,onClick:a?g:null},l.a.createElement("div",{onClick:m,className:"drawer-inner-container nice-scroll","data-testid":"drawer",ref:u,style:r},l.a.createElement("div",{className:"drawer__grabber"}),n&&l.a.createElement("button",{className:"fas fa-times fa-lg drawer__close-button",onClick:g}),t))}))});n(364),n(365);class kl extends o.PureComponent{iconWithFFClickCatcher(e){let{className:t,onClick:n,title:a,disabled:i,testId:r=""}=e;return l.a.createElement("div",{title:a,onClick:i?void 0:n,className:"header-action-drawer__ff-click-catcher-container"},l.a.createElement("div",{className:"header-action-drawer__ff-click-catcher"}),l.a.createElement("i",{className:t,"data-testid":r}))}render(){const{onSwitch:e,onTitleClick:t,onDescriptionClick:n,onTagsClick:a,onPropertiesClick:i,onDeadlineClick:r,onScheduledClick:s,onAddNote:o,onRemoveHeader:c,activePopupType:d,editRawValues:h,setEditRawValues:u,restorePreferEditRawValues:p}=this.props;return l.a.createElement("div",{className:"header-action-drawer-container"},l.a.createElement("div",{className:"header-action-drawer__row"},this.iconWithFFClickCatcher({className:"fas fa-pencil-alt fa-lg"+("title-editor"===d?" drawer-action-button--selected":""),onClick:()=>{"title-editor"===d?(e(),u(!h)):p(),t()},title:"Edit title"}),this.iconWithFFClickCatcher({className:"fas fa-edit fa-lg"+("description-editor"===d?" drawer-action-button--selected":""),onClick:()=>{"description-editor"===d?(e(),u(!h)):p(),n()},title:"Edit description",testId:"edit-header-title"}),this.iconWithFFClickCatcher({className:"fas fa-tags fa-lg"+("tags-editor"===d?" drawer-action-button--selected":""),onClick:a,title:"Modify tags",disabled:"tags-editor"===d}),this.iconWithFFClickCatcher({className:"fas fa-list fa-lg"+("property-list-editor"===d?" drawer-action-button--selected":""),onClick:i,title:"Modify properties",disabled:"property-list-editor"===d}),this.iconWithFFClickCatcher({className:"fas fa-calendar-check fa-lg"+("deadline-editor"===d?" drawer-action-button--selected":""),onClick:r,title:"Set deadline datetime",disabled:"deadline-editor"===d}),this.iconWithFFClickCatcher({className:"far fa-calendar-times fa-lg"+("scheduled-editor"===d?" drawer-action-button--selected":""),onClick:s,title:"Set scheduled datetime",disabled:"scheduled-editor"===d}),this.iconWithFFClickCatcher({className:"far fa-sticky-note fa-lg"+("note-editor"===d?" drawer-action-button--selected":""),onClick:o,title:"Add a note",disabled:"note-editor"===d}),this.iconWithFFClickCatcher({className:"fas fa-trash fa-lg"+("note-editor"===d?" drawer-action-button--selected":""),onClick:c,title:"Delete this header",disabled:"note-editor"===d})))}}class vl extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleShowTitleEditModal","handleShowDescriptionEditModal","handleShowTagsModal","handleShowPropertyListEditorModal","handleShowDeadlineModal","handleShowScheduledModal","handleShowNoteModal","handleRemoveHeader"])}handleShowTitleEditModal(){this.props.onSwitch(),this.props.base.activatePopup("title-editor")}handleShowDescriptionEditModal(){this.props.onSwitch(),this.props.org.openHeader(this.props.selectedHeaderId),this.props.base.activatePopup("description-editor")}handleShowTagsModal(){this.props.onSwitch(),this.props.base.activatePopup("tags-editor")}handleShowPropertyListEditorModal(){this.props.onSwitch(),this.props.base.activatePopup("property-list-editor")}handleDeadlineAndScheduledClick(e){const{header:t,selectedHeaderId:n}=this.props,a={DEADLINE:"deadline-editor",SCHEDULED:"scheduled-editor"}[e],i=t.get("planningItems",[]).findIndex((t=>t.get("type")===e));this.props.base.activatePopup(a,{headerId:t.get("id"),planningItemIndex:i}),this.props.org.openHeader(n)}handleShowDeadlineModal(){this.props.onSwitch(),this.handleDeadlineAndScheduledClick("DEADLINE")}handleShowScheduledModal(){this.props.onSwitch(),this.handleDeadlineAndScheduledClick("SCHEDULED")}handleShowNoteModal(){this.props.onSwitch(),this.props.base.activatePopup("note-editor")}handleRemoveHeader(){this.props.base.closePopup(),this.props.org.selectHeader(null),this.props.org.removeHeader(this.props.header.get("id"))}render(){return l.a.createElement("div",{className:"static-action-bar"},l.a.createElement(kl,{activePopupType:this.props.activePopupType,onSwitch:this.props.onSwitch,onTitleClick:this.handleShowTitleEditModal,onDescriptionClick:this.handleShowDescriptionEditModal,onTagsClick:this.handleShowTagsModal,onPropertiesClick:this.handleShowPropertyListEditorModal,onDeadlineClick:this.handleShowDeadlineModal,onScheduledClick:this.handleShowScheduledModal,onAddNote:this.handleShowNoteModal,onRemoveHeader:this.handleRemoveHeader,editRawValues:this.props.editRawValues,setEditRawValues:this.props.setEditRawValues,restorePreferEditRawValues:this.props.restorePreferEditRawValues}))}}var Tl=Object(h.b)((e=>{const t=e.org.present.get("path"),n=e.org.present.getIn(["files",t],Object(y.Map)()),a=e.base.get("activePopup");return{selectedHeaderId:n.get("selectedHeaderId"),header:be(e),activePopupType:a?a.get("type"):null}}),(e=>({org:Object(u.b)(r,e),base:Object(u.b)(a,e)})))(vl);const Sl=[["Select next header","selectNextVisibleHeader","ctrl+down"],["Select previous header","selectPreviousVisibleHeader","ctrl+up"],["Toggle header opened","toggleHeaderOpened","tab"],["Advance todo state","advanceTodo","alt+t"],["Edit title","editTitle","ctrl+h"],["Edit description","editDescription","ctrl+d"],["Exit edit mode","exitEditMode","alt+enter"],["Add header","addHeader","ctrl+enter"],["Remove header","removeHeader","backspace"],["Move header up","moveHeaderUp","alt+up"],["Move header down","moveHeaderDown","alt+down"],["Move header left","moveHeaderLeft","alt+shift+left"],["Move header right","moveHeaderRight","alt+shift+right"],["Undo","undo","ctrl+/"]],_l=e=>Sl.map((t=>{let[n,a,i]=t;return[n,e.get(n,i)]}));n(366),n(367),n(368);const Il=e=>W(e.get("timestamp")).getTime();var Cl=Object(h.b)((e=>{const t=e.org.present.get("files");return{headersForFiles:e.org.present.getIn(["search","filteredHeaders"])||Object(y.Map)(),todoKeywordSetsForFiles:t.map((e=>e.get("todoKeywordSets")))}}),(e=>({org:Object(u.b)(r,e)})))((function(e){const{dateDisplayType:t,onToggleDateDisplayType:n,headersForFiles:a,todoKeywordSetsForFiles:i}=e;Object(o.useEffect)((()=>{e.org.setSearchFilterInformation("",0,"task-list")}),[e.org]);const r=function(e){let{headersForFiles:t,todoKeywordSetsForFiles:n}=e;const a=Object(y.List)().concat(...t.mapEntries((e=>{let[t,n]=e;return[t,n.map((e=>e.set("path",t)))]})).valueSeq()),i=n.map((e=>Ve(e)));return a.filter((e=>e.getIn(["titleLine","todoKeyword"]))).map((e=>[e.get("planningItems").sortBy(Il).first(),e])).sortBy((e=>{let[t,n]=e;return[i.get(n.get("path"))(n.getIn(["titleLine","todoKeyword"])),t?Il(t):Number.MAX_SAFE_INTEGER,n.getIn(["titleLine","rawTitle"])]}))}({headersForFiles:a,todoKeywordSetsForFiles:i});return l.a.createElement("div",{className:"agenda-day__container"},l.a.createElement("div",{className:"agenda-day__headers-container"},r.map((a=>{let[i,r]=a;const s=i?W(i.get("timestamp")):null,c=!!r.getIn(["titleLine","todoKeyword"]),d=to()("task-list__header-planning-date",{"task-list__header-planning-date--overdue":c&&i&&Object(hl.a)(s)});let h=l.a.createElement("div",null);return s&&(h=l.a.createElement("div",{className:"agenda-day__header__planning-item-container"},l.a.createElement("div",{className:"task-list__header-planning-type"},We(i)),l.a.createElement("div",{className:d,onClick:n},"absolute"===t?Object(k.a)(s,"MM/dd"):Re(s),!!i.getIn(["timestamp","startHour"])&&l.a.createElement(o.Fragment,null,l.a.createElement("br",null),Object(k.a)(s,"h:mma"))))),l.a.createElement("div",{key:r.get("id"),className:"agenda-day__header-container"},l.a.createElement("div",{className:"agenda-day__header__header-container"},l.a.createElement(Io,{header:r,color:"var(--base03)",hasContent:!1,isSelected:!1,shouldDisableActions:!0,shouldDisableExplicitWidth:!0,onClick:(u=r.get("path"),p=r.get("id"),()=>e.onHeaderClick(u,p))}),h));var u,p}))))}));var Dl=Object(h.b)((e=>({searchFilter:e.org.present.getIn(["search","searchFilter"])||"",searchFilterValid:e.org.present.getIn(["search","searchFilterValid"]),searchFilterSuggestions:e.org.present.getIn(["search","searchFilterSuggestions"])||[],bookmarks:e.org.present.getIn(["bookmarks","task-list"])})),(e=>({org:Object(u.b)(r,e)})))((function(e){const{searchFilter:t,searchFilterValid:n,searchFilterSuggestions:a,bookmarks:i}=e,r=i.contains(t),s=n&&0!==t.length,[c,d]=Object(o.useState)("absolute");return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"task-list__modal-title_search"}),l.a.createElement("div",{className:"search-input-container"},l.a.createElement("div",{className:"search-input-line"},l.a.createElement("datalist",{id:"task-list__datalist-filter"},(0===t.length?i:a).map(((e,t)=>l.a.createElement("option",{key:t,value:e})))),l.a.createElement("div",{className:"search__input-container"},l.a.createElement("input",{type:"text",value:t,autoFocus:!Uo(),autoCapitalize:"none",autoComplete:"off",className:to()("textfield","task-list__filter-input",{"task-list__filter-input--invalid":!!t&&!n}),placeholder:"e.g. -DONE doc|man :simple|easy :assignee:nobody|none",list:"task-list__datalist-filter",onChange:function(t){e.org.setSearchFilterInformation(t.target.value,t.target.selectionStart,"task-list")}})),l.a.createElement("i",{className:to()("fas fa-lg bookmark__icon ",{"fa-star":!r,"fa-trash":r,bookmark__icon__enabled:s}),onClick:function(){r?e.org.deleteBookmark("task-list",t):s&&e.org.saveBookmark("task-list",t)}}))),l.a.createElement("div",{className:"task-list__headers-container",style:Vo?void 0:{overflow:"auto"}},l.a.createElement(Cl,{onHeaderClick:function(t,n){e.onClose(),e.org.selectHeaderAndOpenParents(t,n)},dateDisplayType:c,onToggleDateDisplayType:function(){d("absolute"===c?"relative":"absolute")}})))}));var Al=Object(h.b)((e=>{const t=e.org.present.get("path"),n=e.org.present.get("files"),a=e.org.present.get("fileSettings"),i=yi(n,a,t,"includeInSearch",!1),r=Object.values(i.map((e=>e.get("headers").size?e.get("activeClocks"):0)).toJS()).reduce(((e,t)=>"number"===typeof t?e+t:e),0);return{finderTab:e.base.get("finderTab"),activeClocks:r}}),(e=>({org:Object(u.b)(r,e),base:Object(u.b)(a,e)})))((function(e){const{finderTab:t,onClose:n,headers:a,activeClocks:i}=e;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"agenda__tab-container"},l.a.createElement(Xo,{buttons:i?["Search","Task List","Clock List"]:["Search","Task List"],selectedButton:t,onSelect:function(t){e.base.setFinderTab(t)},useEqualWidthTabs:!0})),function(t){if(i||"Clock List"!==t)switch(t){case"Search":return l.a.createElement(El,{context:"search",onClose:n});case"Task List":return l.a.createElement(Dl,{headers:a,onClose:n});case"Clock List":return l.a.createElement(El,{activeClocks:i,context:"search",onClose:n});default:return l.a.createElement("h2",null,"Error")}else e.base.setFinderTab("Search")}(t),l.a.createElement("br",null))}));class Ol extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleSelectNextVisibleHeaderHotKey","handleSelectPreviousVisibleHeaderHotKey","handleToggleHeaderOpenedHotKey","handleAdvanceTodoHotKey","handleEditTitleHotKey","handleEditDescriptionHotKey","handleExitEditModeHotKey","handleAddHeaderHotKey","handleCreateFirstHeader","handleRemoveHeaderHotKey","handleMoveHeaderUpHotKey","handleMoveHeaderDownHotKey","handleMoveHeaderLeftHotKey","handleMoveHeaderRightHotKey","handleUndoHotKey","handleContainerRef","handleCapture","handlePopupClose","handleSearchPopupClose","handleRefilePopupClose","handleTitlePopupClose","saveTitle","handleTodoChange","handleDescriptionPopupClose","handleTablePopupClose","handleSyncConfirmationPull","handleSyncConfirmationPush","handleSyncConfirmationCancel","handleTagsChange","handlePropertyListItemsChange","getPopupCloseAction","getPopupSwitchAction","checkPopupAndHeader","checkPopup"]),this.state={hasUncaughtError:!1,editRawValues:e.preferEditRawValues}}componentDidMount(){const{staticFile:e,path:t}=this.props;e?(this.props.org.setPath(te+e),"changelog"===e&&(this.props.base.setHasUnseenChangelog(!1),ne().then((e=>{this.props.base.setLastSeenChangelogHeader(e)}))),setTimeout((()=>document.querySelector(".App").scrollTop=0),0)):b.a.isEmpty(t)||(this.props.fileIsLoaded(t)?this.props.org.sync({path:t,shouldSuppressMessages:!0}):this.props.syncBackend.downloadFile(t),this.props.org.setPath(t)),this.activatePopup()}activatePopup(){const e=window.location.hash.substr(1);b.a.isEmpty(e)||this.props.base.activatePopup(e)}componentWillUnmount(){const{staticFile:e}=this.props;e?this.props.base.unloadStaticFile():this.props.org.resetFileDisplay()}componentDidUpdate(e){const{headers:t,pendingCapture:n}=this.props;n&&t&&t.size>0&&this.props.org.insertPendingCapture();const{path:a}=this.props;b.a.isEmpty(a)||a===e.path||(this.props.syncBackend.downloadFile(a),this.props.org.setPath(a))}componentDidCatch(){this.setState({hasUncaughtError:!0})}handleSelectNextVisibleHeaderHotKey(){this.props.org.selectNextVisibleHeader()}handleSelectPreviousVisibleHeaderHotKey(){this.props.org.selectPreviousVisibleHeader()}handleToggleHeaderOpenedHotKey(){const{selectedHeaderId:e,closeSubheadersRecursively:t}=this.props;e&&this.props.org.toggleHeaderOpened(e,t)}handleAdvanceTodoHotKey(){this.props.org.advanceTodoState(null,this.props.shouldLogIntoDrawer)}handleEditTitleHotKey(){this.props.base.activatePopup("title-editor")}handleEditDescriptionHotKey(){this.props.base.activatePopup("description-editor")}handleExitEditModeHotKey(){this.getPopupSwitchAction(this.props.activePopupType)(...this.state.popupCloseActionValuesAccessor?this.state.popupCloseActionValuesAccessor():[]),this.props.base.closePopup(),this.container.focus()}handleAddHeaderHotKey(){this.props.org.addHeaderAndEdit(this.props.selectedHeaderId)}handleCreateFirstHeader(){this.props.org.createFirstHeader()}handleRemoveHeaderHotKey(){const{selectedHeaderId:e}=this.props;this.props.org.selectNextSiblingHeader(e),this.props.org.removeHeader(e)}handleMoveHeaderUpHotKey(){this.props.org.moveHeaderUp(this.props.selectedHeaderId)}handleMoveHeaderDownHotKey(){this.props.org.moveHeaderDown(this.props.selectedHeaderId)}handleMoveHeaderLeftHotKey(){this.props.org.moveHeaderLeft(this.props.selectedHeaderId)}handleMoveHeaderRightHotKey(){this.props.org.moveHeaderRight(this.props.selectedHeaderId)}handleUndoHotKey(){this.props.undo.undo()}handleContainerRef(e){this.container=e,this.container&&this.container.focus()}handleCapture(e,t,n){this.props.org.insertCapture(e,t,n)}handlePopupClose(){this.props.base.closePopup()}handleSearchPopupClose(e,t){this.props.base.closePopup(),e&&t&&this.props.org.selectHeaderAndOpenParents(e,t)}handleRefilePopupClose(e,t){if(this.props.base.closePopup(),t){const{loadedPath:n,selectedHeaderId:a}=this.props;this.props.org.refileSubtree(n,a,e,t)}}saveTitle(e){const{selectedHeader:t}=this.props;this.state.editRawValues?X(t.toJS(),!1)!==e&&this.props.org.updateHeaderTitle(t.get("id"),e):t.getIn(["titleLine","rawTitle"])!==e&&this.props.org.updateHeaderTitle(t.get("id"),X(t.setIn(["titleLine","rawTitle"],e).toJS(),!1))}handleTitlePopupClose(e){this.saveTitle(e),this.props.base.closePopup()}handleDescriptionPopupClose(e){const{selectedHeader:t}=this.props;this.state.editRawValues?Q(t,!1,this.props.dontIndent)!==e&&this.props.org.updateHeaderDescription(t.get("id"),e):t.get("rawDescription")!==e&&this.props.org.updateHeaderDescription(t.get("id"),Q(t.set("rawDescription",e),!1,this.props.dontIndent)),this.props.base.closePopup()}handleTablePopupClose(){this.props.base.closePopup(),this.props.org.setSelectedTableCellId(null),this.props.org.setSelectedTableId(null)}handleSyncConfirmationPull(e){this.props.org.sync({path:e,forceAction:"pull"}),this.props.base.closePopup()}handleSyncConfirmationPush(e){this.props.org.sync({path:e,forceAction:"push"}),this.props.base.closePopup()}handleSyncConfirmationCancel(){this.props.base.closePopup()}handleTagsChange(e){this.props.org.setHeaderTags(this.props.selectedHeaderId,e)}handlePropertyListItemsChange(e){this.props.org.updatePropertyListItems(this.props.selectedHeaderId,e)}handleTimestampChange(e){return e.get("timestampId")?t=>this.props.org.updateTimestampWithId(e.get("timestampId"),t):void 0!==e.get("logEntryIndex")?t=>this.props.org.updateLogEntryTime(e.get("headerId"),e.get("logEntryIndex"),e.get("entryType"),t.get("firstTimestamp")):t=>this.props.org.updatePlanningItemTimestamp(e.get("headerId"),e.get("planningItemIndex"),t.get("firstTimestamp"))}handleTodoChange(e){this.props.org.setTodoState(this.props.selectedHeaderId,e,this.props.shouldLogIntoDrawer)}getPopupSwitchAction(e){switch(e){case"title-editor":return e=>this.handleTitlePopupClose(e);case"description-editor":return e=>this.handleDescriptionPopupClose(e);default:return()=>{}}}getPopupCloseAction(e){switch(e){case"search":return this.handleSearchPopupClose;case"refile":return this.handleRefilePopupClose;case"title-editor":return this.handleTitlePopupClose;case"description-editor":return this.handleDescriptionPopupClose;case"table-editor":return this.handleTablePopupClose;default:return this.handlePopupClose}}getPopupMaxSize(e){switch(e){case"agenda":case"task-list":case"search":case"refile":return!0;default:return!1}}renderActivePopup(e){const{activePopupType:t,activePopupData:n,captureTemplates:a,files:i,headers:r,selectedHeader:s,shouldDisableActions:o,todoKeywordSets:c}=this.props;switch(t){case"sync-confirmation":return l.a.createElement(Jo,{lastServerModifiedAt:n.get("lastServerModifiedAt"),lastSyncAt:n.get("lastSyncAt"),path:n.get("path"),onPull:()=>this.handleSyncConfirmationPull(n.get("path")),onPush:()=>this.handleSyncConfirmationPush(n.get("path")),onCancel:this.handleSyncConfirmationCancel});case"capture":const d=a.find((e=>e.get("id")===n.get("templateId"))),h=d.get("file");let u=r;if(h){const e=i.get(h);u=e?e.get("headers"):Object(y.List)()}return l.a.createElement(Yo,{template:d,headers:u,onCapture:this.handleCapture,onClose:this.getPopupCloseAction(t)});case"tags-editor":const p=Me(r);return l.a.createElement(qo,{header:s,allTags:p,onChange:this.handleTagsChange});case"timestamp-editor":case"scheduled-editor":case"deadline-editor":let m=null;return n.get("timestampId")?m=((e,t)=>e.map((e=>Le(e.getIn(["titleLine","title"]),t)||Le(e.get("description"),t)||Le(e.get("logNotes"),t)||e.get("propertyListItems").map((e=>Le(e.get("value"),t))).filter((e=>e)).first())).find((e=>e)))(r,n.get("timestampId")):void 0!==n.get("logEntryIndex")?m=Object(y.fromJS)({firstTimestamp:re(r,n.get("headerId")).getIn(["logBookEntries",n.get("logEntryIndex"),n.get("entryType")])}):("scheduled-editor"!==t&&"deadline-editor"!==t||-1!==n.get("planningItemIndex"))&&(m=Object(y.fromJS)({firstTimestamp:re(r,n.get("headerId")).getIn(["planningItems",n.get("planningItemIndex"),"timestamp"])})),l.a.createElement(el,{headerId:n.get("headerId"),timestamp:m,timestampId:n.get("timestampId"),popupType:t,planningItemIndex:n.get("planningItemIndex"),singleTimestampOnly:!n.get("timestampId"),onClose:this.getPopupCloseAction(t),onChange:this.handleTimestampChange(n)});case"property-list-editor":const g=Fe(r);return s?l.a.createElement(tl,{onChange:this.handlePropertyListItemsChange,propertyListItems:s.get("propertyListItems"),allOrgProperties:g}):null;case"agenda":return l.a.createElement(bl,{headers:r,onClose:this.getPopupCloseAction(t)});case"search":return l.a.createElement(Al,{headers:r,onClose:this.getPopupCloseAction(t)});case"refile":return l.a.createElement(El,{context:"refile",onClose:this.getPopupCloseAction(t)});case"title-editor":return l.a.createElement(nl,{editRawValues:this.state.editRawValues,todoKeywordSets:c,onClose:this.getPopupCloseAction("title-editor"),saveTitle:this.saveTitle,onTodoClicked:this.handleTodoChange,header:s,setPopupCloseActionValuesAccessor:e});case"description-editor":return l.a.createElement(il,{editRawValues:this.state.editRawValues,header:s,dontIndent:this.props.dontIndent,setPopupCloseActionValuesAccessor:e});case"table-editor":return l.a.createElement(ol,{shouldDisableActions:o});case"note-editor":return l.a.createElement(cl,{shouldDisableActions:o});default:return null}}checkPopupAndHeader(e){return t=>{!this.props.selectedHeader||this.props.activePopupType||this.props.shouldDisableActions||e(t)}}checkPopup(e){return t=>{this.props.activePopupType||e(t)}}render(){const{headers:e,linesBeforeHeadings:t,shouldDisableDirtyIndicator:n,shouldDisableSyncButtons:a,shouldDisableActions:i,isDirty:r,parsingErrorMessage:s,path:c,staticFile:d,customKeybindings:h,orgFileErrorMessage:u,activePopupType:p}=this.props;if(!c&&!d)return l.a.createElement($s.a,{to:"/files"});if(this.state.hasUncaughtError)return l.a.createElement("div",{className:"error-message-container"},"Uh oh, you ran into a bug!",l.a.createElement("br",null),l.a.createElement("br",null),"This was probably the result of an error in attempting to parse your org file. It'd be super helpful if you could"," ",l.a.createElement(no,{href:"https://github.com/200ok-ch/organice/issues/new"},"create an issue")," ","(and include the org file if possible!)");if(u)return l.a.createElement("div",{className:"error-message-container"},u);if(!e)return l.a.createElement("div",null);const m=b.a.fromPairs((e=>Sl.map((t=>{let[n,a,i]=t;return[a,e.get(n,i)]})))(h)),g=e=>t=>{t.preventDefault(),e(t)},f={selectNextVisibleHeader:this.checkPopup(g(this.handleSelectNextVisibleHeaderHotKey)),selectPreviousVisibleHeader:this.checkPopup(g(this.handleSelectPreviousVisibleHeaderHotKey)),toggleHeaderOpened:this.checkPopup(g(this.handleToggleHeaderOpenedHotKey)),advanceTodo:this.checkPopupAndHeader(g(this.handleAdvanceTodoHotKey)),editTitle:this.checkPopupAndHeader(g(this.handleEditTitleHotKey)),editDescription:this.checkPopupAndHeader(g(this.handleEditDescriptionHotKey)),exitEditMode:g(this.handleExitEditModeHotKey),addHeader:this.checkPopupAndHeader(g(this.handleAddHeaderHotKey)),removeHeader:this.checkPopupAndHeader(g(this.handleRemoveHeaderHotKey)),moveHeaderUp:this.checkPopupAndHeader(g(this.handleMoveHeaderUpHotKey)),moveHeaderDown:this.checkPopupAndHeader(g(this.handleMoveHeaderDownHotKey)),moveHeaderLeft:this.checkPopupAndHeader(g(this.handleMoveHeaderLeftHotKey)),moveHeaderRight:this.checkPopupAndHeader(g(this.handleMoveHeaderRightHotKey)),undo:this.checkPopupAndHeader(g(this.handleUndoHotKey))};return l.a.createElement(uo.GlobalHotKeys,{keyMap:m,handlers:f},l.a.createElement("div",{className:"org-file-container",tabIndex:"-1",ref:this.handleContainerRef},0===e.size?l.a.createElement("div",{className:"org-file__parsing-error-message"},l.a.createElement("h3",null,"This file has no headlines"),s?l.a.createElement(o.Fragment,null,s):l.a.createElement(o.Fragment,null,0===e.size&&t.size>0?l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,"Yes, your file has content. Do not worry, it is still there! "),l.a.createElement("p",null,"However, interacting with Org files in organice happens on a per headline basis. To use organice with this file, please create a new headline with the button below. The existing content is then put into the description of this new header.")):l.a.createElement("p",null),l.a.createElement("p",null,"Interact with your file by creating the first headline."),l.a.createElement("p",null,l.a.createElement("button",{className:"btn",onClick:this.handleCreateFirstHeader},"Create headline")))):l.a.createElement(Mo,{shouldDisableActions:i}),r&&!n&&l.a.createElement("div",{className:"dirty-indicator"},"Unpushed changes"),!i&&l.a.createElement(Fo,{shouldDisableSyncButtons:a,staticFile:d}),p?l.a.createElement(wl,{onClose:()=>{this.getPopupCloseAction(p)(...this.state.popupCloseActionValuesAccessor?this.state.popupCloseActionValuesAccessor():[]),this.setState({editRawValues:this.props.preferEditRawValues}),this.container.focus()},maxSize:this.getPopupMaxSize(p)},this.renderActivePopup((e=>{this.setState({popupCloseActionValuesAccessor:e})})),("title-editor"===p||"description-editor"===p||"tags-editor"===p||"property-list-editor"===p||"timestamp-editor"===p||"scheduled-editor"===p||"deadline-editor"===p||"note-editor"===p)&&l.a.createElement(Tl,{onSwitch:()=>{this.getPopupSwitchAction(p)(...this.state.popupCloseActionValuesAccessor?this.state.popupCloseActionValuesAccessor():[])},editRawValues:this.state.editRawValues,setEditRawValues:e=>this.setState({editRawValues:e}),restorePreferEditRawValues:()=>this.setState({editRawValues:this.props.preferEditRawValues})})):null))}}var Nl=Object(h.b)((e=>{const t=e.org.present.get("files"),n=e.org.present.get("path"),a=y.Set.fromKeys(t),i=e.org.present.getIn(["files",n],Object(y.Map)()),r=i.get("headers"),s=i.get("linesBeforeHeadings"),o=i.get("selectedHeaderId",null),l=e.base.get("activePopup",Object(y.Map)());return{loadedPath:n,files:t,headers:r,linesBeforeHeadings:s,selectedHeaderId:o,isDirty:i.get("isDirty"),fileIsLoaded:e=>a.includes(e),selectedHeader:r&&r.find((e=>e.get("id")===o)),customKeybindings:e.base.get("customKeybindings"),dontIndent:e.base.get("shouldNotIndentOnExport"),shouldLogIntoDrawer:e.base.get("shouldLogIntoDrawer"),shouldLiveSync:e.base.get("shouldLiveSync"),showDeadlineDisplay:e.base.get("showDeadlineDisplay"),activePopupType:l?l.get("type"):null,activePopupData:l?l.get("data"):null,captureTemplates:e.capture.get("captureTemplates").concat(Ot),pendingCapture:e.org.present.get("pendingCapture"),closeSubheadersRecursively:e.base.get("closeSubheadersRecursively"),orgFileErrorMessage:e.org.present.get("orgFileErrorMessage"),preferEditRawValues:e.base.get("preferEditRawValues"),todoKeywordSets:i.get("todoKeywordSets")}}),(e=>({base:Object(u.b)(a,e),syncBackend:Object(u.b)(s,e),org:Object(u.b)(r,e),undo:Object(u.b)(m.ActionCreators,e),capture:Object(u.b)(i,e)})))(Ol);n(369);var Pl=Object($s.i)(Object(h.b)((e=>{const t=e.base.get("agendaStartOnWeekday");return{fontSize:e.base.get("fontSize")||"Regular",bulletStyle:e.base.get("bulletStyle"),shouldTapTodoToAdvance:e.base.get("shouldTapTodoToAdvance"),editorDescriptionHeightValue:e.base.get("editorDescriptionHeightValue")||8,agendaDefaultDeadlineDelayValue:e.base.get("agendaDefaultDeadlineDelayValue")||5,agendaDefaultDeadlineDelayUnit:e.base.get("agendaDefaultDeadlineDelayUnit")||"d",agendaStartOnWeekday:null==t?1:+t,shouldStoreSettingsInSyncBackend:e.base.get("shouldStoreSettingsInSyncBackend"),shouldLiveSync:e.base.get("shouldLiveSync"),showDeadlineDisplay:e.base.get("showDeadlineDisplay"),shouldSyncOnBecomingVisibile:e.base.get("shouldSyncOnBecomingVisibile"),shouldShowTitleInOrgFile:e.base.get("shouldShowTitleInOrgFile"),shouldLogIntoDrawer:e.base.get("shouldLogIntoDrawer"),closeSubheadersRecursively:e.base.get("closeSubheadersRecursively"),shouldNotIndentOnExport:e.base.get("shouldNotIndentOnExport"),hasUnseenChangelog:e.base.get("hasUnseenChangelog"),showClockDisplay:e.org.present.get("showClockDisplay"),preferEditRawValues:e.base.get("preferEditRawValues"),colorScheme:e.base.get("colorScheme"),theme:e.base.get("theme")}}),(e=>({syncBackend:Object(u.b)(s,e),base:Object(u.b)(a,e),org:Object(u.b)(r,e)})))((e=>{let{fontSize:t,bulletStyle:n,shouldTapTodoToAdvance:a,shouldStoreSettingsInSyncBackend:i,shouldLiveSync:r,showDeadlineDisplay:s,shouldSyncOnBecomingVisibile:o,shouldShowTitleInOrgFile:c,shouldLogIntoDrawer:d,closeSubheadersRecursively:h,shouldNotIndentOnExport:u,editorDescriptionHeightValue:p,agendaDefaultDeadlineDelayValue:m,agendaDefaultDeadlineDelayUnit:g,agendaStartOnWeekday:f,hasUnseenChangelog:b,syncBackend:y,preferEditRawValues:E,showClockDisplay:w,colorScheme:k,theme:v,base:T,org:S}=e;const _=Object($s.g)(),I=window.location.origin.match(/staging.organice.200ok.ch/)?"https://staging.organice.200ok.ch":"https://organice.200ok.ch";return l.a.createElement("div",{className:"settings-container"},l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Font size"),l.a.createElement(Xo,{buttons:["Regular","Large"],selectedButton:t,onSelect:e=>T.setFontSize(e)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Color scheme"),l.a.createElement(Xo,{buttons:["OS","Light","Dark"],selectedButton:k,onSelect:e=>T.setColorScheme(e)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Theme"),l.a.createElement(Xo,{buttons:["Solarized","One","Gruvbox","Smyck","Code"],selectedButton:v,onSelect:e=>T.setTheme(e)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Bullet style"),l.a.createElement(Xo,{buttons:["Classic","Fancy"],selectedButton:n,onSelect:e=>T.setBulletStyle(e)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Tap TODO to advance state"),l.a.createElement(Ko,{isEnabled:a,onToggle:()=>T.setShouldTapTodoToAdvance(!a)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Live sync",l.a.createElement("div",{className:"setting-label__description"},"If enabled, changes are automatically pushed to the sync backend as you make them.")),l.a.createElement(Ko,{isEnabled:r,onToggle:()=>T.setShouldLiveSync(!r)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Sync on application becoming visible",l.a.createElement("div",{className:"setting-label__description"},"If enabled, the current org file is pulled from the sync backend when the browser tab becomes visible. This prevents you from having a stale file before starting to make changes to it.")),l.a.createElement(Ko,{isEnabled:o,onToggle:()=>T.setShouldSyncOnBecomingVisibile(!o)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Show Org filename as Title",l.a.createElement("div",{className:"setting-label__description"},"When in an Org file view, it shows the filename in the HeaderBar.")),l.a.createElement(Ko,{isEnabled:c,onToggle:()=>T.setShouldShowTitleInOrgFile(!c)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Log into LOGBOOK drawer when item repeats",l.a.createElement("div",{className:"setting-label__description"},"Log TODO state changes (currently only for repeating items) into the LOGBOOK drawer instead of into the body of the heading (default). See the Orgmode documentation on"," ",l.a.createElement(no,{href:"https://www.gnu.org/software/emacs/manual/html_node/org/Tracking-TODO-state-changes.html"},l.a.createElement("code",null,"org-log-into-drawer"))," ","for more information.")),l.a.createElement(Ko,{isEnabled:d,onToggle:()=>T.setShouldLogIntoDrawer(!d)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"When folding a header, fold all subheaders too",l.a.createElement("div",{className:"setting-label__description"},"When folding a header, fold recursively all its subheaders, so that when the header is reopened all subheaders are folded, regardless of their state prior to folding. This is the default in Emacs Org mode. If this turned off, the fold-state of the subheaders is preserved when the header is unfolded.")),l.a.createElement(Ko,{isEnabled:h,onToggle:()=>T.setCloseSubheadersRecursively(!h)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Disable hard indent on Org export",l.a.createElement("div",{className:"setting-label__description"},"By default, the metadata body (including deadlines and drawers) of an exported org heading is indented according to its level. If instead you prefer to keep your body text flush-left, i.e."," ",l.a.createElement(no,{href:"https://orgmode.org/manual/Hard-indentation.html"},l.a.createElement("code",null,"(setq org-adapt-indentation nil)")),", then activate this setting. The raw content text is left unchanged.")),l.a.createElement(Ko,{isEnabled:u,onToggle:()=>T.setShouldNotIndentOnExport(!u)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Store settings in sync backend",l.a.createElement("div",{className:"setting-label__description"},"Store settings and keyboard shortcuts in a .organice-config.json file in your sync backend to sync between multiple devices.")),l.a.createElement(Ko,{isEnabled:i,onToggle:()=>T.setShouldStoreSettingsInSyncBackend(!i)})),l.a.createElement("div",{className:"setting-container setting-container--vertical"},l.a.createElement("div",{className:"setting-label"},"Default DEADLINE warning period"),l.a.createElement("div",{className:"default-deadline-warning-container"},l.a.createElement("input",{type:"number",min:"0",className:"textfield default-deadline-value-textfield",value:m,onChange:e=>T.setAgendaDefaultDeadlineDelayValue(e.target.value)}),l.a.createElement(Xo,{buttons:"hdwmy".split(""),selectedButton:g,onSelect:e=>T.setAgendaDefaultDeadlineDelayUnit(e)}))),l.a.createElement("div",{className:"setting-container setting-container--vertical"},l.a.createElement("div",{className:"setting-label"},"Description editor height"),l.a.createElement("div",{className:"setting-label__description"},"This setting controls the height of the description editor on computers only. The height will be limited to ensure that all buttons are always visible. On mobile devices this setting is ignored and the editor will always be 8 rows high."),l.a.createElement("div",{className:"default-deadline-warning-container"},l.a.createElement("input",{type:"number",min:"2",className:"textfield default-deadline-value-textfield",value:p,onChange:e=>T.setEditorDescriptionHeightValue(e.target.value)}))),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Start of week for weekly agenda",l.a.createElement("div",{className:"setting-label__description"},"Akin to"," ",l.a.createElement(no,{href:"https://orgmode.org/manual/Weekly_002fdaily-agenda.html"},l.a.createElement("code",null,"org-agenda-start-on-weekday")))),l.a.createElement(Xo,{buttons:["S","M","T","W","T","F","S","Today"],values:[0,1,2,3,4,5,6,-1],titles:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],selectedButton:f,onSelect:e=>T.setAgendaStartOnWeekday(e)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Display time summaries",l.a.createElement("div",{className:"setting-label__description"},"This puts overlays at the end of each headline, showing the total time recorded under that heading, including the time of any subheadings.")),l.a.createElement(Ko,{isEnabled:w,onToggle:()=>S.setShowClockDisplay(!w)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Show Deadline Display",l.a.createElement("div",{className:"setting-label__description"},"If enabled, the deadline will displayed on each header line.")),l.a.createElement(Ko,{isEnabled:s,onToggle:()=>T.setShowDeadlineDisplay(!s)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Prefer raw values",l.a.createElement("div",{className:"setting-label__description"},'When editing title or description of a header, you can switch between editing the text part or the full content (including text representation of todo keywords, tags, schedule items, properties etc.) by clicking the "edit title" or "edit description" icon in the popup. This option allows you to view the full content first instead of on a second click.')),l.a.createElement(Ko,{isEnabled:E,onToggle:()=>T.setPreferEditRawValues(!E)})),l.a.createElement("div",{className:"settings-buttons-container"},l.a.createElement("button",{className:"btn settings-btn",onClick:()=>T.pushModalPage("capture_templates_editor")},"Capture templates"),l.a.createElement("button",{className:"btn settings-btn",onClick:()=>T.pushModalPage("keyboard_shortcuts_editor")},"Keyboard shortcuts"),l.a.createElement("button",{className:"btn settings-btn",onClick:()=>T.pushModalPage("file_settings_editor")},"File settings"),l.a.createElement("hr",{className:"settings-button-separator"}),l.a.createElement(_s.b,{to:"/changelog",className:"btn settings-btn"},"Changelog",b&&l.a.createElement("div",{className:"changelog-badge-container"},l.a.createElement("i",{className:"fas fa-gift"}),"\xa0 What's New?")),l.a.createElement(_s.b,{to:"/sample",className:"btn settings-btn"},"Help"),l.a.createElement("button",{className:"btn settings-btn"},l.a.createElement(no,{href:`${I}/documentation.html`},"Documentation",l.a.createElement("i",{className:"fas fa-external-link-alt fa-sm"}))," "),l.a.createElement("button",{className:"btn settings-btn"},l.a.createElement(no,{href:"https://github.com/200ok-ch/organice"},"Github repo",l.a.createElement("i",{className:"fas fa-external-link-alt fa-sm"}))," "),l.a.createElement("hr",{className:"settings-button-separator"}),l.a.createElement("button",{className:"btn settings-btn",onClick:()=>{window.confirm("Are you sure you want to sign out?")&&(y.signOut(),_.push("/"))}},"Sign out")))})));n(370);class Ll extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleRebindClick","handleKeyPress"]),this.state={isEditMode:!1}}componentDidMount(){this.rebindArea.addEventListener("blur",(()=>this.setState({isEditMode:!1})))}handleRebindClick(){this.setState({isEditMode:!0}),document.addEventListener("keypress",this.handleKeyPress)}handleKeyPress(e){this.setState({isEditMode:!1}),document.removeEventListener("keypress",this.handleKeyPress);let t=null;if(t=e.code.startsWith("Key")?e.code.substr(3).toLowerCase():e.code.startsWith("Digit")?e.code.substr(5):{Minus:"-",Equal:"=",Backspace:"backspace",Enter:"enter",Return:"return",Tab:"tab",BracketLeft:"[",BracketRight:"]",Semicolon:";",Quote:'"',Backslash:"\\",Comma:",",Period:".",Slash:"/"}[e.code],!t)return;const n=[["ctrlKey","ctrl"],["altKey","alt"],["metaKey","meta"],["shiftKey","shift"]].filter((t=>{let[n,a]=t;return e[n]})).map((e=>{let[t,n]=e;return n})).join("+"),a=`${n}${n?"+":""}${t}`;this.props.onBindingChange(this.props.name,a)}symbolizeKeybinding(e){if(!e)return"";return[["ctrl","^"],["alt","\u2325"],["option","\u2325"],["command","\u2318"],["meta","\u2318"],["shift","\u21e7"],["backspace","\u232b"],["return","\u23ce"],["enter","\u23ce"],["left","\u2190"],["right","\u2192"],["up","\u2191"],["down","\u2193"]].reduce(((e,t)=>{let[n,a]=t;return e.replace(RegExp(`${n}\\+?`),a)}),e)}render(){const{name:e,binding:t}=this.props,{isEditMode:n}=this.state,a=to()("keyboard-shortcut-container__shortcut-key",{"keyboard-shortcut-container__shortcut-key--edit-mode":n});return l.a.createElement("div",{className:"keyboard-shortcut-container"},l.a.createElement("div",{className:"keyboard-shortcut-container__shortcut-name"},e),l.a.createElement("div",{className:a,onClick:this.handleRebindClick,tabIndex:"-1",ref:e=>this.rebindArea=e},n?"...":this.symbolizeKeybinding(t)))}}n(371);var Rl=Object($s.i)(Object(h.b)((e=>({customKeybindings:e.base.get("customKeybindings")||Object(y.Map)()})),(e=>({base:Object(u.b)(a,e)})))((e=>{let{customKeybindings:t,base:n}=e;const a=(e,a)=>{const i=_l(t).filter((e=>{let[t,n]=e;return n===a}))[0];i?alert(`That binding is already in use for "${i[0]}"`):n.setCustomKeybinding(e,a)};return l.a.createElement("div",{className:"keyboard-shortcuts-editor-container"},_l(t).map((e=>{let[t,n]=e;return l.a.createElement(Ll,{key:t,name:t,binding:n,onBindingChange:a})})))}))),xl=(n(372),n(373),e=>{let{template:t,index:n,onFieldPathUpdate:a,onAddNewTemplateOrgFileAvailability:i,onRemoveTemplateOrgFileAvailability:r,onAddNewTemplateHeaderPath:s,onRemoveTemplateHeaderPath:c,onDeleteTemplate:d,syncBackendType:h,loadedFilePaths:u}=e;const[p,m]=Object(o.useState)(!!t.get("description")),g=()=>m(!p),f=e=>n=>a(t.get("id"),[e],n.target.value),b=()=>a(t.get("id"),["isAvailableInAllOrgFiles"],!t.get("isAvailableInAllOrgFiles")),y=()=>a(t.get("id"),["shouldPrepend"],!t.get("shouldPrepend")),E=()=>{i(t.get("id"))},w=e=>()=>r(t.get("id"),e),k=e=>n=>a(t.get("id"),["orgFilesWhereAvailable",e],n.target.value),v=()=>s(t.get("id")),T=e=>()=>c(t.get("id"),e),S=e=>n=>a(t.get("id"),["headerPaths",e],n.target.value),_=()=>{window.confirm(`Are you sure you want to delete the "${t.get("description")}" template?`)&&d(t.get("id"))},I=to()("fas fa-2x fa-caret-right capture-template-container__header__caret",{"capture-template-container__header__caret--rotated":!p});return l.a.createElement(Is.b,{draggableId:`capture-template--${t.get("id")}`,index:n},((e,n)=>l.a.createElement("div",Object.assign({className:to()("capture-template-container",{"capture-template-container--dragging":n.isDragging}),ref:e.innerRef},e.draggableProps),l.a.createElement("div",{className:"capture-template-container__header",onClick:g},l.a.createElement("i",{className:I}),l.a.createElement(so,{iconName:t.get("iconName"),letter:t.get("letter"),onClick:()=>{},style:{marginRight:20}}),l.a.createElement("span",{className:"capture-template-container__header__title"},t.get("description")),l.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg capture-template-container__header__drag-handle"},e.dragHandleProps))),l.a.createElement(po.UnmountClosed,{isOpened:!p,springConfig:{stiffness:300}},l.a.createElement("div",{className:"capture-template-container__content"},(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Description:"),l.a.createElement("input",{type:"text",className:"textfield",value:e.get("description",""),onChange:f("description")}))))(t),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Letter:"),l.a.createElement("input",{type:"text",className:"textfield capture-template__letter-textfield",maxLength:"1",value:e.get("letter",""),onChange:f("letter"),autoCapitalize:"none"})),l.a.createElement("div",{className:"capture-template__field__or-container"},l.a.createElement("div",{className:"capture-template__field__or-line"}),l.a.createElement("div",{className:"capture-template__field__or"},"or"),l.a.createElement("div",{className:"capture-template__field__or-line"})),l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Icon name:"),l.a.createElement("input",{type:"text",className:"textfield",value:e.get("iconName"),onChange:f("iconName"),autoCapitalize:"none",autoCorrect:"none"})),l.a.createElement("div",{className:"capture-template__help-text"},"Instead of a letter, you can specify the name of any free Font Awesome icon (like lemon or calendar-plus) to use as the capture icon. You can search the available icons"," ",l.a.createElement(no,{href:"https://fontawesome.com/icons?d=gallery&s=solid&m=free"},"here"),".")))(t),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Available in all org files?"),l.a.createElement(Ko,{isEnabled:e.get("isAvailableInAllOrgFiles"),onToggle:b})),l.a.createElement("div",{className:"capture-template__help-text"},"You can make this capture template available in all org files, or just the ones you specify.","Dropbox"===h&&l.a.createElement(o.Fragment,null," ","Specify full paths starting from the root of your Dropbox, like"," ",l.a.createElement("code",null,"/org/todo.org"))),l.a.createElement(po.UnmountClosed,{isOpened:!e.get("isAvailableInAllOrgFiles"),springConfig:{stiffness:300}},l.a.createElement("div",{className:"multi-textfields-container"},e.get("orgFilesWhereAvailable").map(((e,t)=>l.a.createElement("div",{key:`org-file-availability-${t}`,className:"multi-textfield-container"},l.a.createElement("input",{type:"text",placeholder:"e.g., /org/todo.org",className:"textfield multi-textfield-field",value:e,onChange:k(t)}),l.a.createElement("button",{className:"fas fa-times fa-lg remove-multi-textfield-button",onClick:w(t)}))))),l.a.createElement("div",{className:"add-new-multi-textfield-button-container"},l.a.createElement("button",{className:"fas fa-plus add-new-multi-textfield-button",onClick:E})))))(t),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"File: "),l.a.createElement("select",{onChange:f("file"),style:{width:"90%"}},(0!==u.filter((t=>(t===e.get("file","")).length))?u:[e.get("file"),...u]).map((t=>l.a.createElement("option",{key:t,value:t,selected:t===e.get("file")},t))))),l.a.createElement("div",{className:"capture-template__help-text"},"By default the file opened when capturing is the capture target. Select a specific file if you want this template to always capture to that file. Make sure the file is loaded for it to be selectable here. You might also consider to set the file to load on startup in the file settings so it's always available.")))(t),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field",style:{marginTop:7}},l.a.createElement("div",null,"Header path")),l.a.createElement("div",{className:"capture-template__help-text"},"Specify the path to the header under which the new header should be filed. One header per textfield."),l.a.createElement("div",{className:"multi-textfields-container"},e.get("headerPaths").map(((e,t)=>l.a.createElement("div",{key:`header-path-${t}`,className:"multi-textfield-container"},l.a.createElement("input",{type:"text",placeholder:"e.g., Todos",className:"textfield multi-textfield-field",value:e,onChange:S(t)}),l.a.createElement("button",{className:"fas fa-times fa-lg remove-multi-textfield-button",onClick:T(t)}))))),l.a.createElement("div",{className:"add-new-multi-textfield-button-container"},l.a.createElement("button",{className:"fas fa-plus add-new-multi-textfield-button",onClick:v}))))(t),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Prepend?"),l.a.createElement(Ko,{isEnabled:e.get("shouldPrepend"),onToggle:y})),l.a.createElement("div",{className:"capture-template__help-text"},"By default, new captured headers are appended to the specified header path. Enable this setting to prepend them instead.")))(t),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field",style:{marginTop:7}},l.a.createElement("div",null,"Template")),l.a.createElement("textarea",{className:"textarea template-textarea",rows:"3",value:e.get("template"),onChange:f("template")}),l.a.createElement("div",{className:"capture-template__help-text"},"The template for creating the capture item. You can use the following template variables that will be expanded upon capture:",l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("code",null,"%?")," - Place the cursor here."),l.a.createElement("li",null,l.a.createElement("code",null,"%t")," - Timestamp, date only."),l.a.createElement("li",null,l.a.createElement("code",null,"%T")," - Timestamp, with date and time."),l.a.createElement("li",null,l.a.createElement("code",null,"%u")," - Inactive timestamp, date only."),l.a.createElement("li",null,l.a.createElement("code",null,"%U")," - Inactive timestamp, with date and time."),l.a.createElement("li",null,l.a.createElement("code",null,"%r")," - Raw timestamp, date only, no surrounding punctation.",l.a.createElement("ul",null,l.a.createElement("li",null,"Build custom expressions like"," ",l.a.createElement("code",null,"TODO Monthly - %?\\n DEADLINE: <%r .+1m>")))),l.a.createElement("li",null,l.a.createElement("code",null,"%R")," - Raw timestamp, with date and time, no surrounding punctuation."),l.a.createElement("li",null,l.a.createElement("code",null,"%y")," - Raw year"),l.a.createElement("li",null,l.a.createElement("code",null,"%","<custom variable>")," - A custom variable from a URL param capture. See"," ",l.a.createElement(no,{href:"https://organice.200ok.ch/documentation.html#capture_templates"},"the README file")," ","for more details.")),"You can also use ",l.a.createElement("code",null,"%u")," and ",l.a.createElement("code",null,"%t")," as part of the header path.")))(t),l.a.createElement("div",{className:"capture-template__field-container capture-template__delete-button-container"},l.a.createElement("button",{className:"btn settings-btn capture-template__delete-button",onClick:_},"Delete template")))))))});var Ml=Object(h.b)((e=>{const t=e.org.present.get("files",Object(y.List)()).keySeq().toJS().filter((e=>!e.startsWith(te)));return t.unshift(""),{captureTemplates:e.capture.get("captureTemplates",Object(y.List)()),syncBackendType:e.syncBackend.get("client").type,loadedFilePaths:t}}),(e=>({capture:Object(u.b)(i,e)})))((e=>{let{captureTemplates:t,syncBackendType:n,capture:a,loadedFilePaths:i}=e;const r=(e,t,n)=>a.updateTemplateFieldPathValue(e,t,n),s=e=>a.addNewTemplateOrgFileAvailability(e),c=(e,t)=>a.removeTemplateOrgFileAvailability(e,t),d=e=>a.addNewTemplateHeaderPath(e),h=(e,t)=>a.removeTemplateHeaderPath(e,t),u=e=>a.deleteTemplate(e),p=(e,t)=>a.reorderCaptureTemplate(e,t);return l.a.createElement("div",null,l.a.createElement(Is.c,{droppableId:"capture-templates-editor-droppable",type:"CAPTURE-TEMPLATE"},(e=>l.a.createElement("div",Object.assign({className:"capture-templates-container",ref:e.innerRef},e.droppableProps),0===t.size?l.a.createElement("div",{className:"no-capture-templates-message"},"You don't currently have any capture templates - add one by pressing the"," ",l.a.createElement("i",{className:"fas fa-plus"})," button.",l.a.createElement("br",null),l.a.createElement("br",null),"Capture templates show up in the action drawer and give you quick access to creating new headers (like org-capture)."):l.a.createElement(o.Fragment,null,t.map(((e,t)=>l.a.createElement(xl,{key:e.get("id"),index:t,template:e,syncBackendType:n,loadedFilePaths:i,onFieldPathUpdate:r,onAddNewTemplateOrgFileAvailability:s,onRemoveTemplateOrgFileAvailability:c,onAddNewTemplateHeaderPath:d,onRemoveTemplateHeaderPath:h,onDeleteTemplate:u,onReorder:p}))),e.placeholder)))),l.a.createElement("div",{className:"new-capture-template-button-container"},l.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:()=>a.addNewEmptyCaptureTemplate()})))})),Fl=(n(374),n(375),e=>{let{setting:t,index:n,onFieldPathUpdate:a,onDeleteSetting:i,loadedFilepaths:r,path:s}=e;const[c,d]=Object(o.useState)(!0),h=()=>d(!c),u=e=>n=>a(t.get("id"),[e],n.target.value),p=()=>a(t.get("id"),["defaultOnStartup"],!t.get("defaultOnStartup")),m=()=>a(t.get("id"),["loadOnStartup"],!t.get("loadOnStartup")),g=()=>a(t.get("id"),["includeInAgenda"],!t.get("includeInAgenda")),f=()=>a(t.get("id"),["includeInSearch"],!t.get("includeInSearch")),b=()=>a(t.get("id"),["includeInTasklist"],!t.get("includeInTasklist")),y=()=>a(t.get("id"),["includeInRefile"],!t.get("includeInRefile")),E=()=>{window.confirm(`Are you sure you want to delete the settings for "${t.get("path")}"?`)&&i(t.get("id"))},w=to()("fas fa-2x fa-caret-right file-setting-container__header__caret",{"file-setting-container__header__caret--rotated":!c});return l.a.createElement(Is.b,{draggableId:`file-setting--${t.get("path")}`,index:n},((e,n)=>l.a.createElement("div",Object.assign({className:to()("file-setting-container",{"file-setting-container--dragging":n.isDragging}),ref:e.innerRef},e.draggableProps),l.a.createElement("div",{className:"file-setting-container__header",onClick:h},l.a.createElement("i",{className:w}),l.a.createElement("div",{className:"file-setting-icons"},l.a.createElement("div",{className:to()("default-on-startup-icon",{"fas fa-bookmark fa-lg file-setting-icon":t.get("defaultOnStartup")})}),l.a.createElement("div",{className:to()("load-on-startup-icon",{"fas fa-sync-alt fa-lg file-setting-icon":t.get("loadOnStartup")})}),l.a.createElement("div",{className:to()({"fas fa-calendar-alt fa-lg file-setting-icon":t.get("includeInAgenda")})}),l.a.createElement("div",{className:to()({"fas fa-search fa-lg file-setting-icon":t.get("includeInSearch")})}),l.a.createElement("div",{className:to()({"fas fa-tasks fa-lg file-setting-icon":t.get("includeInTasklist")})}),l.a.createElement("div",{className:to()({"fas fa-file-export fa-lg file-setting-icon":t.get("includeInRefile")})})),l.a.createElement("span",{className:"file_setting-container__header__title"},t.get("path")),l.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg file-setting-container__header__drag-handle"},e.dragHandleProps))),l.a.createElement(po.UnmountClosed,{isOpened:!c,springConfig:{stiffness:300}},l.a.createElement("div",{className:"file-setting-container__content"},(e=>(""===e.get("path")&&u("path")({target:{value:s||r[0]}}),l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Path: "),l.a.createElement("select",{onChange:u("path"),style:{width:"90%"}},[e.get("path"),...r].map((e=>l.a.createElement("option",{key:e,value:e},e))))))))(t),(e=>l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Is default file to load on startup?"),l.a.createElement(Ko,{isEnabled:e.get("defaultOnStartup"),onToggle:p})),l.a.createElement("div",{className:"file-setting__help-text"},"By default, when you start organice, it will display your root file directory. If you prefer to display a specific Org file instead, enable this option. ",l.a.createElement("br",null)," Note: There can only be one default file, of course. If you enable this option for multiple files, organice will pick the first one.")),l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Sync on startup?"),l.a.createElement(Ko,{isEnabled:e.get("loadOnStartup"),onToggle:m})),l.a.createElement("div",{className:"file-setting__help-text"},"By default, files are loaded from localStorage when available and are only synced when visited or when a sync is manually triggered. Enable this setting to always sync this file when opening organice.")),l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Include in Agenda?"),l.a.createElement(Ko,{isEnabled:e.get("includeInAgenda"),onToggle:g})),l.a.createElement("div",{className:"file-setting__help-text"},"By default, only the currently opened file is included in the agenda. Enable this setting to always include this file. The currently viewed file is always included.")),l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Include in Search?"),l.a.createElement(Ko,{isEnabled:e.get("includeInSearch"),onToggle:f})),l.a.createElement("div",{className:"file-setting__help-text"},"By default, only the current viewed file is included in search. Enable this setting to always include this file. The currently loaded file is always included.")),l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Include in Tasklist?"),l.a.createElement(Ko,{isEnabled:e.get("includeInTasklist"),onToggle:b})),l.a.createElement("div",{className:"file-setting__help-text"},"By default, only the current viewed file is included in the tasklist. Enable this setting to always include this file. The currently loaded file is always included.")),l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Include in Refile?"),l.a.createElement(Ko,{isEnabled:e.get("includeInRefile"),onToggle:y})),l.a.createElement("div",{className:"file-setting__help-text"},"By default, only the currently viewed file is available as a refile targets. Enable this setting to always include this file. The currently loaded file is always included."))))(t),l.a.createElement("div",{className:"file-setting__field-container file-setting__delete-button-container"},l.a.createElement("button",{className:"btn settings-btn file-setting__delete-button",onClick:E},"Delete setting")))))))});var Hl=Object(h.b)((e=>{const t=e.base.get("lastViewedPath"),n=e.org.present.get("fileSettings",Object(y.List)()),a=n.map((e=>e.get("path"))),i=e.org.present.get("files",Object(y.List)()).keySeq(),r=a.find((e=>e===t))?null:t,s=i.filter((e=>!e.startsWith(te))).filter((e=>!a.find((t=>t===e)))).toJS();return{fileSettings:n,loadedFilepaths:s,currentPathIfWithoutFileSetting:r}}),(e=>({org:Object(u.b)(r,e)})))((e=>{let{fileSettings:t,loadedFilepaths:n,currentPathIfWithoutFileSetting:a,org:i}=e;const r=(e,t,n)=>i.updateFileSettingFieldPathValue(e,t,n),s=e=>i.deleteFileSetting(e),c=(e,t)=>i.reorderFileSetting(e,t);return l.a.createElement("div",null,l.a.createElement(Is.c,{droppableId:"file-setting-editor-droppable",type:"FILE-SETTING"},(e=>l.a.createElement("div",Object.assign({className:"file-setting-container",ref:e.innerRef},e.droppableProps),0===t.size?l.a.createElement("div",{className:"no-file-setting-message"},"You don't currently have any file settings - add one by pressing the"," ",l.a.createElement("i",{className:"fas fa-plus"})," button.",l.a.createElement("br",null),l.a.createElement("br",null),"File settings allow you to configure how specific files are handeled when multiple files are loaded. Make sure a file is loaded to create a setting entry."):l.a.createElement(o.Fragment,null,t.map(((e,t)=>l.a.createElement(Fl,{key:e.get("id"),index:t,setting:e,path:a,loadedFilepaths:n,onFieldPathUpdate:r,onDeleteSetting:s,onReorder:c}))),e.placeholder)))),0!==n.length&&l.a.createElement("div",{className:"new-capture-template-button-container"},l.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:()=>i.addNewEmptyFileSetting()})))}));class jl extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["renderChangelogFile","renderSampleFile","renderFileBrowser","renderFile","setChangelogUnseenChanges"])}componentDidMount(){this.setChangelogUnseenChanges(),this.props.filesToLoad.forEach((e=>this.props.syncBackend.downloadFile(e))),this.props.filesToSync.forEach((e=>this.props.org.sync({path:e})))}setChangelogUnseenChanges(){const{lastSeenChangelogHash:e,isAuthenticated:t}=this.props;ne().then((n=>{const a=t&&e&&!b.a.isEqual(n,e);this.props.base.setHasUnseenChangelog(a)}))}componentDidUpdate(){this.shouldPromptWhenLeaving()?window.onbeforeunload=()=>!0:window.onbeforeunload=void 0}componentWillUnmount(){window.onbeforeunload=void 0}renderChangelogFile(){return l.a.createElement(Nl,{staticFile:"changelog",shouldDisableDirtyIndicator:!0,shouldDisableActions:!0,shouldDisableSyncButtons:!1,parsingErrorMessage:"The contents of changelog.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!"})}renderSampleFile(){return l.a.createElement(Nl,{staticFile:"sample",shouldDisableDirtyIndicator:!0,shouldDisableActionDrawer:!1,shouldDisableSyncButtons:!0,parsingErrorMessage:"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!"})}renderFileBrowser(e){let{match:{params:{path:t=""}}}=e;return t&&(t="/"+t),l.a.createElement(lo,{path:t})}renderFile(e){let{match:{params:{path:t}}}=e;return t&&(t="/"+t),this.props.path&&!this.props.path.startsWith(te)&&this.props.path!==t?(this.props.org.sync({path:this.props.path}),l.a.createElement($s.a,{push:!0,to:"/file"+this.props.path})):l.a.createElement(Nl,{path:t,shouldDisableDirtyIndicator:!1,shouldDisableActionDrawer:!1,shouldDisableSyncButtons:!1})}shouldPromptWhenLeaving(){return this.props.hasDirtyFiles}render(){const{isAuthenticated:e,loadingMessage:t,fontSize:n,activeModalPage:a,pendingCapture:i,location:{pathname:r},colorScheme:s,theme:c,defaultFilePath:d}=this.props;!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Solarized",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Light";if("OS"===t){const e=window.matchMedia("(prefers-color-scheme: dark)");t="matches"in e&&e.matches?"Dark":"Light"}const n=document.documentElement.style;Object.entries(Eo[e][t]).forEach((e=>{let[t,a]=e;return n.setProperty(t,a)})),document.querySelector('meta[name="theme-color"]').setAttribute("content",Eo[e]["--base3"])}(c,s);const h=!!i&&`/file${i.get("capturePath")}`,u=h&&h!==r,p=to()("App entry-container",{"entry-container--large-font":"Large"===n});return l.a.createElement("div",{className:p},l.a.createElement(ro,null),l.a.createElement(ho,{message:t}),e&&(["keyboard_shortcuts_editor","settings","capture_templates_editor","file_settings_editor","sample"].includes(a)?l.a.createElement(o.Fragment,null,"keyboard_shortcuts_editor"===a&&l.a.createElement(Rl,null),"capture_templates_editor"===a&&l.a.createElement(Ml,null),"file_settings_editor"===a&&l.a.createElement(Hl,null)):l.a.createElement($s.d,null,u&&l.a.createElement($s.a,{to:h}),l.a.createElement($s.b,{path:"/privacy-policy",exact:!0,component:ao}),l.a.createElement($s.b,{path:"/file/:path+",render:this.renderFile}),l.a.createElement($s.b,{path:"/files/:path*",render:this.renderFileBrowser}),l.a.createElement($s.b,{path:"/sample",exact:!0,render:this.renderSampleFile}),l.a.createElement($s.b,{path:"/changelog",exact:!0,render:this.renderChangelogFile}),l.a.createElement($s.b,{path:"/settings",exact:!0},l.a.createElement(Pl,null)),d?l.a.createElement($s.a,{to:d}):l.a.createElement($s.a,{to:"/files"}))))}}var Bl=Object($s.i)(Object(h.b)((e=>{const t=e.org.present.get("files"),n=e.org.present.get("path"),a=e.org.present.get("fileSettings").filter((e=>e.get("defaultOnStartup"))).map((e=>`file${e.get("path")}`)).first(),i=e.org.present.get("fileSettings").filter((e=>e.get("loadOnStartup"))).map((e=>e.get("path"))),r=y.Set.fromKeys(t),s=e=>r.includes(e),o=i.filter((e=>!s(e))),l=i.filter((e=>s(e))),c=!!t.find((e=>e.get("isDirty")));return{path:n,filesToLoad:o,filesToSync:l,defaultFilePath:a,loadingMessage:e.base.get("loadingMessage"),isAuthenticated:e.syncBackend.get("isAuthenticated"),fontSize:e.base.get("fontSize"),lastSeenChangelogHash:e.base.get("lastSeenChangelogHash"),activeModalPage:e.base.get("modalPageStack",Object(y.List)()).last(),pendingCapture:e.org.present.get("pendingCapture"),hasDirtyFiles:c,colorScheme:e.base.get("colorScheme"),theme:e.base.get("theme")}}),(e=>({syncBackend:Object(u.b)(s,e),org:Object(u.b)(r,e),base:Object(u.b)(a,e)})))(jl)),Vl=(n(376),n.p+"static/media/dropbox.9d61ebe9.svg"),Ul=n.p+"static/media/gitlab.9ffaa26e.svg";function Wl(){const[e,t]=Object(o.useState)(!1),[n,a]=Object(o.useState)(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DROPBOX_CLIENT_ID:"5uoz09pasfoxrcj"}).REACT_APP_WEBDAV_URL),[i,r]=Object(o.useState)(""),[s,c]=Object(o.useState)("");return l.a.createElement("div",{id:"webdavLogin"},l.a.createElement("h2",null,l.a.createElement("a",{href:"#webdav",onClick:()=>t(!e),style:{textDecoration:"none"}},"WebDAV")),e&&l.a.createElement(l.a.Fragment,null,l.a.createElement("form",{onSubmit:e=>{e.preventDefault(),qt("authenticatedSyncService","WebDAV"),qt("webdavEndpoint",n),qt("webdavUsername",i),qt("webdavPassword",s),window.location=window.location.origin+"/"}},l.a.createElement("p",null,l.a.createElement("label",{htmlFor:"input-webdav-url"},"URL:"),l.a.createElement("input",{id:"input-webdav-url",name:"url",type:"url",value:n,className:"textfield",onChange:e=>{a(e.target.value)}})),l.a.createElement("p",null,l.a.createElement("label",{htmlFor:"input-webdav-user"},"Username:"),l.a.createElement("input",{id:"input-webdav-user",type:"text",className:"textfield",value:i,onChange:e=>{r(e.target.value)}})),l.a.createElement("p",null,l.a.createElement("label",{htmlFor:"input-webdav-password"},"Password:"),l.a.createElement("input",{id:"input-webdav-password",type:"password",className:"textfield",value:s,onChange:e=>{c(e.target.value)}})),l.a.createElement("input",{type:"submit",value:"Sign-in"})),l.a.createElement("p",null,"Please make sure your WebDAV backend meets the requirements as documented"," ",l.a.createElement("a",{href:"https://organice.200ok.ch/documentation.html#faq_webdav",target:"_blank",rel:"noopener noreferrer"},"here"),", especially"," ",l.a.createElement("a",{href:"https://organice.200ok.ch/documentation.html#webdav_cors",target:"_blank",rel:"noopener noreferrer"},"CORS"),".")))}function zl(){const[e,t]=Object(o.useState)(!1),n="https://gitlab.com/your/project",[a,i]=Object(o.useState)(n);return l.a.createElement(l.a.Fragment,null,l.a.createElement("a",{href:"#gitlab",onClick:()=>t(!e)},l.a.createElement("img",{src:Ul,alt:"GitLab logo"})),e&&l.a.createElement("form",{onSubmit:e=>{const t=(e=>{if(e){e.includes("://")||(e=`https://${e}`);try{const t=new URL(e),n=t.pathname.replace(/(^\/)|(\/$)/g,"");return"gitlab.com"===t.hostname&&n.split("/").length>1?encodeURIComponent(n):void 0}catch(t){return console.error("Error trying to get gitLab project_id from URL:"),void console.error(t)}}})(a);t?(qt("authenticatedSyncService","GitLab"),qt("gitLabProject",t),Ds().fetchAuthorizationCode()):(e.preventDefault(),alert("Project does not appear to be a valid gitlab.com URL"))}},l.a.createElement("p",null,l.a.createElement("label",{htmlFor:"input-gitlab-project"},"Project:"),l.a.createElement("input",{id:"input-gitlab-project",type:"url",className:"textfield",placeholder:n,value:a,onChange:e=>i(e.target.value)})),l.a.createElement("input",{type:"submit",value:"Sign-in"})))}class Gl extends o.PureComponent{constructor(e){super(e),b.a.bindAll(this,["handleDropboxClick"])}handleDropboxClick(){qt("authenticatedSyncService","Dropbox");const e=window.location.origin+"/",t=new Us.DropboxAuth({clientId:"5uoz09pasfoxrcj",fetch:fetch.bind(window)});t.getAuthenticationUrl(e,void 0,"code","offline",void 0,void 0,!0).then((e=>{qt("codeVerifier",t.codeVerifier),window.location.href=e})).catch((e=>console.error(e)))}render(){return l.a.createElement("div",{className:"sync-service-sign-in-container"},l.a.createElement("p",{className:"sync-service-sign-in__help-text"},"organice syncs your files with Dropbox, GitLab, and WebDAV."),l.a.createElement("p",{className:"sync-service-sign-in__help-text"},"Click to sign in with:"),l.a.createElement("div",{className:"sync-service-container"},l.a.createElement("a",{href:"#dropbox",onClick:this.handleDropboxClick},l.a.createElement("img",{src:Vl,alt:"Dropbox logo",className:"dropbox-logo"}))),l.a.createElement("div",{className:"sync-service-container"},l.a.createElement(zl,null)),l.a.createElement("div",{className:"sync-service-container"},l.a.createElement(Wl,null)),l.a.createElement("footer",null,"For questions regarding synchronization back-ends, please consult the"," ",l.a.createElement("a",{href:"https://organice.200ok.ch/documentation.html#sync_backends",target:"_blank",rel:"noopener noreferrer"},"documentation"),"."))}}var $l=Object($s.i)(Object(h.b)((e=>({isAuthenticated:e.syncBackend.get("isAuthenticated")})))((e=>{let{isAuthenticated:t}=e;return t?l.a.createElement(Bl,null):t?void 0:l.a.createElement("div",null,l.a.createElement($s.d,null,l.a.createElement($s.b,{path:"/privacy-policy",exact:!0},l.a.createElement("div",{className:"App entry-container"},l.a.createElement(ro,null),l.a.createElement(ao,null))),l.a.createElement($s.b,{path:"/sample",exact:!0},l.a.createElement("div",{className:"App entry-container"},l.a.createElement(ro,null),l.a.createElement(Nl,{staticFile:"sample",shouldDisableDirtyIndicator:!0,shouldDisableActionDrawer:!1,shouldDisableSyncButtons:!0,parsingErrorMessage:"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!"}))),l.a.createElement($s.b,{path:"/sign_in",exact:!0},l.a.createElement("div",{className:"App entry-container"},l.a.createElement(ro,null),l.a.createElement(Gl,null))),l.a.createElement($s.b,{path:"/",exact:!0},l.a.createElement("div",{className:"App landing-page"},l.a.createElement(Qs,null))),l.a.createElement($s.a,{to:"/"})))})));const Kl=Object(f.debounce)((e=>{if(e.getState().syncBackend.get("client")&&e.getState().base.get("shouldSyncOnBecomingVisibile")){const t=e.getState().org.present.get("path");let n=e.getState().org.present.get("fileSettings").filter((e=>e.get("loadOnStartup"))).map((e=>e.get("path")));!t||t.startsWith(te)||n.find((e=>t===e))||(n=n.push(t)),n.forEach((t=>{ji({path:t,shouldSuppressMessages:!0})(e.dispatch,e.getState)}))}}),1e3);function Yl(e){let t=function(){const e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(let t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}();if(t){const n=t.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(n,(()=>Kl(e)))}}Object(uo.configure)({ignoreTags:[]});class Jl extends o.PureComponent{constructor(e){super(e),Ss();const t=Jt(),n=Xt("authenticatedSyncService",!0);let a=null;if(n)switch(n){case"Dropbox":a=zs(),t.syncBackend=Object(y.Map)({isAuthenticated:!0,client:a});break;case"GitLab":const e=Ds();e.isAuthorized()?(a=Ns(e),t.syncBackend=Object(y.Map)({isAuthenticated:!0,client:a})):(async e=>{let t=!1;try{t=await e.isReturningFromAuthServer(),await e.getAccessToken()}catch{t=!1}if(!t)return void alert("Unexpected sign in error, please try again");const n=Ns(e);await n.isProjectAccessible()?window.location.search="":alert("Failed to access GitLab project - is the URL correct?")})(e);break;case"WebDAV":a=((e,t,n)=>{const a=Object(Gs.createClient)(e,{username:t,password:n}),i=e=>{const t=(e=>e.filter((e=>"directory"===e.type||e.basename.match(/org$|org_archive$/))).sort(((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:e.basename>t.basename?1:-1)))(e);return Object(y.fromJS)(t.map((e=>({id:e.filename,name:e.basename,isDirectory:"directory"===e.type,path:e.filename}))))},r=e=>new Promise(((t,n)=>{a.getDirectoryContents(e).then((e=>t({listing:i(e)}))).catch(n)})),s=(e,t)=>new Promise(((n,i)=>a.putFileContents(e,t,{overwrite:!0}).then(n()).catch(i))),o=n=>new Promise(((i,r)=>a.stat(n).then((e=>{a.getFileContents(n,{format:"text"}).then((t=>{i({contents:t,lastModifiedAt:new Date(Date.parse(e.lastmod)).toISOString()})})).catch((e=>{console.error(n,": get file failed",e),r()}))})).catch((a=>{a&&a.response&&-1!==[401,403].indexOf(a.response.status)&&alert(t+"@"+e+": "+a.response.statusText),console.error(n,": get stat failed",a),r()}))));return{type:"WebDAV",isSignedIn:()=>new Promise((e=>{r("/").then((()=>{e(!0)})).catch((t=>{console.error("Login didn't work, error: ",JSON.stringify(t)),e(!1)}))})),getDirectoryListing:r,getMoreDirectoryListing:e=>new Promise(((e,t)=>e())),updateFile:s,createFile:s,getFileContentsAndMetadata:o,getFileContents:e=>Object(f.isEmpty)(e)?Promise.reject("No path given"):new Promise(((t,n)=>o(e).then((e=>{let{contents:n}=e;return t(n)})).catch(n))),deleteFile:e=>new Promise(((t,n)=>a.deleteFile(e).then(t).catch((t=>{t&&t.response&&404===t.response.status||(console.error(e,": delete failed",t),n())}))))}})(Xt("webdavEndpoint"),Xt("webdavUsername"),Xt("webdavPassword")),t.syncBackend=Object(y.Map)({isAuthenticated:!0,client:a})}const i=Ts(window.location.search),{captureFile:r,captureTemplateName:s,captureContent:o}=i;if(r&&s){const e=r.startsWith("/")?r:`/${r}`,n=Object(y.Map)(Object.entries(i).map((e=>{let[t,n]=e;const a="captureVariable_";return t.startsWith(a)?[t.substring(16),n]:null})).filter((e=>!!e)));t.org.present=t.org.present.set("pendingCapture",Object(y.Map)({capturePath:e,captureTemplateName:s,captureContent:o,customCaptureVariables:n}))}var l;this.store=(e=>Object(u.e)(ks,e,vs(Object(u.a)(p.a,fs,bs))))(t),this.store.subscribe((l=this.store,Wt?()=>{const e=l.getState(),t=Kt(e,Gt);if(t.forEach((e=>{let[t,n]=e;t&&n&&localStorage.setItem(t,n)})),e.base.get("shouldStoreSettingsInSyncBackend")){const n=Yt(t);window.previousSettingsFileContents!==n&&zt(e.syncBackend.get("client"),n),window.previousSettingsFileContents=n}const n=e.org.present.get("path"),a=e.org.present.getIn(["files",n,"headers"]);if(n&&a){const e=fe(a);let t={};const i=localStorage.getItem("headerOpenness");i&&(t=JSON.parse(i)),t[n]=e,localStorage.setItem("headerOpenness",JSON.stringify(t))}}:()=>{})),a?a.isSignedIn().then((e=>{e?((e,t)=>{const n=t().syncBackend.get("client");if(!n)return;let a=null;switch(n.type){case"Dropbox":case"GitLab":case"WebDAV":a=n.getFileContents("/.organice-config.json")}a.then((t=>{try{let n;n="string"===typeof t?JSON.parse(t):t,e(kt(n)),e(Vt(n)),e(us(n))}catch(n){}})).catch((()=>{}))})(this.store.dispatch,this.store.getState):this.store.dispatch(Rs())})):this.store.getState().org.present.get("pendingCapture")&&this.store.dispatch(Xe("You need to sign in before you can use capture templates",5e3)),this.store.dispatch(Qe("sample")),this.store.dispatch(Qe("changelog")),function(e){const t=e.getState().org.present.get("path"),n=window.location.href.match(/.*file(\/.*)/);let a=t;n&&(a=n[1]),window.onpopstate=function(){t!==a&&e.dispatch(zi(t))}}(this.store),Yl(this.store),function(e){e.dispatch(qe(navigator.onLine)),window.onoffline=function(){e.dispatch(qe(!1))},window.ononline=function(){e.dispatch(qe(!0)),setTimeout((()=>{ji({shouldSuppressMessages:!0,forceAction:"manual"})(e.dispatch,e.getState)}),2e3)}}(this.store),b.a.bindAll(this,["handleDragEnd"])}handleDragEnd(e){e.destination&&("TAG"===e.type?this.store.dispatch(Yr(e.source.index,e.destination.index)):"PROPERTY-LIST"===e.type?this.store.dispatch(Jr(e.source.index,e.destination.index)):"CAPTURE-TEMPLATE"===e.type?this.store.dispatch(Ut(e.source.index,e.destination.index)):"FILE-SETTING"===e.type&&this.store.dispatch(cs(e.source.index,e.destination.index)))}render(){return l.a.createElement(Is.a,{onDragEnd:this.handleDragEnd},l.a.createElement(_s.a,null,l.a.createElement(h.a,{store:this.store},l.a.createElement($l,null))))}}const ql=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Xl(e){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const t=e.installing;t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((e=>{console.error("Error during service worker registration:",e)}))}d.a.render(l.a.createElement(Jl,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const e="/service-worker.js";ql?(!function(e){fetch(e).then((t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):Xl(e)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Xl(e)}))}}()}},[[377,1,2]]]);
//# sourceMappingURL=main.a18f989e.chunk.js.map